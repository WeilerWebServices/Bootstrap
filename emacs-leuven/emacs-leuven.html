<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Emacs-Leuven</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Fabrice Niessen" />
<meta name="keywords" content="emacs, dotfile, config" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/lib/js/jquery.stickytableheaders.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/readtheorg/js/readtheorg.js"></script>
</head>
<body>
<div id="content">
<h1 class="title">Emacs-Leuven</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgc2285ff">Description</a></li>
<li><a href="#orgaf4fc3a">Header</a></li>
<li><a href="#org6b7d465">Code</a></li>
<li><a href="#orge6d5dc7">Pre-init</a>
<ul>
<li><a href="#orgd255849">Startup Time</a></li>
<li><a href="#orgc4ec533">GNU Emacs Internals: Garbage Collection</a></li>
</ul>
</li>
<li><a href="#org64b1b50">Init</a></li>
<li><a href="#orgac960a0">Loading Libraries of Lisp Code for Emacs</a>
<ul>
<li><a href="#org8e889aa">Creating and selecting buffers</a></li>
</ul>
</li>
<li><a href="#orgf17b105">Environment</a></li>
<li><a href="#org4394d89">Debugging</a></li>
<li><a href="#orgf4a8798">Emacs Lisp Packages</a>
<ul>
<li><a href="#orgceba6ec">The Package Menu Buffer</a></li>
<li><a href="#org00d3a2a">Package Installation</a></li>
</ul>
</li>
<li><a href="#org3c400de">The Organization of the Screen</a></li>
<li><a href="#org8590b36">Exiting Emacs</a></li>
<li><a href="#orgabaeca5">Basic Editing Commands</a>
<ul>
<li><a href="#org7257ba3">Inserting Text</a></li>
<li><a href="#orgb26b740">Moving Point Location</a></li>
<li><a href="#orgcf753a4">Basic Undoing Changes</a></li>
</ul>
</li>
<li><a href="#org5c7e5bc">The Minibuffer</a>
<ul>
<li><a href="#org8be9c38">Editing in the Minibuffer</a></li>
<li><a href="#org6eaecfd">Completion</a></li>
<li><a href="#orgf61a8a2">Minibuffer History</a></li>
<li><a href="#org3970ad1">Repeating Minibuffer Commands</a></li>
</ul>
</li>
<li><a href="#orgf634821">Help</a>
<ul>
<li><a href="#org0cc28c6">Help Summary</a></li>
<li><a href="#org31cf208">Apropos</a></li>
<li><a href="#org23daa04">Misc Help Commands</a></li>
</ul>
</li>
<li><a href="#orgc308508">The Mark and the Region</a>
<ul>
<li><a href="#org54bfbc2">Setting the Mark</a></li>
<li><a href="#org409c16b">Commands to Mark Textual Objects</a></li>
<li><a href="#orgda69de3">Operating on the Region</a></li>
<li><a href="#org9559561">Shift Selection</a></li>
<li><a href="#orgf6e57d1">Multiple selections</a></li>
</ul>
</li>
<li><a href="#org5fab9c6">Killing and Moving Text</a>
<ul>
<li><a href="#org70df8d1">Deletion and Killing</a></li>
<li><a href="#org54d18e9">Yanking</a></li>
<li><a href="#orgfca9711">Cutting and Pasting on Graphical Displays</a></li>
<li><a href="#org7df20d0">Rectangles</a></li>
<li><a href="#orgf37693e">CUA Bindings</a></li>
</ul>
</li>
<li><a href="#org0e0c003">Registers (Navigation)</a>
<ul>
<li><a href="#org969c883">Saving Positions in Registers</a></li>
<li><a href="#orgd8ec213">Navigating with Bookmarks</a></li>
<li><a href="#orge0c1fd9">Avy (alternative to Ace Jump)</a></li>
</ul>
</li>
<li><a href="#orgedd8dd1">Controlling the Display</a>
<ul>
<li><a href="#orgc905102">Scrolling</a></li>
<li><a href="#org9d18bcb">Automatic Scrolling</a></li>
<li><a href="#org6023741">Horizontal Scrolling</a></li>
<li><a href="#orgbaee368">Narrowing</a></li>
<li><a href="#org480b568">Font Lock mode</a></li>
<li><a href="#org5421363">Interactive Highlighting</a></li>
<li><a href="#orgbe9987e">Window Fringes</a></li>
<li><a href="#org7073da4">Displaying Boundaries</a></li>
<li><a href="#org7da7427">Useless Whitespace</a></li>
<li><a href="#org9db8e18">Selective Display</a></li>
<li><a href="#org298d9d9">Optional Mode Line Features</a></li>
<li><a href="#org2a1eeda">How Text Is Displayed</a></li>
<li><a href="#org5140926">Displaying the Cursor</a></li>
<li><a href="#org11f2773">Truncation of Lines</a></li>
<li><a href="#org3079c58">Customization of Display</a></li>
</ul>
</li>
<li><a href="#orge3529c1">Searching and Replacement</a>
<ul>
<li><a href="#org8c7b8f4">Incremental Search (aka &ldquo;Live Search&rdquo;)</a></li>
<li><a href="#orgbf7075b">Symbol Search</a></li>
<li><a href="#org02d1292">Regexp Search</a></li>
<li><a href="#org3ae400c">Search Case</a></li>
<li><a href="#org53e815f">Replacement Commands</a></li>
<li><a href="#org466ef51">Other Search-and-Loop Commands</a></li>
</ul>
</li>
<li><a href="#org9a6c78d">Commands for Fixing Typos</a>
<ul>
<li><a href="#orgddad89f">Checking and Correcting Spelling</a></li>
</ul>
</li>
<li><a href="#orge1533fe">Keyboard Macros</a>
<ul>
<li><a href="#orgb5236d5">Basic Use</a></li>
<li><a href="#org67caaae">Naming and Saving Keyboard Macros</a></li>
</ul>
</li>
<li><a href="#orgd2fb698">Files Handling</a>
<ul>
<li><a href="#orgb9545c8">Visiting Files</a></li>
<li><a href="#orge9882bc">Saving Files</a></li>
<li><a href="#org10ef735">Reverting a Buffer</a></li>
<li><a href="#org4e64a7a">Auto Reverting Non-File Buffers</a></li>
<li><a href="#org514eac9">Auto-Saving: Protection Against Disasters</a></li>
<li><a href="#org53d6fc1">Comparing Files</a></li>
<li><a href="#orga946410">Diff mode</a></li>
<li><a href="#orgc3afe05">Miscellaneous File Operations</a></li>
<li><a href="#org1dd59af">Accessing Compressed Files</a></li>
<li><a href="#orga8193aa">Auto Encryption</a></li>
<li><a href="#orgac36200">Remote Files</a></li>
<li><a href="#orgd4abd67">Convenience Features for Finding Files</a></li>
</ul>
</li>
<li><a href="#orgdc910c2">Using Multiple Buffers</a>
<ul>
<li><a href="#org2a520f9">Listing Existing Buffers</a></li>
<li><a href="#orgafee01d">Killing Buffers</a></li>
<li><a href="#org291962c">Operating on Several Buffers</a></li>
<li><a href="#orgf3df0ef">Convenience Features and Customization of Buffer Handling</a></li>
</ul>
</li>
<li><a href="#orgd1b9835">Multiple Windows</a>
<ul>
<li><a href="#orgc0bcafe">Concepts of Emacs Windows</a></li>
<li><a href="#org6ca990c">Using Other Windows</a></li>
<li><a href="#orge7c63d7">Deleting and Rearranging Windows</a></li>
<li><a href="#org053ca49">Dedicated windows</a></li>
<li><a href="#org791b451">Displaying a Buffer in a Window</a></li>
<li><a href="#org6fd38c2">Window Handling Convenience Features and Customization</a></li>
</ul>
</li>
<li><a href="#orgb6826aa">Frames and Graphical Displays</a>
<ul>
<li><a href="#org4bcb063">Mouse Commands for Editing</a></li>
<li><a href="#org9675dac">Creating Frames</a></li>
<li><a href="#org0945091">Frame Commands</a></li>
<li><a href="#orgfc38d63">Speedbar Frames</a></li>
<li><a href="#org75e4721">Scroll Bars</a></li>
<li><a href="#orgdcebcd4">Tool Bars</a></li>
<li><a href="#org94769d2">Using Dialog Boxes</a></li>
<li><a href="#orgfe862f2">Tooltips</a></li>
</ul>
</li>
<li><a href="#org3a64455">International Character Set Support</a>
<ul>
<li><a href="#org24547f1">Introduction to International Character Sets</a></li>
<li><a href="#org7592e62">Language Environments</a></li>
<li><a href="#orgb5350c6">Input Methods</a></li>
<li><a href="#orgaf14607">Recognizing Coding Systems</a></li>
<li><a href="#org50ff135">Specifying a File&rsquo;s Coding System</a></li>
<li><a href="#orgdf11622">Bidirectional Editing</a></li>
</ul>
</li>
<li><a href="#orgf93b2d2">Major and Minor Modes</a>
<ul>
<li><a href="#org9a7b621">How Major Modes are Chosen</a></li>
</ul>
</li>
<li><a href="#org472b030">Indentation</a>
<ul>
<li><a href="#org2de6df4">Indentation Commands</a></li>
<li><a href="#org99c3b98">Tabs vs. Spaces</a></li>
<li><a href="#orgb37c68b">Convenience Features for Indentation</a></li>
</ul>
</li>
<li><a href="#orgb04fefd">Commands for Human Languages</a>
<ul>
<li><a href="#orgf1b59e7">Words</a></li>
<li><a href="#org485b297">Sentences</a></li>
<li><a href="#org524cc58">Filling Text</a></li>
<li><a href="#orgcca4d53">Case Conversion Commands</a></li>
<li><a href="#orga906bd8">Outline Mode</a></li>
<li><a href="#org7b19fd4">Boxquote</a></li>
<li><a href="#org4b137b2">Phonetic</a></li>
</ul>
</li>
<li><a href="#orge51d507">Org Mode (Getting Things Done)</a>
<ul>
<li><a href="#org5e1153b">Document Structure</a></li>
<li><a href="#org16ebc5e">Tables</a></li>
<li><a href="#orgea32933">Hyperlinks</a></li>
<li><a href="#org33b058a">&ldquo;TODO&rdquo; Items</a></li>
<li><a href="#orgb158aaf">Tags</a></li>
<li><a href="#org9433598">Properties and Columns</a></li>
<li><a href="#orgabdcdc6">Dates and Times</a></li>
<li><a href="#org6a326ca">Capture - Refile - Archive</a></li>
<li><a href="#org8b92228">Agenda Views</a></li>
<li><a href="#orgd720f65">Markup for rich export</a></li>
<li><a href="#org3e93543">Exporting</a></li>
<li><a href="#org389f060">Publishing</a></li>
<li><a href="#orgd75d5a3">Working With Source Code</a></li>
<li><a href="#org7d1226a">Miscellaneous</a></li>
<li><a href="#orgd022428">Other</a></li>
<li><a href="#org020b4d5">A.3 Adding hyperlink types</a></li>
<li><a href="#org4208440">A.5 Tables and lists in arbitrary syntax</a></li>
<li><a href="#org780e260">A.6 Dynamic blocks</a></li>
<li><a href="#org8736627">Org-contrib</a></li>
</ul>
</li>
<li><a href="#org10e0e6d">TeX</a>
<ul>
<li><a href="#orgccdde24">Native TeX Mode</a></li>
<li><a href="#orgd2d0df7">AUCTeX</a></li>
<li><a href="#org1f819ef">Preview-LaTeX</a></li>
<li><a href="#orgf7eb36e">RefTeX</a></li>
<li><a href="#org791a844">BibTeX</a></li>
</ul>
</li>
<li><a href="#org31d145e">SGML and HTML Modes</a>
<ul>
<li><a href="#org1e401f7">HTML</a></li>
<li><a href="#org30e9568">XHTML</a></li>
<li><a href="#orgcf58fcb">web-mode</a></li>
<li><a href="#org74fc797">XML</a></li>
<li><a href="#org08555af">Highlight the closing tag (Pair highlighting)</a></li>
<li><a href="#org5a6faea">CSS</a></li>
</ul>
</li>
<li><a href="#org7a8a7a8">Editing Programs</a>
<ul>
<li><a href="#org443e4c1">Major Modes for Programming Languages</a></li>
<li><a href="#org1bacaee">Top-Level Definitions, or Defuns</a></li>
<li><a href="#org0b9862e">Indentation for Programs</a></li>
<li><a href="#org74f5c20">Commands for Editing with Parentheses</a></li>
<li><a href="#org3effb30">Manipulating Comments</a></li>
<li><a href="#org1252ac2">Documentation Lookup</a></li>
<li><a href="#org3e27d98">Hideshow minor mode (code folding)</a></li>
<li><a href="#orge11bfbe">Completion for Symbol Names</a></li>
<li><a href="#orgbe9379c">Glasses minor mode</a></li>
<li><a href="#orgde15f1b">C and related modes</a></li>
<li><a href="#orgb2efb1c">Java</a></li>
<li><a href="#org84f3430">JavaScript</a></li>
<li><a href="#org94fb42f">SQL</a></li>
</ul>
</li>
<li><a href="#org6c7220c">Compiling and Testing Programs</a>
<ul>
<li><a href="#orgbb0b591">Running Compilations under Emacs</a></li>
<li><a href="#org35b950b">Compilation Mode</a></li>
<li><a href="#orgcff247c">Searching with Grep under Emacs</a></li>
<li><a href="#org68ba600">Finding Syntax Errors On The Fly</a></li>
<li><a href="#org4bab522">Running Debuggers Under Emacs</a></li>
<li><a href="#org834a12e">Debugging Lisp programs</a></li>
<li><a href="#orgb246be4">Executing Lisp Expressions</a></li>
<li><a href="#orgdb15d85">Libraries of Lisp Code for Emacs</a></li>
<li><a href="#orgee32d35">Evaluating Emacs Lisp Expressions</a></li>
<li><a href="#org47d00a1">Lisp Interaction Buffers (<code>*scratch*</code>)</a></li>
<li><a href="#org5f82040">Switching to a Buffer in a Window</a></li>
</ul>
</li>
<li><a href="#orgf134b99">Maintaining Programs</a>
<ul>
<li><a href="#org4bb7919">Version Control</a></li>
<li><a href="#orgb8361c9">Change Logs</a></li>
<li><a href="#orgcbf4c11">Tags Tables (navigating code)</a></li>
<li><a href="#org8bee6d2">Emacs Development Environment</a></li>
</ul>
</li>
<li><a href="#orgb7079e7">Abbrevs (Snippets, Auto Replacements, or live Code Templates)</a>
<ul>
<li><a href="#org3fe53d4">Controlling Abbrev Expansion</a></li>
<li><a href="#orgf08f88d">Dynamic Abbrev Expansion</a></li>
<li><a href="#orgf766f0c">Code Completion</a></li>
</ul>
</li>
<li><a href="#orgb5eb15b">Dired, the Directory Editor</a>
<ul>
<li><a href="#org2ebd7f2">Entering Dired</a></li>
<li><a href="#org506582a">Emulation of <code>ls</code> on MS-Windows</a></li>
<li><a href="#orgaf7c822">Navigation in the Dired Buffer</a></li>
<li><a href="#orgf70039f">Deleting Files with Dired</a></li>
<li><a href="#org0e7855b">Visiting Files in Dired</a></li>
<li><a href="#org623e795">Operating on Files</a></li>
<li><a href="#orgbe9c459">Updating the Dired Buffer</a></li>
<li><a href="#org0f87350">Dired and <code>find</code></a></li>
<li><a href="#org6a48900">Editing the Dired Buffer</a></li>
<li><a href="#org865485e">Viewing Image Thumbnails in Dired</a></li>
<li><a href="#orgf8014f6">Other Dired features</a></li>
<li><a href="#orge1eeac6">Dired &ldquo;extra&rdquo; features</a></li>
<li><a href="#orgce308dc">Dired+</a></li>
<li><a href="#org4dba356">VC diff highlighting</a></li>
</ul>
</li>
<li><a href="#org487e173">The Calendar and the Diary</a>
<ul>
<li><a href="#org20e3b3a">Calendar Motion</a></li>
<li><a href="#org4169397">Scroll Calendar</a></li>
<li><a href="#orge7a7235">Times of Sunrise/Sunset</a></li>
<li><a href="#org74e9597">Diary</a></li>
<li><a href="#orge4b1f1f">Appointments</a></li>
<li><a href="#orge359ef4">Advanced Calendar/Diary Usage</a></li>
<li><a href="#orgb0685fd">Calendar framework</a></li>
</ul>
</li>
<li><a href="#orgc77204a">Sending Mail</a></li>
<li><a href="#org8dce648">Gnus</a>
<ul>
<li><a href="#org2c43391">BBDB</a></li>
</ul>
</li>
<li><a href="#orga5e8236">Document Viewing</a>
<ul>
<li><a href="#org32d994c">Navigation</a></li>
<li><a href="#orga6dd705">Conversion</a></li>
</ul>
</li>
<li><a href="#org43b91b4">Web Browsing</a>
<ul>
<li><a href="#org33530c3">EWW (Emacs Web Browser)</a></li>
</ul>
</li>
<li><a href="#org8a32fc2">Running Shell Commands from Emacs</a>
<ul>
<li><a href="#orgcecf76f">Single Shell</a></li>
<li><a href="#org15dd22c">Interactive Subshell</a></li>
<li><a href="#orge40ee1d">Shell Mode</a></li>
<li><a href="#org7124db4">Shell Prompts</a></li>
<li><a href="#org614dc11">Shell Command History</a></li>
<li><a href="#org79326c5">Directory Tracking</a></li>
<li><a href="#org38d257e">Options</a></li>
<li><a href="#orgbb878c3">Term Mode</a></li>
<li><a href="#org34fb1f5">Remote Host</a></li>
<li><a href="#orga78f21d">Serial Terminal</a></li>
<li><a href="#org24063d8">Helper for GNU Emacs on w32</a></li>
<li><a href="#orgd6cf69d">Helper for Cygwin Emacs</a></li>
<li><a href="#org03c3180">Emacs Speaks Statistics (ESS)</a></li>
<li><a href="#org2d8614a">Proced</a></li>
</ul>
</li>
<li><a href="#orgd764534">Using Emacs Server</a></li>
<li><a href="#orgfcc393b">Printing Hard Copies</a></li>
<li><a href="#orgdf3b949">Sorting Text</a></li>
<li><a href="#org0d24e6b">Saving Emacs Sessions</a></li>
<li><a href="#orgae20938">Hyperlinking and Navigation Features</a>
<ul>
<li><a href="#orgec882df">Following URLs</a></li>
<li><a href="#org034b232">Finding Files and URLs at Point</a></li>
<li><a href="#org008b71b">Google search</a></li>
<li><a href="#org0b7e5af">How do I?  (StackOverflow)</a></li>
<li><a href="#org46981cb">Babel translator</a></li>
</ul>
</li>
<li><a href="#org5bb9b45">Other Amusements</a></li>
<li><a href="#org0fa1848">Customization</a>
<ul>
<li><a href="#org5716267">Color</a></li>
<li><a href="#org7eae814">Variables</a></li>
<li><a href="#org16ac0a3">Key Bindings</a></li>
<li><a href="#orgaa11d5c">Syntax Table</a></li>
</ul>
</li>
<li><a href="#orgeae8056">Emacs Display</a>
<ul>
<li><a href="#org5502b5c">Faces</a></li>
<li><a href="#orgf9bca00">Images</a></li>
</ul>
</li>
<li><a href="#orge63b264">Emacs Lisp</a>
<ul>
<li><a href="#org712f45e">Variables</a></li>
</ul>
</li>
<li><a href="#org9e995de">Calc</a>
<ul>
<li><a href="#orgdee03ee">Introduction</a></li>
<li><a href="#org4c4081c">Embedded Mode</a></li>
</ul>
</li>
<li><a href="#org0f79863">IRC client for Emacs</a></li>
<li><a href="#orgc0f72d1">Emacs and Microsoft Windows/MS-DOS</a></li>
<li><a href="#org566d66d">Profiler</a></li>
<li><a href="#org5599d81">Reporting Bugs</a></li>
<li><a href="#org5f6b9b4">Post Init</a></li>
<li><a href="#orgeec5eb4">Leuven</a>
<ul>
<li><a href="#org5ee40c1">Feature</a></li>
<li><a href="#orgaaec302">File Local Variables</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgc2285ff" class="outline-2">
<h2 id="orgc2285ff">Description</h2>
<div class="outline-text-2" id="text-orgc2285ff">
<p>
Emacs can be very difficult for the beginner, as many of the default choices may
seem (and sometimes are) ugly or awkward.
</p>

<p>
But &#x2013; that&rsquo;s the joy of Emacs &#x2013; nearly everything can be adjusted!  Hence,
this set of customizations (from one pathological Emacs tweaker) to &ldquo;short-cut&rdquo;
that initial process.
</p>

<p>
Citations:
</p>

<ul class="org-ul">
<li>&ldquo;Show me your ~/.emacs and I will tell you who you are.&rdquo; <br />
&#x2013; Bogdan Maryniuk</li>

<li>&ldquo;Emacs is like a laser guided missile.  It only has to be slightly
mis-configured to ruin your whole day.&rdquo; <br />
&#x2013; Sean McGrath</li>

<li>&ldquo;While any text editor can save your files, only Emacs can save your soul.&rdquo; <br />
&#x2013; Per Abrahamsen</li>
</ul>
</div>
</div>

<div id="outline-container-orgaf4fc3a" class="outline-2">
<h2 id="orgaf4fc3a">Header</h2>
<div class="outline-text-2" id="text-orgaf4fc3a">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;; </span><span class="org-comment">emacs-leuven.el --- Emacs configuration file with more pleasant defaults</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Copyright (C) 1999-2020 Fabrice Niessen</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Author: Fabrice Niessen &lt;(concat "fniessen" at-sign "pirilampo.org")&gt;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">URL: https://github.com/fniessen/emacs-leuven</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Version: 20200210.1947</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Keywords: emacs, dotfile, config</span>

<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;;    </span><span class="org-comment">___ _ __ ___   __ _  ___ ___</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">/ _ \ '_ ` _ \ / _` |/ __/ __|</span>
<span class="org-comment-delimiter">;;  </span><span class="org-comment">|  __/ | | | | | (_| | (__\__ \</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(_)___|_| |_| |_|\__,_|\___|___/</span>
<span class="org-comment-delimiter">;;</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">This file is NOT part of GNU Emacs.</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">This file is free software: you can redistribute it and/or</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">modify it under the terms of the GNU General Public License as</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">published by the Free Software Foundation, either version 3 of</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">the License, or (at your option) any later version.</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">This file is distributed in the hope that it will be useful,</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">GNU General Public License for more details.</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">You should have received a copy of the GNU General Public License</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">along with this file. If not, see <a href="http://www.gnu.org/licenses/">&lt;http://www.gnu.org/licenses/&gt;</a>.</span>

<span class="org-comment-delimiter">;;; </span><span class="org-comment">Commentary:</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Emacs 24.4+ configuration file with many packages already enabled and a more</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">pleasant set of defaults.</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Operating systems: supposed to work both for Windows and for Linux.</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Minimal .emacs configuration file:</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;;     </span><span class="org-comment">(add-to-list 'load-path "/path/to/emacs-leuven/")</span>
<span class="org-comment-delimiter">;;     </span><span class="org-comment">(require 'emacs-leuven)</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">To get more debug info about the packages getting loaded, add the following</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">line before requiring Emacs-Leuven.</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;;     </span><span class="org-comment">;; Show messages describing progress of loading Emacs-Leuven.</span>
<span class="org-comment-delimiter">;;     </span><span class="org-comment">(setq leuven-verbose-loading t)</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">To avoid being questioned about packages to add to your local Emacs</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">installation (though, I think you should install them), add the following</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">line before requiring Emacs-Leuven.</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;;     </span><span class="org-comment">;; Do not (try to) install extra Emacs packages.</span>
<span class="org-comment-delimiter">;;     </span><span class="org-comment">(setq package-selected-packages nil)</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">To install all the extra packages used hereunder, without being questioned,</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">add the following line before requiring Emacs-Leuven.</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;;     </span><span class="org-comment">;; Install all extra Emacs packages without asking for confirmation.</span>
<span class="org-comment-delimiter">;;     </span><span class="org-comment">(setq leuven-install-all-missing-elpa-packages t)</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">For help on the Emacs Editor, see (info "(emacs)")  &lt;== `C-x C-e' here!</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org6b7d465" class="outline-2">
<h2 id="org6b7d465">Code</h2>
<div class="outline-text-2" id="text-org6b7d465">
<p>
Some things are &ldquo;activated&rdquo; by default in <code>lisp/loaddefs.el</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;; </span><span class="org-comment">Code:</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">This file is only provided as an example.  Customize it to your own taste!</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge6d5dc7" class="outline-2">
<h2 id="orge6d5dc7">Pre-init</h2>
<div class="outline-text-2" id="text-orge6d5dc7">
</div>
<div id="outline-container-orgd255849" class="outline-3">
<h3 id="orgd255849">Startup Time</h3>
<div class="outline-text-3" id="text-orgd255849">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Time the loading of Emacs Leuven.  Keep this on top of your .emacs.</span>
(<span class="org-keyword">defconst</span> <span class="org-variable-name">leuven--start-time</span> (current-time)
  <span class="org-doc">"Value of `</span><span class="org-doc"><span class="org-constant">current-time</span></span><span class="org-doc">' before loading the Emacs-Leuven library."</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc4ec533" class="outline-3">
<h3 id="orgc4ec533">GNU Emacs Internals: Garbage Collection</h3>
<div class="outline-text-3" id="text-orgc4ec533">
<p>
By default Emacs will initiate GC every 0.76 MB allocated (<code>gc-cons-threshold</code> ==
800,000 B).
</p>

<p>
If you have a modern machine, I encourage you to add the following:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Speed up things by preventing garbage collections.</span>
(<span class="org-keyword">setq</span> gc-cons-threshold most-positive-fixnum)
(add-hook 'after-init-hook
          #'(lambda ()
              (garbage-collect)
(message <span class="org-string">"XXX Set GC back to initial value XXX"</span>)
(sit-for 2)
              (<span class="org-keyword">setq</span> gc-cons-threshold
                    (car (get 'gc-cons-threshold 'standard-value)))))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Don't display messages at start and end of garbage collection (as it hides</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">too many interesting messages).</span>
(<span class="org-keyword">setq</span> garbage-collection-messages nil)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org64b1b50" class="outline-2">
<h2 id="org64b1b50">Init</h2>
<div class="outline-text-2" id="text-org64b1b50">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defconst</span> <span class="org-variable-name">leuven--emacs-version</span> <span class="org-string">"20200210.1947"</span>
  <span class="org-doc">"Emacs-Leuven version (date of the last change)."</span>)

(message <span class="org-string">"* --[ Loading Emacs-Leuven %s]--"</span> leuven--emacs-version)

<span class="org-comment-delimiter">;; </span><span class="org-comment">Turn on Common Lisp support.</span>
(<span class="org-keyword">eval-when-compile</span> (<span class="org-keyword">require</span> '<span class="org-constant">cl</span>))       <span class="org-comment-delimiter">; </span><span class="org-comment">Provide useful things like `</span><span class="org-comment"><span class="org-constant">setf</span></span><span class="org-comment">'.</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defmacro</span> <span class="org-function-name">measure-time</span> (message <span class="org-type">&amp;rest</span> body)
  <span class="org-doc">"Measure the time it takes to evaluate BODY."</span>
  `(<span class="org-keyword">let</span> ((start (current-time)))
     ,@body
     (message <span class="org-string">"[__%s (in %.02f s)___________________________]"</span>
              ,message (float-time (time-since start)))))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;; </span><span class="org-comment">User Customizable Internal Variables</span>

(<span class="org-keyword">defgroup</span> <span class="org-type">leuven</span> nil
  <span class="org-doc">"Set of Emacs customizations (better defaults)."</span>
  <span class="org-builtin">:group</span> 'convenience
  <span class="org-builtin">:group</span> 'text)

(<span class="org-keyword">defcustom</span> <span class="org-variable-name">leuven-verbose-loading</span> nil
  <span class="org-doc">"If non-nil, means show messages describing progress of loading Emacs-Leuven."</span>
  <span class="org-builtin">:group</span> 'emacs-leuven
  <span class="org-builtin">:type</span> 'integer)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">when</span> (<span class="org-keyword">and</span> (string-match <span class="org-string">"GNU Emacs"</span> (version))
           leuven-verbose-loading)
  (<span class="org-keyword">defadvice</span> <span class="org-function-name">message</span> (before leuven-when-was-that activate)
    <span class="org-doc">"Add time stamps to `</span><span class="org-doc"><span class="org-constant">message</span></span><span class="org-doc">' output."</span>
    (ad-set-arg 0 (concat (format-time-string <span class="org-string">"[%Y-%m-%d %T."</span>)
                          (substring (format-time-string <span class="org-string">"%N"</span>) 0 3)
                          (format-time-string <span class="org-string">"] "</span>)
                          (ad-get-arg 0)))))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Allow quick include/exclude of setup parts -- DO NOT EDIT the DEFVAR!</span>
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-0-environment</span> t) <span class="org-comment-delimiter">; </span><span class="org-comment">required</span>
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-0-loading-libraries</span> t) <span class="org-comment-delimiter">; </span><span class="org-comment">required</span>
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-0-debugging</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-48-packages</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-1-screen</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-6-exiting</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-7-basic</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-8-minibuffer</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-10-help</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-11-mark</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-12-killing</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-13-registers</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-14-display</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-15-search</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-16-fixit</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-17-keyboard-macros</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-18-files</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-19-buffers</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-20-windows</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-21-frames</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-22-international</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-23-major-and-minor-modes</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-24-indentation</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-25-text</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-25.10-org-mode</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-25.11-tex-mode</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-26-programs</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-27-building</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-28-maintaining</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-29-abbrevs</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-30-dired</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-31-calendar-diary</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-32-sending-mail</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-34-gnus</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-36-document-view</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-38-shell</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-39-emacs-server</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-40-printing</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-41-sorting</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-44-saving-emacs-sessions</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-46-hyperlinking</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-47-amusements</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-49-customization</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-AppG-ms-dos</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-XX-emacs-display</span> t)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-load-chapter-99-debugging</span> t)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven--load-times-list</span> nil
  <span class="org-doc">"List of chapters and time to load them."</span>)

(<span class="org-keyword">defmacro</span> <span class="org-function-name">leuven--chapter</span> (chapterid chaptername <span class="org-type">&amp;rest</span> body)
  <span class="org-doc">"When CHAPTERID is not nil, report as CHAPTERNAME the evaluation of BODY.</span>
<span class="org-doc">Save execution times in the global list `</span><span class="org-doc"><span class="org-constant">leuven--load-times-list</span></span><span class="org-doc">'."</span>
  `(<span class="org-keyword">when</span> ,chapterid
     (<span class="org-keyword">let</span> (before-chapter-time
           this-chapter-time)
       (<span class="org-keyword">when</span> leuven-verbose-loading
         (message <span class="org-string">"** %s"</span> ,chaptername))
       (<span class="org-keyword">setq</span> before-chapter-time (float-time))
       (<span class="org-keyword">setq</span> leuven--before-section-time (float-time)) <span class="org-comment-delimiter">; </span><span class="org-comment">Init section time.</span>
       (<span class="org-keyword">progn</span> ,@body)
       (leuven--section (concat <span class="org-string">"["</span> ,chaptername <span class="org-string">" ends here]"</span>) 'end-of-chapter)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Add fake closing section.</span>
       (<span class="org-keyword">setq</span> this-chapter-time
             (format <span class="org-string">"%.2f"</span> (- (float-time) before-chapter-time)))
       (add-to-list 'leuven--load-times-list
                    (concat <span class="org-string">"| "</span> ,chaptername <span class="org-string">" "</span>
                            <span class="org-string">"| "</span> this-chapter-time <span class="org-string">" |"</span>)))))

(<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven--before-section-time</span> (float-time)
  <span class="org-doc">"Value of `</span><span class="org-doc"><span class="org-constant">float-time</span></span><span class="org-doc">' before loading some section."</span>)

(<span class="org-keyword">defun</span> <span class="org-function-name">leuven--section</span> (sectionname <span class="org-type">&amp;optional</span> end-of-chapter)
  <span class="org-doc">"Report under SECTIONNAME the time taken since it was last saved.</span>
<span class="org-doc">Last time is saved in global variable `</span><span class="org-doc"><span class="org-constant">leuven--before-section-time</span></span><span class="org-doc">'."</span>
  (<span class="org-keyword">let</span> ((this-section-time (- (float-time)
                              leuven--before-section-time)))
    (<span class="org-keyword">when</span> leuven-verbose-loading
      (<span class="org-keyword">when</span> (not (equal this-section-time 0.00))
        (message <span class="org-string">"[    Section time: %.2f s]"</span> this-section-time))
      (<span class="org-keyword">unless</span> end-of-chapter (message <span class="org-string">"*** %s"</span> sectionname)))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">For next one.</span>
    (<span class="org-keyword">setq</span> leuven--before-section-time (float-time))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgac960a0" class="outline-2">
<h2 id="orgac960a0">Loading Libraries of Lisp Code for Emacs</h2>
<div class="outline-text-2" id="text-orgac960a0">
<p>
Adding the right Lisp directories to your <code>load-path</code> (list of directories where
Emacs Lisp libraries &#x2013; <code>.el</code> and <code>.elc</code> files &#x2013; are installed) must be the very
<b>first thing</b> in your <code>.emacs</code> file, before the first time packages are required, to
make sure that you&rsquo;re not picking up bits and pieces from older files (bundled
with Emacs, and loaded before the path to the <b>newest</b> versions are set).
</p>

<p>
The most important directories are the last to be added to <code>load-path</code> (so that
they become the first of the list)!
</p>

<p>
Use <code>M-x list-load-path-shadows RET</code> to display a list of external Emacs Lisp
files that shadow Emacs builtins (listing potential load path problems).
</p>

<p>
Some Emacs modes are over 10K lines of code (e.g. <code>nxml-mode</code>, <code>CEDET</code>).  Many
packages (e.g. <code>Org</code>, <code>Gnus</code>) make use of the <code>autoload</code> feature, so that you only
need to load a single file that define autoloaded functions.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* Loading Libraries of Lisp Code for Emacs</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-0-loading-libraries <span class="org-string">"0 Loading Libraries"</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Load-path enhancement.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--add-to-load-path</span> (this-directory)
    <span class="org-doc">"Add THIS-DIRECTORY at the beginning of the load-path, if it exists."</span>
    (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> this-directory
               (file-directory-p this-directory))
      <span class="org-comment-delimiter">;; </span><span class="org-comment">TODO Add warning if directory does not exist.</span>
      (<span class="org-keyword">let*</span> ((this-directory (expand-file-name this-directory)))

        <span class="org-comment-delimiter">;; </span><span class="org-comment">Directories containing a `</span><span class="org-comment"><span class="org-constant">.nosearch</span></span><span class="org-comment">' file (such as</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">auctex-11.88.6\style</span></span><span class="org-comment">') should not made part of `</span><span class="org-comment"><span class="org-constant">load-path</span></span><span class="org-comment">'.</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">TODO `</span><span class="org-comment"><span class="org-constant">RCS</span></span><span class="org-comment">' and `</span><span class="org-comment"><span class="org-constant">CVS</span></span><span class="org-comment">' directories should also be excluded.</span>
        (<span class="org-keyword">unless</span> (file-exists-p (concat this-directory <span class="org-string">"/.nosearch"</span>))
          (add-to-list 'load-path this-directory)
          (<span class="org-keyword">when</span> leuven-verbose-loading
            (message <span class="org-string">"[Added `</span><span class="org-string"><span class="org-constant">%s</span></span><span class="org-string">' to `</span><span class="org-string"><span class="org-constant">load-path</span></span><span class="org-string">']"</span> this-directory))))))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Remember this directory.</span>
  (<span class="org-keyword">defconst</span> <span class="org-variable-name">leuven--directory</span>
    (file-name-directory (<span class="org-keyword">or</span> load-file-name (buffer-file-name)))
    <span class="org-doc">"Directory path of Emacs-Leuven installation."</span>)

  (leuven--add-to-load-path
   (concat leuven--directory <span class="org-string">"site-lisp"</span>))
</pre>
</div>

<p>
<code>leuven--local-repos-directory</code> is where you put Emacs Git/SVN/CSV repositories.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven--local-repos-directory</span> <span class="org-string">"~/Public/Repositories/"</span>
    <span class="org-doc">"Directory containing additional Emacs Lisp public repositories."</span>)

  (leuven--add-to-load-path
   (concat leuven--local-repos-directory <span class="org-string">"babel"</span>))
  (leuven--add-to-load-path
   (concat leuven--local-repos-directory <span class="org-string">"emacs-bookmark-extension"</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">XXX?</span>
   )
</pre>
</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Specify variables using `defcustom&rsquo;</b><br />
nil</div>

<p>
<code>leuven-user-lisp-directory</code> is there so that you have an easy way of installing
<b>your own Emacs add-ons</b> (which may be specific to the version of Emacs you&rsquo;re
running).  This keeps your local add-ons apart from distro supplied ones.
</p>

<p>
It also means you can do a complete re-install of Emacs (or even your Linux
distro) without impacting on stuff you have added by hand.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-user-lisp-directory</span> (concat user-emacs-directory <span class="org-string">"lisp/"</span>)
    <span class="org-doc">"Directory containing personal additional Emacs Lisp packages."</span>)

  (leuven--add-to-load-path leuven-user-lisp-directory)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Require a feature/library if available; if not, fail silently.</span>
  (<span class="org-keyword">unless</span> (fboundp 'try-require)
    (<span class="org-keyword">defun</span> <span class="org-function-name">try-require</span> (feature)
      <span class="org-doc">"Attempt to load a FEATURE (or library).</span>
<span class="org-doc">Return true if the library given as argument is successfully loaded.</span>
<span class="org-doc">If not, just print a message."</span>
      (<span class="org-keyword">condition-case</span> err
          (<span class="org-keyword">progn</span>
            (<span class="org-keyword">if</span> (stringp feature)
                (load-library feature)
              (<span class="org-keyword">require</span> <span class="org-constant">feature</span>))
            t)                          <span class="org-comment-delimiter">; </span><span class="org-comment">Necessary for correct behavior in</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">conditional expressions.</span>
        (file-error
         (message <span class="org-string">"[Requiring `</span><span class="org-string"><span class="org-constant">%s</span></span><span class="org-string">'... missing]"</span> feature)
         nil))))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">TEMPORARY.</span>
  (<span class="org-keyword">unless</span> (fboundp 'with-eval-after-load)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Wrapper around `</span><span class="org-comment"><span class="org-constant">eval-after-load</span></span><span class="org-comment">' (added in GNU Emacs 24.4).</span>
    (<span class="org-keyword">defmacro</span> <span class="org-function-name">with-eval-after-load</span> (mode <span class="org-type">&amp;rest</span> body)
      <span class="org-doc">"`</span><span class="org-doc"><span class="org-constant">eval-after-load</span></span><span class="org-doc">' MODE evaluate BODY."</span>
      (<span class="org-keyword">declare</span> (indent defun))
      `(eval-after-load ,mode
         '(<span class="org-keyword">progn</span> ,@body))))
</pre>
</div>
</div>

<div id="outline-container-org8e889aa" class="outline-3">
<h3 id="org8e889aa">Creating and selecting buffers</h3>
<div class="outline-text-3" id="text-org8e889aa">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">switch-or-start</span> (<span class="org-keyword">function</span> buffer)
    <span class="org-doc">"If the BUFFER is current, bury it.  If there is a buffer with that name,</span>
<span class="org-doc">  switch to it; otherwise, invoke the FUNCTION."</span>
    (<span class="org-keyword">if</span> (equal (buffer-name (current-buffer)) buffer)
        (bury-buffer)
      (<span class="org-keyword">if</span> (get-buffer buffer)
          (switch-to-buffer buffer)
        (funcall function))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">switch-or-find-file</span> (file)
    <span class="org-doc">"If the FILE is current, bury it.  If there is a buffer with that name,</span>
<span class="org-doc">  switch to it; otherwise, open it."</span>
    (<span class="org-keyword">when</span> (file-exists-p file)
      (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> (buffer-file-name)
               (string= (expand-file-name file)
                        (expand-file-name (buffer-file-name))))
          (bury-buffer)
        (find-file file))))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
    (global-set-key (kbd <span class="org-string">"&lt;M-right&gt;"</span>) #'next-buffer) <span class="org-comment-delimiter">; </span><span class="org-comment">XXX</span>
    (global-set-key (kbd <span class="org-string">"&lt;M-left&gt;"</span>)  #'previous-buffer) <span class="org-comment-delimiter">; </span><span class="org-comment">XXX</span>


</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 0-loading-libraries ends here.</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf17b105" class="outline-2">
<h2 id="orgf17b105">Environment</h2>
<div class="outline-text-2" id="text-orgf17b105">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* Environment</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-0-environment <span class="org-string">"0 Environment"</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">** Type of OS</span>

  (leuven--section <span class="org-string">"Type of OS"</span>)

  (<span class="org-keyword">defconst</span> <span class="org-variable-name">leuven--linux-p</span>
    (eq system-type 'gnu/linux)
    <span class="org-doc">"Running a GNU/Linux version of Emacs."</span>)

  (<span class="org-keyword">defconst</span> <span class="org-variable-name">leuven--mac-p</span>
    (eq system-type 'darwin)
    <span class="org-doc">"Running a Mac OS version of Emacs."</span>)

  (<span class="org-keyword">defconst</span> <span class="org-variable-name">leuven--win32-p</span>
    (eq system-type 'windows-nt)
    <span class="org-doc">"Running a native Microsoft Windows version of Emacs."</span>)

  (<span class="org-keyword">defconst</span> <span class="org-variable-name">leuven--cygwin-p</span>
    (eq system-type 'cygwin)
    <span class="org-doc">"Running a Cygwin version of Emacs."</span>)

<span class="org-comment-delimiter">;;</span><span class="org-comment">** MS Windows</span>

  (<span class="org-keyword">defconst</span> <span class="org-variable-name">leuven--windows-program-files-dir</span> <span class="org-comment-delimiter">; </span><span class="org-comment">sys-path.</span>
    (<span class="org-keyword">cond</span> (leuven--win32-p
           (file-name-as-directory (<span class="org-keyword">or</span> (getenv <span class="org-string">"ProgramFiles(x86)"</span>)
                                       (getenv <span class="org-string">"ProgramFiles"</span>))))
          (leuven--cygwin-p
           <span class="org-string">"/cygdrive/c/Program Files/"</span>)
          (t
           <span class="org-string">"/usr/local/bin/"</span>))
    <span class="org-doc">"Default Windows Program Files folder."</span>)
</pre>
</div>

<p>
Use <code>(display-graphic-p)</code> (instead of <code>window-system</code>) in conditions.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** Window system</span>

  (leuven--section <span class="org-string">"Window system"</span>)

  (<span class="org-keyword">defconst</span> <span class="org-variable-name">leuven--console-p</span>
    (eq window-system nil)
    <span class="org-doc">"Running a text-only terminal."</span>)

  (<span class="org-keyword">defconst</span> <span class="org-variable-name">leuven--x-window-p</span>
    (eq window-system 'x)
    <span class="org-doc">"Running a X Window system."</span>)

<span class="org-comment-delimiter">;;</span><span class="org-comment">** Testing file accessibility</span>

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--file-exists-and-executable-p</span> (file)
    <span class="org-doc">"Make sure the file FILE exists and is executable."</span>
    (<span class="org-keyword">if</span> file
        (<span class="org-keyword">if</span> (file-executable-p file)
            file
          (message <span class="org-string">"[WARN- Can't find executable `</span><span class="org-string"><span class="org-constant">%s</span></span><span class="org-string">']"</span> file)
          <span class="org-comment-delimiter">;; </span><span class="org-comment">Sleep 1.5 s so that you can see the warning.</span>
          (sit-for 1.5))
      (<span class="org-warning">error</span> <span class="org-string">"Missing argument to \"leuven--file-exists-and-executable-p\""</span>)))

<span class="org-comment-delimiter">;;</span><span class="org-comment">** Init</span>

  (leuven--section <span class="org-string">"Init"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Ensure that the echo area is always visible during the early stage of</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">startup (useful in case of error).</span>
  (modify-all-frames-parameters
   '((height . 32)))

)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 0 ends here.</span>
</pre>
</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Function for finding executables</b><br />
<p>
See function <code>--find-program</code> at <a href="http://www.visualco.de/src/elisp/.emacs.el.html">http://www.visualco.de/src/elisp/.emacs.el.html</a>.
</p>
</div>
</div>
</div>

<div id="outline-container-org4394d89" class="outline-2">
<h2 id="org4394d89">Debugging</h2>
<div class="outline-text-2" id="text-org4394d89">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* Debugging</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-0-debugging <span class="org-string">"0 Debugging"</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Get the backtrace when uncaught errors occur.</span>
  (<span class="org-keyword">setq</span> debug-on-error t)               <span class="org-comment-delimiter">; </span><span class="org-comment">Will be unset at the end.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Hit `</span><span class="org-comment"><span class="org-constant">C-g</span></span><span class="org-comment">' while it's frozen to get an Emacs Lisp backtrace.</span>
  (<span class="org-keyword">setq</span> debug-on-quit t)                <span class="org-comment-delimiter">; </span><span class="org-comment">Will be unset at the end.</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 0 ends here.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf4a8798" class="outline-2">
<h2 id="orgf4a8798">Emacs Lisp Packages</h2>
<div class="outline-text-2" id="text-orgf4a8798">
<p>
Another <b>first thing</b> in your init script should be <code>(package-initialize)</code> so that
customization of Org variables (for example) doesn&rsquo;t auto-load the old version
that came with Emacs.
</p>

<p>
If you require something from Org mode, it must be after <code>package-initialize</code>.
</p>
</div>

<div id="outline-container-orgceba6ec" class="outline-3">
<h3 id="orgceba6ec">The Package Menu Buffer</h3>
<div class="outline-text-3" id="text-orgceba6ec">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 48 Emacs Lisp (info "(emacs)Packages")</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-48-packages <span class="org-string">"48 Emacs Lisp Packages"</span>
</pre>
</div>

<p>
To upgrade packages after running <code>package-list-packages</code>, type:
</p>

<ul class="org-ul">
<li><code>U</code> (<i>mark Upgradable packages</i>) and then</li>
<li><code>x</code> (<i>eXecute the installs and deletions</i>).</li>
</ul>

<p>
When it&rsquo;s done installing all the packages, you delete the obsolete packages by
hitting <code>y</code> (<i>Yes</i>) when asked.
</p>
</div>
</div>

<div id="outline-container-org00d3a2a" class="outline-3">
<h3 id="org00d3a2a">Package Installation</h3>
<div class="outline-text-3" id="text-org00d3a2a">
<p>
The first time you start emacs, it will install some additional packages that
are best handled by the package manager.
</p>

<ul class="org-ul">
<li>User&rsquo;s Emacs Lisp packages in <code>package-user-dir</code> (<code>~/.emacs.d/elpa</code>)</li>
<li>System-wide Emacs Lisp packages in <code>package-directory-list</code></li>
</ul>

<p>
HTTP frontends for the Emacs repositories:
</p>
<ul class="org-ul">
<li><a href="http://elpa.gnu.org/packages/">http://elpa.gnu.org/packages/</a></li>
<li><a href="http://melpa.org/packages/">http://melpa.org/packages/</a></li>
</ul>

<p>
In Marmalade, the developers themselves do the packaging.  In MELPA, packages
are generated programmatically from upstream Git-based sources.
</p>

<div class="note">
<p>
The Marmalade repository is not recommended by Flycheck (due to frequent
outages).
</p>

</div>

<p>
To list packages which should <i>not</i> be installed by Emacs-Leuven, add something
like this into your configuration file:
</p>

<pre class="example">
(setq leuven-excluded-packages '(ess flycheck-ledger))
</pre>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 48.2 Package Installation</span>

  (leuven--section <span class="org-string">"48.2 Package Installation"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Simple package system for GNU Emacs.</span>
  (try-require 'package)
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"package"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Archives from which to fetch.</span>
    (<span class="org-keyword">setq</span> package-archives
          (append '((<span class="org-string">"org"</span>   . <span class="org-string">"http://orgmode.org/elpa/"</span>)
                    (<span class="org-string">"melpa"</span> . <span class="org-string">"http://melpa.org/packages/"</span>))
                  package-archives))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Packages which were installed by the user (as opposed to installed as</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">dependencies).</span>
    (<span class="org-keyword">setq</span> package-selected-packages
          '(ag
            ant
            anzu
            auctex
            auto-complete
            auto-highlight-symbol
            auto-package-update
            avy
            back-button
            bbdb
            boxquote
            <span class="org-comment-delimiter">;; </span><span class="org-comment">calfw</span>
            circe
            color-identifiers-mode
            company
            company-tern
            company-quickhelp
            csv-mode
            dashboard
            diff-hl
            diminish
            docker-compose-mode
            dumb-jump
            <span class="org-comment-delimiter">;; </span><span class="org-comment">emacs-eclim</span>
            emr
            ess
            expand-region
            fancy-narrow
            flycheck
            flycheck-color-mode-line
            flycheck-ledger
            fuzzy
            git-commit
            git-commit-insert-issue
            git-messenger
            git-timemachine
            google-this
            google-translate
            goto-chg
            graphviz-dot-mode
            helm
            helm-ag
            helm-descbinds
            helm-ls-git
            helm-org
            helm-projectile <span class="org-comment-delimiter">; </span><span class="org-comment">Obsolete package?</span>
            helm-swoop
            hide-lines
            highlight-numbers
            hl-anything                 <span class="org-comment-delimiter">; </span><span class="org-comment">Better than `</span><span class="org-comment"><span class="org-constant">highlight-symbol</span></span><span class="org-comment">'.</span>
            howdoi
            htmlize
            indent-guide
            <span class="org-comment-delimiter">;; </span><span class="org-comment">jabber</span>
            jquery-doc
            js2-mode
            js2-refactor
            json-mode
            key-chord
            litable
            idle-require
            interaction-log
            ledger-mode
            leuven-theme
            <span class="org-comment-delimiter">;; </span><span class="org-comment">magit</span>
            markdown-mode
            multi-term
            multiple-cursors
            <span class="org-comment-delimiter">;; </span><span class="org-comment">multi-term</span>
            org-plus-contrib
            pager
            <span class="org-comment-delimiter">;; </span><span class="org-comment">paredit</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">pdf-tools</span>
            powerline
            rainbow-delimiters
            rainbow-mode
            <span class="org-comment-delimiter">;; </span><span class="org-comment">redshank</span>
            skewer-mode
            sqlup-mode
            symbol-overlay
            tern
            smart-comment
            smartparens
            sql-indent
            undo-tree
            volatile-highlights
            web-mode
            which-key
            ws-butler
            yasnippet
            ztree))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Load the latest version of all installed packages, and activate them.</span>
    (package-initialize)                <span class="org-comment-delimiter">; </span><span class="org-comment">Add ALL ELPA subdirs to `</span><span class="org-comment"><span class="org-constant">load-path</span></span><span class="org-comment">'</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">and load `</span><span class="org-comment"><span class="org-constant">&lt;pkg&gt;-autoloads.el</span></span><span class="org-comment">'.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(when (fboundp 'package-install-selected-packages) ; Emacs-v25</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(package-install-selected-packages))</span>

    (<span class="org-keyword">defcustom</span> <span class="org-variable-name">leuven-excluded-packages</span>
      nil
      <span class="org-doc">"List of packages that should be ignored by Emacs-Leuven."</span>
      <span class="org-builtin">:group</span> 'emacs-leuven
      <span class="org-builtin">:type</span> '(repeat (string)))

    (<span class="org-keyword">defcustom</span> <span class="org-variable-name">leuven-install-all-missing-elpa-packages</span>
     nil
      <span class="org-doc">"Force the installation (without query) of all missing packages."</span>
      <span class="org-builtin">:group</span> 'emacs-leuven
      <span class="org-builtin">:type</span> '(repeat (string)))

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--missing-elpa-packages</span> ()
      <span class="org-doc">"List packages to install for a full blown Leuven installation.</span>
<span class="org-doc">These packages are neither built-in nor already installed nor ignored."</span>
      (<span class="org-keyword">let</span> (missing-elpa-packages)
        (<span class="org-keyword">dolist</span> (pkg package-selected-packages)
          (<span class="org-keyword">unless</span> (<span class="org-keyword">or</span> (package-installed-p pkg)
                      (locate-library (symbol-name pkg))
                      (member pkg leuven-excluded-packages))
            (<span class="org-keyword">push</span> pkg missing-elpa-packages)))
        missing-elpa-packages))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Propose to install all the packages specified in</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">package-selected-packages</span></span><span class="org-comment">' which are missing and which shouldn't be</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">ignored.</span>
    (<span class="org-keyword">let</span> ((missing-elpa-packages (leuven--missing-elpa-packages)))
      (<span class="org-keyword">when</span> missing-elpa-packages

        (<span class="org-keyword">when</span> (<span class="org-keyword">or</span> leuven-install-all-missing-elpa-packages
                  (yes-or-no-p
                   (format <span class="org-string">"Install the %s missing ELPA package(s) without confirming each? "</span>
                           (length missing-elpa-packages))))
          (<span class="org-keyword">setq</span> leuven-install-all-missing-elpa-packages t))

        <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Download once the ELPA archive description.</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">(package-refresh-contents)      ; Ensure that the list of packages is</span>
        <span class="org-comment-delimiter">;;                                 </span><span class="org-comment">; up-to-date.  Otherwise, new packages</span>
        <span class="org-comment-delimiter">;;                                 </span><span class="org-comment">; (not present in the cache of the ELPA</span>
        <span class="org-comment-delimiter">;;                                 </span><span class="org-comment">; contents) won't install.</span>
        (<span class="org-keyword">dolist</span> (pkg (reverse missing-elpa-packages))
          (<span class="org-keyword">if</span> (<span class="org-keyword">or</span> leuven-install-all-missing-elpa-packages
                  (yes-or-no-p (format <span class="org-string">"Install ELPA package `</span><span class="org-string"><span class="org-constant">%s</span></span><span class="org-string">'? "</span> pkg)))
              (<span class="org-keyword">ignore-errors</span>
                (package-install pkg))  <span class="org-comment-delimiter">; </span><span class="org-comment">Must be run after initializing</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">package-initialize</span></span><span class="org-comment">'.</span>
            (message (concat <span class="org-string">"[Customize Emacs-Leuven to ignore the `</span><span class="org-string"><span class="org-constant">%s</span></span><span class="org-string">' package next times...]"</span>) pkg)
            (sit-for 1.5)))))

    )
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Automatically update Emacs packages.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"auto-package-update-autoloads"</span>

    (<span class="org-keyword">setq</span> auto-package-update-delete-old-versions t)

    (add-hook 'auto-package-update-before-hook
              #'(lambda ()
                  (message <span class="org-string">"[Updating (M)ELPA packages now...]"</span>)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">"It looks like there's a problem with your network connection."</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(auto-package-update-maybe)</span>
  )
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 48 ends here.</span>
</pre>
</div>

<p>
<code>Idle-require</code> must be loaded <b>after</b> <code>package-initialize</code>, and should not be
cancelable; hence, we put it out of a &ldquo;chapter&rdquo;.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Load elisp libraries while Emacs is idle.</span>
  (try-require 'idle-require) <span class="org-comment-delimiter">;</span><span class="org-comment">XXX</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Fail-safe for `</span><span class="org-comment"><span class="org-constant">idle-require</span></span><span class="org-comment">'.</span>
  (<span class="org-keyword">if</span> (not (<span class="org-keyword">featurep</span> '<span class="org-constant">idle-require</span>))
    (<span class="org-keyword">defun</span> <span class="org-function-name">idle-require</span> (feature <span class="org-type">&amp;optional</span> file noerror)
      (try-require feature)))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"idle-require"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Idle time in seconds after which autoload functions will be loaded.</span>
    (<span class="org-keyword">setq</span> idle-require-idle-delay 5)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Time in seconds between automatically loaded functions.</span>
    (<span class="org-keyword">setq</span> idle-require-load-break 2)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Starts loading.</span>
    (add-hook 'after-init-hook #'idle-require-mode))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org3c400de" class="outline-2">
<h2 id="org3c400de">The Organization of the Screen</h2>
<div class="outline-text-2" id="text-org3c400de">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 1 The Organization of the (info "(emacs)Screen")</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-1-screen <span class="org-string">"1 The Organization of the Screen"</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 1.2 The (info "(emacs)Echo Area")</span>

  (leuven--section <span class="org-string">"1.2 (emacs) The Echo Area"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't truncate the message log buffer when it becomes large.</span>
  (<span class="org-keyword">setq</span> message-log-max t)

)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 1 ends here.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org8590b36" class="outline-2">
<h2 id="org8590b36">Exiting Emacs</h2>
<div class="outline-text-2" id="text-org8590b36">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 6 (info "(emacs)Exiting") Emacs</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-6-exiting <span class="org-string">"6 Exiting Emacs"</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Unbind "minimize".</span>
  (global-unset-key (kbd <span class="org-string">"C-z"</span>))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Quit with Alt + F4.</span>
  (global-set-key (kbd <span class="org-string">"&lt;M-f4&gt;"</span>) #'save-buffers-kill-terminal)

)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 6 ends here.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgabaeca5" class="outline-2">
<h2 id="orgabaeca5">Basic Editing Commands</h2>
<div class="outline-text-2" id="text-orgabaeca5">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 7 (info "(emacs)Basic") Editing Commands</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-7-basic <span class="org-string">"7 Basic Editing Commands"</span>
</pre>
</div>
</div>

<div id="outline-container-org7257ba3" class="outline-3">
<h3 id="org7257ba3">Inserting Text</h3>
<div class="outline-text-3" id="text-org7257ba3">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 7.1 (info "(emacs)Inserting Text")</span>

  (leuven--section <span class="org-string">"7.1 (emacs)Inserting Text"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Enter characters by their code in octal (for `C-q NNN RET').</span>
  (<span class="org-keyword">setq</span> read-quoted-char-radix 8)       <span class="org-comment-delimiter">; </span><span class="org-comment">16 for hexadecimal (for Unicode char)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb26b740" class="outline-3">
<h3 id="orgb26b740">Moving Point Location</h3>
<div class="outline-text-3" id="text-orgb26b740">
<dl class="org-dl">
<dt><code>M-r</code></dt><dd><code>move-to-window-line</code>.</dd>

<dt><code>M-g g</code></dt><dd><b>Jump to</b> the beginning of <b>line</b> number <i>N</i> (<code>goto-line</code>).</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 7.2 (info "(emacs)Moving Point") Location</span>

  (leuven--section <span class="org-string">"7.2 (emacs)Moving Point Location"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't add newlines to end of buffer when scrolling.</span>
  (<span class="org-keyword">setq</span> next-line-add-newlines nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Print the current buffer line number.</span>
  (global-set-key (kbd <span class="org-string">"M-G"</span>) #'what-line)
</pre>
</div>

<p>
Show line numbers temporarily &#x2013; just when you&rsquo;re going to a line number with
<code>goto-line</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">goto-line-with-feedback</span> ()
    <span class="org-doc">"Show line numbers temporarily, while prompting for the line number input"</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">unwind-protect</span>
        (<span class="org-keyword">progn</span>
          (linum-mode 1)
          (goto-line (read-number <span class="org-string">"Goto line: "</span>)))
      (linum-mode -1)))

  (global-set-key [remap goto-line] #'goto-line-with-feedback)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcf753a4" class="outline-3">
<h3 id="orgcf753a4">Basic Undoing Changes</h3>
<div class="outline-text-3" id="text-orgcf753a4">
<p>
Shortcuts:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Command</th>
<th scope="col" class="org-left">Emacs</th>
<th scope="col" class="org-left">Emacs-Leuven</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Undo</td>
<td class="org-left">C-/</td>
<td class="org-left">&lt;f11&gt;</td>
</tr>

<tr>
<td class="org-left">Redo</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">C-S-z, &lt;S-f11&gt;</td>
</tr>
</tbody>
</table>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 7.4 (info "(emacs)Basic Undo")ing Changes</span>

  (leuven--section <span class="org-string">"7.4 (emacs)Basic Undoing Changes"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Undo changes.</span>
  (global-set-key (kbd <span class="org-string">"&lt;f11&gt;"</span>) #'undo)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Treat undo history as a tree.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"undo-tree-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable Global-Undo-Tree mode.</span>
    (global-undo-tree-mode 1))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"undo-tree"</span>

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"diminish-autoloads"</span>
      (diminish 'undo-tree-mode))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Display times relative to current time in visualizer.</span>
    (<span class="org-keyword">setq</span> undo-tree-visualizer-relative-timestamps t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Display time-stamps by default in undo-tree visualizer.</span>
    (<span class="org-keyword">setq</span> undo-tree-visualizer-timestamps t)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Toggle time-stamps display using `t'.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Display diff by default in undo-tree visualizer.</span>
    (<span class="org-keyword">setq</span> undo-tree-visualizer-diff t)  <span class="org-comment-delimiter">; </span><span class="org-comment">Toggle the diff display using `d'.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Redo changes.</span>
    (global-set-key (kbd <span class="org-string">"C-S-z"</span>)   #'undo-tree-redo)
    (global-set-key (kbd <span class="org-string">"&lt;S-f11&gt;"</span>) #'undo-tree-redo))
</pre>
</div>

<p>
Visual feedback on some operations (<code>undo</code>, <code>yank</code>, etc.).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"volatile-highlights-autoloads"</span>
    (volatile-highlights-mode 1))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 7 ends here.</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org5c7e5bc" class="outline-2">
<h2 id="org5c7e5bc">The Minibuffer</h2>
<div class="outline-text-2" id="text-org5c7e5bc">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 8 The (info "(emacs)Minibuffer")</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-8-minibuffer <span class="org-string">"8 The Minibuffer"</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">How long to display an echo-area message when the minibuffer is active.</span>
  (<span class="org-keyword">setq</span> minibuffer-message-timeout 0.5)
</pre>
</div>
</div>

<div id="outline-container-org8be9c38" class="outline-3">
<h3 id="org8be9c38">Editing in the Minibuffer</h3>
<div class="outline-text-3" id="text-org8be9c38">
<p>
If the output is short enough to display in the echo area (which is determined
by the variables <code>resize-mini-windows</code> and <code>max-mini-window-height</code>), it is shown in
echo area.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 8.3 (info "(emacs)Minibuffer Edit")ing</span>

  (leuven--section <span class="org-string">"8.3 (emacs)Minibuffer Editing"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Minibuffer and echo area windows resize vertically as necessary to fit</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">the text displayed in them.</span>
  (<span class="org-keyword">setq</span> resize-mini-windows t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org6eaecfd" class="outline-3">
<h3 id="org6eaecfd">Completion</h3>
<div class="outline-text-3" id="text-org6eaecfd">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 8.4 (info "(emacs)Completion")</span>

  (leuven--section <span class="org-string">"8.4 (emacs)Completion"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Ignore case differences when completing file names.</span>
  (<span class="org-keyword">setq</span> read-file-name-completion-ignore-case t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't consider case significant in completion.</span>
  (<span class="org-keyword">setq</span> completion-ignore-case t)
</pre>
</div>

<p>
Within <code>read-file-name</code>, this variable is overridden by
<code>read-file-name-completion-ignore-case</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Ignore case when reading a file name.</span>
  (<span class="org-keyword">setq</span> read-file-name-completion-ignore-case t) <span class="org-comment-delimiter">; </span><span class="org-comment">[Default: t on Windows]</span>
</pre>
</div>

<p>
Within <code>read-buffer</code>, <code>completion-ignore-case</code> is overridden by
<code>read-buffer-completion-ignore-case</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Ignore case when reading a buffer name.</span>
  (<span class="org-keyword">setq</span> read-buffer-completion-ignore-case t) <span class="org-comment-delimiter">; </span><span class="org-comment">[Default: nil].</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Provide the same facility of `ls --color' inside Emacs.</span>
  (<span class="org-keyword">when</span> (locate-library <span class="org-string">"dircolors"</span>)
    (autoload 'dircolors <span class="org-string">"dircolors"</span> nil t)
    (add-hook 'completion-list-mode-hook #'dircolors))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf61a8a2" class="outline-3">
<h3 id="orgf61a8a2">Minibuffer History</h3>
<div class="outline-text-3" id="text-orgf61a8a2">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Delete duplicates in history.</span>
  (<span class="org-keyword">setq</span> history-delete-duplicates t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org3970ad1" class="outline-3">
<h3 id="org3970ad1">Repeating Minibuffer Commands</h3>
<div class="outline-text-3" id="text-org3970ad1">
<p>
Use <code>M-x list-command-history</code> to display the entire command history, showing all
the commands <code>C-x &lt;ESC&gt; &lt;ESC&gt;</code> can repeat, most recent first.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 8 ends here.</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf634821" class="outline-2">
<h2 id="orgf634821">Help</h2>
<div class="outline-text-2" id="text-orgf634821">
<p>
In general, the following functions are very interesting for finding useful
functions and documentation.
</p>

<dl class="org-dl">
<dt><code>apropos-documentation</code> (<code>C-h d</code>)</dt><dd><b>Show symbols whose documentation contains matches for PATTERN.</b>
For example, <code>C-h d yank properties RET</code>.</dd>

<dt><code>describe-function</code> (<code>C-h f</code>)</dt><dd>Used with TAB completion to show documentation of functions.</dd>

<dt><code>elisp-index-search</code> (<code>C-h E</code> in Emacs-Leuven)</dt><dd>Look up documentation on broad Emacs Lisp topics (in the indices of the
Emacs Lisp Reference Manual).</dd>

<dt><code>info-lookup-symbol</code> (<code>C-h S</code>, or <code>C-&lt;F1&gt;</code> in Emacs-Leuven)</dt><dd><b>Bring the relevant section from the manual, which describes the topic in
more detail.</b></dd>
</dl>

<p>
With all prefix keys, if you follow them with <code>C-h</code> (<code>h</code> for help), a list of key
bindings in that prefix map is displayed.  This is automatic and is one of the
self-documenting features of Emacs.
</p>

<p>
Try, for example <code>C-x C-h</code> or <code>C-c C-x C-h</code> to see what it does.  I do use it to
remind myself of rarely used rectangle commands: <code>C-x r C-h</code>.
</p>

<p>
FYI, <code>catman</code> create the database files that are used by <code>apropos</code> or <code>man -k</code>.
</p>

<p>
Note about PHP documentation lookup &#x2013; PHP Mode has a nice feature to lookup the
function&rsquo;s definition in PHP&rsquo;s manual in your web browser (<code>M-x
php-search-documentation</code> or <code>C-c C-f</code>).  You can combine it with EWW to get the
relevant manual page without leaving Emacs.
</p>

<p>
<b>Close</b> the help buffer by pressing <code>Q</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 10 (info "(emacs)Help")</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-10-help <span class="org-string">"10 Help"</span>
</pre>
</div>
</div>

<div id="outline-container-org0cc28c6" class="outline-3">
<h3 id="org0cc28c6">Help Summary</h3>
<div class="outline-text-3" id="text-org0cc28c6">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 10.1 (info "(emacs)Help Summary")</span>

  (leuven--section <span class="org-string">"10.1 (emacs)Help Summary"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Avoid the description of all minor modes.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-describe-major-mode</span> ()
    <span class="org-doc">"Describe only `</span><span class="org-doc"><span class="org-constant">major-mode</span></span><span class="org-doc">'."</span>
    (<span class="org-keyword">interactive</span>)
    (describe-function major-mode))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Look up subject in (the indices of the) Emacs Lisp manual.</span>
  (global-set-key (kbd <span class="org-string">"C-h E"</span>) #'elisp-index-search)
</pre>
</div>
</div>
</div>

<div id="outline-container-org31cf208" class="outline-3">
<h3 id="org31cf208">Apropos</h3>
<div class="outline-text-3" id="text-org31cf208">
<p>
You can ask what pertains to a given topic by typing <code>M-x apropos RET pattern
RET</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 10.4 (info "(emacs)Apropos")</span>

  (leuven--section <span class="org-string">"10.4 (emacs)Apropos"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"apropos"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Apropos commands will search more extensively, checking all variables and</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">non-interactive functions as well.</span>
    (<span class="org-keyword">setq</span> apropos-do-all t))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(defun apropos-user-option (string)</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">"Like apropos, but lists only symbols that are names of user</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">modifiable variables.  Argument REGEXP is a regular expression.</span>
  <span class="org-comment-delimiter">;;    </span><span class="org-comment">Returns a list of symbols, and documentation found"</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(interactive "sVariable apropos (regexp): ")</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(let ((message</span>
  <span class="org-comment-delimiter">;;          </span><span class="org-comment">(let ((standard-output (get-buffer-create "*Help*")))</span>
  <span class="org-comment-delimiter">;;            </span><span class="org-comment">(print-help-return-message 'identity))))</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">(if (apropos string  'user-variable-p)</span>
  <span class="org-comment-delimiter">;;         </span><span class="org-comment">(and message (message message)))))</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Show all variables whose name matches the pattern.</span>
  (define-key help-map (kbd <span class="org-string">"A"</span>) #'apropos-user-option)
</pre>
</div>
</div>
</div>

<div id="outline-container-org23daa04" class="outline-3">
<h3 id="org23daa04">Misc Help Commands</h3>
<div class="outline-text-3" id="text-org23daa04">
<p>
<code>update-info-dir</code>
</p>

<p>
The utility <code>install-info</code> is used to maintain the <code>info/dir</code> file.
</p>

<p>
<code>C-h K</code> goes to the node in the Emacs manual describing the command bound to
a key.
</p>

<p>
In a manual, these key bindings will make your life easier:
</p>

<dl class="org-dl">
<dt><code>^</code></dt><dd>Move &ldquo;up&rdquo; from this node.</dd>

<dt><code>]</code></dt><dd>Go forward one node, considering all nodes as forming one sequence.</dd>

<dt><code>l</code></dt><dd>Move back in history to the last node you were at.</dd>

<dt><code>L</code></dt><dd>Go to menu of visited nodes.</dd>

<dt><code>i</code></dt><dd><b>Search for a topic in this manual&rsquo;s Index</b> and go to index entry.</dd>

<dt><code>s</code></dt><dd><b>Search for a regexp</b> and select node it&rsquo;s found in.</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 10.8 (info "(emacs)Misc Help")</span>

  (leuven--section <span class="org-string">"10.8 (emacs)Misc Help"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Enter Info documentation browser.</span>
  (global-set-key (kbd <span class="org-string">"&lt;f1&gt;"</span>) #'info)

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-describe-elisp-symbol-at-point</span> ()
    <span class="org-doc">"Get help for the symbol at point."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let</span> ((sym (intern-soft (current-word))))
      (<span class="org-keyword">unless</span>
          (<span class="org-keyword">cond</span> ((null sym))
                ((not (eq t (help-function-arglist sym)))
                 (describe-function sym))
                ((boundp sym)
                 (describe-variable sym)))
        (message <span class="org-string">"[nothing]"</span>))))

  (global-set-key (kbd <span class="org-string">"&lt;f1&gt;"</span>) #'leuven-describe-elisp-symbol-at-point)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Display symbol definitions, as found in the relevant manual</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(for AWK, C, Emacs Lisp, LaTeX, M4, Makefile, Sh and other languages that</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">have documentation in Info).</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "&lt;C-f1&gt;") #'info-lookup-symbol)</span>
</pre>
</div>

<p>
When Info is called, the variable <code>Info-directory-list</code> is populated from:
</p>

<ol class="org-ol">
<li>the <code>INFOPATH</code> environment variable, or <i>(if unset)</i></li>

<li>the <code>Info-default-directory-list</code> variable &#x2013; non-existent directories will be
removed when copied to <code>Info-directory-list</code></li>
</ol>

<p>
The best would be to set the <code>INFOPATH</code> environment variable so that you see the
same manuals outside of Emacs, in the same shell from which you invoke Emacs.
</p>

<p>
However, as Windows Emacs doesn&rsquo;t see that Cygwin environment variable (it would
well work with a Windows environment variable), I prefer to try and put the
Windows configuration inside the Emacs configuration files.
</p>

<p>
Normally, <code>Info-directory-list</code> is not intended to be settable by the user. But we
must do so if we want to force our Info manuals before the standard ones (from
Emacs). XXX Could we set <code>Info-default-directory-list</code> instead???
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"info"</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">List of directories to search for Info documentation files (in the order</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">they are listed).</span>
    (<span class="org-keyword">when</span> leuven--win32-p
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(info-initialize)</span>
      (<span class="org-keyword">setq</span> Info-directory-list
            `(,(expand-file-name
                (concat (file-name-directory (locate-library <span class="org-string">"org"</span>)) <span class="org-string">"../doc/"</span>))
              <span class="org-string">"c:/cygwin/usr/share/info/"</span>
              ,@Info-directory-list)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">XXX Replace by add-to-list to ensure we don't insert duplicates (if Cygwin was already there).</span>
</pre>
</div>

<p>
<code>Info+</code> fontifies entries for reference items (functions, macros, commands,
special forms, constants, options, other variables), and that includes their
parameters, even those on continuation lines.
</p>

<p>
With <code>Info+</code>, you can also merge an Info node with its subnodes into the same
buffer, by calling <code>Info-merge-subnodes</code> (bound to <code>+</code>).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"info+-autoloads"</span>
      (idle-require 'info+))

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"info+"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Show breadcrumbs in the header line.</span>
      (<span class="org-keyword">setq</span> Info-breadcrumbs-in-header-flag t)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't show breadcrumbs in the mode line.</span>
      (<span class="org-keyword">setq</span> Info-breadcrumbs-in-mode-line-mode nil))
</pre>
</div>

<p>
In an Info page, <code>w</code> will copy the reference to the current node (the <code>(%s)%s</code> part
of your format string).
</p>

<p>
When called with a 0 argument (<code>M-0 w</code>), you get <code>(info \"(%s)%s\")</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    )
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Get a Unix manual page of the item under point.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "&lt;S-f1&gt;") #'man-follow)</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"man"</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Make the manpage the current buffer in the current window.</span>
    (<span class="org-keyword">setq</span> Man-notify-method 'pushy))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Alias man to woman.</span>
  (<span class="org-keyword">defalias</span> '<span class="org-function-name">man</span> 'woman)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Decode and browse Unix man-pages "W.o. (without) Man".</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"woman"</span>
    (<span class="org-keyword">defalias</span> '<span class="org-function-name">man</span> 'woman)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">WoMan adds a Contents menu to the menubar.</span>
    (<span class="org-keyword">setq</span> woman-imenu t))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 10 ends here.</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgc308508" class="outline-2">
<h2 id="orgc308508">The Mark and the Region</h2>
<div class="outline-text-2" id="text-orgc308508">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 11 The (info "(emacs)Mark") and the Region</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-11-mark <span class="org-string">"11 The Mark and the Region"</span>
</pre>
</div>
</div>

<div id="outline-container-org54bfbc2" class="outline-3">
<h3 id="org54bfbc2">Setting the Mark</h3>
<div class="outline-text-3" id="text-org54bfbc2">
<p>
Instead of setting the <b>mark</b> in order to operate on a region, you can also type:
</p>

<dl class="org-dl">
<dt><code>C-SPC C-SPC</code></dt><dd><b>&ldquo;Remember&rdquo; a position</b> in the buffer (pushes the current position to the
<b>mark ring</b>, by setting the mark where point is without leaving it active),
and</dd>

<dt><code>C-u C-SPC</code></dt><dd>Later <b>jump</b> back <b>to the</b> previous <b>mark</b> in the buffer.  You can use this
repeatedly to <b>navigate</b> through the entire <b>mark ring</b>.</dd>
</dl>

<div class="tip">
<p>
Many commands (especially ones which are liable to move you an an unknown or
arbitrary distance from your original location, like <code>isearch-forward</code>,
<code>beginning-of-buffer</code>, <code>avy</code>) automatically save the previous position in the mark
ring &#x2013; you don&rsquo;t have to use <code>C-SPC C-SPC</code> before, but only <code>C-u C-SPC</code> to return
afterwards.
</p>

<p>
So, after using <code>C-s</code> to go somewhere, you can easily jump back again.
</p>

</div>
</div>

<div id="outline-container-org9b3665b" class="outline-4">
<h4 id="org9b3665b">Navigating to Previous Change</h4>
<div class="outline-text-4" id="text-org9b3665b">
<p>
<b>Go to</b> the <b>place</b> where you <b>last changed</b> something (&ldquo;last edit location&rdquo;):
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Go to Last (buffer-local) Edit Location.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"goto-chg-autoloads"</span>
    (global-set-key (kbd <span class="org-string">"&lt;C-S-backspace&gt;"</span>) #'goto-last-change))
</pre>
</div>

<p>
It moves point through <code>buffer-undo-list</code> positions.
</p>
</div>
</div>

<div id="outline-container-orga6d693f" class="outline-4">
<h4 id="orga6d693f">Navigating to Navigated Items</h4>
<div class="outline-text-4" id="text-orga6d693f">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"back-button-autoloads"</span>
    (back-button-mode 1)
</pre>
</div>

<p>
You can go back and forth along the items that have been marked.
</p>

<dl class="org-dl">
<dt>C-x &lt;left&gt;</dt><dd>Go back in buffer-local <code>mark-ring</code>.</dd>

<dt>C-x &lt;right&gt;</dt><dd>Go forward in buffer-local <code>mark-ring</code>.</dd>

<dt>C-x C-&lt;left&gt; (or &lt;C-M-left&gt; in Emacs Leuven)</dt><dd>Go back in <code>global-mark-ring</code>.</dd>

<dt>C-x C-&lt;right&gt; (or &lt;C-M-right&gt; in Emacs Leuven)</dt><dd>Go forward in <code>global-mark-ring</code>.</dd>
</dl>

<p>
When the <code>smartrep</code> package is installed, the <code>C-x</code> prefix need not be used for
consecutive <code>back-button</code> commands.
</p>

<p>
You can also use keyboard shortcuts <code>C-M-left</code>, or <code>C-M-right</code>:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Navigate backward.</span>
    (global-set-key (kbd <span class="org-string">"&lt;C-M-left&gt;"</span>)  #'back-button-global-backward) <span class="org-comment-delimiter">; </span><span class="org-comment">IntelliJ IDEA.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Navigate forward.</span>
    (global-set-key (kbd <span class="org-string">"&lt;C-M-right&gt;"</span>) #'back-button-global-forward)) <span class="org-comment-delimiter">; </span><span class="org-comment">IntelliJ IDEA.</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org409c16b" class="outline-3">
<h3 id="org409c16b">Commands to Mark Textual Objects</h3>
<div class="outline-text-3" id="text-org409c16b">
<dl class="org-dl">
<dt><code>M-@</code></dt><dd>Set mark after end of next <b>word</b> (<code>mark-word</code>) without moving point.</dd>

<dt><code>C-M-@</code></dt><dd>Set mark after end of following <b>balanced expression</b> (<code>mark-sexp</code>) without
moving point.</dd>
</dl>

<p>
Shortcuts:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Command</th>
<th scope="col" class="org-left">Emacs-Leuven</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Extend Selection</td>
<td class="org-left">C-M-w</td>
</tr>

<tr>
<td class="org-left">Shrink Selection</td>
<td class="org-left">C-S-w</td>
</tr>
</tbody>
</table>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Increase selected region by semantic units.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"expand-region-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Key to use after an initial expand/contract to undo.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq expand-region-reset-fast-key "&lt;escape&gt; &lt;escape&gt;")</span>

    (global-set-key (kbd <span class="org-string">"C-M-w"</span>) #'er/expand-region)    <span class="org-comment-delimiter">; </span><span class="org-comment">See key-chord `</span><span class="org-comment"><span class="org-constant">hh</span></span><span class="org-comment">'.</span>
    (global-set-key (kbd <span class="org-string">"C-S-w"</span>) #'er/contract-region)) <span class="org-comment-delimiter">; </span><span class="org-comment">See key-chord `</span><span class="org-comment"><span class="org-constant">HH</span></span><span class="org-comment">'.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgda69de3" class="outline-3">
<h3 id="orgda69de3">Operating on the Region</h3>
<div class="outline-text-3" id="text-orgda69de3">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Inserting text while the mark is active causes the text in the region to be</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">deleted first.</span>
  (delete-selection-mode 1)             <span class="org-comment-delimiter">; </span><span class="org-comment">Overwrite region.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org9559561" class="outline-3">
<h3 id="org9559561">Shift Selection</h3>
<div class="outline-text-3" id="text-org9559561">
<p>
Shifted motion keys activate the mark momentarily.
</p>
</div>
</div>

<div id="outline-container-orgf6e57d1" class="outline-3">
<h3 id="orgf6e57d1">Multiple selections</h3>
<div class="outline-text-3" id="text-orgf6e57d1">
<p>
You can <a href="http://www.emacsrocks.com/e13.html">watch an intro to multiple-cursors at Emacs Rocks</a>.
</p>

<p>
In other editors:
</p>

<ul class="org-ul">
<li><a href="https://www.sublimetext.com/docs/2/multiple_selection_with_the_keyboard.html">https://www.sublimetext.com/docs/2/multiple_selection_with_the_keyboard.html</a></li>
<li><a href="https://docs.c9.io/multiple_cursors.html">https://docs.c9.io/multiple_cursors.html</a></li>
<li><a href="http://komodoide.com/screencasts/watch/87286656-multiple-selections/">http://komodoide.com/screencasts/watch/87286656-multiple-selections/</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Multiple cursors for Emacs.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"multiple-cursors-autoloads"</span>
</pre>
</div>
</div>

<div id="outline-container-orgd6348f6" class="outline-4">
<h4 id="orgd6348f6">Splitting the selection into lines</h4>
<div class="outline-text-4" id="text-orgd6348f6">
<p>
Make <b>batch edits</b> with Multiple Cursors: select a block of lines, and then <b>split
the region into lines</b> which are then <b>edited simultaneously</b>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add a cursor to each (continuous) line in the current region.</span>
    (global-set-key (kbd <span class="org-string">"C-S-c C-S-c"</span>) #'mc/edit-lines) <span class="org-comment-delimiter">;</span><span class="org-comment">!</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org1c63732" class="outline-4">
<h4 id="org1c63732">Quick add next/previous</h4>
<div class="outline-text-4" id="text-org1c63732">
<p>
Use Multiple Cursors to <b>rename variables quickly</b>: <b>add the next</b> or previous
<b>occurrence of the current word to the selection</b>, and then type the new name.
Done.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add a cursor and region at the next/previous part of the buffer that</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">matches the current region.</span>
    (global-set-key (kbd <span class="org-string">"C-&gt;"</span>) #'mc/mark-next-like-this) <span class="org-comment-delimiter">;</span><span class="org-comment">!</span>
    (global-set-key (kbd <span class="org-string">"C-&lt;"</span>) #'mc/mark-previous-like-this) <span class="org-comment-delimiter">;</span><span class="org-comment">!</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add Selection for Next Occurrence.</span>
    (global-set-key (kbd <span class="org-string">"M-j"</span>) #'mc/mark-next-like-this) <span class="org-comment-delimiter">; </span><span class="org-comment">IntelliJ.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Unselect Occurrence. XXX</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "M-J") #'mc/unmark-next-like-this) ; IntelliJ.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Skip the current one and select the next/previous part of the buffer that</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">matches the current region.</span>
    (global-set-key (kbd <span class="org-string">"C-M-&gt;"</span>) #'mc/skip-to-next-like-this)
    (global-set-key (kbd <span class="org-string">"C-M-&lt;"</span>) #'mc/skip-to-previous-like-this)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add or remove caret.</span>
    (global-set-key (kbd <span class="org-string">"&lt;C-S-mouse-1&gt;"</span>) #'mc/add-cursor-on-click)
    (global-set-key (kbd <span class="org-string">"&lt;M-mouse-1&gt;"</span>)   #'mc/add-cursor-on-click) <span class="org-comment-delimiter">;; </span><span class="org-comment">XXX DOES NOT WORK.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org05eff81" class="outline-4">
<h4 id="org05eff81">Find All</h4>
<div class="outline-text-4" id="text-org05eff81">
<p>
<b>Add all occurrences of the current word to the selection.</b>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Select All Occurrences.</span>
    (global-set-key (kbd <span class="org-string">"C-M-S-j"</span>) #'mc/mark-all-like-this-dwim) <span class="org-comment-delimiter">;</span><span class="org-comment">! IntelliJ.</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Tries to guess what you want to mark all of.</span>
    (global-set-key (kbd <span class="org-string">"C-;"</span>)     #'mc/mark-all-like-this-dwim) <span class="org-comment-delimiter">;</span><span class="org-comment">! Like Iedit.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-c C-w") #'mc/mark-all-like-this-dwim)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-x C-;") #'mc/mark-all-like-this-dwim)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Mark all parts of the buffer that matches the current region.</span>
    (global-set-key (kbd <span class="org-string">"C-c C-&lt;"</span>) #'mc/mark-all-like-this) <span class="org-comment-delimiter">;</span><span class="org-comment">!</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (global-set-key (kbd <span class="org-string">"C-!"</span>) #'mc/mark-next-symbol-like-this)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "&lt;C-RET&gt;") #'mc/mark-more-like-this-extended) ; useful for completion</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Insert increasing numbers for each cursor.</span>
    (global-set-key (kbd <span class="org-string">"C-M-="</span>) #'mc/insert-numbers)
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdf7cbd9" class="outline-4">
<h4 id="orgdf7cbd9">Single Selection</h4>
<div class="outline-text-4" id="text-orgdf7cbd9">
<p>
To go from multiple selections to a single selection, press <code>C-g</code> or <code>RET</code>.
</p>
</div>
</div>

<div id="outline-container-org73f0254" class="outline-4">
<h4 id="org73f0254">Commands to run in multiple-cursors-mode</h4>
<div class="outline-text-4" id="text-org73f0254">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Multiple cursors for Emacs.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"multiple-cursors-core"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Commands to run for all cursors in multiple-cursors-mode.</span>
    (<span class="org-keyword">setq</span> mc/cmds-to-run-for-all        <span class="org-comment-delimiter">; </span><span class="org-comment">See .mc-lists.el.</span>
          '(c-electric-slash
            cycle-spacing
            emr-show-refactor-menu
            isearch-abort
            isearch-printing-char
            js2-mode-show-node
            just-one-space
            kill-region
            leuven-fill-paragraph
            leuven-smart-punctuation-quotation-mark
            org-beginning-of-line
            org-end-of-line
            org-kill-line
            org-self-insert-command
            org-shiftdown
            org-shiftleft
            org-shiftright
            org-shiftup
            org-yank
            orgtbl-self-insert-command
            yas-expand))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Commands to run only once in multiple-cursors-mode.</span>
    (<span class="org-keyword">setq</span> mc/cmds-to-run-once
          '()))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 11 ends here.</span>
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org5fab9c6" class="outline-2">
<h2 id="org5fab9c6">Killing and Moving Text</h2>
<div class="outline-text-2" id="text-org5fab9c6">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 12 (info "(emacs)Killing") and Moving Text</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-12-killing <span class="org-string">"12 Killing and Moving Text"</span>
</pre>
</div>
</div>

<div id="outline-container-org70df8d1" class="outline-3">
<h3 id="org70df8d1">Deletion and Killing</h3>
<div class="outline-text-3" id="text-org70df8d1">
<dl class="org-dl">
<dt><code>C-S-backspace</code></dt><dd>Kill an entire line at once.</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 12.1 (info "(emacs)Deletion and Killing")</span>

  (leuven--section <span class="org-string">"12.1 (emacs)Deletion and Killing"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Manipulate whitespace around point in a smart way.</span>
  (global-set-key (kbd <span class="org-string">"M-SPC"</span>) #'cycle-spacing) <span class="org-comment-delimiter">; </span><span class="org-comment">vs `</span><span class="org-comment"><span class="org-constant">just-one-space</span></span><span class="org-comment">'.</span>
</pre>
</div>

<p>
With the following gems, you can kill or copy the line point is on with a single
keystroke:
</p>

<ul class="org-ul">
<li><code>C-w</code> kills the current line</li>
<li><code>M-w</code> copies the current line</li>
</ul>

<div class="note">
<p>
If there is an active region, <code>kill-region</code> and <code>kill-ring-save</code> will continue to do
what they normally do: kill or copy it.
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Add the ability to cut the current line without marking it (no selection).</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">kill-region--slick-cut</span> (beg end)
    <span class="org-doc">"When called with no active region, kill the current line instead."</span>
    (<span class="org-keyword">interactive</span>
     (<span class="org-keyword">if</span> (use-region-p)
         (list (region-beginning) (region-end))
       (list (line-beginning-position) (line-beginning-position 2)))))
  (advice-add 'kill-region <span class="org-builtin">:before</span> #'kill-region--slick-cut)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Add the ability to copy the current line without marking it (no selection).</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">kill-ring-save--slick-copy</span> (beg end)
    <span class="org-doc">"When called with no active region, copy the current line instead."</span>
    (<span class="org-keyword">interactive</span>
     (<span class="org-keyword">if</span> (use-region-p)
         (list (region-beginning) (region-end))
       (message <span class="org-string">"[Copied the current line]"</span>)
       (list (line-beginning-position) (line-beginning-position 2)))))
  (advice-add 'kill-ring-save <span class="org-builtin">:before</span> #'kill-ring-save--slick-copy)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Command</th>
<th scope="col" class="org-left">Emacs</th>
<th scope="col" class="org-left">Sublime Text</th>
<th scope="col" class="org-left">TextMate</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Duplicate line</td>
<td class="org-left">C-S-d</td>
<td class="org-left">C-S-d</td>
<td class="org-left">C-S-d</td>
</tr>
</tbody>
</table>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">duplicate-current-line</span> ()
    <span class="org-doc">"Duplicate the line containing point."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">save-excursion</span>
      (<span class="org-keyword">let</span> (line-text)
        (goto-char (line-beginning-position))
        (<span class="org-keyword">let</span> ((beg (point)))
          (goto-char (line-end-position))
          (<span class="org-keyword">setq</span> line-text (buffer-substring beg (point))))
        (<span class="org-keyword">if</span> (eobp)
            (insert ?\n)
          (forward-line))
        (open-line 1)
        (insert line-text))))

  (global-set-key (kbd <span class="org-string">"C-S-d"</span>) #'duplicate-current-line)
</pre>
</div>

<p>
To <b>highlight duplicate lines</b>, see
<a href="https://emacs.stackexchange.com/questions/13092/how-can-i-highlight-duplicate-lines">https://emacs.stackexchange.com/questions/13092/how-can-i-highlight-duplicate-lines</a>
</p>

<p>
In Emacs 24.4+, the cleanest way to <b>uniquify lines</b> (<code>uniq-lines</code>) is the
<code>delete-duplicate-lines</code> function.
</p>

<p>
Note that:
</p>
<ul class="org-ul">
<li>this works on a region, not a buffer, so select the desired text first,</li>
<li>it maintains the relative order of the originals, killing the duplicates.</li>
</ul>

<p>
For example, if your input is:
</p>

<pre class="example">
test
dup
dup
one
two
one
three
one
test
five
</pre>

<p>
<code>M-x delete-duplicate-lines</code> would make it:
</p>

<pre class="example">
test
dup
one
two
three
five
</pre>

<p>
That is, it does remove all <b>duplicate lines</b> in region, not only the <b>consecutive</b>
ones.
</p>
</div>
</div>

<div id="outline-container-org54d18e9" class="outline-3">
<h3 id="org54d18e9">Yanking</h3>
<div class="outline-text-3" id="text-org54d18e9">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 12.2 (info "(emacs)Yanking")</span>

  (leuven--section <span class="org-string">"12.2 (emacs)Yanking"</span>)
</pre>
</div>

<p>
Auto-indent on paste.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Auto-indentation of pasted code in the programming modes</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(fall back to default, non-indented, yanking by preceding the yanking</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">command `</span><span class="org-comment"><span class="org-constant">C-y</span></span><span class="org-comment">' with `</span><span class="org-comment"><span class="org-constant">C-u</span></span><span class="org-comment">').</span>
  (<span class="org-keyword">dolist</span> (command '(yank
                     yank-pop))
    (eval `(<span class="org-keyword">defadvice</span> ,command (after leuven-indent-region activate)
             <span class="org-doc">"Indent `</span><span class="org-doc"><span class="org-constant">yank</span></span><span class="org-doc">'ed text if programming mode (and no prefix)."</span>
             (<span class="org-keyword">let</span> ((mark-even-if-inactive t))
               (<span class="org-keyword">and</span> (not current-prefix-arg)
                    (derived-mode-p 'prog-mode)
                    (indent-region (region-beginning) (region-end) nil))))))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Save clipboard strings into kill ring before replacing them.</span>
  (<span class="org-keyword">setq</span> save-interprogram-paste-before-kill t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Rotating the kill ring changes the window system selection.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq yank-pop-change-selection t)</span>
</pre>
</div>
</div>

<div id="outline-container-org0d5fad5" class="outline-4">
<h4 id="org0d5fad5">Yanking Earlier Kills</h4>
<div class="outline-text-4" id="text-org0d5fad5">
<p>
Interactively insert items from kill ring with <code>M-x helm-show-kill-ring</code> (see
<a href="#org268951e">Helm</a>).
</p>
</div>
</div>
</div>

<div id="outline-container-orgfca9711" class="outline-3">
<h3 id="orgfca9711">Cutting and Pasting on Graphical Displays</h3>
<div class="outline-text-3" id="text-orgfca9711">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 12.3 (info "(emacs)Cut and Paste")</span>

  (leuven--section <span class="org-string">"12.3 (emacs)Cut and Paste on Graphical Displays"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Make cut, copy and paste (keys and menu bar items) use the clipboard.</span>
  (menu-bar-enable-clipboard)
</pre>
</div>
</div>
</div>

<div id="outline-container-org7df20d0" class="outline-3">
<h3 id="org7df20d0">Rectangles</h3>
<div class="outline-text-3" id="text-org7df20d0">
<p>
To kill the text of a rectangular area (vertically selected text), use <code>C-x r k</code>
(<code>kill-rectangle</code>).  Or just &ldquo;delete&rdquo; the &ldquo;region-rectangle&rdquo; (without &ldquo;killing&rdquo;
it) with <code>C-x r d</code>.
</p>

<p>
To copy a (series of) Org column(s) while avoiding the use of registers:
</p>
<ol class="org-ol">
<li>select the region-rectangle,</li>
<li>use the command <code>copy-rectangle-as-kill</code> (bound to <code>C-x r M-w</code>), then</li>
<li>paste the copied rectangle by doing <code>yank-rectangle</code> (<code>C-x r y</code>).</li>
</ol>

<p>
To do the same with registers:
</p>
<ol class="org-ol">
<li>select the region-rectangle,</li>
<li>use <code>C-x r r R</code> to copy the rectangle to the register named <code>R</code>,</li>
<li>use <code>C-x r i R</code> to insert the rectangle that is being held in the register
named <code>R</code>.</li>
</ol>

<p>
To shift cells up/down within a column of an Org table while leaving remaining
columns intact, use <code>kill-rectangle</code> and <code>yank-rectangle</code>.
</p>

<p>
To delete whitespace in each of the lines on the specified rectangle, use
<code>M-x delete-whitespace-rectangle</code>.
</p>

<p>
Use <code>C-x r t STRING RET</code> to replace each line of a region-rectangle with a given
string.
</p>

<div class="note">
<p>
Since Emacs 24.4, you can use <code>rectangle-mark-mode</code> (<code>C-x SPC</code>) and do:
</p>
<ul class="org-ul">
<li><code>C-x SPC</code> &lt;&#x2026;move around&#x2026;&gt; <code>DEL</code> to delete the rectangle and</li>
<li><code>C-x SPC</code> &lt;&#x2026;move around&#x2026;&gt; <code>C-t</code> to invoke <code>string-rectangle</code>.</li>
</ul>

</div>
</div>
</div>

<div id="outline-container-orgf37693e" class="outline-3">
<h3 id="orgf37693e">CUA Bindings</h3>
<div class="outline-text-3" id="text-orgf37693e">
<p>
CUA mode sets up key bindings used in many other applications (<code>C-x</code>, <code>C-c</code>, <code>C-v</code> and
<code>C-z</code>).
</p>

<p>
The <code>C-x</code> and <code>C-c</code> keys only do cut and copy when the region is active, so in most
cases, they do not conflict with the normal function of these prefix keys.
</p>

<p>
If you really need to perform a command which starts with one of the prefix keys
even when the region is active, you have three options:
</p>

<ul class="org-ul">
<li>press the prefix key twice very quickly (within 0.2 seconds),</li>
<li>press the prefix key and the following key within 0.2 seconds, or</li>
<li>use the Shift key with the prefix key, i.e. <code>C-S-x</code> or <code>C-S-c</code>.</li>
</ul>

<p>
You can customize <code>cua-enable-cua-keys</code> to completely disable the CUA bindings, or
<code>cua-prefix-override-inhibit-delay</code> to change the prefix fallback behavior.
</p>

<p>
CUA mode also provides enhanced rectangle support with visible rectangle
highlighting.  Though, since Emacs 24.4, <code>rectangle-mark-mode</code> is the new way.
</p>

<ul class="org-ul">
<li><code>&lt;C-RET&gt;</code> runs the command <code>cua-set-rectangle-mark</code></li>
<li><code>M-n</code> runs the command <code>cua-sequence-rectangle</code></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 12 ends here.</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0e0c003" class="outline-2">
<h2 id="org0e0c003">Registers (Navigation)</h2>
<div class="outline-text-2" id="text-org0e0c003">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 13 (info "(emacs)Registers")</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-13-registers <span class="org-string">"13 Registers"</span>
</pre>
</div>
</div>

<div id="outline-container-org969c883" class="outline-3">
<h3 id="org969c883">Saving Positions in Registers</h3>
<div class="outline-text-3" id="text-org969c883">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 13.1 (info "(emacs)Position Registers")</span>

  (leuven--section <span class="org-string">"13.1 (emacs)Position Registers"</span>)
</pre>
</div>

<p>
<b>Registers:</b>
</p>

<dl class="org-dl">
<dt><code>C-x r SPC</code></dt><dd><code>point-to-register</code>.  Store point in a register.  Type any character to
specify a register when prompted.</dd>

<dt><code>C-x r j</code></dt><dd><code>jump-to-register</code>.  Jump to a point stored in a register.</dd>
</dl>

<p>
Setup registers for files I commonly edit.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (set-register ?a '(file . <span class="org-string">"/sudo::/etc/apt/sources.list"</span>))
  (set-register ?b '(file . <span class="org-string">"~/.bashrc"</span>))
  (set-register ?e `(file . ,(concat leuven--directory <span class="org-string">"emacs-leuven.txt"</span>)))
  (<span class="org-keyword">when</span> (file-exists-p <span class="org-string">"~/4-Admin/0-refile.org"</span>)
    (set-register ?r '(file . <span class="org-string">"~/4-Admin/0-refile.org"</span>))) <span class="org-comment-delimiter">; </span><span class="org-comment">Open my CollectBox.</span>
  (set-register ?z '(file . <span class="org-string">"~/.zshrc"</span>))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd8ec213" class="outline-3">
<h3 id="orgd8ec213">Navigating with Bookmarks</h3>
<div class="outline-text-3" id="text-orgd8ec213">
</div>
<div id="outline-container-orgf1cda2c" class="outline-4">
<h4 id="orgf1cda2c">Bookmark</h4>
<div class="outline-text-4" id="text-orgf1cda2c">
<p>
If you need to <b>move to somewhere in your document</b> and want a <b>quick way to
return</b>, you can create a <b>bookmark WITH MNEMONIC</b> on the current line.
</p>

<div class="note">
<p>
Emacs bookmarks positions, not (just) lines!
</p>

</div>

<p>
<b>Bookmarks:</b>
</p>

<dl class="org-dl">
<dt>C-x r m</dt><dd><code>C-x r m RET</code> or <code>C-x r m BOOKMARK RET</code> (<code>M-x bookmark-set</code>).  Save a named
bookmark.</dd>

<dt>C-x r b</dt><dd><code>bookmark-jump</code>.  Jump to a named bookmark.</dd>

<dt>C-x r l</dt><dd>List all bookmarks.</dd>
</dl>

<div class="note">
<p>
Bookmarks are <b>persistent</b> across sessions and they have <b>names</b>; not <i>markers</i>.
Bookmarked positions can also be <b>relocated</b> (found) if they move slightly because
of text changes.
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 13.7 (info "(emacs)Bookmarks")</span>

  (leuven--section <span class="org-string">"13.7 (emacs)Bookmarks"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"bookmark"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Where to save the bookmarks.</span>
    (<span class="org-keyword">setq</span> bookmark-default-file (concat user-emacs-directory <span class="org-string">"bookmarks.bmk"</span>))
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">! A `</span><span class="org-comment"><span class="org-constant">.txt</span></span><span class="org-comment">' extension would load Org at</span>
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">! the time `</span><span class="org-comment"><span class="org-constant">bookmark</span></span><span class="org-comment">' is required!</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Each command that sets a bookmark will also save your bookmarks.</span>
    (<span class="org-keyword">setq</span> bookmark-save-flag 1)
</pre>
</div>
</div>
</div>

<div id="outline-container-org8c29e9f" class="outline-4">
<h4 id="org8c29e9f">Bookmark+</h4>
<div class="outline-text-4" id="text-org8c29e9f">
<p>
With <b>Bookmark+</b> (which offers quite a bit more than <code>bm.el</code>):
</p>

<ul class="org-ul">
<li>Bookmarks are <b>visible</b> in the buffer.</li>

<li>Bookmarks can be as simple as marks &#x2013; <b>no naming needed</b>.</li>

<li>You can <b>cycle</b> among them.</li>

<li>You can bookmark arbitrary sets of files, from any locations.</li>

<li>You can bookmark Dired buffers (which, again, can actually list arbitrary
files, not even necessarily in the same directory).  Markings, subdir
inclusions, and omissions are all recorded, and restored when you access the
bookmark.</li>

<li>You can tag bookmarks or files, using arbitrary strings as tags.  You can do
this programmatically and interactively, by regexp, name, or Dired markings.
Tags give you a great way to define sets of bookmarks or files &#x2013; sets that
can overlap, etc.  They serve to categorize, but they can do more than that.
You can use tags to, in effect, merge projects, split projects, define
subprojects, and so on.</li>
</ul>

<p>
Key shortcuts:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Command</th>
<th scope="col" class="org-left">Sublime Text</th>
<th scope="col" class="org-left">IntelliJ</th>
<th scope="col" class="org-left">Atom</th>
<th scope="col" class="org-left">Webstorm</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">View All bookmarks</td>
<td class="org-left">M-F2</td>
<td class="org-left">S-F11</td>
<td class="org-left">C-F2</td>
<td class="org-left">S-F11</td>
</tr>

<tr>
<td class="org-left">Toggle bookmark</td>
<td class="org-left">C-F2</td>
<td class="org-left">F11</td>
<td class="org-left">C-M-F2</td>
<td class="org-left">F11</td>
</tr>

<tr>
<td class="org-left">Toggle bookmark with mnemonic</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">C-F11</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">C-S-F11</td>
</tr>

<tr>
<td class="org-left">Jump to Next bookmark</td>
<td class="org-left">F2</td>
<td class="org-left">-</td>
<td class="org-left">F2</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Jump to Previous bookmark</td>
<td class="org-left">S-F2</td>
<td class="org-left">-</td>
<td class="org-left">S-F2</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Clear All Bookmarks</td>
<td class="org-left">C-S-F2</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<dl class="org-dl">
<dt><code>C-x p RET</code> (<code>C-&lt;F2&gt;</code> in Emacs-Leuven, Sublime Text and TextMate)</dt><dd><b>Toggle</b> (<b>set</b> or delete) an <b>ANONYMOUS bookmark</b> at point.</dd>

<dt>M-x bmkp-set-autonamed-regexp-buffer</dt><dd>Set <b>ANONYMOUS bookmarks</b> at matches for REGEXP in the buffer.</dd>

<dt><code>C-x p C-down</code> (<code>S-&lt;F2&gt;</code> in Emacs-Leuven, <code>F2</code> in Sublime Text and TextMate)</dt><dd>Navigate to the <b>next bookmark</b> within the current buffer.</dd>

<dt><code>C-x p C-up</code> (<code>S-&lt;F2&gt;</code> in Sublime Text and TextMate)</dt><dd>Navigate to the <b>previous bookmark</b> within the current buffer.</dd>

<dt><code>C-x j h</code></dt><dd>Jump to a bookmark.</dd>

<dt>C-x p ,</dt><dd><b>Show all bookmarks</b> for the current file/buffer.</dd>

<dt>C-x p DEL</dt><dd><b>Delete bookmark</b> (<b>ANONYMOUS</b> or <b>WITH MNEMONICS</b>) <b>at point</b>.</dd>

<dt><code>C-S-&lt;F2&gt;</code> (in Emacs-Leuven)</dt><dd><b>Delete all ANONYMOUS bookmarks</b> for the current file/buffer.</dd>
</dl>

<p>
Buffer-local nature of the bookmarks.
</p>

<p>
Annotating bookmarks.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Extensions to standard library `</span><span class="org-comment"><span class="org-constant">bookmark.el</span></span><span class="org-comment">'.</span>
    (<span class="org-keyword">when</span> (try-require 'bookmark+)<span class="org-comment-delimiter">;</span><span class="org-comment">XXX + needs bookmark+-mac</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Toggle an ANONYMOUS bookmark on the current line.</span>
      (global-set-key (kbd <span class="org-string">"&lt;C-f2&gt;"</span>) #'bmkp-toggle-autonamed-bookmark-set/delete)

      (global-set-key (kbd <span class="org-string">"&lt;S-f2&gt;"</span>) #'bmkp-next-bookmark-this-file/buffer-repeat)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Delete all ANONYMOUS bookmarks in a buffer.</span>
      (global-set-key (kbd <span class="org-string">"&lt;C-S-f2&gt;"</span>) #'bmkp-delete-all-autonamed-for-this-buffer))

    (<span class="org-keyword">when</span> (fboundp 'helm-bookmarks)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">View all bookmarks.</span>
      (global-set-key (kbd <span class="org-string">"&lt;M-f2&gt;"</span>) #'helm-bookmarks))

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"bookmark+"</span>

      (add-hook 'find-file-hook #'bmkp-light-this-buffer)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Priorities of bookmark highlighting overlay types.</span>
      (<span class="org-keyword">setq</span> bmkp-light-priorities '((bmkp-autonamed-overlays     . 150)
                                    (bmkp-non-autonamed-overlays . 160)))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Symbols for the fringe bitmaps to use to highlight a bookmark.</span>
      (<span class="org-keyword">setq</span> bmkp-light-left-fringe-bitmap 'filled-square)
      (<span class="org-keyword">setq</span> bmkp-light-right-fringe-bitmap 'filled-square)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Default highlight style for ANONYMOUS (= default) bookmarks.</span>
      (<span class="org-keyword">setq</span> bmkp-light-style-autonamed 'line+lfringe)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Default highlight style for bookmarks WITH MNEMONICS.</span>
      (<span class="org-keyword">setq</span> bmkp-light-style-non-autonamed 'line+lfringe)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Automatically highlight bookmarks when set.</span>
      (<span class="org-keyword">setq</span> bmkp-auto-light-when-set 'all-in-buffer)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Automatically highlight bookmarks when jumped to.</span>
      (<span class="org-keyword">setq</span> bmkp-auto-light-when-jump 'all-in-buffer)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't propertize bookmark names to hold full bookmark data.</span>
      (<span class="org-keyword">setq</span> bmkp-propertize-bookmark-names-flag nil)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">We will often be going back and forth</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">between using Bookmark+ and using</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">vanilla Emacs.</span>

      (<span class="org-keyword">setq</span> bmkp-last-as-first-bookmark-file nil)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Name ANONYMOUS bookmarks with buffer name and line number.</span>
      (<span class="org-keyword">setq</span> bmkp-autoname-format <span class="org-string">"^%B:[0-9]+: %s"</span>)

      (<span class="org-keyword">setq</span> bmkp-autoname-bookmark-function #'leuven-bmkp-autoname-line)

      (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-bmkp-autoname-line</span> (position)
        <span class="org-doc">"Name autonamed bookmark at POSITION using line number."</span>
        (<span class="org-keyword">let</span> ((line  (line-number-at-pos position)))
          <span class="org-comment-delimiter">;; </span><span class="org-comment">(format "%s:%d (%s)" (buffer-name) line (buffer-file-name))</span>
          (format <span class="org-string">"%s:%d: %s"</span>
                  (buffer-name)
                  line
                  (buffer-substring-no-properties
                   (line-beginning-position)
                   (1- (line-beginning-position 2))))))))
</pre>
</div>

<p>
XXX They should always be in color when opening a buffer&#x2026; not only when
jumping onto them&#x2026;
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm-autoloads"</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Helm for bookmarks (filtered by category).</span>
      (global-set-key (kbd <span class="org-string">"C-x r l"</span>) #'helm-filtered-bookmarks))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orge0c1fd9" class="outline-3">
<h3 id="orge0c1fd9">Avy (alternative to Ace Jump)</h3>
<div class="outline-text-3" id="text-orge0c1fd9">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"avy-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Quickly jump to a position in the current view. XXX Conflict with Org mode (in tables).</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-c SPC") #'avy-goto-word-or-subword-1)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Jump back to previous position.</span>
    (global-set-key (kbd <span class="org-string">"C-c C-SPC"</span>) #'avy-pop-mark)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Jump during Isearch to one of the current candidates.</span>
    (define-key isearch-mode-map (kbd <span class="org-string">"C-'"</span>) #'avy-isearch)
    (define-key isearch-mode-map (kbd <span class="org-string">"@"</span>)   #'avy-isearch))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Jump to things.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"avy"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Default keys for jumping.</span>
    (<span class="org-keyword">setq</span> avy-keys (number-sequence ?a ?z))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Determine the list of windows to consider in search of candidates.</span>
    (<span class="org-keyword">setq</span> avy-all-windows 'all-frames)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Highlight the first decision char with `</span><span class="org-comment"><span class="org-constant">avy-lead-face-0</span></span><span class="org-comment">'.</span>
    (<span class="org-keyword">setq</span> avy-highlight-first t))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 13 ends here.</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgedd8dd1" class="outline-2">
<h2 id="orgedd8dd1">Controlling the Display</h2>
<div class="outline-text-2" id="text-orgedd8dd1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 14 Controlling the (info "(emacs)Display")</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-14-display <span class="org-string">"14 Controlling the Display"</span>
</pre>
</div>
</div>

<div id="outline-container-orgc905102" class="outline-3">
<h3 id="orgc905102">Scrolling</h3>
<div class="outline-text-3" id="text-orgc905102">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.1 (info "(emacs)Scrolling")</span>

  (leuven--section <span class="org-string">"14.1 (emacs)Scrolling"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">When scrolling, point preserves the cursor position in the buffer if the</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">original position is still visible.</span>
  (<span class="org-keyword">setq</span> scroll-preserve-screen-position t)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Better scrolling in Emacs (doing a &lt;PageDown&gt; followed by a &lt;PageUp&gt; will</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">place the point at the same place).</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"pager-autoloads"</span>

    (autoload 'pager-page-up <span class="org-string">"pager"</span>
      <span class="org-doc">"Like scroll-down, but moves a fixed amount of lines."</span> t)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">These autoloads aren't defined in</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">pager-autoloads</span></span><span class="org-comment">'!</span>
    (autoload 'pager-page-down <span class="org-string">"pager"</span>
      <span class="org-doc">"Like scroll-up, but moves a fixed amount of lines."</span> t)

    (global-set-key (kbd <span class="org-string">"&lt;prior&gt;"</span>) #'pager-page-up)
    (global-set-key (kbd <span class="org-string">"&lt;next&gt;"</span>)  #'pager-page-down))
</pre>
</div>
</div>
</div>

<div id="outline-container-org9d18bcb" class="outline-3">
<h3 id="org9d18bcb">Automatic Scrolling</h3>
<div class="outline-text-3" id="text-org9d18bcb">
<p>
&ldquo;Smooth&rdquo; (civilized) scrolling.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.3 (info "(emacs)Auto Scrolling")</span>

  (leuven--section <span class="org-string">"14.3 (emacs)Auto Scrolling"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Scroll only one line at a time (redisplay will never recenter point).</span>
  (<span class="org-keyword">setq</span> scroll-conservatively 10000)    <span class="org-comment-delimiter">; </span><span class="org-comment">Or `</span><span class="org-comment"><span class="org-constant">most-positive-fixnum</span></span><span class="org-comment">'.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Number of lines of margin at the top and bottom of a window.</span>
  (<span class="org-keyword">setq</span> scroll-margin 4)                <span class="org-comment-delimiter">; </span><span class="org-comment">Also for `</span><span class="org-comment"><span class="org-constant">isearch-forward</span></span><span class="org-comment">'.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Scrolling down looks much better.</span>
  (<span class="org-keyword">setq</span> auto-window-vscroll nil)
</pre>
</div>
</div>
</div>

<div id="outline-container-org6023741" class="outline-3">
<h3 id="org6023741">Horizontal Scrolling</h3>
<div class="outline-text-3" id="text-org6023741">
<p>
How to automatically add/remove horizontal scrollbars as needed by text width?
</p>
</div>
</div>

<div id="outline-container-orgbaee368" class="outline-3">
<h3 id="orgbaee368">Narrowing</h3>
<div class="outline-text-3" id="text-orgbaee368">
<dl class="org-dl">
<dt><code>C-x n n</code></dt><dd><b>Narrow</b> down to between point and mark.</dd>

<dt><code>C-x n d</code></dt><dd><b>Narrow</b> down to the current <b>defun</b>.</dd>

<dt><code>C-x n s</code></dt><dd><b>Narrow</b> buffer to the current <b>subtree</b> (bound in Org mode).</dd>

<dt><code>C-x n w</code></dt><dd><b>Widen</b> to make the entire buffer accessible again.</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.5 (info "(emacs)Narrowing")</span>

  (leuven--section <span class="org-string">"14.5 (emacs)Narrowing"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable the use of the command `</span><span class="org-comment"><span class="org-constant">narrow-to-region</span></span><span class="org-comment">' without confirmation.</span>
  (put 'narrow-to-region 'disabled nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "fancy-narrow-autoloads"</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(fancy-narrow-mode)) ; perf problems when calling `</span><span class="org-comment"><span class="org-constant">helm-for-files</span></span><span class="org-comment">' from a big file?</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org480b568" class="outline-3">
<h3 id="org480b568">Font Lock mode</h3>
<div class="outline-text-3" id="text-org480b568">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.12 (info "(emacs)Font Lock")</span>

  (leuven--section <span class="org-string">"14.12 (emacs)Font Lock"</span>)
</pre>
</div>

<p>
Prior to running their own mode hooks,
</p>
<ul class="org-ul">
<li>all text-based major modes run <code>text-mode-hook</code>, and</li>
<li>all programming language modes run <code>prog-mode-hook</code>.</li>
</ul>

<p>
Add font locking for the following patterns in upper case:
</p>

<ul class="org-ul">
<li><code>TODO</code>,</li>
<li><code>FIXME</code>,</li>
<li><code>XXX</code> and</li>
<li><code>BUG</code></li>
</ul>

<p>
to all modes except Diff mode and Org mode.
</p>

<div class="note">
<p>
In Eclipse, they are all <b>case in-sensitive</b> by default.
In IntelliJ IDEA, the are recognized in both lower and upper case.
</p>

</div>

<pre class="example">
// TODO(fni) Please make sure that everything works
// FIXME[fni] Main method
// XXX-fni: Add comments
// BUG Review script body

/* TODO this is the normal way */
/* todo this is another to-do */
/*! \todo this is a doxygen to-do */
// TODO this is a C++ to-do comment
</pre>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-todo-patterns-face</span>
    '((t <span class="org-builtin">:weight</span> bold <span class="org-builtin">:foreground</span> <span class="org-string">"#FF3125"</span> <span class="org-builtin">:background</span> <span class="org-string">"#FFFF88"</span>))
    <span class="org-doc">"Face for making TODO items stand out."</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Highlight tasks.</span>
  (<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-todo-patterns-in-org</span>
    <span class="org-string">"\\&lt;</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">FIXME</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">XXX</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">BUG</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">([</span><span class="org-string"><span class="org-negation-char">^</span></span><span class="org-string">)]*)</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">?:?.*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span> <span class="org-comment-delimiter">; </span><span class="org-comment">Start of word.</span>
    <span class="org-doc">"TODO patterns to highlight (for Org mode only).</span>
<span class="org-doc">  The goal is to ensure no conflict with the Org mode TODO keyword."</span>)

  (<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-todo-patterns-anywhere</span>
    <span class="org-string">"\\&lt;</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">TODO</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">FIXME</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">XXX</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">BUG</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">([</span><span class="org-string"><span class="org-negation-char">^</span></span><span class="org-string">)]*)</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">?:?.*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span>
    <span class="org-doc">"TODO patterns to highlight (for all modes)."</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Add highlighting keywords.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--highlight-todo-patterns</span> ()
    <span class="org-doc">"Highlight TODO patterns."</span>
    (<span class="org-keyword">cond</span>
     ((derived-mode-p 'org-mode)
      (font-lock-add-keywords nil         <span class="org-comment-delimiter">; </span><span class="org-comment">In the current buffer.</span>
       `((,leuven-todo-patterns-in-org 1 'leuven-todo-patterns-face prepend)) 'end))
     ((not (derived-mode-p 'diff-mode))
      (font-lock-add-keywords nil         <span class="org-comment-delimiter">; </span><span class="org-comment">In the current buffer.</span>
       `((,leuven-todo-patterns-anywhere 1 'leuven-todo-patterns-face prepend)) 'end))))

  (add-hook 'find-file-hook #'leuven--highlight-todo-patterns)
</pre>
</div>

<p>
See doc of <code>font-lock-keywords</code> and <code>font-lock-add-keywords</code>.
</p>

<p>
Check out <code>log4j-mode</code> instead?  And nice colors at
<a href="https://www.jetbrains.com/resharper/help/Regular_Expressions_Assistance.html">https://www.jetbrains.com/resharper/help/Regular_Expressions_Assistance.html</a>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (global-set-key (kbd <span class="org-string">"&lt;M-f6&gt;"</span>)
                  #'(lambda ()
                      (<span class="org-keyword">interactive</span>)
                      (occur <span class="org-string">"TODO</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">FIXME</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">XXX</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">BUG"</span>)))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Just-in-time fontification.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"jit-lock"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Stealth fontification should show status messages.</span>
    (<span class="org-keyword">setq</span> jit-lock-stealth-verbose t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Idle time after which deferred fontification should take place.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq jit-lock-defer-time 0.05)     ; Improve the scrolling speed in large</span>
    <span class="org-comment-delimiter">;;                                     </span><span class="org-comment">; files.</span>
    )
</pre>
</div>
</div>
</div>

<div id="outline-container-org5421363" class="outline-3">
<h3 id="org5421363">Interactive Highlighting</h3>
<div class="outline-text-3" id="text-org5421363">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.13 (info "(emacs)Highlight Interactively") by Matching</span>

  (leuven--section <span class="org-string">"14.13 (emacs)Highlight Interactively by Matching"</span>)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Highlight-Changes mode.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"hilit-chg"</span>
    (<span class="org-keyword">defvar</span> <span class="org-variable-name">highlight-fringe-mark</span> 'filled-rectangle
      <span class="org-doc">"The fringe bitmap name marked at changed line.</span>
<span class="org-doc">Should be selected from `</span><span class="org-doc"><span class="org-constant">fringe-bitmaps</span></span><span class="org-doc">'."</span>)

    (<span class="org-keyword">defun</span> <span class="org-function-name">hilit-chg-make-ov--add-fringe</span> ()
      (mapc #'(lambda (ov)
                (<span class="org-keyword">if</span> (overlay-get ov 'hilit-chg)
                    (<span class="org-keyword">let</span> ((fringe-anchor (make-string 1 ?x)))
                      (put-text-property 0 1 'display
                                         (list 'left-fringe highlight-fringe-mark)
                                         fringe-anchor)
                      (overlay-put ov 'before-string fringe-anchor))))
            (overlays-at (ad-get-arg 1))))
    (advice-add 'hilit-chg-make-ov <span class="org-builtin">:after</span> #'hilit-chg-make-ov--add-fringe))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Enable Global-Highlight-Changes mode.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-highlight-changes-mode 1)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Changes are initially NOT visible in Highlight Changes mode.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq highlight-changes-visibility-initial-state nil)</span>
</pre>
</div>

<p>
You can use <b>Hi Lock</b> (part of Emacs) to highlight a regexp (identical tokens)
throughout a buffer.
</p>

<dl class="org-dl">
<dt><code>M-x hi-lock-mode RET</code></dt><dd>Enable or disable Hi Lock mode.</dd>

<dt><code>M-s h .</code></dt><dd><b>Highlight</b> each instance of the <b>symbol at point</b>.</dd>

<dt><code>M-s h r REGEXP RET</code> (<code>highlight-regexp</code>)</dt><dd>Highlight text that <b>matches REGEXP</b>.</dd>

<dt><code>M-s h l REGEXP RET</code></dt><dd>Highlight <b>entire lines</b> containing a match for REGEXP.</dd>

<dt><code>M-s h p</code> (<code>highlight-phrase</code>)</dt><dd><p>
When called interactively, replace whitespace in user-provided
regexp with arbitrary whitespace, and make initial lower-case
letters case-insensitive, before highlighting with <code>hi-lock-set-pattern</code>.
</p>

<p>
<code>highlight-phrase</code> is just a bit of sugar around <code>highlight-regexp</code> that
</p>

<p>
ignores case and translates a space in the regex to match arbitrary
whitespace. Handy.
</p>

<p>
Also, <code>highlight-phrase</code> is not fully case insensitive. Only initial
lower-case letters (of words) ae made case insensitive. (I suppose it was
intended to deal with fred vs Fred) .. eg it generates a regex like:
<code>[Cc]at[ ]+[Dd]og</code>
</p></dd>

<dt><code>M-s h u REGEXP RET</code></dt><dd><b>Unhighlight</b> REGEXP.</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Do not prompt for the face to use. Instead, cycle through them.</span>
  (<span class="org-keyword">setq</span> hi-lock-auto-select-face t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Enable Hi Lock mode for all buffers.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-hi-lock-mode 1)</span>
</pre>
</div>

<p>
It is complementary to the features of the library <b>Hl-anything</b>.
</p>

<ul class="org-ul">
<li>Hi Lock uses <b>text properties</b>.  Copying and pasting text will also paste the
highlighting.</li>

<li><p>
Hl-anything uses <b>overlays</b>.  It prevents highlighted things to be hidden by
hl-line mode.
</p>

<div class="note">
<p>
As <b>overlay highlighting</b> (used by <code>hl-line</code>) <b>always takes priority over
text-property highlighting</b>, the highlighting of symbols should use overlays at
all times, and thus have higher priority over <code>hl-line</code> (because shorter
overlays have an implicitly higher priority, given the same value of
priority).
</p>

<p>
<b>Use highlighting that is produced by an overlay!</b>
</p>

<ul class="org-ul">
<li>Highlight from Drew Adams</li>
<li>highlight-symbol from Nicolas</li>
<li>Symbol-overlay from Wolray</li>
</ul>

</div></li>

<li>Hi Lock and Hl-anything both <b>highlight new text</b> as you type it.</li>

<li>Hl-anything lets you <b>navigate among highlights</b>: <code>hl-find-next-thing</code>,
<code>hl-find-prev-thing</code>.</li>

<li><code>Hl-anything</code> automatically chooses <b>rainbow colors</b> and makes it much easier to
follow some key variables through a block of code.</li>
</ul>

<div class="note">
<p>
We tend to think of highlighting a buffer region with a background as putting
such a background behind or underneath the text.  Think of a marker pen
(highlighter) instead: the highlighting goes on top.
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Highlight symbols, selections, enclosing parens and more.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "hl-anything-autoloads"</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(setq hl-highlight-background-colors '("#C7FF85" "#FFFA85" "#85FFFA" "#FCACFF"))</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; See the very good hl-paren-mode.</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; Don't save and restore highlight.</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(setq hl-highlight-save-file nil)</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; Emulation of Vim's `*' search.</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(global-set-key (kbd "C-*")      #'hl-highlight-thingatpt-global)</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(global-set-key (kbd "C-&lt;f4&gt;")   #'hl-find-next-thing)</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(global-set-key (kbd "S-&lt;f4&gt;")   #'hl-find-prev-thing)</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(global-set-key (kbd "C-M-*")    #'hl-unhighlight-all-global))</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; ;; Find Next / Move to Next Occurrence.</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; (global-set-key (kbd "&lt;f3&gt;")     #'hl-find-next-thing)</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; ;; Find Previous / Move to Previous Occurrence.</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; (global-set-key (kbd "&lt;S-f3&gt;")   #'hl-find-prev-thing)</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; ;; Find Word at Caret.</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; (global-set-key (kbd "&lt;C-f3&gt;")   #'hl-highlight-thingatpt-global)</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; ;; Highlight Usages in File.</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; (global-set-key (kbd "&lt;C-S-f7&gt;") #'hl-highlight-thingatpt-global)</span>


(<span class="org-keyword">when</span> (try-require 'symbol-overlay) <span class="org-comment-delimiter">;</span><span class="org-comment">XXX</span>
  (global-set-key (kbd <span class="org-string">"&lt;C-S-f7&gt;"</span>) 'symbol-overlay-put)
  (global-set-key (kbd <span class="org-string">"&lt;f3&gt;"</span>) 'symbol-overlay-switch-forward)
  (global-set-key (kbd <span class="org-string">"&lt;S-f3&gt;"</span>) 'symbol-overlay-switch-backward)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "&lt;f7&gt;") 'symbol-overlay-mode)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "&lt;f8&gt;") 'symbol-overlay-remove-all)</span>
  )
</pre>
</div>

<p>
Use Auto-Highlight-Symbol to <b>automatically highlight</b> all found <b>usages of</b> the
<b>symbol at point</b> in the current file (if you pause on a symbol).  When you move
point, the highlighting goes away.
</p>

<div class="tip">
<p>
<code>ahs</code> can find the <b>definition</b> of a symbol, and colors it differently!
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Automatic highlighting occurrences of the current symbol under cursor.</span>
  (<span class="org-keyword">when</span> (try-require 'auto-highlight-symbol) <span class="org-comment-delimiter">;</span><span class="org-comment">XXX</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add major modes Auto-Highlight-Symbol can run on.</span>
    (mapc #'(lambda (mode)
              (add-to-list 'ahs-modes mode t))
          '(js2-mode
            ess-mode))                  <span class="org-comment-delimiter">; </span><span class="org-comment">R.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Number of seconds to wait before highlighting the current symbol.</span>
    (<span class="org-keyword">setq</span> ahs-idle-interval 0.2) <span class="org-comment-delimiter">; </span><span class="org-comment">0.35.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Unset AHS key bindings that override Org key bindings.</span>
    (define-key auto-highlight-symbol-mode-map (kbd <span class="org-string">"&lt;M-left&gt;"</span>)    nil)
    (define-key auto-highlight-symbol-mode-map (kbd <span class="org-string">"&lt;M-right&gt;"</span>)   nil)
    (define-key auto-highlight-symbol-mode-map (kbd <span class="org-string">"&lt;M-S-left&gt;"</span>)  nil)
    (define-key auto-highlight-symbol-mode-map (kbd <span class="org-string">"&lt;M-S-right&gt;"</span>) nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Toggle Auto-Highlight-Symbol mode in all buffers.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-auto-highlight-symbol-mode t)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable Auto-Highlight-Symbol mode in all programming mode buffers.</span>
    (add-hook 'prog-mode-hook #'auto-highlight-symbol-mode)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable Auto-Highlight-Symbol mode in LaTeX mode.</span>
    (add-hook 'latex-mode-hook #'auto-highlight-symbol-mode)
    )
</pre>
</div>

<p>
XXX Check out <code>light-symbol</code>.
</p>

<p>
Color Identifiers Mode: <b>color</b> every <b>variable</b> in its own, consistent color.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">XXX Impact on Org's HTML export?</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "color-identifiers-mode-autoloads"</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(add-hook 'after-init-hook #'global-color-identifiers-mode))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbe9987e" class="outline-3">
<h3 id="orgbe9987e">Window Fringes</h3>
<div class="outline-text-3" id="text-orgbe9987e">
<p>
Show an icon in the fringe of version-controlled files indicating which <b>lines</b>
have been <b>edited</b> (inserted, modified or deleted) <b>since the last commit</b>.  Similar
to Git Gutter.
</p>

<p>
This feature gives you a really nice at-a-glance view of where you&rsquo;ve made
changes.
</p>

<div class="tip">
<p>
If you need to know what lines changed in latest commit as well, you can enable
<code>diff-hl-amend-mode</code> to <b>show changes against the second-last revision</b>.
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"diff-hl-autoloads"</span>
    (idle-require 'diff-hl))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Indicate changes in the fringe.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"diff-hl"</span>

    (global-diff-hl-mode 1)
</pre>
</div>

<p>
If you&rsquo;re using some package other than <code>vc</code> to commit changes, it might not run
<code>vc-checkin-hook</code> after commits.  In that case, you&rsquo;ll need to either add
<code>diff-hl-update</code> to the hook it does run, or advise some function that&rsquo;s called in
the buffer after its state has changed.
</p>

<div class="note">
<p>
Of course, <code>diff-hl</code> is not updated when we commit changes with our <code>sendpatch</code>
utility&#x2026;
</p>

</div>

<p>
Jump between changes:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Move to Next Change (also on `C-x v ]').</span>
    (define-key diff-hl-mode-map (kbd <span class="org-string">"C-x v &gt;"</span>)      #'diff-hl-next-hunk)
    (define-key diff-hl-mode-map (kbd <span class="org-string">"M-g &lt;down&gt;"</span>)   #'diff-hl-next-hunk)
    (define-key diff-hl-mode-map (kbd <span class="org-string">"&lt;C-M-S-down&gt;"</span>) #'diff-hl-next-hunk) <span class="org-comment-delimiter">;; </span><span class="org-comment">IntelliJ IDEA.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Move to Previous Change (also on `C-x v [').</span>
    (define-key diff-hl-mode-map (kbd <span class="org-string">"C-x v &lt;"</span>)      #'diff-hl-previous-hunk)
    (define-key diff-hl-mode-map (kbd <span class="org-string">"M-g &lt;up&gt;"</span>)     #'diff-hl-previous-hunk)
    (define-key diff-hl-mode-map (kbd <span class="org-string">"&lt;C-M-S-up&gt;"</span>)   #'diff-hl-previous-hunk) <span class="org-comment-delimiter">;; </span><span class="org-comment">IntelliJ IDEA.</span>
</pre>
</div>

<p>
Act on changes:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Popup current diff.</span>
    (define-key diff-hl-mode-map (kbd <span class="org-string">"C-x v ="</span>) #'diff-hl-diff-goto-hunk)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Revert current hunk (also on `C-x v n').</span>
    (define-key diff-hl-mode-map (kbd <span class="org-string">"C-x v u"</span>) #'diff-hl-revert-hunk))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">defun</span> <span class="org-function-name">magit-refresh--diff-hl-refresh-after</span> ()
      (<span class="org-keyword">dolist</span> (buffer (buffer-list))
        (<span class="org-keyword">with-current-buffer</span> buffer
          (<span class="org-keyword">when</span> diff-hl-mode
            (diff-hl-update)))))
    (advice-add 'magit-refresh <span class="org-builtin">:after</span> #'magit-refresh--diff-hl-refresh-after)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (add-hook 'magit-post-refresh-hook 'diff-hl-magit-post-refresh)
</pre>
</div>

<div class="tip">
<p>
Is It Possible To Replace Fringe Bitmaps With Text in Emacs?
<a href="http://stackoverflow.com/questions/16114700/is-it-possible-to-replace-fringe-bitmaps-with-text-in-emacs">http://stackoverflow.com/questions/16114700/is-it-possible-to-replace-fringe-bitmaps-with-text-in-emacs</a>
</p>

</div>
</div>
</div>

<div id="outline-container-org7073da4" class="outline-3">
<h3 id="org7073da4">Displaying Boundaries</h3>
<div class="outline-text-3" id="text-org7073da4">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.15 (info "(emacs)Displaying Boundaries")</span>

  (leuven--section <span class="org-string">"14.15 (emacs)Displaying Boundaries"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Visually indicate buffer boundaries and scrolling in the fringe.</span>
  (<span class="org-keyword">setq-default</span> indicate-buffer-boundaries '((top . left) (t . right)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org7da7427" class="outline-3">
<h3 id="org7da7427">Useless Whitespace</h3>
<div class="outline-text-3" id="text-org7da7427">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.16 (info "(emacs)Useless Whitespace")</span>

  (leuven--section <span class="org-string">"14.16 (emacs)Useless Whitespace"</span>)
</pre>
</div>

<p>
Make trailing whitespace at the end of a line visible.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Highlight trailing whitespaces in all modes.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq-default show-trailing-whitespace t)</span>
</pre>
</div>

<p>
Remove trailing whitespace (right trim lines) <b>in all lines</b>:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Nuke all trailing whitespaces in the buffer.</span>
  (add-hook 'before-save-hook
            #'(lambda ()                  <span class="org-comment-delimiter">; </span><span class="org-comment">Except for ...</span>
                (<span class="org-keyword">let</span> ((buffer-undo-list buffer-undo-list)) <span class="org-comment-delimiter">; </span><span class="org-comment">For goto-chg.</span>
                  (<span class="org-keyword">unless</span> (<span class="org-keyword">or</span> (derived-mode-p 'message-mode)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">... where "-- " is the signature</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">separator (for when using emacsclient</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">to compose emails and doing C-x #).</span>
                              (derived-mode-p 'diff-mode))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">... where the patch file can't be</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">changed!</span>
                    (delete-trailing-whitespace)))))
</pre>
</div>

<p>
This command also deletes all <b>empty lines at the end of the buffer</b>.
</p>

<p>
Remove trailing whitespace <b>in edited lines</b> with <code>ws-butler</code>:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Unobtrusively remove trailing whitespace.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ws-butler-autoloads"</span>
    (add-hook 'text-mode-hook #'ws-butler-mode)
    (add-hook 'prog-mode-hook #'ws-butler-mode))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ws-butler"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Remove all tab/space indent conversion.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(defun ws-butler-clean-region (beg end)</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">"Delete trailing blanks in region BEG END."</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(interactive "*r")</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(ws-butler-with-save</span>
    <span class="org-comment-delimiter">;;    </span><span class="org-comment">(narrow-to-region beg end)</span>
    <span class="org-comment-delimiter">;;    </span><span class="org-comment">;;  _much slower would be:       (replace-regexp "[ \t]+$" "")</span>
    <span class="org-comment-delimiter">;;    </span><span class="org-comment">(goto-char (point-min))</span>
    <span class="org-comment-delimiter">;;    </span><span class="org-comment">(while (not (eobp))</span>
    <span class="org-comment-delimiter">;;      </span><span class="org-comment">(end-of-line)</span>
    <span class="org-comment-delimiter">;;      </span><span class="org-comment">(delete-horizontal-space)</span>
    <span class="org-comment-delimiter">;;      </span><span class="org-comment">(forward-line 1)))</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; clean return code for hooks</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">nil)</span>

    (diminish 'ws-butler-mode))
</pre>
</div>

<div class="warning">
<p>
If <code>indent-tabs-mode</code> is nil, then <b>tabs in indentation is replaced by spaces</b> (only
for lines modified by you).
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Visually indicate empty lines after the buffer end in the fringe.</span>
  (<span class="org-keyword">setq-default</span> indicate-empty-lines t)
</pre>
</div>

<p>
When Whitespace mode is on, it takes care of highlighting some special
characters over the default mechanism of <code>nobreak-char-display</code> and
<code>show-trailing-whitespace</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable Whitespace mode in all file buffers (not in *vc-dir*, etc.).</span>
  (add-hook 'text-mode-hook #'whitespace-mode)
  (add-hook 'prog-mode-hook #'whitespace-mode)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"whitespace"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Which kind of blank is visualized (Show Invisibles).</span>
    (<span class="org-keyword">setq</span> whitespace-style
          '(face
            trailing
            tabs
            <span class="org-comment-delimiter">;; </span><span class="org-comment">lines-tail</span>
            indentation::space
            space-mark
            tab-mark))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Column beyond which the line is highlighted.</span>
    (<span class="org-keyword">setq</span> whitespace-line-column 80)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Mappings for displaying characters.</span>
    (<span class="org-keyword">setq</span> whitespace-display-mappings
          '((space-mark ?\u00A0         <span class="org-comment-delimiter">; </span><span class="org-comment">No-break space.</span>
                        [?_]            <span class="org-comment-delimiter">; </span><span class="org-comment">Spacing underscore.</span>
                        [?_])           <span class="org-comment-delimiter">; </span><span class="org-comment">Spacing underscore.</span>

            (space-mark ?\u202F         <span class="org-comment-delimiter">; </span><span class="org-comment">Narrow no-break space.</span>
                        [?\u00B7]       <span class="org-comment-delimiter">; </span><span class="org-comment">Middle dot.</span>
                        [?.])

            (tab-mark ?\t               <span class="org-comment-delimiter">; </span><span class="org-comment">Tabulation.</span>
                      [?\u25BA ?\t]     <span class="org-comment-delimiter">; </span><span class="org-comment">Black right-pointing pointer.</span>
                      [?\\ ?\t]))))
</pre>
</div>

<p>
Example :
VPATH=		/home/jt/src/cygwin/cygwin-packages/1.7/python-2.6.8-2/python-2.6.8-2/src/Python-2.6.8
LDLAST=
SGI_ABI=
PYTHON_OBJS=	\
                Python/pythonrun.o \
                Python/random.o \
                Python/structmember.o
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Control highlighting of non-ASCII space and hyphen chars, using the</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; `</span><span class="org-comment"><span class="org-constant">nobreak-space</span></span><span class="org-comment">' or `</span><span class="org-comment"><span class="org-constant">escape-glyph</span></span><span class="org-comment">' face respectively.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq nobreak-char-display t)      ; [Default]</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Show zero-width spaces.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(font-lock-add-keywords nil</span>
  <span class="org-comment-delimiter">;;  </span><span class="org-comment">`((,(format "\\(%c\\)" ?\u200B) ; #\ZERO_WIDTH_SPACE</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">(1 (progn (compose-region (match-beginning 1) (match-end 1)</span>
  <span class="org-comment-delimiter">;;                               </span><span class="org-comment">?\u2B1B ; #\BLACK_LARGE_SQUARE</span>
  <span class="org-comment-delimiter">;;                               </span><span class="org-comment">'decompose-region)</span>
  <span class="org-comment-delimiter">;;               </span><span class="org-comment">nil)))))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org9db8e18" class="outline-3">
<h3 id="org9db8e18">Selective Display</h3>
<div class="outline-text-3" id="text-org9db8e18">
<p>
Emacs has the ability to <b>hide lines indented more than a given number of
columns</b>.  You can use this to get an overview of a part of a program.
</p>

<p>
To hide lines with at least 1 column of indentation (replacing them by an
ellipsis), type <code>C-1 C-x $</code> (or <code>C-x $</code> and give it <code>1</code> as depth argument).  It gives
a quick overview any source file.
</p>

<p>
To make all lines visible again, type <code>C-x $</code> with no argument.
</p>

<p>
See also <b>Outline Mode</b> for another way to hide part of the text in a buffer.
</p>
</div>
</div>

<div id="outline-container-org298d9d9" class="outline-3">
<h3 id="org298d9d9">Optional Mode Line Features</h3>
<div class="outline-text-3" id="text-org298d9d9">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.18 (info "(emacs)Optional Mode Line") Features</span>

  (leuven--section <span class="org-string">"14.18 (emacs)Optional Mode Line Features"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Show the column number in each mode line.</span>
  (column-number-mode 1)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Unclutter the mode line.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"diminish-autoloads"</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"abbrev"</span>       (diminish 'abbrev-mode <span class="org-string">" Ab"</span>))
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"back-button"</span>  (diminish 'back-button-mode))
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"volatile-highlights"</span> (diminish 'volatile-highlights-mode))
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"checkdoc"</span>     (diminish 'checkdoc-minor-mode <span class="org-string">" Cd"</span>))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "company"      (diminish 'company-mode " Cp"))</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Company displays the currently used</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">backend in the mode-line.</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"eldoc"</span>        (diminish 'eldoc-mode))
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"color-identifiers-mode"</span> (diminish 'color-identifiers-mode))
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"fancy-narrow"</span> (diminish 'fancy-narrow-mode))
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"flycheck"</span>     (diminish 'flycheck-mode <span class="org-string">" fC"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">Wanna see FlyC:1/1.</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"flyspell"</span>     (diminish 'flyspell-mode <span class="org-string">" fS"</span>))
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"google-this"</span>  (diminish 'google-this-mode))
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"hilit-chg"</span>    (diminish 'highlight-changes-mode))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "isearch"      (diminish 'isearch-mode (string 32 ?\u279c)))</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"paredit"</span>      (diminish 'paredit-mode <span class="org-string">" Pe"</span>))
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"rainbow-mode"</span> (diminish 'rainbow-mode))
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"simple"</span>       (diminish 'auto-fill-function))
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"whitespace"</span>   (diminish 'whitespace-mode))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(diminish-on-load hs-minor-mode-hook hs-minor-mode)</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"glasses"</span>      (diminish 'glasses-mode))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "redshank"     (diminish 'redshank-mode))</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "smartparens"  (diminish 'smartparens-mode)) ;; Don't hide it, as it impacts perf on big files (must see it!)</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"which-key"</span>    (diminish 'which-key-mode)))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "whitespace"   (diminish 'whitespace-mode))</span>
</pre>
</div>

<p>
See <a href="https://powerline.readthedocs.org/en/latest/overview.html#vim-statusline">https://powerline.readthedocs.org/en/latest/overview.html#vim-statusline</a> for screenshots.
</p>

<p>
See <a href="https://github.com/bling/vim-airline">https://github.com/bling/vim-airline</a> for the original author.
</p>

<p>
We build our mode line:
</p>

<ul class="org-ul">
<li>Git/SVN branch</li>
<li>buffer-read-only / buffer-modified-p</li>
<li>mule environment</li>
<li>buffer name</li>
<li>which function information</li>
<li>major mode</li>
<li>minor modes</li>
<li>line number, column number</li>
<li>percent</li>
<li>buffer size</li>
<li>dictionary</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defface</span> <span class="org-variable-name">powerline-modified-face</span>
    '((((class color))
       (<span class="org-builtin">:background</span> <span class="org-string">"#FFA335"</span> <span class="org-builtin">:foreground</span> <span class="org-string">"black"</span> <span class="org-builtin">:weight</span> bold))
      (t (<span class="org-builtin">:weight</span> bold)))
    <span class="org-doc">"Face to fontify modified files."</span>
    <span class="org-builtin">:group</span> 'powerline)

  (<span class="org-keyword">defface</span> <span class="org-variable-name">powerline-normal-face</span>
    '((((class color))
       (<span class="org-builtin">:background</span> <span class="org-string">"#4F9D03"</span> <span class="org-builtin">:foreground</span> <span class="org-string">"black"</span> <span class="org-builtin">:weight</span> bold))
      (t (<span class="org-builtin">:weight</span> bold)))
    <span class="org-doc">"Face to fontify unchanged files."</span>
    <span class="org-builtin">:group</span> 'powerline)

  (<span class="org-keyword">defface</span> <span class="org-variable-name">powerline-default-dictionary-active-face</span>
    '((((class color))
       (<span class="org-builtin">:background</span> <span class="org-string">"#8A2BE2"</span> <span class="org-builtin">:foreground</span> <span class="org-string">"black"</span> <span class="org-builtin">:weight</span> bold))
      (t (<span class="org-builtin">:weight</span> bold)))
    <span class="org-doc">"Face to fontify default dictionary in the active buffer."</span>
    <span class="org-builtin">:group</span> 'powerline)

  (<span class="org-keyword">defface</span> <span class="org-variable-name">powerline-default-dictionary-inactive-face</span>
    '((((class color))
       (<span class="org-builtin">:background</span> <span class="org-string">"thistle"</span> <span class="org-builtin">:foreground</span> <span class="org-string">"black"</span> <span class="org-builtin">:weight</span> bold))
      (t (<span class="org-builtin">:weight</span> bold)))
    <span class="org-doc">"Face to fontify default dictionary in inactive buffers."</span>
    <span class="org-builtin">:group</span> 'powerline)

  (<span class="org-keyword">defface</span> <span class="org-variable-name">powerline-other-dictionary-active-face</span>
    '((((class color))
       (<span class="org-builtin">:background</span> <span class="org-string">"yellow"</span> <span class="org-builtin">:foreground</span> <span class="org-string">"black"</span> <span class="org-builtin">:weight</span> bold))
      (t (<span class="org-builtin">:weight</span> bold)))
    <span class="org-doc">"Face to fontify another dictionary in the active buffer."</span>
    <span class="org-builtin">:group</span> 'powerline)

  (<span class="org-keyword">defface</span> <span class="org-variable-name">powerline-other-dictionary-inactive-face</span>
    '((((class color))
       (<span class="org-builtin">:background</span> <span class="org-string">"LightYellow1"</span> <span class="org-builtin">:foreground</span> <span class="org-string">"black"</span> <span class="org-builtin">:weight</span> bold))
      (t (<span class="org-builtin">:weight</span> bold)))
    <span class="org-doc">"Face to fontify another dictionary in inactive buffers."</span>
    <span class="org-builtin">:group</span> 'powerline)

  (<span class="org-keyword">defface</span> <span class="org-variable-name">powerline-buffer-position-face</span>
    '((((class color))
       (<span class="org-builtin">:background</span> <span class="org-string">"#D2D2D2"</span> <span class="org-builtin">:foreground</span> <span class="org-string">"#282828"</span>))
      (t (<span class="org-builtin">:weight</span> bold)))
    <span class="org-doc">"Face to fontify buffer position."</span>
    <span class="org-builtin">:group</span> 'powerline)

  (<span class="org-keyword">defun</span> <span class="org-function-name">powerline-simpler-vc-mode</span> (s)
    (<span class="org-keyword">if</span> s
        (replace-regexp-in-string <span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">Git</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">SVN</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">[-:]"</span> <span class="org-string">""</span> s)
      s))

  (<span class="org-keyword">defun</span> <span class="org-function-name">powerline-leuven-theme</span> ()
    <span class="org-doc">"Setup the leuven mode-line."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">setq-default</span> mode-line-format
     '(<span class="org-string">"%e"</span>
       (<span class="org-builtin">:eval</span>
        (<span class="org-keyword">let*</span> ((active (powerline-selected-window-active))
               (mode-line (<span class="org-keyword">if</span> active
                              'mode-line
                            'mode-line-inactive))
               (face1 (<span class="org-keyword">if</span> active
                          'powerline-active1
                        'powerline-inactive1))
               (face2 (<span class="org-keyword">if</span> active
                          'powerline-active2
                        'powerline-inactive2))
               (default-dictionary-face
                 (<span class="org-keyword">if</span> active
                     'powerline-default-dictionary-active-face
                   'powerline-default-dictionary-inactive-face))
               (other-dictionary-face
                (<span class="org-keyword">if</span> active
                    'powerline-other-dictionary-active-face
                  'powerline-other-dictionary-inactive-face))
               (separator-left
                (intern
                 (format <span class="org-string">"powerline-%s-%s"</span>
                         powerline-default-separator
                         (car powerline-default-separator-dir))))
               (separator-right
                (intern
                 (format <span class="org-string">"powerline-%s-%s"</span>
                         powerline-default-separator
                         (cdr powerline-default-separator-dir))))
               (lhs (list
                     <span class="org-comment-delimiter">;; </span><span class="org-comment">VC mode.</span>
                     (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> (fboundp 'vc-switches)
                                buffer-file-name
                                vc-mode)
                       (<span class="org-keyword">if</span> (eq (vc-state buffer-file-name) 'up-to-date)
                           (powerline-simpler-vc-mode (powerline-vc 'powerline-normal-face 'r))
                         (powerline-simpler-vc-mode (powerline-vc 'powerline-modified-face 'r))))

                     (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> (not (fboundp 'vc-switches))
                                buffer-file-name
                                vc-mode)
                       (powerline-simpler-vc-mode (powerline-vc face1 'r)))

                     (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> buffer-file-name
                                vc-mode)
                       (<span class="org-keyword">if</span> (eq (vc-state buffer-file-name) 'up-to-date)
                           (funcall separator-left 'powerline-normal-face mode-line)
                         (funcall separator-left 'powerline-modified-face mode-line)))

                     <span class="org-comment-delimiter">;; </span><span class="org-comment">"Modified" indicator.</span>
                     (<span class="org-keyword">if</span> (not (buffer-modified-p))
                         (powerline-raw <span class="org-string">"%*"</span> nil 'l)
                       (powerline-raw <span class="org-string">"%*"</span> 'mode-line-emphasis 'l))

                     (powerline-raw mode-line-mule-info nil 'l)

                     (powerline-buffer-id 'mode-line-buffer-id 'l)

                     (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> (boundp 'which-func-mode) which-func-mode)
                       (powerline-raw which-func-format nil 'l))

                     (powerline-raw <span class="org-string">" "</span>)
                     (funcall separator-left mode-line face1)
                     (<span class="org-keyword">when</span> (boundp 'erc-modified-channels-object)
                       (powerline-raw erc-modified-channels-object face1 'l))
                     (powerline-major-mode face1 'l)
                     (powerline-process face1)
                     (powerline-raw <span class="org-string">" "</span> face1)
                     (funcall separator-left face1 face2)
                     (powerline-minor-modes face2 'l)
                     (powerline-narrow face2 'l)
                     (powerline-raw <span class="org-string">" "</span> face2)
                     (funcall separator-left face2 mode-line)))
               (rhs (list (powerline-raw global-mode-string mode-line 'r)
                          (funcall separator-right mode-line face1)
</pre>
</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Show column in red when we go over the 80th character</b><br />
<p>
See <a href="http://www.elliotglaysher.org/emacs/">http://www.elliotglaysher.org/emacs/</a>
</p>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">                          (powerline-raw <span class="org-string">"%l,"</span> face1 'l)
                          (powerline-raw <span class="org-string">"%c"</span> face1 'r)
                          (funcall separator-right face1 'powerline-buffer-position-face)
                          (powerline-raw <span class="org-string">" %3p"</span> 'powerline-buffer-position-face 'r)
                          (funcall separator-right 'powerline-buffer-position-face face2)
                          (powerline-buffer-size face2 'l)
                          (powerline-raw <span class="org-string">" "</span> face2)

                          (<span class="org-keyword">let</span> ((dict (<span class="org-keyword">and</span> (<span class="org-keyword">featurep</span> '<span class="org-constant">ispell</span>)
                                           (<span class="org-keyword">or</span>
                                            ispell-local-dictionary
                                            ispell-dictionary))))
                            <span class="org-comment-delimiter">;; </span><span class="org-comment">Add 2 spaces after the language indicator</span>
                            <span class="org-comment-delimiter">;; </span><span class="org-comment">(for GNU/Linux).</span>
                            (<span class="org-keyword">cond</span> (buffer-read-only
                                   (powerline-raw <span class="org-string">"%%%%  "</span> default-dictionary-face 'l))
                                  ((null dict)
                                   (powerline-raw <span class="org-string">"--  "</span> default-dictionary-face 'l))
                                  (t
                                   (powerline-raw (concat (substring dict 0 2) <span class="org-string">"  "</span>) other-dictionary-face 'l))))

                          <span class="org-comment-delimiter">;; </span><span class="org-comment">(powerline-hud face2 face1)</span>
                          )))
          (concat (powerline-render lhs)
                  (powerline-fill mode-line (powerline-width rhs))
                  (powerline-render rhs)))))))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"powerline-autoloads"</span>
    (add-hook 'after-init-hook #'powerline-leuven-theme))
</pre>
</div>
</div>
</div>

<div id="outline-container-org2a1eeda" class="outline-3">
<h3 id="org2a1eeda">How Text Is Displayed</h3>
<div class="outline-text-3" id="text-org2a1eeda">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.19 The (info "(emacs)")</span>

  (leuven--section <span class="org-string">"14.19 (emacs)"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Display width of a TAB character.</span>
  (<span class="org-keyword">setq-default</span> tab-width 4)
</pre>
</div>
</div>
</div>

<div id="outline-container-org5140926" class="outline-3">
<h3 id="org5140926">Displaying the Cursor</h3>
<div class="outline-text-3" id="text-org5140926">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.20 The (info "(emacs)Cursor Display")</span>

  (leuven--section <span class="org-string">"14.20 (emacs)The Cursor Display"</span>)
</pre>
</div>

<p>
Colorize cursor according to state.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Use cursor color and type to indicate some modes (read-only, overwrite</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">and normal insert modes).</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--set-cursor-according-to-mode</span> ()
    <span class="org-doc">"Change cursor color according to some minor modes."</span>
    (<span class="org-keyword">let</span> ((color (<span class="org-keyword">cond</span> (buffer-read-only <span class="org-string">"purple1"</span>)
                       (overwrite-mode   <span class="org-string">"#7F7F7F"</span>)
                       (t                <span class="org-string">"black"</span>))) <span class="org-comment-delimiter">; </span><span class="org-comment">#21BDFF is less visible.</span>
          (type (<span class="org-keyword">if</span> (null overwrite-mode)
                    'bar
                  'box)))
      (set-cursor-color color)
      (<span class="org-keyword">setq</span> cursor-type type)))

  (add-hook 'post-command-hook #'leuven--set-cursor-according-to-mode)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Cursor to use.</span>
  (<span class="org-keyword">setq-default</span> cursor-type 'bar)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Cursor blinks forever.</span>
  (<span class="org-keyword">setq</span> blink-cursor-blinks 0)
</pre>
</div>

<p>
Highlight the current line:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Toggle line highlighting in all buffers (Global Hl-Line mode).</span>
  (global-hl-line-mode 1)               <span class="org-comment-delimiter">; </span><span class="org-comment">XXX Perhaps only in prog-modes?</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Extensions to hl-line.el.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "hl-line+-autoloads"</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; Disable Global Hl-Line mode.</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(global-hl-line-mode -1)</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; Turn on `</span><span class="org-comment"><span class="org-constant">global-hl-line-mode</span></span><span class="org-comment">' only when Emacs is idle.</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(toggle-hl-line-when-idle))</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">hl-line-overlay-priority</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(require 'hl-line+) ; Load this file (it will load `</span><span class="org-comment"><span class="org-constant">hl-line.el</span></span><span class="org-comment">')</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org11f2773" class="outline-3">
<h3 id="org11f2773">Truncation of Lines</h3>
<div class="outline-text-3" id="text-org11f2773">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.21 (info "(emacs)Line Truncation")</span>

  (leuven--section <span class="org-string">"14.21 (emacs)Line Truncation"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Respect the value of `</span><span class="org-comment"><span class="org-constant">truncate-lines</span></span><span class="org-comment">' in all windows less than the full</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">width of the frame.</span>
  (<span class="org-keyword">setq</span> truncate-partial-width-windows nil)
</pre>
</div>
</div>
</div>

<div id="outline-container-org3079c58" class="outline-3">
<h3 id="org3079c58">Customization of Display</h3>
<div class="outline-text-3" id="text-org3079c58">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.23 (info "(emacs)Display Custom")ization</span>

  (leuven--section <span class="org-string">"14.23 (emacs)Display Customization"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Echo what I'm typing *immediately*.</span>
  (<span class="org-keyword">setq</span> echo-keystrokes 0.01)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Let emacs react faster to keystrokes.</span>
  (<span class="org-keyword">setq</span> idle-update-delay 0.35)
</pre>
</div>

<p>
Display pressed keyboard shortcuts on screen during presentations or
screencasts.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Exhaustive log of interactions with Emacs (display keystrokes, etc.).</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"interaction-log-autoloads"</span>

    (autoload 'interaction-log-mode <span class="org-string">"interaction-log"</span>
      <span class="org-doc">"Global minor mode logging keys, commands, file loads and messages."</span> t)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">This autoload isn't defined in</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">interaction-log-autoloads</span></span><span class="org-comment">'!</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Maximum number of lines to keep in the *Emacs Log* buffer.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq ilog-log-max 10)</span>

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-display-interaction-log</span> ()
      <span class="org-doc">"Display the Interaction-Log buffer."</span>
      (<span class="org-keyword">interactive</span>)
      (interaction-log-mode 1)
      (display-buffer ilog-buffer-name))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Hotkey for showing the log buffer.</span>
    (global-set-key (kbd <span class="org-string">"C-h C-l"</span>) #'leuven-display-interaction-log))
</pre>
</div>

<div class="note">
<p>
View-lossage is much improved in Emacs 25, showing directly which commands were
run by each keypress.
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 14 ends here.</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orge3529c1" class="outline-2">
<h2 id="orge3529c1">Searching and Replacement</h2>
<div class="outline-text-2" id="text-orge3529c1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 15 (info "(emacs)Search")ing and Replacement</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-15-search <span class="org-string">"15 Searching and Replacement"</span>
</pre>
</div>
</div>

<div id="outline-container-org8c7b8f4" class="outline-3">
<h3 id="org8c7b8f4">Incremental Search (aka &ldquo;Live Search&rdquo;)</h3>
<div class="outline-text-3" id="text-org8c7b8f4">
<p>
Have a look at the &ldquo;Standard Isearch Keys&rdquo; on
<a href="http://www.emacswiki.org/emacs/IncrementalSearch">http://www.emacswiki.org/emacs/IncrementalSearch</a>
</p>

<p>
Isearch has a binding which deletes all the non-matching characters from the
search string: <code>C-g</code> (not a very intuitive binding, because it&rsquo;s usually
associated with aborting operations, not with correcting things).
</p>

<p>
If you hit <code>M-e</code> (to edit the search string), the cursor is moved to the mismatch
position.
</p>

<p>
Since Emacs 24.3:
</p>
<ul class="org-ul">
<li><code>M-s _</code> starts a symbol (identifier) incremental search.</li>
<li><code>M-s _</code> in Isearch toggles symbol search mode.</li>
<li><code>M-s c</code> in Isearch toggles search case-sensitivity.</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 15.1 (info "(emacs)Incremental Search")</span>

  (leuven--section <span class="org-string">"15.1 (emacs)Incremental Search"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">FIXME Error when selecting search string from kill ring (`</span><span class="org-comment"><span class="org-constant">M-p</span></span><span class="org-comment">')</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Always exit searches at the beginning of the expression found.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'isearch-mode-end-hook #'isearch-goto-match-beginning)</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(defun isearch-goto-match-beginning ()</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">"Use with isearch hook to end search at first char of match."</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(when isearch-forward (goto-char isearch-other-end)))</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Incremental search/query-replace will open the contents.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq search-invisible 'open)         ; XXX</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't re-hide an invisible match right away.</span>
  (<span class="org-keyword">setq</span> isearch-hide-immediately nil)   <span class="org-comment-delimiter">; </span><span class="org-comment">XXX</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Scrolling commands are allowed during incremental search (without canceling</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Isearch mode).</span>
  (<span class="org-keyword">setq</span> isearch-allow-scroll t)
</pre>
</div>

<p>
Search for string ignoring new lines: incremental search will see any number of
white spaces, tab spaces, and line breaks as a simple white space.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">setq</span> isearch-regexp-lax-whitespace t)
(<span class="org-keyword">setq</span> search-whitespace-regexp <span class="org-string">"[ \t\r\n]+"</span>)
</pre>
</div>

<div class="note">
<p>
When <code>search-invisible</code> is <code>t</code>, <code>perform-replace</code> can replace matches in any invisible
text, but does not display it when prompting the user for confirmation.
</p>

<p>
When <code>search-invisible</code> is <code>'open</code>, <code>perform-replace</code> can replace matches only in
hidden text (invisible through an overlay), and displays it when prompting the
user.
</p>

<p>
We lack a way to reveal truly invisible text when performing a search and
replace.  The URL of a bracket link in Org is an example of such truly invisible
text.
</p>

<p>
Juri&rsquo;s solution to add <code>'open-all</code> could also be used in <code>perform-replace</code> to let
the user see truly invisible matches before replacing them.
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Fuzzy matching utilities (a must-have).</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"fuzzy-autoloads"</span>

    (autoload 'turn-on-fuzzy-isearch <span class="org-string">"fuzzy"</span> nil t)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">This autoload isn't defined in</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">fuzzy-autoloads</span></span><span class="org-comment">'!</span>

    (add-hook 'isearch-mode-hook #'turn-on-fuzzy-isearch))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Show number of matches in mode-line while searching.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"anzu-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Lighter of anzu-mode.</span>
    (<span class="org-keyword">setq</span> anzu-mode-lighter <span class="org-string">""</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Deactive region if you use anzu a replace command with region.</span>
    (<span class="org-keyword">setq</span> anzu-deactivate-region t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Separator of `</span><span class="org-comment"><span class="org-constant">to</span></span><span class="org-comment">' string.</span>
    (<span class="org-keyword">setq</span> anzu-replace-to-string-separator <span class="org-string">" =&gt; "</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Function which returns mode-line string.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--anzu-update-mode-line</span> (here total)
      (<span class="org-keyword">when</span> anzu--state
        (<span class="org-keyword">let</span> ((status (<span class="org-keyword">cl-case</span> anzu--state
                        (search (format (<span class="org-keyword">if</span> (&gt; total 1)
                                            <span class="org-string">" %s of %d%s matches "</span>
                                          <span class="org-string">" %s of %d%s match "</span>)
                                        (anzu--format-here-position here total)
                                        total (<span class="org-keyword">if</span> anzu--overflow-p <span class="org-string">"+"</span> <span class="org-string">""</span>)))
                        (replace-query (format <span class="org-string">" %d replace "</span> total))
                        (replace (format (<span class="org-keyword">if</span> (&gt; total 1)
                                             <span class="org-string">" %d of %d matches "</span>
                                           <span class="org-string">" %d of %d match "</span>)
                                         here total))))
              (face (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> (zerop total) (not (string= isearch-string <span class="org-string">""</span>)))
                        'anzu-mode-line-no-match
                      'anzu-mode-line)))
          (propertize status 'face face))))
    (<span class="org-keyword">setq</span> anzu-mode-line-update-function #'leuven--anzu-update-mode-line)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable Global-Anzu mode.</span>
    (global-anzu-mode 1)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Override binding for `</span><span class="org-comment"><span class="org-constant">query-replace</span></span><span class="org-comment">'.</span>
    (global-set-key (kbd <span class="org-string">"M-%"</span>)   #'anzu-query-replace)
    (global-set-key (kbd <span class="org-string">"C-M-%"</span>) #'anzu-query-replace-regexp)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key isearch-mode-map (kbd "M-%") #'anzu-query-replace)</span>
    )
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbf7075b" class="outline-3">
<h3 id="orgbf7075b">Symbol Search</h3>
<div class="outline-text-3" id="text-orgbf7075b">
<dl class="org-dl">
<dt><code>M-s .</code> (<code>isearch-forward-symbol-at-point</code>)</dt><dd>Start a symbol (identifier) incremental search forward with the symbol
found near point added to the search string initially.</dd>
</dl>
</div>
</div>

<div id="outline-container-org02d1292" class="outline-3">
<h3 id="org02d1292">Regexp Search</h3>
<div class="outline-text-3" id="text-org02d1292">
<p>
Emacs uses basic regular expressions, which means that the extended regexp
operators have to be escaped.  This means you have to use <code>\(</code>, <code>\|</code>, and <code>\)</code>
instead of <code>(</code>, <code>|</code>, and <code>)</code>.
</p>

<p>
You can build regexps with visual feedback by using:
</p>
<ul class="org-ul">
<li><code>M-x re-builder</code> or</li>
<li><code>M-x regex-tool</code> (by John Wiegley)</li>
</ul>

<p>
Optimize regexps with <code>regexp-opt.el</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 15.5 (info "(emacs)Regexp Search")</span>

  (leuven--section <span class="org-string">"15.5 (emacs)Regexp Search"</span>)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Use regexps by default (allows searching across line breaks).</span>
  (global-set-key (kbd <span class="org-string">"C-s"</span>) #'isearch-forward-regexp)
  (global-set-key (kbd <span class="org-string">"C-r"</span>) #'isearch-backward-regexp)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Shift the meaning of `</span><span class="org-comment"><span class="org-constant">C-M-s/r</span></span><span class="org-comment">' with `</span><span class="org-comment"><span class="org-constant">C-s/r</span></span><span class="org-comment">'.</span>
  (global-set-key (kbd <span class="org-string">"C-M-s"</span>) #'isearch-forward)
  (global-set-key (kbd <span class="org-string">"C-M-r"</span>) #'isearch-backward)
</pre>
</div>
</div>
</div>

<div id="outline-container-org3ae400c" class="outline-3">
<h3 id="org3ae400c">Search Case</h3>
<div class="outline-text-3" id="text-org3ae400c">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 15.9 (info "(emacs)Search Case")</span>

  (leuven--section <span class="org-string">"15.9 (emacs)Search Case"</span>)
</pre>
</div>

<p>
<b>Case folding</b> folds together &ldquo;a&rdquo; and &ldquo;A&rdquo;.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Searches should ignore case by default (in all buffers that do not</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">override this).</span>
  (<span class="org-keyword">setq-default</span> case-fold-search t)
</pre>
</div>

<p>
<b>Char folding</b> allows simple ASCII characters to match their complex Unicode
counterparts.  For instance, if you search for &ldquo;a&rdquo;, you will also match &ldquo;á&rdquo; and
&ldquo;ã&rdquo;; that is, char folding folds together &ldquo;a&rdquo;, &ldquo;á&rdquo; and &ldquo;ã&rdquo;.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">setq</span> search-default-mode 'char-fold-to-regexp)
</pre>
</div>

<p>
You can also <b>toggle character folding</b> in the middle of a search by typing <code>M-s '</code>.
</p>
</div>
</div>

<div id="outline-container-org53e815f" class="outline-3">
<h3 id="org53e815f">Replacement Commands</h3>
<div class="outline-text-3" id="text-org53e815f">
<p>
Pass the string or the regexp directly to <code>query-replace</code>, so you can&rsquo;t mangle it
on the way, by pressing <code>M-%</code> while at the <code>I-search:</code> prompt.
</p>

<p>
<code>query-replace</code> honors <b>character folding</b> if the new variable <code>replace-char-fold</code> is
customized to a non-nil value.
</p>
</div>
</div>

<div id="outline-container-org466ef51" class="outline-3">
<h3 id="org466ef51">Other Search-and-Loop Commands</h3>
<div class="outline-text-3" id="text-org466ef51">
<p>
<code>M-x flush-lines</code> (or <code>delete-matching-lines</code>) deletes each line that contains
a match for REGEXP.
</p>

<p>
There is also the opposite command, <code>M-x keep-lines</code>, which deletes all lines
except those containing matches for REGEXP.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 15.11 (info "(emacs)Other Repeating Search") Commands</span>

  (leuven--section <span class="org-string">"15.11 (emacs)Other Repeating Search Commands"</span>)

  (global-unset-key (kbd <span class="org-string">"M-o"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">XXX???</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">"Multi-occur" easily inside Isearch.</span>
  (define-key isearch-mode-map (kbd <span class="org-string">"M-o"</span>) #'helm-multi-swoop-all)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Grep all same extension files from inside Isearch.</span>
  (define-key isearch-mode-map (kbd <span class="org-string">"C-M-o"</span>)
    #'(lambda ()
        (<span class="org-keyword">interactive</span>)
        (grep-compute-defaults)
        (lgrep (<span class="org-keyword">if</span> isearch-regexp isearch-string (regexp-quote isearch-string))
               (<span class="org-keyword">if</span> (file-name-extension (buffer-file-name))
                   (format <span class="org-string">"*.%s"</span> (file-name-extension (buffer-file-name)))
                 <span class="org-string">"*"</span>)
               default-directory)
        (isearch-abort)))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 15 ends here.</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org9a6c78d" class="outline-2">
<h2 id="org9a6c78d">Commands for Fixing Typos</h2>
<div class="outline-text-2" id="text-org9a6c78d">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 16 Commands for (info "(emacs)Fixit") Typos</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-16-fixit <span class="org-string">"16 Commands for Fixing Typos"</span>
</pre>
</div>
</div>

<div id="outline-container-orgddad89f" class="outline-3">
<h3 id="orgddad89f">Checking and Correcting Spelling</h3>
<div class="outline-text-3" id="text-orgddad89f">
<div class="note">
<p>
On Windows:
</p>
<ul class="org-ul">
<li>Install <a href="http://ftp.gnu.org/gnu/aspell/w32/Aspell-0-50-3-3-Setup.exe">GNU Aspell 0.50.3</a> (more dictionaries than Cygwin Aspell)</li>
<li>Install <a href="http://ftp.gnu.org/gnu/aspell/w32/Aspell-en-0.50-2-3.exe">Aspell English dictionary-0.50-2</a></li>
<li>Add <code>C:\Program Files (x86)\Aspell\bin</code> to the System <code>PATH</code></li>
</ul>

</div>

<p>
GNU <b>Aspell</b> is better than <b>Ispell</b>:
</p>

<ul class="org-ul">
<li>It does recognize words with apostrophes (l&rsquo;avion)&#x2026; but it is slower.</li>

<li>It can handle UTF-8 documents far better than Ispell can.</li>
</ul>

<p>
When spellchecking a buffer, the <code>A</code> command accepts an incorrect word, and adds
it to the <b>file word list</b> (<code>ispell-add-per-file-word-list</code>).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 16.4 Checking and Correcting (info "(emacs)Spelling")</span>

  (leuven--section <span class="org-string">"16.4 (emacs)Checking and Correcting Spelling"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Spelling checker program.</span>
  (<span class="org-keyword">setq</span> ispell-program-name             <span class="org-comment-delimiter">; </span><span class="org-comment">Defined in ispell.el.</span>
        (<span class="org-keyword">or</span> (executable-find <span class="org-string">"aspell"</span>)
            (executable-find <span class="org-string">"hunspell"</span>)
            (executable-find <span class="org-string">"ispell"</span>)
            <span class="org-comment-delimiter">;; </span><span class="org-comment">nil                      ; [Default: "ispell"]</span>
            ))

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--executable-ispell-program-name-p</span> ()
    <span class="org-doc">"Ensure that `</span><span class="org-doc"><span class="org-constant">ispell-program-name</span></span><span class="org-doc">' is an executable program name."</span>
    (<span class="org-keyword">and</span> (boundp 'ispell-program-name)
         ispell-program-name            <span class="org-comment-delimiter">; </span><span class="org-comment">It can be nil!</span>
         (file-executable-p ispell-program-name)
         ispell-program-name))

  (<span class="org-keyword">when</span> (leuven--executable-ispell-program-name-p)

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-ispell-region-or-buffer</span> ()
      <span class="org-doc">"Interactively check the current region or buffer for spelling errors."</span>
      (<span class="org-keyword">interactive</span>)
      (<span class="org-keyword">if</span> mark-active
          (<span class="org-keyword">if</span> (&lt; (mark) (point))
              (ispell-region (mark) (point))
              (ispell-region (point) (mark)))
          (ispell-buffer)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Key bindings (or `C-c i' prefix key binding?).</span>
    (global-set-key (kbd <span class="org-string">"C-$"</span>) #'leuven-ispell-region-or-buffer)
    (global-set-key (kbd <span class="org-string">"C-M-$"</span>) #'ispell-change-dictionary)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Default dictionary to use (if `</span><span class="org-comment"><span class="org-constant">ispell-local-dictionary</span></span><span class="org-comment">' is nil, that</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; is if there is no local dictionary to use in the buffer).</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq ispell-dictionary "american") ; see `</span><span class="org-comment"><span class="org-constant">sentence-end-double-space</span></span><span class="org-comment">'</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Comments in programs should always be in English.</span>
    (add-hook 'prog-mode-hook
              #'(lambda ()
                  (<span class="org-keyword">setq</span> ispell-dictionary <span class="org-string">"american"</span>)))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable on-the-fly spell checking.</span>
    (add-hook 'org-mode-hook
              #'(lambda ()
                  (<span class="org-keyword">if</span> (<span class="org-keyword">or</span> (eq (aref (buffer-name) 0) ?\s)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Buffer starting with " *".</span>
                          (<span class="org-keyword">and</span> (boundp 'org-babel-exp-reference-buffer)
                               org-babel-exp-reference-buffer))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Export buffer.</span>
                      (message <span class="org-string">"[DON'T TURN ON Flyspell mode in `</span><span class="org-string"><span class="org-constant">%s</span></span><span class="org-string">']"</span> (buffer-name))
                    (message <span class="org-string">"[Turning on Flyspell mode in `</span><span class="org-string"><span class="org-constant">%s</span></span><span class="org-string">']"</span> (buffer-name))
                    (flyspell-mode))))
</pre>
</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Enable Flyspell in other modes deriving from Text (HTML, etc.)</b><br />
nil</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable on-the-fly spell checking.</span>
    (add-hook 'text-mode-hook
              #'(lambda ()
                  (message <span class="org-string">"[Turning on Flyspell mode in `</span><span class="org-string"><span class="org-constant">%s</span></span><span class="org-string">']"</span> (buffer-name))
                  (flyspell-mode)))

    (<span class="org-keyword">defun</span> <span class="org-function-name">org-export-as--org-export-as-around</span> (orig-fun <span class="org-type">&amp;rest</span> args)
      <span class="org-doc">"Turn off Text mode hooks (Flyspell, etc.) when exporting current Org buffer."</span>
      (<span class="org-keyword">let</span> ((text-mode-hook nil))
        (apply orig-fun args)))
    (advice-add 'org-export-as <span class="org-builtin">:around</span> #'org-export-as--org-export-as-around)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Prevent Flyspell from finding mistakes in the code, well in comments and</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">strings.</span>
    (add-hook 'prog-mode-hook #'flyspell-prog-mode)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ispell"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Save the personal dictionary without confirmation.</span>
      (<span class="org-keyword">setq</span> ispell-silently-savep t)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Extensions and extra switches to pass to the `</span><span class="org-comment"><span class="org-constant">ispell</span></span><span class="org-comment">' program.</span>
      (<span class="org-keyword">cond</span>
</pre>
</div>

<p>
Tell <code>aspell</code> to speed up, though this reduces somewhat the quality of its
suggestions.  According to the <code>aspell</code> documentation:
</p>

<ul class="org-ul">
<li><code>ultra</code> is the fastest suggestion mode, which is still twice as slow as <code>ispell</code>.</li>

<li>If your machine is fast enough, a better option might be to try <code>fast</code> mode,
which is twice as slow as <code>ultra</code>, but more accurate.</li>

<li>The <code>normal</code> mode, which is the <code>aspell</code> default, is even more accurate, but is
reportedly 10 times slower than <code>fast</code> mode.</li>
</ul>

<p>
Use the <code>-C</code> option which will ConsiderCamelCaseToBeCorrect.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">       ((string-match <span class="org-string">"aspell"</span> ispell-program-name)
        (<span class="org-keyword">setq</span> ispell-extra-args '(<span class="org-string">"--sug-mode=ultra"</span> <span class="org-string">"-C"</span>))
        (<span class="org-keyword">setq</span> ispell-really-aspell t)
        (<span class="org-keyword">setq</span> ispell-really-hunspell nil))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">       ((string-match <span class="org-string">"ispell"</span> ispell-program-name)
        (<span class="org-keyword">setq</span> ispell-extra-args '())
        (<span class="org-keyword">setq</span> ispell-really-aspell nil)
        (<span class="org-keyword">setq</span> ispell-really-hunspell nil)))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">      <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Solve the problem of words separated by `-' flagged as</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">;; erroneous by removing the `-' from the value of otherchars.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(if (fboundp 'ispell-get-decoded-string)</span>
      <span class="org-comment-delimiter">;;     </span><span class="org-comment">(defun ispell-get-otherchars ()</span>
      <span class="org-comment-delimiter">;;       </span><span class="org-comment">(replace-regexp-in-string "-" "" (ispell-get-decoded-string 3))))</span>
</pre>
</div>

<p>
Add language indicator.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">      <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq-default mode-line-format</span>
      <span class="org-comment-delimiter">;;               </span><span class="org-comment">(cons</span>
      <span class="org-comment-delimiter">;;                </span><span class="org-comment">'(:eval</span>
      <span class="org-comment-delimiter">;;                  </span><span class="org-comment">(let ((dict (and (featurep 'ispell)</span>
      <span class="org-comment-delimiter">;;                                   </span><span class="org-comment">(not buffer-read-only)</span>
      <span class="org-comment-delimiter">;;                                   </span><span class="org-comment">(or ispell-local-dictionary</span>
      <span class="org-comment-delimiter">;;                                       </span><span class="org-comment">ispell-dictionary</span>
      <span class="org-comment-delimiter">;;                                       </span><span class="org-comment">"--" ; default dictionary</span>
      <span class="org-comment-delimiter">;;                                       </span><span class="org-comment">))))</span>
      <span class="org-comment-delimiter">;;                    </span><span class="org-comment">(and dict</span>
      <span class="org-comment-delimiter">;;                         </span><span class="org-comment">(propertize (concat " " (substring dict 0 2))</span>
      <span class="org-comment-delimiter">;;                                     </span><span class="org-comment">'face 'mode-line-highlight))))</span>
      <span class="org-comment-delimiter">;;                </span><span class="org-comment">(default-value 'mode-line-format)))</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">      )
</pre>
</div>

<div class="note">
<p>
Each time you cycle to another window (<code>C-x o</code>), the <b>Ispell process</b> gets <b>killed</b>
and a <b>new Ispell process</b> is <b>started</b>, if the language in the next window is
different from the language in the current window&#x2026;
</p>

</div>

<p>
<code>flyspell-auto-correct-word</code> is bound to <code>C-.</code>.  Press it one time to correct the
word under the cursor.  If several spellings are possible, they appear in the
minibuffer.  Just keep hitting <code>C-.</code> to replace the word with the successive
suggestions.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"flyspell"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Remove the binding of `</span><span class="org-comment"><span class="org-constant">flyspell-auto-correct-previous-word</span></span><span class="org-comment">', to be used</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">by Multiple Cursors.</span>
      (define-key flyspell-mode-map (kbd <span class="org-string">"C-;"</span>) nil))
</pre>
</div>

<p>
<code>flyspell-goto-next-error</code> is bound to &ldquo;C-,&rdquo;.  Press it to go to the next
previously detected error.
</p>

<p>
<code>flyspell-correct-word-before-point</code> is bound to <code>C-c $</code>.  Press it to <b>pop up a menu</b>
of possible corrections for misspelled word before point.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't use `</span><span class="org-comment"><span class="org-constant">M-TAB</span></span><span class="org-comment">' to auto-correct the current word (only use `</span><span class="org-comment"><span class="org-constant">C-.</span></span><span class="org-comment">').</span>
    (<span class="org-keyword">setq</span> flyspell-use-meta-tab nil)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">FIXME M-TAB is still bound to `</span><span class="org-comment"><span class="org-constant">flyspell-auto-correct-word</span></span><span class="org-comment">' when this</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">chunk of code is placed within (with-eval-after-load "flyspell"...)</span>

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"flyspell"</span>

     <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't consider that a word repeated twice is an error.</span>
     (<span class="org-keyword">setq</span> flyspell-mark-duplications-flag nil)

     <span class="org-comment-delimiter">;; </span><span class="org-comment">Lower (for performance reasons) the maximum distance for finding</span>
     <span class="org-comment-delimiter">;; </span><span class="org-comment">duplicates of unrecognized words.</span>
     (<span class="org-keyword">setq</span> flyspell-duplicate-distance 12000) <span class="org-comment-delimiter">; </span><span class="org-comment">[default: 400000]</span>

     <span class="org-comment-delimiter">;; </span><span class="org-comment">Fix the "enabling flyspell mode gave an error" bug.</span>
     (<span class="org-keyword">setq</span> flyspell-issue-welcome-flag nil)

     <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Don't print messages for every word (when checking the entire buffer)</span>
     <span class="org-comment-delimiter">;; </span><span class="org-comment">;; as it causes a (small) slowdown.</span>
     <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq flyspell-issue-message-flag nil)</span>

     <span class="org-comment-delimiter">;; </span><span class="org-comment">Dash character (`-') is considered as a word delimiter.</span>
     (<span class="org-keyword">setq-default</span> flyspell-consider-dash-as-word-delimiter-flag t)
     <span class="org-comment-delimiter">;; </span><span class="org-comment">'("francais" "deutsch8" "norsk")</span>

     (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-flyspell-toggle-dictionary</span> ()
       <span class="org-doc">"Toggle the local dictionary between French and US English."</span>
       (<span class="org-keyword">interactive</span>)
       (<span class="org-keyword">let</span> ((dict (<span class="org-keyword">or</span> ispell-local-dictionary
                       ispell-dictionary)))
         (<span class="org-keyword">setq</span> dict (<span class="org-keyword">if</span> (string= dict <span class="org-string">"francais"</span>) <span class="org-string">"american"</span> <span class="org-string">"francais"</span>))
         (message <span class="org-string">"[Switched to %S]"</span> dict)
         (sit-for 0.5)
         (ispell-change-dictionary dict)
         (force-mode-line-update)
         (<span class="org-keyword">when</span> flyspell-mode
           <span class="org-comment-delimiter">;; </span><span class="org-comment">(flyspell-delete-all-overlays)</span>
           <span class="org-comment-delimiter">;; </span><span class="org-comment">If above is executed, the advised `</span><span class="org-comment"><span class="org-constant">org-mode-flyspell-verify</span></span><span class="org-comment">'</span>
           <span class="org-comment-delimiter">;; </span><span class="org-comment">won't work anymore.</span>
           (flyspell-buffer))))

     <span class="org-comment-delimiter">;; </span><span class="org-comment">Key bindings.</span>
     (global-set-key (kbd <span class="org-string">"C-$"</span>) #'flyspell-buffer)
     (global-set-key (kbd <span class="org-string">"C-M-$"</span>) #'leuven-flyspell-toggle-dictionary)

     <span class="org-comment-delimiter">;; </span><span class="org-comment">Spell-check your XHTML (by adding `</span><span class="org-comment"><span class="org-constant">nxml-text-face</span></span><span class="org-comment">' to the list of</span>
     <span class="org-comment-delimiter">;; </span><span class="org-comment">faces corresponding to text in programming-mode buffers).</span>
     (add-to-list 'flyspell-prog-text-faces 'nxml-text-face)))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 16 ends here.</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orge1533fe" class="outline-2">
<h2 id="orge1533fe">Keyboard Macros</h2>
<div class="outline-text-2" id="text-orge1533fe">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 17 (info "(emacs)Keyboard Macros")</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-17-keyboard-macros <span class="org-string">"17 Keyboard Macros"</span>
</pre>
</div>

<p>
Shows keyboard macros or latest interactive commands as Emacs Lisp:
<a href="https://github.com/Silex/elmacro">https://github.com/Silex/elmacro</a>.
</p>
</div>

<div id="outline-container-orgb5236d5" class="outline-3">
<h3 id="orgb5236d5">Basic Use</h3>
<div class="outline-text-3" id="text-orgb5236d5">
<dl class="org-dl">
<dt><code>S-&lt;F8&gt;</code></dt><dd>Start recording your keyboard macro.</dd>

<dt><code>S-&lt;F8&gt;</code> again</dt><dd>Stop recording it.</dd>

<dt><code>&lt;F8&gt;</code></dt><dd>Call the keyboard macro.</dd>
</dl>

<p>
If you want to check the result each time before repeating, type <code>&lt;F8&gt; e e...</code>.
</p>

<p>
If you want to repeat only N times, type <code>C-u N &lt;F8&gt;</code>.
</p>

<p>
If you want to repeat forever or until error, type <code>C-u 0 &lt;F8&gt;</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 17.1 (info "(emacs)Basic Keyboard Macro") Use</span>

  (leuven--section <span class="org-string">"17.1 (emacs)Basic Keyboard Macro Use"</span>)

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-kmacro-turn-on-recording</span> ()
    <span class="org-doc">"Start recording a keyboard macro and toggle functionality of key binding."</span>
    (<span class="org-keyword">interactive</span>)
    (global-set-key (kbd <span class="org-string">"&lt;S-f8&gt;"</span>) #'leuven-kmacro-turn-off-recording)
    (kmacro-start-macro nil))

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-kmacro-turn-off-recording</span> ()
    <span class="org-doc">"Stop recording a keyboard macro and toggle functionality of key binding."</span>
    (<span class="org-keyword">interactive</span>)
    (global-set-key (kbd <span class="org-string">"&lt;S-f8&gt;"</span>) #'leuven-kmacro-turn-on-recording)
    (kmacro-end-macro nil))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Start/stop recording a keyboard macro.</span>
  (global-set-key (kbd <span class="org-string">"&lt;S-f8&gt;"</span>) #'leuven-kmacro-turn-on-recording)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Execute the most recent keyboard macro.</span>
  (global-set-key (kbd <span class="org-string">"&lt;f8&gt;"</span>) #'kmacro-call-macro)
</pre>
</div>
</div>
</div>

<div id="outline-container-org67caaae" class="outline-3">
<h3 id="org67caaae">Naming and Saving Keyboard Macros</h3>
<div class="outline-text-3" id="text-org67caaae">
<dl class="org-dl">
<dt><code>C-&lt;F8&gt;</code></dt><dd>Give the keyboard macro a name (to invoke it under that name).</dd>
</dl>

<p>
Assign the last macro to a free key binding of your choice with
<code>kmacro-bind-to-key</code> (bound to <code>C-x C-k b</code>).
</p>

<p>
To <b>save a named keyboard macro</b> (with its key binding) for future use, switch to
your <code>.emacs</code> file, and run <code>C-u M-x insert-kbd-macro</code> (if you leave out the <code>C-u</code>,
then it will just insert the macro definition without the <code>global-set-key</code>
sequence).
</p>

<p>
You can add <code>(interactive)</code> to make it a command, so that you can use it with
<code>M-x</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 17.5 Name and (info "(emacs)Save Keyboard Macro")s</span>

  (leuven--section <span class="org-string">"17.5 (emacs)Name and Save Keyboard Macros"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Assign a name to the last keyboard macro defined.</span>
  (global-set-key (kbd <span class="org-string">"&lt;C-f8&gt;"</span>) #'kmacro-name-last-macro)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 17 ends here.</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgd2fb698" class="outline-2">
<h2 id="orgd2fb698">Files Handling</h2>
<div class="outline-text-2" id="text-orgd2fb698">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 18 (info "(emacs)Files") Handling</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-18-files <span class="org-string">"18 Files Handling"</span>
</pre>
</div>
</div>

<div id="outline-container-orgb9545c8" class="outline-3">
<h3 id="orgb9545c8">Visiting Files</h3>
<div class="outline-text-3" id="text-orgb9545c8">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 18.2 (info "(emacs)Visiting") Files</span>

  (leuven--section <span class="org-string">"18.2 (emacs)Visiting Files"</span>)

  (<span class="org-keyword">defadvice</span> <span class="org-function-name">find-file</span> (around leuven-find-file activate)
    <span class="org-doc">"Open the file named FILENAME and report time spent."</span>
    (<span class="org-keyword">let</span> ((filename (ad-get-arg 0))
          (find-file-time-start (float-time)))
      (message <span class="org-string">"[Finding file %s...]"</span> filename)
      ad-do-it
      (message <span class="org-string">"[Found file %s in %.2f s]"</span> filename
               (- (float-time) find-file-time-start))))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Visit a file.</span>
  (global-set-key (kbd <span class="org-string">"&lt;f3&gt;"</span>) #'find-file)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Get rid of the "File xxx is large, really open? (y or n)" annoying message.</span>
  (<span class="org-keyword">setq</span> large-file-warning-threshold (* 512 1024 1024)) <span class="org-comment-delimiter">; </span><span class="org-comment">512 MB.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Maximum buffer size for which line number should be displayed.</span>
  (<span class="org-keyword">setq</span> line-number-display-limit large-file-warning-threshold)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">14.18 Optional Mode Line Features.</span>
</pre>
</div>

<p>
Knowing this kind of behaviour, and especially when trying to guard myself
against reading a log which spits out a long line, I often do something like
<code>tail -f /some/file | fold -s</code> in a shell buffer. This isn&rsquo;t good for editing,
obviously, but helps a lot with reading.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--is-file-large-p</span> ()
    <span class="org-doc">"File is too big and might cause performance issue."</span>
    (&gt; (buffer-size) large-file-warning-threshold))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">View large files.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--view-large-file</span> ()
    <span class="org-doc">"Fix performance issues in Emacs when viewing large files."</span>
    (<span class="org-keyword">setq</span> buffer-read-only t)
    (<span class="org-keyword">setq-local</span> bidi-display-reordering nil) <span class="org-comment-delimiter">; </span><span class="org-comment">Default local setting.</span>
    (jit-lock-mode nil)
    (buffer-disable-undo)
    (set (make-variable-buffer-local 'global-hl-line-mode) nil)
    (set (make-variable-buffer-local 'line-number-mode) nil)
    (set (make-variable-buffer-local 'column-number-mode) nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Disable costly modes.</span>
    (<span class="org-keyword">when</span> (boundp 'smartparens-mode)
      (smartparens-mode -1))              <span class="org-comment-delimiter">; </span><span class="org-comment">XXX: DOES NOT WORK.</span>
    (<span class="org-keyword">when</span> (boundp 'anzu-mode)
      (anzu-mode -1)))

  (<span class="org-keyword">define-derived-mode</span> <span class="org-function-name">leuven-large-file-mode</span> fundamental-mode <span class="org-string">"LvnLargeFile"</span>
    <span class="org-doc">"Fix performance issues in Emacs for large files."</span>
    (leuven--view-large-file))

  (add-to-list 'magic-mode-alist (cons #'leuven--is-file-large-p #'leuven-large-file-mode))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-find-large-file-conservatively</span> (filename)
    (<span class="org-keyword">interactive</span>
     (list (read-file-name
            <span class="org-string">"Find file conservatively: "</span> nil default-directory
            (confirm-nonexistent-file-or-buffer))))
    (<span class="org-keyword">let</span> ((auto-mode-alist nil))
      (find-file filename)
      (fundamental-mode)
      (leuven--view-large-file)))
</pre>
</div>

<p>
The <b>SoLong</b> package is a workaround for the issue of large &ldquo;minified&rdquo; files of
programming code bringing Emacs to its knees on account of the relevant modes
not being optimised for that use-case.
</p>
</div>
</div>

<div id="outline-container-orge9882bc" class="outline-3">
<h3 id="orge9882bc">Saving Files</h3>
<div class="outline-text-3" id="text-orge9882bc">
<p>
You can define a <b>shadow file</b> group to automatically upload local files to
a remote location.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 18.3 (info "(emacs)Saving") Files</span>

  (leuven--section <span class="org-string">"18.3 (emacs)Saving Files"</span>)

  (<span class="org-keyword">defadvice</span> <span class="org-function-name">save-buffer</span> (around leuven-save-buffer activate)
    <span class="org-doc">"Save the file named FILENAME and report time spent."</span>
    (<span class="org-keyword">let</span> ((filename (buffer-file-name))
          (save-buffer-time-start (float-time)))
      (message <span class="org-string">"[Saving file %s...]"</span> filename)
      ad-do-it
      (message <span class="org-string">"[Saved file %s in %.2f s]"</span> filename
               (- (float-time) save-buffer-time-start))))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Make your changes permanent.</span>
  (global-set-key (kbd <span class="org-string">"&lt;f2&gt;"</span>) #'save-buffer)
</pre>
</div>

<p>
Builtin file version control of Emacs.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Make numbered backups.</span>
  (<span class="org-keyword">setq</span> version-control t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Save backup files (i.e., `</span><span class="org-comment"><span class="org-constant">foo~</span></span><span class="org-comment">' or `</span><span class="org-comment"><span class="org-constant">foo.~i~</span></span><span class="org-comment">') in one central location</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(instead of in the local directory).</span>
  (<span class="org-keyword">setq</span> backup-directory-alist
        '((<span class="org-string">".*"</span> . <span class="org-string">"~/.emacs.d/backups/"</span>)))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Filenames matching a regexp are backed</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">up in the corresponding directory.</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Emacs will `</span><span class="org-comment"><span class="org-constant">make-directory</span></span><span class="org-comment">' it, if</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">necessary.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Number of oldest versions to keep when a new numbeRed backup is made.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq kept-old-versions 0)            ; [Default: 2]</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Number of newest versions to keep when a new numbered backup is made.</span>
  (<span class="org-keyword">setq</span> kept-new-versions 5)            <span class="org-comment-delimiter">; </span><span class="org-comment">[Default: 2]</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't ask me about deleting excess backup versions.</span>
  (<span class="org-keyword">setq</span> delete-old-versions t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Always use copying to create backup files (don't clobber symlinks).</span>
  (<span class="org-keyword">setq</span> backup-by-copying t)
</pre>
</div>

<p>
Customize saving actions.
</p>

<p>
Automatically add a newline at the end of the file:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Ensure newline at the end of file when it is saved.</span>
  (<span class="org-keyword">setq</span> require-final-newline t)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">TODO Do this only for text and Fundamental modes, because I could</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">edit binary files (see `</span><span class="org-comment"><span class="org-constant">mode-require-final-newline</span></span><span class="org-comment">')</span>
</pre>
</div>

<p>
Update time stamps (and copyright notice) automatically.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Update time stamps every time you save a buffer.</span>
  (add-hook 'before-save-hook #'time-stamp)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Maintain last change time stamps (`Time-stamp: &lt;&gt;' occurring within</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">the first 8 lines) in files edited by Emacs.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"time-stamp"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Format of the string inserted by `M-x time-stamp':</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">`YYYY-MM-DD Day HH:MM' (see `</span><span class="org-comment"><span class="org-constant">system-time-locale</span></span><span class="org-comment">' for non-numeric</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">formatted items of time).</span>
    (<span class="org-keyword">setq-default</span> time-stamp-format <span class="org-string">"%:y-%02m-%02d %3a %02H:%02M"</span>))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Update the copyright notice to indicate the current year.</span>
  (add-hook 'before-save-hook
            #'(lambda ()                  <span class="org-comment-delimiter">; </span><span class="org-comment">Except for ...</span>
                (<span class="org-keyword">unless</span> (derived-mode-p 'diff-mode)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">... where the patch file can't be</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">changed!</span>
                  (copyright-update))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org10ef735" class="outline-3">
<h3 id="org10ef735">Reverting a Buffer</h3>
<div class="outline-text-3" id="text-org10ef735">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 18.4 (info "(emacs)Reverting") a Buffer</span>

  (leuven--section <span class="org-string">"18.4 (emacs)Reverting a Buffer"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Time between Auto-Revert Mode file checks.</span>
  (<span class="org-keyword">setq</span> auto-revert-interval 1)         <span class="org-comment-delimiter">; </span><span class="org-comment">[Default: 5]</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; But if, for instance, a new version is checked in from outside the current</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Emacs session, the version control number in the mode line, as well as</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; other version control related information, may not be properly updated</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq auto-revert-check-vc-info t)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Synchronize.  Reload the file from disk (replacing current buffer text with</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">the text of the visited file on disk).</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-revert-buffer-without-query</span> ()
    <span class="org-doc">"Unconditionally revert current buffer."</span>
    (<span class="org-keyword">interactive</span>)
    (revert-buffer t t)                 <span class="org-comment-delimiter">; </span><span class="org-comment">ignore-auto(-save), noconfirm</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Remove highlights.</span>
    (<span class="org-keyword">dolist</span> (o (overlays-in (window-start) (window-end)))
      (<span class="org-keyword">when</span> (<span class="org-keyword">or</span> (equal (overlay-get o 'face) 'recover-this-file)
                (equal (overlay-get o 'face) 'highlight-changes)
                (equal (overlay-get o 'face) 'highlight-changes-delete)
                (equal (overlay-get o 'face) 'org-block-executing))
        (delete-overlay o)))            <span class="org-comment-delimiter">; </span><span class="org-comment">Useful when our advice of function</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">org-babel-execute-src-block</span></span><span class="org-comment">' fails to</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">remove the background color.</span>
    (message <span class="org-string">"[Buffer is up to date with file on disk]"</span>))

  (global-set-key (kbd <span class="org-string">"C-S-y"</span>) #'leuven-revert-buffer-without-query)
</pre>
</div>

<p>
Turn on auto-revert mode globally.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">when</span> leuven--cygwin-p                <span class="org-comment-delimiter">; </span><span class="org-comment">Cygwin Emacs uses gfilenotify (based</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">on GLib) and there are performance</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">problems... Emacs bug 20927</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't use file notification functions.</span>
    (<span class="org-keyword">setq</span> auto-revert-use-notify nil))  <span class="org-comment-delimiter">; </span><span class="org-comment">XXX Apply this in EmacsW32 if it doesn't revert!</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable Global Auto-Revert mode (auto refresh buffers).</span>
  (global-auto-revert-mode 1)           <span class="org-comment-delimiter">; </span><span class="org-comment">Can generate a lot of network traffic</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">if `</span><span class="org-comment"><span class="org-constant">auto-revert-remote-files</span></span><span class="org-comment">' is set</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">to non-nil.</span>
</pre>
</div>

<p>
Auto-revert will automatically <b>reload files</b> that have been <b>modified outside of
Emacs</b> (externally modified files).  It won&rsquo;t revert a buffer that you&rsquo;ve edited
inside Emacs, even if the file also changes outside.
</p>

<div class="warning">
<p>
<code>global-auto-revert-mode</code> blocks Cygwin Emacs for more than 5 seconds at many
points in time. Disabled for now, under Cygwin.
</p>

</div>
</div>
</div>

<div id="outline-container-org4e64a7a" class="outline-3">
<h3 id="org4e64a7a">Auto Reverting Non-File Buffers</h3>
<div class="outline-text-3" id="text-org4e64a7a">
<p>
Auto-refresh Dired.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Global Auto-Revert mode operates on all buffers (Dired, etc.)</span>
  (<span class="org-keyword">setq</span> global-auto-revert-non-file-buffers t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Do not generate any messages (be quiet about refreshing Dired).</span>
  (<span class="org-keyword">setq</span> auto-revert-verbose nil)        <span class="org-comment-delimiter">; </span><span class="org-comment">Avoid "Reverting buffer `</span><span class="org-comment"><span class="org-constant">some-dir/</span></span><span class="org-comment">'.".</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org514eac9" class="outline-3">
<h3 id="org514eac9">Auto-Saving: Protection Against Disasters</h3>
<div class="outline-text-3" id="text-org514eac9">
<p>
How to get Emacs to auto-save to your local disk (<code>#file#</code>).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 18.6 (info "(emacs)Auto Save"): Protection Against Disasters</span>

  (leuven--section <span class="org-string">"18.6 (emacs)Auto Save: Protection Against Disasters"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Auto-save every 100 input events.</span>
  (<span class="org-keyword">setq</span> auto-save-interval 100)         <span class="org-comment-delimiter">; </span><span class="org-comment">[Default: 300].</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Save files automatically if application is idle for 15 sec.</span>
  (<span class="org-keyword">setq</span> auto-save-timeout 15)           <span class="org-comment-delimiter">; </span><span class="org-comment">[Default: 30].</span>
</pre>
</div>

<p>
Disable backups and auto-save only in the current buffer with
<code>M-x sensitive-mode</code>:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">define-minor-mode</span> <span class="org-function-name">sensitive-mode</span>
    <span class="org-doc">"For sensitive files like password lists.</span>
<span class="org-doc">  It disables backup creation and auto saving in the current buffer.</span>

<span class="org-doc">  With no argument, this command toggles the mode.  Non-null prefix argument</span>
<span class="org-doc">  turns on the mode.  Null prefix argument turns off the mode."</span>
    nil                                 <span class="org-comment-delimiter">; </span><span class="org-comment">Initial value.</span>
    <span class="org-string">" Sensitive"</span>                        <span class="org-comment-delimiter">; </span><span class="org-comment">Indicator for the mode line.</span>
    nil                                 <span class="org-comment-delimiter">; </span><span class="org-comment">Minor mode bindings.</span>
    (<span class="org-keyword">if</span> (symbol-value sensitive-mode)
        (<span class="org-keyword">progn</span>
          <span class="org-comment-delimiter">;; </span><span class="org-comment">Disable backups.</span>
          (set (make-local-variable 'backup-inhibited) t)
          <span class="org-comment-delimiter">;; </span><span class="org-comment">Disable auto-save.</span>
          (<span class="org-keyword">if</span> auto-save-default
              (auto-save-mode -1)))
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Resort to default value of backup-inhibited.</span>
      (kill-local-variable 'backup-inhibited)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Resort to default auto save setting.</span>
      (<span class="org-keyword">if</span> auto-save-default
          (auto-save-mode 1))))
</pre>
</div>

<p>
You should enable it for all <code>.vcf</code> and <code>.gpg</code> files.
</p>

<p>
Make the message &ldquo;<i>FILENAME has auto save data</i>&rdquo; unmissable:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defface</span> <span class="org-variable-name">recover-this-file</span>
    '((t <span class="org-builtin">:weight</span> bold <span class="org-builtin">:background</span> <span class="org-string">"#FF3F3F"</span>))
    <span class="org-doc">"Face for buffers visiting files with auto save data."</span>
    <span class="org-builtin">:group</span> 'files)

  (<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven--recover-this-file</span> nil
    <span class="org-doc">"If non-nil, an overlay indicating that the visited file has auto save data."</span>)

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--recover-this-file</span> ()
    (<span class="org-keyword">let</span> ((<span class="org-warning">warn</span> (not buffer-read-only)))
      (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> warn
                 <span class="org-comment-delimiter">;; </span><span class="org-comment">No need to warn if buffer is auto-saved under the name of</span>
                 <span class="org-comment-delimiter">;; </span><span class="org-comment">the visited file.</span>
                 (not (<span class="org-keyword">and</span> buffer-file-name
                           auto-save-visited-mode)) <span class="org-comment-delimiter">; </span><span class="org-comment">Emacs 26.1</span>
                 (file-newer-than-file-p (<span class="org-keyword">or</span> buffer-auto-save-file-name
                                             (make-auto-save-file-name))
                                         buffer-file-name))
        (set (make-local-variable 'leuven--recover-this-file)
             (make-overlay (point-min) (point-max)))
        (overlay-put leuven--recover-this-file
                     'face 'recover-this-file))))

  (add-hook 'find-file-hook #'leuven--recover-this-file)
</pre>
</div>

<p>
XXX Add explanation about what to do when a file is opened in red background!
</p>
</div>
</div>

<div id="outline-container-org53d6fc1" class="outline-3">
<h3 id="org53d6fc1">Comparing Files</h3>
<div class="outline-text-3" id="text-org53d6fc1">
</div>
<div id="outline-container-org08cb18b" class="outline-4">
<h4 id="org08cb18b">Diff</h4>
<div class="outline-text-4" id="text-org08cb18b">
<p>
If you want a Magit diff buffer for the current file, you can call
magit-diff-buffer-file directly, or use the &ldquo;diff&rdquo; option (d) in
magit-file-popup. e.g.:
</p>

<p>
(global-set-key (kbd &ldquo;C-c m d&rdquo;) #&rsquo;magit-diff-buffer-file)
(global-set-key (kbd &ldquo;C-c m f&rdquo;) #&rsquo;magit-file-popup)
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 18.9 (info "(emacs)Comparing Files")</span>

  (leuven--section <span class="org-string">"18.9 (emacs)Comparing Files"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Default to unified diffs.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq diff-switches "-u")             ; Default in Emacs 25.</span>
</pre>
</div>

<p>
Press <code>e</code> in Dired mode to immediately Ediff two marked files, no questions asked:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-ediff-files-from-dired</span> ()
<span class="org-doc">"Quickly Ediff files from Dired"</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let</span> ((files (dired-get-marked-files))
          (wnd (current-window-configuration)))
      (<span class="org-keyword">if</span> (&lt;= (length files) 2)
          (<span class="org-keyword">let</span> ((file1 (car files))
                (file2 (<span class="org-keyword">if</span> (cdr files)
                           (cadr files)
                         (read-file-name
                          <span class="org-string">"File B to compare: "</span>
                          (dired-dwim-target-directory)))))
            (<span class="org-keyword">if</span> (file-newer-than-file-p file1 file2)
                (ediff-files file2 file1)
              (ediff-files file1 file2))
            (add-hook 'ediff-after-quit-hook-internal
                      #'(lambda ()
                          (<span class="org-keyword">setq</span> ediff-after-quit-hook-internal nil)
                          (set-window-configuration wnd))))
        (<span class="org-warning">error</span> <span class="org-string">"no more than 2 files should be marked"</span>))))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"dired"</span>
    (define-key dired-mode-map (kbd <span class="org-string">"E"</span>) #'leuven-ediff-files-from-dired))
</pre>
</div>

<ul class="org-ul">
<li>In case no files are marked, the file at point is used as the first file, and
<code>read-file-name</code> is used for the second file. Since I have the magic
(setq dired-dwim-target t)
in my config, in case a second dired buffer is open,
<code>dired-dwim-target-directory</code> will offer it as the starting directory during
completion. Very useful to compare two files in two different directories.</li>

<li>Depending on the order of the arguments to <code>ediff-files</code>, the changes will
appear either as added or removed; <code>file-newer-than-file-p</code> tries to put the
arguments in a logical order by looking at the files&rsquo; last change times.</li>

<li><code>ediff-after-quit-hook-internal</code> is used to restore the previous window
configuration after I quit Ediff with <code>q</code>.</li>
</ul>
</div>
</div>

<div id="outline-container-org32a9526" class="outline-4">
<h4 id="org32a9526">Compare windows</h4>
<div class="outline-text-4" id="text-org32a9526">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Compare text in current window with text in next window.</span>
  (global-set-key (kbd <span class="org-string">"C-="</span>) #'compare-windows)
</pre>
</div>
</div>
</div>

<div id="outline-container-org0dba515" class="outline-4">
<h4 id="org0dba515">SMerge mode</h4>
<div class="outline-text-4" id="text-org0dba515">
<p>
You can use <code>M-x smerge-mode</code> to <b>edit a file with conflict markers</b> (output from
the <code>diff3</code> program).
</p>

<p>
SMerge does not automatically select regions but provides convenient key
bindings to navigate between conflicts and to choose the A or B variant.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Change the cumbersome default prefix (C-c ^).</span>
  (<span class="org-keyword">setq</span> smerge-command-prefix (kbd <span class="org-string">"C-c v"</span>))
</pre>
</div>

<p>
Important keybindings:
</p>

<dl class="org-dl">
<dt><code>C-c v n</code> (<code>smerge-next</code>)</dt><dd>Move to next conflict.</dd>

<dt><code>C-c v p</code> (<code>smerge-previous</code>)</dt><dd>Move to previous conflict.</dd>

<dt><code>C-c v RET</code> (<code>smerge-keep-current</code>)</dt><dd>Keep the version the cursor is on.</dd>

<dt><code>C-c v m</code> (<code>smerge-keep-mine</code>)</dt><dd>Keep your changes.</dd>

<dt><code>C-c v o</code> (<code>smerge-keep-other</code>)</dt><dd>Keep other changes.</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable SMerge automatically.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--enable-smerge-maybe</span> ()
    (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> buffer-file-name (vc-backend buffer-file-name))
      (<span class="org-keyword">save-excursion</span>
        (goto-char (point-min))
        (<span class="org-keyword">when</span> (re-search-forward <span class="org-string">"^&lt;&lt;&lt;&lt;&lt;&lt;&lt; "</span> nil t)
          (smerge-mode 1)))))

  (add-hook 'buffer-list-update-hook #'leuven--enable-smerge-maybe)
</pre>
</div>

<div class="note">
<p>
In recent Emacs versions, SMerge is turned on automatically??? XXX
</p>

</div>
</div>
</div>

<div id="outline-container-org872e134" class="outline-4">
<h4 id="org872e134">Interface for merging files</h4>
<div class="outline-text-4" id="text-org872e134">
<dl class="org-dl">
<dt><code>C-c v E</code> (<code>smerge-ediff</code>)</dt><dd>Start an Ediff session to merge the conflicts.</dd>
</dl>

<p>
Keybindings:
</p>

<dl class="org-dl">
<dt><code>n</code> and <code>p</code></dt><dd>Navigate through the conflicts.</dd>

<dt><code>a</code> or <code>b</code></dt><dd>Accept versions.</dd>

<dt><code>/</code></dt><dd>Look at the ancestor!</dd>

<dt><code>q</code></dt><dd>Quit the ediff session.</dd>
</dl>

<p>
The top-left pane contains the <code>file</code> in my working directory as it was before the
merge, the top-right pane contains the final revision of <code>file</code> at the source URL
and the bottom pane contains the merged version.
</p>

<p>
The really nice thing is that as soon as I end the Ediff session, Emacs goes
back to the conflicted file <i>with all the changes done in the Ediff session
applied</i>. So if you have resolved all conflicts, the file is not in Smerge mode
anymore. The only thing left to do is to save the file. After that, the state of
the file as displayed in the vc-dir buffer changes from <i>conflicted</i> to <i>edited</i>.
</p>

<div class="note">
<p>
Since the year 2000, <code>vc-resolve-conflict</code> is an alias for <code>smerge-ediff</code>, which as
the name suggests starts an Ediff session, not an Emerge session.
</p>

<p>
By the way, the library header of <code>ediff.el</code> acknowledges <code>emerge.el</code>&rsquo;s influence
and then goes on saying &ldquo;The present version of <b>Ediff supersedes Emerge</b>.  It
provides a superior user interface and has numerous major features not found in
Emerge.  In particular, it can do patching, and 2-way and 3-way file comparison,
merging, and directory operations.&rdquo;
</p>

<p>
Also note that <code>magit-ediff-resolve</code> (<code>E m</code> or <code>e</code> on a file with conflicts) uses
<code>smerge-ediff</code> internally.  It does however override the <code>ediff-quit-hook</code> to
provide a slightly better session finishing experience.  Instead of telling you
that you could save &ldquo;the buffer&rdquo; (there are several buffers), it asks you
whether you want to save the buffer (while showing you its name).
</p>

</div>
</div>
</div>
</div>

<div id="outline-container-orga946410" class="outline-3">
<h3 id="orga946410">Diff mode</h3>
<div class="outline-text-3" id="text-orga946410">
<p>
You can review the diff of all file changes, either:
</p>

<ul class="org-ul">
<li><b>unified</b> (Diff mode) or</li>
<li><b>split</b> (Ediff mode).</li>
</ul>

<p>
In Diff mode, the changes specified in a patch are grouped into &ldquo;hunks&rdquo;, which
are contiguous chunks of text that contain one or more changed lines.
</p>

<p>
Use <code>C-x v =</code> to show what&rsquo;s changed.
</p>

<p>
You can also decide to revert a change: <b>select a hunk and apply it (in reverse)</b>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 18.10 (info "(emacs)Diff Mode")</span>

  (leuven--section <span class="org-string">"18.10 (emacs)Diff Mode"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Mode for viewing/editing context diffs.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"diff-mode"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Highlight the changes with better granularity.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-diff-make-fine-diffs</span> ()
      <span class="org-doc">"Enable Diff Auto-Refine mode."</span>
      (<span class="org-keyword">interactive</span>)
      (<span class="org-keyword">let</span> (diff-auto-refine-mode)      <span class="org-comment-delimiter">; </span><span class="org-comment">Avoid refining the hunks redundantly ...</span>
        (<span class="org-keyword">condition-case</span> nil
            (<span class="org-keyword">save-excursion</span>
              (goto-char (point-min))
              (<span class="org-keyword">while</span> (not (eobp))
                (diff-hunk-next)
                (diff-refine-hunk)))    <span class="org-comment-delimiter">; </span><span class="org-comment">... when this does it.</span>
          (<span class="org-warning">error</span> nil))
        (run-at-time 0.0 nil
                     #'(lambda ()
                         (<span class="org-keyword">if</span> (derived-mode-p 'diff-mode)
                             <span class="org-comment-delimiter">;; </span><span class="org-comment">Put back the cursor only if still in a Diff buffer</span>
                             <span class="org-comment-delimiter">;; </span><span class="org-comment">after the delay.</span>
                             (goto-char (point-min)))))))

    (<span class="org-keyword">defun</span> <span class="org-function-name">vc-diff--diff-make-fine-diffs-if-necessary</span> (buffer messages)
      <span class="org-doc">"Auto-refine only the regions of 14,000 bytes or less."</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Check for auto-refine limit.</span>
      (<span class="org-keyword">unless</span> (&gt; (buffer-size) 14000)
        (leuven-diff-make-fine-diffs)))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Push the auto-refine function after `</span><span class="org-comment"><span class="org-constant">vc-diff</span></span><span class="org-comment">'.</span>
    (advice-add 'vc-diff <span class="org-builtin">:after</span> #'vc-diff--diff-make-fine-diffs-if-necessary)
</pre>
</div>

<p>
If you use <code>colordiff</code> in SVN, you need this:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">defun</span> <span class="org-function-name">vc-diff-finish--handle-color-in-diff-output</span> (buffer messages)
      <span class="org-doc">"Run `</span><span class="org-doc"><span class="org-constant">ansi-color-apply-on-region</span></span><span class="org-doc">'."</span>
      (<span class="org-keyword">interactive</span>)
      (<span class="org-keyword">progn</span>
        (<span class="org-keyword">require</span> '<span class="org-constant">ansi-color</span>)
        (<span class="org-keyword">let</span> ((inhibit-read-only t))
          (ansi-color-apply-on-region (point-min) (point-max)))))
    (advice-add 'vc-diff-finish <span class="org-builtin">:after</span> #'vc-diff-finish--handle-color-in-diff-output)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    )
</pre>
</div>

<p>
To compare 2 text files, you can also use Ediff if the following command
works.
</p>

<pre class="example">
M-: (executable-find "diff") RET
</pre>


<p>
In Ediff, press:
</p>

<ul class="org-ul">
<li><code>?</code> to get help</li>

<li><code>|</code> to change from vertical window layout to horizontal window layout, and
vice versa</li>

<li><code>a</code> or <code>b</code> key to merge the code from A to B or from B to A</li>

<li><code>ra</code> or <code>rb</code> to revert your change</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Ediff, a comprehensive visual interface to diff &amp; patch</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; setup for Ediff's menus and autoloads</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(try-require 'ediff-hook)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">already loaded (by Emacs?)</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ediff"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Ignore space.</span>
    (<span class="org-keyword">setq</span> ediff-diff-options (concat ediff-diff-options <span class="org-string">" -w"</span>))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Add new options after the default ones.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Skip over difference regions that differ only in white space and line</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">breaks.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq-default ediff-ignore-similar-regions  t)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">XXX Make another key binding (than `E') with that value in a let-bind</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Sometimes grab the mouse and put it in the control frame.</span>
    (<span class="org-keyword">setq</span> ediff-grab-mouse 'maybe)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Do everything in one frame.</span>
    (<span class="org-keyword">setq</span> ediff-window-setup-function 'ediff-setup-windows-plain)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Split the window (horizontally or vertically) depending on the frame</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">width.</span>
    (<span class="org-keyword">setq</span> ediff-split-window-function
          #'(lambda (<span class="org-type">&amp;optional</span> arg)
              (<span class="org-keyword">if</span> (&gt; (frame-width) split-width-threshold)
                  (split-window-horizontally arg)
                (split-window-vertically arg))))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq ediff-merge-split-window-function 'split-window-vertically)</span>
</pre>
</div>

<p>
When using Ediff, everything must be visible; otherwise, it&rsquo;s fairly hard to
resolve conflicts.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">defun</span> <span class="org-function-name">turn-on-visible-mode</span> ()
      <span class="org-doc">"Make all invisible text visible."</span>
      (visible-mode 1)
      (<span class="org-keyword">setq</span> truncate-lines nil)
      (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> (boundp 'hs-minor-mode)
                 hs-minor-mode)
        (hs-show-all))
      (<span class="org-keyword">when</span> (derived-mode-p 'org-mode)
        (org-remove-inline-images)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Force the buffers to unhide (folded) text (in Org files).</span>
    (add-hook 'ediff-prepare-buffer-hook #'turn-on-visible-mode)

    (<span class="org-keyword">defun</span> <span class="org-function-name">turn-off-visible-mode</span> ()
      <span class="org-doc">"Disable Visible mode."</span>
      (visible-mode 0)
      (<span class="org-keyword">setq</span> truncate-lines t)
      (<span class="org-keyword">when</span> (derived-mode-p 'org-mode)
        (org-display-inline-images)))

    (add-hook 'ediff-quit-hook #'turn-off-visible-mode)

    )
</pre>
</div>
</div>

<div id="outline-container-orge03dad7" class="outline-4">
<h4 id="orge03dad7">Ediff-directories</h4>
<div class="outline-text-4" id="text-orge03dad7">
<p>
For <b>comparing two directories</b>, you can use <code>ediff-directories</code>, <code>ztree-diff</code>, <a href="http://meldmerge.org/">Meld</a>
(free) or <a href="https://www.deltawalker.com/">DeltaWalker</a> (39.95 USD).
</p>

<p>
<code>ediff-directories</code> combined with the key sequence <code>= h x</code> <code>= h x</code> shows you only the
files which differ.
</p>

<p>
It is not recursive, but it gives you also subdirectory pairs to compare.  Just
hit <code>RET</code> on such a pair.
</p>

<p>
As bonus, it even works for remote directories.
</p>

<div class="warning">
<p>
<code>ediff-directories</code> does not list files in one directory with no corresponding
files in the other directory.
</p>

</div>
</div>
</div>

<div id="outline-container-org2e6c847" class="outline-4">
<h4 id="org2e6c847">Ztree</h4>
<div class="outline-text-4" id="text-org2e6c847">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">("M-m g v" . ztree-dir)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">("M-m g V" . ztree-diff)</span>
</pre>
</div>

<p>
Hotkeys supported:
</p>

<ul class="org-ul">
<li>Open/close directories with double-click, <code>RET</code> or <code>SPC</code> keys.</li>
<li>To jump to the parent directory, hit the <code>Backspace</code> key.</li>
<li>To toggle open/closed state of the subtree of the current directory, hit the
<code>x</code> key.</li>
<li><code>RET</code> on different files starts the <b>Ediff</b> (or open file if one absent or the same)</li>
<li><code>SPC</code> show the simple diff window for the current file instead of <b>Ediff</b> (or view
file if one absent or the same)</li>
<li><code>TAB</code> to fast switch between panels</li>
<li><code>h</code> key to toggle show/hide identical files/directories</li>
<li><code>H</code> key to toggle show/hide hidden/ignored files/directories</li>
<li><code>C</code> key to copy current file or directory to the left or right panel</li>
<li><code>D</code> key to delete current file or directory</li>
<li><code>v</code> key to quick view the current file</li>
<li><code>r</code> initiates the rescan/refresh of current file or subdirectory</li>
<li><code>&lt;F5&gt;</code> forces the full rescan.</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgc3afe05" class="outline-3">
<h3 id="orgc3afe05">Miscellaneous File Operations</h3>
<div class="outline-text-3" id="text-orgc3afe05">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 18.11 (info "(emacs)Misc File Ops")</span>

  (leuven--section <span class="org-string">"18.11 (emacs)Misc File Ops"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Use the system's Trash (when it is available).</span>
  (<span class="org-keyword">setq</span> delete-by-moving-to-trash t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org1dd59af" class="outline-3">
<h3 id="org1dd59af">Accessing Compressed Files</h3>
<div class="outline-text-3" id="text-org1dd59af">
<ul class="org-ul">
<li>Display the <b>contents</b> of the archive</li>
<li><b>View or edit</b> the actual files contained withing the archive</li>
</ul>

<p>
Using the Emacs Dired utility, you can compress (individually) or uncompress
marked files (using <code>gzip</code>) by pressing <code>Z</code>.
</p>

<p>
If you want to create <b>a single archive</b> file from many marked files, you can use
<code>dired-do-compress-to</code>, bound to <code>c</code>.
</p>
</div>
</div>

<div id="outline-container-orga8193aa" class="outline-3">
<h3 id="orga8193aa">Auto Encryption</h3>
<div class="outline-text-3" id="text-orga8193aa">
<p>
History:
</p>

<ol class="org-ol">
<li>mailcrypt</li>

<li>PGG</li>

<li><p>
EasyPG (= epg) is a GnuPG interface for Emacs.
</p>

<p>
It allows you to encrypt/decrypt files within Emacs.  When you use <code>C-x C-f</code> to
access an encrypted file, Emacs prompts you for the passphrase and then
decrypts the file before displaying it.  When you save the file, Emacs
automatically encrypts it again with that same key.
</p>

<p>
It has two aspects:
</p>

<ul class="org-ul">
<li>convenient tools which allow to use GnuPG from Emacs (EasyPG Assistant),
and</li>

<li><p>
a fully functional interface library to GnuPG (EasyPG Library).
</p>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Fetch the key automatically</b><br />
<p>
Set the <code>keyserver</code> entry in the <code>~/.gnupg/gpg.conf</code> file properly.
</p>
</div></li>
</ul></li>
</ol>

<p>
What is PGP/MIME, what is OpenPGP, and how Gnus handles them?
</p>
<ul class="org-ul">
<li>PGP/MIME is a standard, which mml2015* implements using ep[ag]-*.</li>
<li>OpenPGP is a standard, which ep[ag]-* implements.</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">The EasyPG Assistant, transparent file encryption.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"epa-file"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Stop EasyPG from asking for the recipient used for encrypting files.</span>
    (<span class="org-keyword">setq</span> epa-file-encrypt-to <span class="org-string">"john.doe@example.com"</span>)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">If no one is selected (""), symmetric</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">encryption will always be performed.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Cache passphrase for symmetric encryption (VERY important).</span>
    (<span class="org-keyword">setq</span> epa-file-cache-passphrase-for-symmetric-encryption t)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Not to sound paranoid.  But if you</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">want caching, it's recommended to use</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">*public-key encryption* instead of</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">symmetric encryption.  `</span><span class="org-comment"><span class="org-constant">gpg-agent</span></span><span class="org-comment">' is</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">the preferred way to do this.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Prompt for the password in the Emacs minibuffer (instead of using a</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">graphical password prompt for GPG).</span>
    (setenv <span class="org-string">"GPG_AGENT_INFO"</span> nil))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgac36200" class="outline-3">
<h3 id="orgac36200">Remote Files</h3>
<div class="outline-text-3" id="text-orgac36200">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 18.14 (info "(emacs)Remote Files")</span>

  (leuven--section <span class="org-string">"18.14 (emacs)Remote Files"</span>)
</pre>
</div>
</div>

<div id="outline-container-orgae530b4" class="outline-4">
<h4 id="orgae530b4">Ange-FTP</h4>
<div class="outline-text-4" id="text-orgae530b4">
<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Check out why network share aren&rsquo;t accessible</b><br />
<p>
I should be able to open <i>/SERVER/d</i> via SMB!?
</p>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">*** Ange-FTP</span>

  (leuven--section <span class="org-string">"Ange-FTP"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Transparent FTP support.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ange-ftp"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Try to use passive mode in ftp, if the client program supports it.</span>
    (<span class="org-keyword">setq</span> ange-ftp-try-passive-mode t)) <span class="org-comment-delimiter">; </span><span class="org-comment">Needed for Ubuntu.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org4ce6215" class="outline-4">
<h4 id="org4ce6215">TRAMP</h4>
<div class="outline-text-4" id="text-org4ce6215">
<p>
Open files on a remote machine using <a href="http://www.gnu.org/software/tramp/">TRAMP</a> (other protocols than just FTP) from
your machine, edit and save them!
</p>

<p>
<code>/method:user@host:/path/to/some/file</code>
</p>

<p>
Examples:
</p>
<ul class="org-ul">
<li><code>C-x C-f /ssh:user@host:/etc/motd RET</code> (<code>root</code> to modify it!)</li>
<li><code>C-x C-f /plink:user@host:/etc/motd RET</code> (from Windows Emacs)</li>
<li><code>C-x C-f /sudo:root@localhost:/etc/motd RET</code></li>
<li><code>C-x C-f /su::/etc/motd RET</code> (shortened syntax for the <code>root</code> account on the
local host)</li>
</ul>

<p>
Also <code>M-x find-dired</code>, <code>rgrep</code>, <code>lgrep</code>, <code>compile -</code> properly work with TRAMP (run on
remote server and show result in your Emacs).
</p>

<div class="note">
<p>
<code>sshfs</code> can give you the same functionality as TRAMP: it is like a personal NFS
(another mounted file system) over SSH.  If you can SSH to a server, you can
probably do <code>sshfs</code>.
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">*** TRAMP - Transparent Remote Access, Multiple Protocols</span>

  (leuven--section <span class="org-string">"TRAMP"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"tramp"</span>         <span class="org-comment-delimiter">; </span><span class="org-comment">The autoloads are predefined.</span>
</pre>
</div>
</div>

<div id="outline-container-orga25250f" class="outline-5">
<h5 id="orga25250f"><span class="todo TODO">TODO</span> Configuring TRAMP for use</h5>
<div class="outline-text-5" id="text-orga25250f">
</div>
<ul class="org-ul">
<li><a id="org10c03d9"></a>Selecting a default method<br />
<div class="outline-text-6" id="text-org10c03d9">
<div class="note">
<p>
As there are <b>issues with Cygwin <code>ssh</code></b> (which only works with Cygwinized Emacs),
<b>Windows users</b> should use the PuTTY implementation of SSH (<code>plink</code> method).
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Default transfer method.</span>
    (<span class="org-keyword">setq</span> tramp-default-method          <span class="org-comment-delimiter">; </span><span class="org-comment">[Default: "scp"]</span>
          (<span class="org-keyword">cond</span> (leuven--win32-p <span class="org-string">"plink"</span>)
                (t <span class="org-string">"ssh"</span>)))
</pre>
</div>

<div class="tip">
<p>
You might try out the <code>rsync</code> <i>external</i> method, which saves the remote files quite
a bit faster than SSH.  It&rsquo;s based on SSH, so it works the same, just saves
faster.
</p>

</div>
</div>
</li>

<li><a id="org925a169"></a><span class="todo TODO">TODO</span> Find file as root<br />
<div class="outline-text-6" id="text-org925a169">
<p>
You can just do <code>C-x C-f /sudo:user@localhost:/etc/motd RET</code>.
</p>

<p>
Because I&rsquo;m lazy, I have a hack (from Tassilo Horn): if I try to open a file
for which I don&rsquo;t have permissions for, I&rsquo;m queried if I want to open it as
root using the <code>sudo</code> tramp method.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--find-file-sudo-header-warning</span> ()
      <span class="org-doc">"*Display a warning in header line of the current buffer."</span>
      (<span class="org-keyword">let*</span> ((warning <span class="org-string">"WARNING: EDITING FILE WITH ROOT PRIVILEGES!"</span>)
             (space (+ 6 (- (frame-width) (length warning))))
             (bracket (make-string (/ space 2) ?-))
             (warning (concat bracket warning bracket)))
        (<span class="org-keyword">setq</span> header-line-format
              (propertize warning 'face 'header-line))))

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-find-file-sudo</span> (filename)
      <span class="org-doc">"Open FILENAME with root privileges."</span>
      (<span class="org-keyword">interactive</span> <span class="org-string">"F"</span>)
      (set-buffer (find-file (concat <span class="org-string">"/sudo::"</span> filename)))
      (leuven--find-file-sudo-header-warning))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; XXX already an existing defadvice around find-file!!</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(defadvice find-file (around leuven-find-file activate)</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">"Open FILENAME using tramp's sudo method if it's read-only."</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(if (and (file-exists-p (ad-get-arg 0))</span>
    <span class="org-comment-delimiter">;;            </span><span class="org-comment">(not (file-writable-p (ad-get-arg 0)))</span>
    <span class="org-comment-delimiter">;;            </span><span class="org-comment">(not (file-remote-p (ad-get-arg 0)))</span>
    <span class="org-comment-delimiter">;;            </span><span class="org-comment">(y-or-n-p (concat "File "</span>
    <span class="org-comment-delimiter">;;                              </span><span class="org-comment">(ad-get-arg 0)</span>
    <span class="org-comment-delimiter">;;                              </span><span class="org-comment">" is read-only.  Open it as root? ")))</span>
    <span class="org-comment-delimiter">;;       </span><span class="org-comment">(leuven-find-file-sudo (ad-get-arg 0))</span>
    <span class="org-comment-delimiter">;;     </span><span class="org-comment">ad-do-it))</span>
</pre>
</div>
</div>
</li>

<li><a id="org243011f"></a>Connecting to a remote host using multiple hops<br />
<div class="outline-text-6" id="text-org243011f">
<p>
New proxy system (introduced in 2004, instead of the old &ldquo;multi-hop&rdquo; methods) to
edit files on a remote server by going via another server.
</p>

<pre class="example">
    ;; Route to be followed for specific host/user pairs.
    (add-to-list 'tramp-default-proxies-alist
                 ;;  "final host"    "user"    "proxy in the middle"
                 '("10.10.13.123" "\\`root\\'" "/ssh:%h:"))
</pre>

<p>
Opening <code>/sudo:10.10.13.123:</code> would connect first <code>10.10.13.123</code> via <code>ssh</code> under your
account name, and perform <code>sudo -u root</code> on that host afterwards.  It is important
to know that the given method is applied on the host which has been reached so
far.  The trick is to think from the end.
</p>
</div>
</li>

<li><a id="org362acd6"></a>Reusing passwords for several connections<br />
<div class="outline-text-6" id="text-org362acd6">
<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">How many seconds passwords are cached.</span>
    (<span class="org-keyword">setq</span> password-cache-expiry 60)     <span class="org-comment-delimiter">; </span><span class="org-comment">[Default: 16]</span>
</pre>
</div>
</div>
</li>

<li><a id="org022195e"></a>Remote shell setup hints<br />
<div class="outline-text-6" id="text-org022195e">
<p>
It is worth noting that you can customize the prompt that tramp expects
(<code>tramp-login-prompt-regexp</code>) but my advice would rather be to make your prompt
TRAMP-compatible and not the other way around.
</p>

<p>
<b>The author of TRAMP doesn&rsquo;t think this ever needs to be changed, so please tell
him about it if you need to change this.</b>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">String used for end of line in rsh connections.</span>
    (<span class="org-keyword">setq</span> tramp-rsh-end-of-line         <span class="org-comment-delimiter">; </span><span class="org-comment">[Default: "\n"]</span>
          (<span class="org-keyword">cond</span> (leuven--win32-p <span class="org-string">"\n"</span>)
                (t <span class="org-string">"\r"</span>)))
</pre>
</div>
</div>
</li>

<li><a id="org499fc03"></a>Auto-save and Backup configuration<br />
<div class="outline-text-6" id="text-org499fc03">
<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">"Turn off" the effect of `</span><span class="org-comment"><span class="org-constant">backup-directory-alist</span></span><span class="org-comment">' for TRAMP files.</span>
    (add-to-list 'backup-directory-alist
                 (cons tramp-file-name-regexp nil))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Faster auto saves.</span>
    (<span class="org-keyword">setq</span> tramp-auto-save-directory temporary-file-directory)
</pre>
</div>
</div>
</li>
</ul>
</div>

<div id="outline-container-org16699c3" class="outline-5">
<h5 id="org16699c3">Frequently Asked Questions</h5>
<div class="outline-text-5" id="text-org16699c3">
<p>
Be notified when TRAMP file transfers are complete by making Emacs beep after
reading from or writing to the remote host.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">defadvice</span> <span class="org-function-name">tramp-handle-write-region</span>
      (after leuven-tramp-write-beep-advice activate)
      <span class="org-doc">"Make TRAMP beep after writing a file."</span>
      (<span class="org-keyword">interactive</span>)
      (beep))

    (<span class="org-keyword">defadvice</span> <span class="org-function-name">tramp-handle-do-copy-or-rename-file</span>
      (after leuven-tramp-copy-beep-advice activate)
      <span class="org-doc">"Make TRAMP beep after copying a file."</span>
      (<span class="org-keyword">interactive</span>)
      (beep))

    (<span class="org-keyword">defadvice</span> <span class="org-function-name">tramp-handle-insert-file-contents</span>
      (after leuven-tramp-insert-beep-advice activate)
      <span class="org-doc">"Make TRAMP beep after inserting contents of a file."</span>
      (<span class="org-keyword">interactive</span>)
      (beep))
</pre>
</div>
</div>
</div>

<div id="outline-container-org4b507c8" class="outline-5">
<h5 id="org4b507c8">How to Customize Traces</h5>
<div class="outline-text-5" id="text-org4b507c8">
<p>
The usual way to debug TRAMP is to set <code>tramp-verbose</code> to 6.  This will produce a
debug buffer, which you can show at <code>tramp-devel@gnu.org</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Debugging TRAMP.</span>
    (<span class="org-keyword">setq</span> tramp-verbose 6))             <span class="org-comment-delimiter">; </span><span class="org-comment">[Maximum: 10]</span>
</pre>
</div>

<p>
The best way to report a TRAMP bug is to call <code>M-x tramp-bug</code>; this prepares an
email, including several trace information for analysis.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orgd4abd67" class="outline-3">
<h3 id="orgd4abd67">Convenience Features for Finding Files</h3>
<div class="outline-text-3" id="text-orgd4abd67">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 18.17 (info "(emacs)File Conveniences")</span>

  (leuven--section <span class="org-string">"18.17 (emacs)File Conveniences"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Filenames excluded from the recent list.</span>
  (<span class="org-keyword">setq</span> recentf-exclude                 <span class="org-comment-delimiter">; </span><span class="org-comment">Has to be set before you require</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">recentf</span></span><span class="org-comment">'!</span>
        '(
          <span class="org-string">".recentf"</span>
          <span class="org-string">"~$"</span>                          <span class="org-comment-delimiter">; </span><span class="org-comment">Emacs (and others) backup.</span>
          <span class="org-string">"\\.aux$"</span> <span class="org-string">"\\.log$"</span> <span class="org-string">"\\.toc$"</span> <span class="org-comment-delimiter">; </span><span class="org-comment">LaTeX.</span>
          <span class="org-string">"/tmp/"</span>
          ))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Setup a menu of recently opened files.</span>
  (idle-require 'recentf)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"recentf"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Maximum number of items that will be saved.</span>
    (<span class="org-keyword">setq</span> recentf-max-saved-items 100)  <span class="org-comment-delimiter">; </span><span class="org-comment">Just 20 is too recent.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">File to save the recent list into.</span>
    (<span class="org-keyword">setq</span> recentf-save-file (concat user-emacs-directory <span class="org-string">".recentf"</span>))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(When using TRAMP) turn off the cleanup feature of `</span><span class="org-comment"><span class="org-constant">recentf</span></span><span class="org-comment">'.</span>
    (<span class="org-keyword">setq</span> recentf-auto-cleanup 'never)  <span class="org-comment-delimiter">; </span><span class="org-comment">Disable before we start recentf!</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Save file names relative to my current home directory.</span>
    (<span class="org-keyword">setq</span> recentf-filename-handlers '(abbreviate-file-name))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable `</span><span class="org-comment"><span class="org-constant">recentf</span></span><span class="org-comment">' mode.</span>
    (recentf-mode 1))
</pre>
</div>
</div>

<div id="outline-container-org268951e" class="outline-4">
<h4 id="org268951e">Helm</h4>
<div class="outline-text-4" id="text-org268951e">
</div>

<div id="outline-container-org124c3ee" class="outline-5">
<h5 id="org124c3ee">What is Helm?</h5>
<div class="outline-text-5" id="text-org124c3ee">
<p>
Helm (successor of Anything) is an incremental completion and selection
narrowing framework for Emacs.
</p>

<p>
It will help <b>steer</b> you in the right direction when you&rsquo;re looking for stuff in
Emacs (like buffers, files, etc).  You don&rsquo;t have anymore to remember the
structure of your working directory; you can focus on more important things.
</p>
</div>
</div>

<div id="outline-container-org38e1536" class="outline-5">
<h5 id="org38e1536">How does it work?</h5>
<div class="outline-text-5" id="text-org38e1536">
<p>
The <i>default</i> prefix for the preconfigured Helm commands is <code>C-x c</code>.  In
Emacs-Leuven, we changed it to <code>C-c h</code>.
</p>

<div class="note">
<p>
We cannot change <code>helm-command-prefix-key</code> once <code>helm-config</code> is loaded.
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (leuven--section <span class="org-string">"Helm"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Change `</span><span class="org-comment"><span class="org-constant">helm-command-prefix-key</span></span><span class="org-comment">'.</span>
  (global-set-key (kbd <span class="org-string">"C-c h"</span>) #'helm-command-prefix)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Open Helm (QuickSilver-like candidate-selection framework).</span>
  (<span class="org-keyword">when</span> (try-require 'helm-config)<span class="org-comment-delimiter">;</span><span class="org-comment">XXX  ; [default `</span><span class="org-comment"><span class="org-constant">helm-command-prefix-key</span></span><span class="org-comment">']</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Explicitly loads `</span><span class="org-comment"><span class="org-constant">helm-autoloads</span></span><span class="org-comment">'!</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">CAUTION for recursive loads...</span>

    (global-unset-key (kbd <span class="org-string">"C-x c"</span>))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Resume a previous `</span><span class="org-comment"><span class="org-constant">helm</span></span><span class="org-comment">' session.</span>
    (global-set-key (kbd <span class="org-string">"C-M-z"</span>) #'helm-resume)
</pre>
</div>

<p>
In Helm, generally, look at the <b>mode line</b>: you will see <code>C-h m:Help</code>, it is your
friend; hit it for more info.
</p>

<p>
In default Helm:
</p>

<ul class="org-ul">
<li>Narrow the list by typing some patterns (use the <b>space as separator</b> for
multiple patterns),</li>

<li>Select an element with <code>&lt;Up&gt;</code> / <code>&lt;Down&gt;</code> / <code>&lt;PageUp&gt;</code> / <code>&lt;PageDown&gt;</code> / <code>C-p</code> / <code>C-n</code> /
<code>C-v</code> / <code>M-v</code>,</li>

<li>Choose with <code>RET</code>.</li>

<li><p>
<code>C-z</code> executes an action without quitting the Helm session (persistent action).
</p>

<div class="note">
<p>
For <code>helm-find-files</code>:
</p>

<ul class="org-ul">
<li>On a regular file,
<ol class="org-ol">
<li>First hit on <code>C-z</code> expands the file name</li>
<li>Second hit opens the file and displays its contents in the other window</li>
<li>Third hit kills the buffer (unless it was already open before starting
helm session).</li>
</ol></li>

<li>On image files (<code>.jpg</code>, etc..)
<ol class="org-ol">
<li>Second hit (or <code>C-u C-z</code>) displays the image in the other window</li>
<li>If you then turn on <code>helm-follow-mode</code> (<code>C-c C-f</code>), you turn on Helm in
<b>image browser</b> (i.e., use <code>C-n/p</code> or arrows <code>down/up</code>).</li>
<li>You can rotate image with <code>M-l/r</code> (these are persistent actions too).</li>
</ol></li>
</ul>

</div></li>
</ul>

<p>
Kill your buffers with <code>C-u C-z</code> one by one.
</p>

<p>
To go back to the <b>previous element</b> of the minibuffer history, use <code>M-p</code>.
</p>

<p>
To mark all candidates in a Helm buffer, use <code>M-a</code> (<code>helm-mark-all</code>) or <code>M-m</code>
(<code>helm-toggle-all-marks</code>).
</p>

<p>
Switch to <code>*Helm Log*</code> buffer with <code>M-x helm-open-last-log</code>.
</p>
</div>
</div>

<div id="outline-container-org5301d2f" class="outline-5">
<h5 id="org5301d2f">Changes in key bindings</h5>
<div class="outline-text-5" id="text-org5301d2f">
<p>
In <code>helm-find-file</code>, you may want to try using the left arrow to go to the parent
directory!
</p>

<p>
You can reassign <code>TAB</code> only during <code>helm-find-file</code>.  The <code>helm-find-file</code> almost
looks like Dired and I assign <code>^</code> for going up.  Minor side effect is you cannot
type in <code>^</code> without using <code>C-q</code>.
</p>

<p>
Sometimes you want to hit <code>TAB</code> for <code>helm-selection-action</code>; however, you chose not
to happen.  Now look for substitute for <code>TAB</code>.  Something not <code>TAB</code> can be <code>C-z</code>,
<code>C-TAB</code>, and <code>SPC</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(define-key helm-find-files-map (kbd <span class="org-string">"&lt;C-tab&gt;"</span>) #'helm-select-action)
(define-key helm-find-files-map (kbd <span class="org-string">"&lt;SPC&gt;"</span>)   #'helm-select-action)
(define-key helm-find-files-map (kbd <span class="org-string">"&lt;RET&gt;"</span>)   #'helm-confirm-and-exit-minibuffer)
(define-key helm-find-files-map (kbd <span class="org-string">"^"</span>)       #'helm-find-files-up-one-level)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(define-key helm-grep-mode-map (kbd <span class="org-string">"&lt;RET&gt;"</span>) #'helm-grep-mode-jump-other-window)
(define-key helm-grep-mode-map (kbd <span class="org-string">"n"</span>) #'helm-grep-mode-jump-other-window-forward)
(define-key helm-grep-mode-map (kbd <span class="org-string">"p"</span>) #'helm-grep-mode-jump-other-window-backward)
</pre>
</div>
</div>
</div>

<div id="outline-container-org5cc39f6" class="outline-5">
<h5 id="org5cc39f6">Helm documentation</h5>
<div class="outline-text-5" id="text-org5cc39f6">
<ul class="org-ul">
<li><b>Advanced usage</b> on <a href="https://github.com/emacs-helm/helm#advanced-usage">Emacs-helm</a> page</li>
<li><a href="https://github.com/emacs-helm/helm/wiki">Emacs-helm wiki</a></li>
<li><a href="https://github.com/thierryvolpiatto/emacs-tv-config/blob/master/init-helm-thierry.el">Helm configuration file of Thierry Volpiatto</a>!</li>
<li><a href="http://tuhdo.github.io/helm-intro.html">http://tuhdo.github.io/helm-intro.html</a></li>
</ul>

<p>
Helm allows you to do interesting things with its interactive interface. For
example:
</p>

<ul class="org-ul">
<li>interactive grep: <img src="http://tuhdo.github.io/static/live_grep.gif" alt="live_grep.gif" /></li>
<li>interactive occur: <img src="http://tuhdo.github.io/static/part3/helm-occur.gif" alt="helm-occur.gif" /></li>
</ul>
</div>
</div>

<div id="outline-container-org308c42b" class="outline-5">
<h5 id="org308c42b">Vocabulary</h5>
<div class="outline-text-5" id="text-org308c42b">
<ul class="org-ul">
<li><code>volatile</code> means your candidates are recomputed each time you enter a character
in pattern (cached candidates are not reused).  Async sources are by essence
volatile.</li>

<li><code>delayed</code> means your candidates are computed after <code>helm-input-idle-delay</code>
seconds.</li>

<li><code>no-matchplugin</code> means to not use the multi regexp matching provided by
<code>helm-match-plugin.el</code>.</li>
</ul>
</div>
</div>

<div id="outline-container-org44dd0a5" class="outline-5">
<h5 id="org44dd0a5">Features</h5>
<div class="outline-text-5" id="text-org44dd0a5">
<p>
Finally, the strings in Helm are not just strings; they are <b>regexps</b> and I think
they are more powerful than normal fuzzy matcher.
</p>

<p>
Grep in Helm is interactive, unlike the stock grep/rgrep.
Demo: <img src="http://tuhdo.github.io/static/live_grep.gif" alt="live_grep.gif" />
</p>

<p>
No package does any of this:
</p>

<ul class="org-ul">
<li>Live grep: <img src="http://tuhdo.github.io/static/live_grep.gif" alt="live_grep.gif" /></li>
<li>A live outline tree for jumping to function/variable in current file:
<ul class="org-ul">
<li>Demo 1: <img src="http://tuhdo.github.io/static/part3/helm-semantic-or-imenu.gif" alt="helm-semantic-or-imenu.gif" /></li>
<li>Demo 2: <img src="https://cloud.githubusercontent.com/assets/4818719/4102208/cda8f392-311e-11e4-9c83-e68df38ef68e.gif" alt="cda8f392-311e-11e4-9c83-e68df38ef68e.gif" /></li>
</ul></li>

<li>Interactively select color and faces: <img src="http://tuhdo.github.io/static/part3/helm-color.gif" alt="helm-color.gif" /></li>

<li>Interactive Eshell history, certainly superior to the stock <code>C-c C-l</code>:
<img src="http://tuhdo.github.io/static/part3/helm-eshell-history.gif" alt="helm-eshell-history.gif" />. I store a large
amount of shell history, so I want a quick way to narrow down.</li>
</ul>



<p>
XXX Helm is also very useful to look up Elisp variable/function documentation
and for finding stuff in the Info Manuals (e.g. <code>helm-info-elisp</code> or
<code>helm-info-emacs</code>).
</p>

<p>
XXX Look at helm-dictionary.
</p>


<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Via: http://www.reddit.com/r/emacs/comments/3asbyn/new_and_very_useful_helm_feature_enter_search/</span>
    (<span class="org-keyword">setq</span> helm-echo-input-in-header-line t)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(defun helm-hide-minibuffer-maybe ()</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(when (with-helm-buffer helm-echo-input-in-header-line)</span>
    <span class="org-comment-delimiter">;;     </span><span class="org-comment">(let ((ov (make-overlay (point-min) (point-max) nil nil t)))</span>
    <span class="org-comment-delimiter">;;       </span><span class="org-comment">(overlay-put ov 'window (selected-window))</span>
    <span class="org-comment-delimiter">;;       </span><span class="org-comment">(overlay-put ov 'face (let ((bg-color (face-background 'default nil)))</span>
    <span class="org-comment-delimiter">;;                               </span><span class="org-comment">`(:background ,bg-color :foreground ,bg-color)))</span>
    <span class="org-comment-delimiter">;;       </span><span class="org-comment">(setq-local cursor-type nil))))</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'helm-minibuffer-set-up-hook 'helm-hide-minibuffer-maybe)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Better version of `</span><span class="org-comment"><span class="org-constant">occur</span></span><span class="org-comment">'.</span>
<span class="org-comment-delimiter">;;    </span><span class="org-comment">(global-set-key [remap occur] #'helm-occur) ; helm-regexp.el</span>
    (global-set-key (kbd <span class="org-string">"C-o"</span>)   #'helm-occur) <span class="org-comment-delimiter">; </span><span class="org-comment">helm-regexp.el</span>
    (global-set-key (kbd <span class="org-string">"C-c o"</span>) #'helm-occur) <span class="org-comment-delimiter">; </span><span class="org-comment">helm-regexp.el</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (global-set-key (kbd <span class="org-string">"M-x"</span>) #'helm-M-x)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Speedy file opening.</span>
    (global-set-key (kbd <span class="org-string">"&lt;f3&gt;"</span>)
                    #'(lambda ()
                        (<span class="org-keyword">interactive</span>)
                        (<span class="org-keyword">let</span> ((split-width-threshold (* 2 132)))
                          (helm-for-files))))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key [remap find-file] #'helm-find-files) ; OK. C-x C-f</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Buffer list.</span>
    (global-set-key (kbd <span class="org-string">"C-x b"</span>) #'helm-mini) <span class="org-comment-delimiter">; </span><span class="org-comment">OK.</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">= `</span><span class="org-comment"><span class="org-constant">helm-buffers-list</span></span><span class="org-comment">' + recents.</span>

    (global-set-key [remap list-buffers] #'helm-buffers-list) <span class="org-comment-delimiter">; </span><span class="org-comment">OK. C-x C-b</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">dabbrev-expand</span></span><span class="org-comment">' (M-/) =&gt;`</span><span class="org-comment"><span class="org-constant">helm-dabbrev</span></span><span class="org-comment">'</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key global-map [remap dabbrev-expand] 'helm-dabbrev)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org24d4fcb" class="outline-5">
<h5 id="org24d4fcb">Navigating with Structure Views</h5>
<div class="outline-text-5" id="text-org24d4fcb">
<p>
Popup structure of the current file for quick navigation:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-helm-file-structure</span> (arg)
      <span class="org-doc">"Jump to a place in the buffer using an Index menu.</span>
<span class="org-doc">    For Org mode buffers, show Org headlines.</span>
<span class="org-doc">    For programming mode buffers, show functions, variables, etc."</span>
      (<span class="org-keyword">interactive</span> <span class="org-string">"P"</span>)
      (<span class="org-keyword">cond</span> ((derived-mode-p 'org-mode) (helm-org-in-buffer-headings))
            ((derived-mode-p 'tex-mode) (helm-imenu))
            (t (helm-semantic-or-imenu arg)))) <span class="org-comment-delimiter">; </span><span class="org-comment">More generic than `</span><span class="org-comment"><span class="org-constant">helm-imenu</span></span><span class="org-comment">'.</span>

    (global-set-key (kbd <span class="org-string">"&lt;C-f12&gt;"</span>) #'leuven-helm-file-structure) <span class="org-comment-delimiter">; </span><span class="org-comment">Awesome.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "&lt;f4&gt;") #'leuven-helm-file-structure)</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">And `C-c =' (like in RefTeX)?</span>

    (global-set-key (kbd <span class="org-string">"C-c o"</span>) #'helm-org-agenda-files-headings)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "M-5") #'helm-etags-select)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (global-set-key (kbd <span class="org-string">"C-h a"</span>) #'helm-apropos) <span class="org-comment-delimiter">; </span><span class="org-comment">OK!</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (global-set-key (kbd <span class="org-string">"C-h i"</span>) #'helm-info-emacs) <span class="org-comment-delimiter">; </span><span class="org-comment">OK.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-h d") #'helm-info-at-point)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-h 4") #'helm-info-elisp)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-S-h C-c") #'helm-wikipedia-suggest)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (global-set-key (kbd <span class="org-string">"C-h b"</span>) #'helm-descbinds) <span class="org-comment-delimiter">; </span><span class="org-comment">OK.</span>
</pre>
</div>

<p>
See helm-flycheck!
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package helm-flycheck
  <span class="org-builtin">:ensure</span> t
  <span class="org-builtin">:bind</span> ((<span class="org-string">"M-g f"</span>   . my-helm-flycheck)
         (<span class="org-string">"C-c ! l"</span> . my-helm-flycheck))
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">my-helm-flycheck</span> ()
    <span class="org-doc">"This function makes sure that flycheck has been finished</span>
<span class="org-doc">before running helm-flycheck"</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">require</span> '<span class="org-constant">flycheck</span>)
    (<span class="org-keyword">if</span> flycheck-mode
        (call-interactively 'helm-flycheck)
      (flycheck-mode)
      (message <span class="org-string">"[Just turned FlyCheck on, wait a bit for errors to appear...]"</span>)
      (run-with-idle-timer 1 nil #'helm-flycheck))))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  )                                     <span class="org-comment-delimiter">; </span><span class="org-comment">require 'helm-config ends here.</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm"</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;;</span><span class="org-comment">! Rebind TAB to do persistent action</span>
    (define-key helm-map (kbd <span class="org-string">"&lt;tab&gt;"</span>) #'helm-execute-persistent-action)
    (define-key helm-map (kbd <span class="org-string">"C-i"</span>)   #'helm-execute-persistent-action)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Make TAB works in terminal.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">List available actions using C-z.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key helm-map (kbd "C-z")       #'helm-select-action)</span>
    (define-key helm-map (kbd <span class="org-string">"&lt;backtab&gt;"</span>) #'helm-select-action)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (define-key helm-map (kbd <span class="org-string">"C-M-n"</span>) #'helm-next-source)

    (define-key helm-map (kbd <span class="org-string">"C-M-p"</span>) #'helm-previous-source)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">@ reserved for searching inside buffers! (See C-h m)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Various functions for Helm (Shell history, etc.).</span>
    (<span class="org-keyword">require</span> '<span class="org-constant">helm-misc</span>)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">For multi-line items in e.g. minibuffer history, match entire items,</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">not individual lines within items.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(try-require 'helm-dictionary)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Use the *current window* (no popup) to show the candidates.</span>
    (<span class="org-keyword">setq</span> helm-full-frame nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Open `</span><span class="org-comment"><span class="org-constant">helm-buffer</span></span><span class="org-comment">' in another window.</span>
    (<span class="org-keyword">setq</span> helm-split-window-default-side 'other)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Default function used for splitting window.</span>
    (<span class="org-keyword">setq</span> helm-split-window-preferred-function
          #'(lambda (window)
              (split-window-sensibly)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Move to end or beginning of source when reaching top or bottom of</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; source.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq helm-move-to-line-cycle-in-source t)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Candidates separator of `</span><span class="org-comment"><span class="org-constant">multiline</span></span><span class="org-comment">' source (such as</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">helm-show-kill-ring</span></span><span class="org-comment">').</span>
    (<span class="org-keyword">setq</span> helm-candidate-separator
          <span class="org-string">"--8&lt;-----------------------separator------------------------&gt;8---"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Suppress displaying sources which are out of screen at first.</span>
    (<span class="org-keyword">setq</span> helm-quick-update t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Time that the user has to be idle for, before ALL candidates are</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">collected.</span>
    (<span class="org-keyword">setq</span> helm-input-idle-delay 0.75)    <span class="org-comment-delimiter">; </span><span class="org-comment">0.06 OK // 0.70 NOK</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Enable adaptive sorting in all sources.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(helm-adaptive-mode 1)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Enable generic Helm completion (for all functions in Emacs that use</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; `</span><span class="org-comment"><span class="org-constant">completing-read</span></span><span class="org-comment">' or `</span><span class="org-comment"><span class="org-constant">read-file-name</span></span><span class="org-comment">' and friends).</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(helm-mode 1)</span>
    )
</pre>
</div>
</div>
</div>

<div id="outline-container-org1b53353" class="outline-5">
<h5 id="org1b53353">Helm find files</h5>
<div class="outline-text-5" id="text-org1b53353">
<p>
<code>helm-find-files</code> is powerful because:
</p>

<ul class="org-ul">
<li>It has <b>fuzzy matching</b> by default (enabled by default, but <b>disabled</b> as soon as
you <b>add a space</b> in the pattern).</li>

<li>It has highlighting on candidates depend on types: directory has a color,
plain file has a color, executable has a color, shell script has a color.</li>

<li>Depends on what file type your highlighting candidate is, Helm opens it
appropriately. For example, if you RET on a directory, Helm opens dired; if
you RET on a file, Helm opens that file. You can also customize the
application to open the files. Stock find-file at least can open directory;
Ido simply can&rsquo;t.</li>

<li>You can open multiple files with helm-find-files by marking with C-SPC and
press RET. If you want to everything at current directory, you can use M-a to
mark all then RET. You can even use wildcard expression like stock find-file</li>

<li>Helm has a list of actions to apply on your files: checksum file, open file
externally, switch to eshell, grep, diff&#x2026;</li>
</ul>


<p>
In helm-find-files, you can alway invoke helm-ff-do-grep with C-s or C-u C-s for
recursive searching. Probably helm-projectile can replace helm-find-files more
if it has this feature? I think you can do this by reusing projectile-grep.
</p>

<p>
helm-find-files can even find file at point. That is, you don&rsquo;t need to remember
ffap as well. If you write Emacs lisp, move point over the required file and
execute helm-find-files, it will prompt the file location and you simply RET to
enter. All in once nice package.
</p>


<dl class="org-dl">
<dt><code>C-l</code></dt><dd>Delete the last segment of a file name (in the minibuffer).</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Disable fuzzy matching.</span>
  (<span class="org-keyword">setq</span> helm-ff-fuzzy-matching nil)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm-files"</span>


    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't show only basename of candidates in `</span><span class="org-comment"><span class="org-constant">helm-find-files</span></span><span class="org-comment">'.</span>
    (<span class="org-keyword">setq</span> helm-ff-transformer-show-only-basename nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Search for library in `</span><span class="org-comment"><span class="org-constant">require</span></span><span class="org-comment">' and `</span><span class="org-comment"><span class="org-constant">declare-function</span></span><span class="org-comment">' sexp.</span>
    (<span class="org-keyword">setq</span> helm-ff-search-library-in-sexp t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Use `</span><span class="org-comment"><span class="org-constant">recentf-list</span></span><span class="org-comment">' instead of `</span><span class="org-comment"><span class="org-constant">file-name-history</span></span><span class="org-comment">' in `</span><span class="org-comment"><span class="org-constant">helm-find-files</span></span><span class="org-comment">'.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq helm-ff-file-name-history-use-recentf t)</span>
    )
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">This set Helm to open files using designated programs.</span>
  (<span class="org-keyword">setq</span> helm-external-programs-associations
        '((<span class="org-string">"rmvb"</span> . <span class="org-string">"smplayer"</span>)
          (<span class="org-string">"mp4"</span>  . <span class="org-string">"smplayer"</span>)))
</pre>
</div>

<p>
See <a href="http://stackoverflow.com/questions/14726601/sublime-text-2s-goto-anything-or-instant-search-for-emacs">Sublime Text 2&rsquo;s &ldquo;Goto Anything&rdquo; (or instant search) for Emacs?</a>
</p>
<ul class="org-ul">
<li><a href="https://github.com/xiaohanyu/oh-my-emacs/blob/master/core/ome-completion.org">https://github.com/xiaohanyu/oh-my-emacs/blob/master/core/ome-completion.org</a></li>
</ul>
</div>
</div>

<div id="outline-container-org3b00db4" class="outline-5">
<h5 id="org3b00db4">Descbinds</h5>
<div class="outline-text-5" id="text-org3b00db4">
<p>
Use the separate Helm Descbinds to get a quick <b>key bindings</b> overview.  It will
make your life much easier with million Emacs keys.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">A convenient `</span><span class="org-comment"><span class="org-constant">describe-bindings</span></span><span class="org-comment">' with `</span><span class="org-comment"><span class="org-constant">helm</span></span><span class="org-comment">'.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm-descbinds"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Window splitting style.</span>
    (<span class="org-keyword">setq</span> helm-descbinds-window-style 'split-window))
</pre>
</div>
</div>
</div>

<div id="outline-container-org378660a" class="outline-5">
<h5 id="org378660a">Grep (Find in Project)</h5>
<div class="outline-text-5" id="text-org378660a">
<p>
Launchable from <code>current-buffer</code> or from <code>helm-find-files</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;;</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm-grep-autoloads"</span>

      (global-set-key (kbd <span class="org-string">"M-g ,"</span>) #'helm-do-grep)

      (global-set-key (kbd <span class="org-string">"M-g a"</span>) #'helm-do-grep-ag) <span class="org-comment-delimiter">; </span><span class="org-comment">Thierry Volpiatto</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Or `C-c p s s' (Helm-projectile ag?)</span>
      (<span class="org-keyword">setq</span> helm-grep-ag-command <span class="org-string">"rg --color=always --colors 'match:fg:black' --colors 'match:bg:yellow' --smart-case --no-heading --line-number %s %s %s"</span>)
      (<span class="org-keyword">setq</span> helm-grep-ag-pipe-cmd-switches '(<span class="org-string">"--colors 'match:fg:black'"</span> <span class="org-string">"--colors 'match:bg:yellow'"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">#CDCD00</span>

      )
</pre>
</div>

<p>
<code>helm-ag-map</code> and <code>helm-do-ag-map</code> are inherited by <code>helm-map</code>.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Key</th>
<th scope="col" class="org-left">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">C-c o</td>
<td class="org-left">Open other window</td>
</tr>

<tr>
<td class="org-left">C-l</td>
<td class="org-left">Search in parent directory</td>
</tr>

<tr>
<td class="org-left">C-c C-e</td>
<td class="org-left">Switch to edit mode</td>
</tr>

<tr>
<td class="org-left">C-x C-s</td>
<td class="org-left">Save ag results to buffer (Ask save buffer name if prefix key is specified)</td>
</tr>

<tr>
<td class="org-left">C-c C-f</td>
<td class="org-left">Enable helm-follow-mode</td>
</tr>

<tr>
<td class="org-left">C-c &gt; , right</td>
<td class="org-left">Move to next file</td>
</tr>

<tr>
<td class="org-left">C-c &lt; , left</td>
<td class="org-left">Move to previous file</td>
</tr>

<tr>
<td class="org-left">C-c ?</td>
<td class="org-left">Show help message</td>
</tr>
</tbody>
</table>

<p>
If you are using <code>ag</code>, you can place an <code>.agignore</code> file in the project root with
the <b>files</b> (or extensions) you would want to <b>ignore</b>.
</p>

<p>
If you use <code>helm-ag</code> command, you can specify option like <code>-G\.js$</code> search_pattern,
or if you use <code>helm-do-ag</code>, you can use <code>C-u</code> prefix for specifying extension.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">the_silver_searcher.</span>
  (<span class="org-keyword">when</span> (executable-find <span class="org-string">"ag"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">The silver searcher with Helm interface.</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm-ag-autoloads"</span>

      (global-set-key (kbd <span class="org-string">"C-c s"</span>) #'helm-ag)
      (global-set-key (kbd <span class="org-string">"M-s s"</span>) #'helm-ag)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Find in Project with Ag (from project root).</span>
      (global-set-key (kbd <span class="org-string">"C-S-f"</span>)   #'helm-do-ag-project-root) <span class="org-comment-delimiter">;; </span><span class="org-comment">Find in project. DOES NOT WORK WELL.</span>
      (global-set-key (kbd <span class="org-string">"C-M-S-f"</span>) #'helm-do-ag-project-root) <span class="org-comment-delimiter">;; </span><span class="org-comment">Find in project. DOES NOT WORK WELL.</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Search with Ag.  Ask for directory first.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-S-d") #'helm-do-ag)</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Search with Ag this file (like Swoop).</span>
      (global-set-key (kbd <span class="org-string">"M-g &gt;"</span>) #'helm-ag-this-file)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Search with Ag in current projectile project.</span>
      (global-set-key (kbd <span class="org-string">"C-S-a"</span>) #'helm-projectile-ag)

      (global-set-key (kbd <span class="org-string">"M-g ,"</span>) #'helm-ag-pop-stack)
      ))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm-ag"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Base command of `</span><span class="org-comment"><span class="org-constant">ag</span></span><span class="org-comment">'.</span>
    (<span class="org-keyword">setq</span> helm-ag-base-command (concat helm-ag-base-command <span class="org-string">" --ignore-case"</span>))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Command line option of `</span><span class="org-comment"><span class="org-constant">ag</span></span><span class="org-comment">'</span>
    (<span class="org-keyword">setq</span> helm-ag-command-option <span class="org-string">"--all-text"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Insert thing at point as search pattern.</span>
    (<span class="org-keyword">setq</span> helm-ag-insert-at-point 'symbol))
</pre>
</div>

<p>
See <a href="https://github.com/dingmingxin/dotfiles/blob/master/config_emacs/config/custom-init-helm.el">https://github.com/dingmingxin/dotfiles/blob/master/config_emacs/config/custom-init-helm.el</a>
</p>
</div>
</div>

<div id="outline-container-orge5c7b39" class="outline-5">
<h5 id="orge5c7b39">Helm M-x (search for a command)</h5>
<div class="outline-text-5" id="text-orge5c7b39">
<p>
There&rsquo;s no denying it: it&rsquo;s really difficult to remember all of these various
commands.  Rather than falling back to using the mouse and menu selections,
instead type <code>M-x</code>.
</p>

<p>
This will bring up a Helm menu, where you can then search for your desired
command.
</p>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Get gray for common text of candidates</b><br />
<p>
See <a href="http://code.tutsplus.com/tutorials/essential-textmate-shortcuts-tips-and-techniques--net-21168">http://code.tutsplus.com/tutorials/essential-textmate-shortcuts-tips-and-techniques--net-21168</a>
</p>
</div>

<div class="note">
<p>
With <code>helm-M-x</code>, to pass prefix arguments to the command you want to run, you have
to type <code>C-u</code> <b>after</b> typing <code>M-x</code> and selecting the command &#x2013; that is, <b>before</b>
pressing <code>RET</code>.
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm-command"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Save command even when it fails (on errors).</span>
    (<span class="org-keyword">setq</span> helm-M-x-always-save-history t))
</pre>
</div>
</div>
</div>

<div id="outline-container-org0b910ca" class="outline-5">
<h5 id="org0b910ca">Helm locate</h5>
<div class="outline-text-5" id="text-org0b910ca">
<p>
Use Helm to <b>quickly navigate between files</b>, even in the largest projects.
</p>

<div class="note">
<p>
Locate for <b>Windows</b> users: you have to install <a href="http://www.voidtools.com/download.php">Everything</a> with its command line
interface <code>es.exe</code>.
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "helm-autoloads"</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(global-set-key [remap locate] #'helm-locate))</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm-locate"</span>

    (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> (<span class="org-keyword">or</span> leuven--win32-p leuven--cygwin-p)
               (executable-find <span class="org-string">"es"</span>))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Sort locate results by full path.</span>
      (<span class="org-keyword">setq</span> helm-locate-command <span class="org-string">"es -s %s %s"</span>)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org0d4921e" class="outline-5">
<h5 id="org0d4921e">Helm for buffers</h5>
<div class="outline-text-5" id="text-org0d4921e">
<p>
As a starting point for all <b>searches in buffers and files</b>, use <code>helm-buffers-list</code>
and <code>helm-find-files</code>: you can launch <code>helm-multi-occur</code> and <code>helm-do-grep</code> from
there.
</p>

<p>
You can also use the <code>@</code> prefix to <b>search buffer contents</b>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm-buffers"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't truncate buffer names.</span>
    (<span class="org-keyword">setq</span> helm-buffer-max-length nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Never show details in buffer list.</span>
    (<span class="org-keyword">setq</span> helm-buffer-details-flag nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">String to display at end of truncated buffer names.</span>
    (<span class="org-keyword">setq</span> helm-buffers-end-truncated-string <span class="org-string">"…"</span>))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "helm-adaptive"</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; Don't save history information to file.</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(remove-hook 'kill-emacs-hook 'helm-adaptive-save-history))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org5952967" class="outline-5">
<h5 id="org5952967">Helm ring</h5>
<div class="outline-text-5" id="text-org5952967">
<p>
By pressing <code>M-y</code>, you will see the <b>clipboard history</b> (list of all previous
clipboard contents) and can pick the one you want to paste into the text using
arrow keys.  Use <code>RET</code> to insert it.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Paste from History.</span>
  (global-set-key (kbd <span class="org-string">"M-y"</span>) #'helm-show-kill-ring) <span class="org-comment-delimiter">; </span><span class="org-comment">OK.</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-h SPC") #'helm-all-mark-rings)</span>
  (global-set-key (kbd <span class="org-string">"C-c m"</span>) #'helm-all-mark-rings)
</pre>
</div>

<p>
<code>helm-all-mark-rings</code> allows you to view the content of the both the <b>local and
global mark rings</b> in a friendly interface, so you can always jump back to where
you were.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">kill-ring, mark-ring, and register browsers for Helm.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm-ring"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Max number of lines displayed per candidate in kill-ring browser.</span>
    (<span class="org-keyword">setq</span> helm-kill-ring-max-lines-number 20))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "helm-utils"</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(setq helm-yank-symbol-first t)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc088a1b" class="outline-5">
<h5 id="orgc088a1b">Helm-ls-git</h5>
<div class="outline-text-5" id="text-orgc088a1b">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">List Git files.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm-ls-git-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-c C-f") #'helm-ls-git-ls) ; used by Org!</span>
    (global-set-key (kbd <span class="org-string">"M-+"</span>)    #'helm-ls-git-ls)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "&lt;S-f3&gt;") #'helm-ls-git-ls)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Browse files and see status of project with its VCS.</span>
    (global-set-key (kbd <span class="org-string">"C-x C-d"</span>) #'helm-browse-project))
</pre>
</div>

<p>
See <a href="http://edvorg.com/edvorg/emacs-configs/blob/master/init.d/init-helm.el">http://edvorg.com/edvorg/emacs-configs/blob/master/init.d/init-helm.el</a> for
much more configs with Git&#x2026;
</p>
</div>
</div>

<div id="outline-container-org464c5bf" class="outline-5">
<h5 id="org464c5bf">Imenu</h5>
<div class="outline-text-5" id="text-org464c5bf">
<p>
Imenu is like an outline tree in regular IDE, but Helm makes it interactive, and
fast.  You can ask questions such as &ldquo;Is there a <code>function</code> whose name contains
<code>memory</code>?&rdquo;.
</p>
</div>
</div>

<div id="outline-container-org2dd0887" class="outline-5">
<h5 id="org2dd0887">Google</h5>
<div class="outline-text-5" id="text-org2dd0887">
<p>
<code>helm-google-suggest</code> is very efficient when you get completions from Google (so
you can type only a few characters to get relevant completions) and then you can
send this completion to various services (e.g. wiki lookup), so you don&rsquo;t have
to start a separate Wikipedia lookup, Youtube lookup, etc. command, because you
can use the same command for any of them.
</p>

<div class="note">
<p>
You can easily add actions for other sites you usually search for info on.
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Emacs Helm Interface for quick Google searches</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm-google-autoloads"</span>
    (global-set-key (kbd <span class="org-string">"C-c h g"</span>) #'helm-google)
    (global-set-key (kbd <span class="org-string">"C-c h s"</span>) #'helm-google-suggest))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "helm-google"</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; (when (executable-find "curl")</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;;   (setq helm-google-suggest-use-curl-p t))</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcc09ecf" class="outline-5">
<h5 id="orgcc09ecf">Helm Projectile</h5>
<div class="outline-text-5" id="text-orgcc09ecf">
<p>
Exploring large projects with Projectile and Helm Projectile:
<a href="http://tuhdo.github.io/helm-projectile.html">http://tuhdo.github.io/helm-projectile.html</a>
</p>

<p>
Helm Projectile replaces many Projectile &ldquo;core commands&rdquo;, such as
`projectile-find-file`.
</p>

<p>
A few demos:
</p>

<ul class="org-ul">
<li><p>
Select and open multiple files,
<img src="http://tuhdo.github.io/static/helm-projectile/helm-projectile-find-files-1.gif" alt="helm-projectile-find-files-1.gif" /> :
Now we can open multiple files at once with `helm-projectile`. It outweighs Ido
</p>
<ul class="org-ul">
<li>flx for finding files, since you can only open one file in Ido. Yes, you can</li>
</ul>
<p>
open one file faster in Helm, but when you need to open two or more files,
Helm is more suitable for the large.
</p></li>

<li>Jump to any file depends on context, even if the file path is in a text file,
<img src="http://tuhdo.github.io/static/helm-projectile/helm-projectile-find-files-dwim-1.gif" alt="helm-projectile-find-files-dwim-1.gif" /></li>

<li>Switch between other files with same names but different extensions,
<img src="http://tuhdo.github.io/static/helm-projectile/helm-projectile-find-other-file.gif" alt="helm-projectile-find-other-file.gif" />. Work
not only for C/C++ but other languages, and is customizable. You don&rsquo;t have to
configure anything, like adding include paths for the command to
search. Everything is automatic. Just use it as it is.</li>

<li>Ediff two selected files from helm-projectile-find-file,
<img src="http://tuhdo.github.io/static/helm-projectile/helm-projectile-find-file-ediff.gif" alt="helm-projectile-find-file-ediff.gif" />.</li>

<li>Invoke Etags while in helm-projectile-find-file session; when in Etags
session, you can switch back later to helm-projectile-find-file,
<img src="http://tuhdo.github.io/static/helm-projectile/helm-projectile-etags.gif" alt="helm-projectile-etags.gif" />.</li>

<li>You can invoke `helm-do-grep` on any project directory when using
a `helm-projectile` command.</li>
</ul>

<p>
Key bindings:
</p>

<ul class="org-ul">
<li><code>C-c p p</code> for <code>helm-projectile-switch-project</code></li>
<li><code>C-c p f</code> for <code>helm-projectile-find-file</code></li>
<li><code>C-c p s g</code> for <code>helm-projectile-grep</code></li>
<li><code>C-c p s a</code> for <code>helm-projectile-ag</code></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Disable fuzzy matching for Helm Projectile commands.</span>
  (<span class="org-keyword">setq</span> helm-projectile-fuzzy-match nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-;") #'helm-projectile)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org4d788f8" class="outline-5">
<h5 id="org4d788f8">Lisp completion</h5>
<div class="outline-text-5" id="text-org4d788f8">
<div class="warning">
<p>
This (from Thierry Volpiatto) seems good, except that it changes the behavior of
<code>TAB</code> when done in a word.  Instead of indenting, it completes the word at point,
changing the buffer&rsquo;s contents!
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Lisp complete or indent.</span>
  (define-key lisp-interaction-mode-map
    [remap indent-for-tab-command] #'helm-lisp-completion-at-point-or-indent)
  (define-key emacs-lisp-mode-map
    [remap indent-for-tab-command] #'helm-lisp-completion-at-point-or-indent)
</pre>
</div>

<p>
<code>M-TAB</code>?
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Lisp complete.</span>
  (define-key lisp-interaction-mode-map
    [remap completion-at-point] #'helm-lisp-completion-at-point)
  (define-key emacs-lisp-mode-map
    [remap completion-at-point] #'helm-lisp-completion-at-point)
</pre>
</div>
</div>
</div>

<div id="outline-container-org77827ff" class="outline-5">
<h5 id="org77827ff">Helm swoop</h5>
<div class="outline-text-5" id="text-org77827ff">
<p>
Pressing twice C-o goes from Helm Swoop to Helm Multi Swoop&#x2026;
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Efficiently hopping squeezed lines powered by Helm interface</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(= Helm occur + Follow mode!).</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm-swoop-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Better version of `(helm-)occur'.</span>
    (global-set-key (kbd <span class="org-string">"C-o"</span>)   #'helm-swoop)
    (global-set-key (kbd <span class="org-string">"M-s o"</span>) #'helm-swoop)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "M-i") #'helm-swoop)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "M-I") #'helm-swoop-back-to-last-point)</span>

    (global-set-key (kbd <span class="org-string">"M-s O"</span>) #'helm-multi-swoop)
    (global-set-key (kbd <span class="org-string">"M-s /"</span>) #'helm-multi-swoop)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-c M-i") #'helm-multi-swoop)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-x M-i") #'helm-multi-swoop-all)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">When doing Isearch, hand the word over to `</span><span class="org-comment"><span class="org-constant">helm-swoop</span></span><span class="org-comment">'.</span>
    (define-key isearch-mode-map (kbd <span class="org-string">"C-o"</span>) #'helm-swoop-from-isearch)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key isearch-mode-map (kbd "M-i") #'helm-swoop-from-isearch)</span>

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"dired"</span>
      (define-key dired-mode-map (kbd <span class="org-string">"C-o"</span>) #'helm-swoop)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key dired-mode-map (kbd "M-i") #'helm-swoop)</span>
      ))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm-swoop"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Move up and down like Isearch.</span>
    (define-key helm-swoop-map (kbd <span class="org-string">"C-r"</span>) #'helm-previous-line)
    (define-key helm-swoop-map (kbd <span class="org-string">"C-s"</span>) #'helm-next-line)
    (define-key helm-multi-swoop-map (kbd <span class="org-string">"C-r"</span>) #'helm-previous-line)
    (define-key helm-multi-swoop-map (kbd <span class="org-string">"C-s"</span>) #'helm-next-line)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">From `</span><span class="org-comment"><span class="org-constant">helm-swoop</span></span><span class="org-comment">' to `</span><span class="org-comment"><span class="org-constant">helm-multi-swoop-all</span></span><span class="org-comment">'.</span>
    (define-key helm-swoop-map (kbd <span class="org-string">"C-o"</span>) #'helm-multi-swoop-all-from-helm-swoop)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key helm-swoop-map (kbd "M-i") #'helm-multi-swoop-all-from-helm-swoop)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't slightly boost invoke speed in exchange for text color.</span>
    (<span class="org-keyword">setq</span> helm-swoop-speed-or-color t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Split direction.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq helm-swoop-split-direction 'split-window-horizontally)</span>
    (<span class="org-keyword">setq</span> helm-swoop-split-direction 'split-window-sensibly)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't save each buffer you edit when editing is complete.</span>
    (<span class="org-keyword">setq</span> helm-multi-swoop-edit-save nil))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org8763964" class="outline-4">
<h4 id="org8763964">Image mode</h4>
<div class="outline-text-4" id="text-org8763964">
<p>
AFAICT you need to eval something like
</p>

<p>
(setq image-type-header-regexps &rsquo;((&ldquo;.*&rdquo; . imagemagick)))
</p>

<p>
to be able to resize images in image-mode with imagemagick (for example, from
the &ldquo;Image&rdquo; menu).  If resizing works for you when visiting an image file,
I guess your imagemagick support is ok.
</p>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> auto-image-file-mode in find-file-hook for performance reasons!?</b><br />
nil</div>

<p>
New commands since Emacs 24.4:
</p>

<ul class="org-ul">
<li><code>v</code> in Dired works just as you request: it shows the image,</li>
<li><code>n</code> shows the next image in the same directory (<code>image-next-file</code>),</li>
<li><code>p</code> shows the previous image (<code>image-previous-file</code>), and</li>
<li><code>q</code> quits.</li>
</ul>

<p>
Get EXIF data with <code>image-dired-get-exif-data</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (leuven--section <span class="org-string">"Image mode"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Show image files as images (not as semi-random bits).</span>
  (add-hook 'find-file-hook #'auto-image-file-mode)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 18 ends here.</span>
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-orgdc910c2" class="outline-2">
<h2 id="orgdc910c2">Using Multiple Buffers</h2>
<div class="outline-text-2" id="text-orgdc910c2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 19 Using Multiple (info "(emacs)Buffers")</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-19-buffers <span class="org-string">"19 Using Multiple Buffers"</span>
</pre>
</div>
</div>

<div id="outline-container-org2a520f9" class="outline-3">
<h3 id="org2a520f9">Listing Existing Buffers</h3>
<div class="outline-text-3" id="text-org2a520f9">
<ul class="org-ul">
<li>The <code>C</code> (current) column has a <code>.</code> for the buffer from which you came.</li>
<li>The <code>R</code> (read-only) column has a <code>%</code> if the buffer is read-only.</li>
<li>The <code>M</code> (modified) column has a <code>*</code> if it is modified.</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 19.2 (info "(emacs)List Buffers")</span>

  (leuven--section <span class="org-string">"19.2 (emacs)List Buffers"</span>)

  (<span class="org-keyword">unless</span> (locate-library <span class="org-string">"helm-autoloads"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Operate on buffers like Dired.</span>
    (global-set-key (kbd <span class="org-string">"C-x C-b"</span>) #'ibuffer))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ibuffer"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Completely replaces `</span><span class="org-comment"><span class="org-constant">list-buffer</span></span><span class="org-comment">'.</span>
    (<span class="org-keyword">defalias</span> '<span class="org-function-name">ibuffer-list-buffers</span> 'list-buffer)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't show the names of filter groups which are empty.</span>
    (<span class="org-keyword">setq</span> ibuffer-show-empty-filter-groups nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Filtering groups.</span>
    (<span class="org-keyword">setq</span> ibuffer-saved-filter-groups
          '((<span class="org-string">"default"</span>
             (<span class="org-string">"Chat"</span>
              (mode . circe-mode))
             (<span class="org-string">"Org"</span>
              (<span class="org-keyword">or</span> (mode . diary-mode)
                  (mode . org-mode)
                  (mode . org-agenda-mode)))
             (<span class="org-string">"LaTeX"</span>
              (<span class="org-keyword">or</span> (mode . latex-mode)
                  (mode . LaTeX-mode)
                  (mode . bibtex-mode)
                  (mode . reftex-mode)))
             (<span class="org-string">"Gnus &amp; News"</span>
              (<span class="org-keyword">or</span> (mode . message-mode)
                  (mode . bbdb-mode)
                  (mode . mail-mode)
                  (mode . gnus-group-mode)
                  (mode . gnus-summary-mode)
                  (mode . gnus-article-mode)
                  (name . <span class="org-string">"^</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">\\.bbdb</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">dot-bbdb</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">$"</span>)
                  (name . <span class="org-string">"^\\.newsrc-dribble$"</span>)
                  (mode . newsticker-mode)))
             (<span class="org-string">"Files"</span>
              (filename . <span class="org-string">".*"</span>))
             (<span class="org-string">"Dired"</span>
              (mode . dired-mode))
             (<span class="org-string">"Shell"</span>
              (mode . shell-mode))
             (<span class="org-string">"Version Control"</span>
              (<span class="org-keyword">or</span> (mode . svn-status-mode)
                  (mode . svn-log-edit-mode)
                  (name . <span class="org-string">"^\\*svn-"</span>)
                  (name . <span class="org-string">"^\\*vc\\*$"</span>)
                  (name . <span class="org-string">"^\\*Annotate"</span>)
                  (name . <span class="org-string">"^\\*git-"</span>)
                  (name . <span class="org-string">"^\\*vc-"</span>)))
             (<span class="org-string">"Emacs"</span>
              (<span class="org-keyword">or</span> (name . <span class="org-string">"^\\*scratch\\*$"</span>)
                  (name . <span class="org-string">"^\\*Messages\\*$"</span>)
                  (name . <span class="org-string">"^TAGS</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">&lt;[0-9]+&gt;</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">?$"</span>)
                  (name . <span class="org-string">"^\\*Occur\\*$"</span>)
                  (name . <span class="org-string">"^\\*grep\\*$"</span>)
                  (name . <span class="org-string">"^\\*Compile-Log\\*$"</span>)
                  (name . <span class="org-string">"^\\*Backtrace\\*$"</span>)
                  (name . <span class="org-string">"^\\*Process List\\*$"</span>)
                  (name . <span class="org-string">"^\\*gud\\*$"</span>)
                  (name . <span class="org-string">"^\\*Kill Ring\\*$"</span>)
                  (name . <span class="org-string">"^\\*Completions\\*$"</span>)
                  (name . <span class="org-string">"^\\*tramp"</span>)
                  (name . <span class="org-string">"^\\*compilation\\*$"</span>)))
             (<span class="org-string">"Emacs Source"</span>
              (mode . emacs-lisp-mode))
             (<span class="org-string">"Documentation"</span>
              (<span class="org-keyword">or</span> (mode . Info-mode)
                  (mode . apropos-mode)
                  (mode . woman-mode)
                  (mode . help-mode)
                  (mode . Man-mode))))))

    (add-hook 'ibuffer-mode-hook
              #'(lambda ()
                  (ibuffer-switch-to-saved-filter-groups <span class="org-string">"default"</span>)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Order the groups so the order is: [Default], [agenda], [emacs].</span>
    (<span class="org-keyword">defadvice</span> <span class="org-function-name">ibuffer-generate-filter-groups</span>
      (after leuven-reverse-ibuffer-groups activate)
      (<span class="org-keyword">setq</span> ad-return-value (nreverse ad-return-value))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgafee01d" class="outline-3">
<h3 id="orgafee01d">Killing Buffers</h3>
<div class="outline-text-3" id="text-orgafee01d">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 19.4 (info "(emacs)Kill Buffer")</span>

  (leuven--section <span class="org-string">"19.4 (emacs)Kill Buffer"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Kill this buffer without confirmation (if not modified).</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-kill-this-buffer-without-query</span> ()
    <span class="org-doc">"Kill the current buffer without confirmation (if not modified)."</span>
    (<span class="org-keyword">interactive</span>)
    (kill-buffer nil))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Key binding.</span>
  (global-set-key (kbd <span class="org-string">"&lt;S-f12&gt;"</span>) #'leuven-kill-this-buffer-without-query)
</pre>
</div>
</div>
</div>

<div id="outline-container-org291962c" class="outline-3">
<h3 id="org291962c">Operating on Several Buffers</h3>
<div class="outline-text-3" id="text-org291962c">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 19.5 (info "(emacs)Several Buffers")</span>

  (leuven--section <span class="org-string">"19.5 (emacs)Several Buffers"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Put the current buffer at the end of the list of all buffers.</span>
  (global-set-key (kbd <span class="org-string">"&lt;M-f12&gt;"</span>) #'bury-buffer)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf3df0ef" class="outline-3">
<h3 id="orgf3df0ef">Convenience Features and Customization of Buffer Handling</h3>
<div class="outline-text-3" id="text-orgf3df0ef">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 19.7 (info "(emacs)Buffer Convenience") and Customization of Buffer Handling</span>

  (leuven--section <span class="org-string">"19.7 (emacs)Buffer Convenience and Customization of Buffer Handling"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Unique buffer names dependent on file name.</span>
  (try-require 'uniquify)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"uniquify"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Distinguish directories by adding extra separator.</span>
    (<span class="org-keyword">setq</span> uniquify-trailing-separator-p t))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 19 ends here.</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgd1b9835" class="outline-2">
<h2 id="orgd1b9835">Multiple Windows</h2>
<div class="outline-text-2" id="text-orgd1b9835">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 20 Multiple (info "(emacs)Windows")</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-20-windows <span class="org-string">"20 Multiple Windows"</span>
</pre>
</div>
</div>

<div id="outline-container-orgc0bcafe" class="outline-3">
<h3 id="orgc0bcafe">Concepts of Emacs Windows</h3>
<div class="outline-text-3" id="text-orgc0bcafe">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 20.1 (info "(emacs)Basic Window")</span>

  (leuven--section <span class="org-string">"20.1 (emacs)Basic Window"</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-org6ca990c" class="outline-3">
<h3 id="org6ca990c">Using Other Windows</h3>
<div class="outline-text-3" id="text-org6ca990c">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 20.3 (info "(emacs)Other Window")</span>

  (leuven--section <span class="org-string">"20.3 (emacs)Other Window"</span>)

  (global-set-key (kbd <span class="org-string">"&lt;f6&gt;"</span>) #'other-window)
</pre>
</div>

<p>
If there are two windows displayed, act like <code>C-x o</code>.
If there is only one window displayed, swap it with previous buffer.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-switch-to-other-window-or-buffer</span> ()
    <span class="org-doc">"If there is only one window displayed, swap it with previous buffer.</span>
<span class="org-doc">If there are two or more windows displayed, act like `</span><span class="org-doc"><span class="org-constant">other-window</span></span><span class="org-doc">':</span>
<span class="org-doc">cycle through all windows on current frame."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">if</span> (one-window-p t)
        (switch-to-buffer (other-buffer (current-buffer) 1))
      (other-window -1)))

  (global-set-key (kbd <span class="org-string">"&lt;f6&gt;"</span>) #'leuven-switch-to-other-window-or-buffer)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Reverse operation of `</span><span class="org-comment"><span class="org-constant">other-window</span></span><span class="org-comment">' (`C-x o').</span>
  (global-set-key (kbd <span class="org-string">"&lt;S-f6&gt;"</span>) #'previous-multiframe-window)
</pre>
</div>
</div>
</div>

<div id="outline-container-orge7c63d7" class="outline-3">
<h3 id="orge7c63d7">Deleting and Rearranging Windows</h3>
<div class="outline-text-3" id="text-orge7c63d7">
<p>
If there is only one window displayed, act like <code>C-x 2</code> or <code>C-x 3</code>.  If there are
two (or more) windows displayed, act like <code>C-x 1</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 20.5 (info "(emacs)Change Window")</span>

  (leuven--section <span class="org-string">"20.5 (emacs)Change Window"</span>)

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-delete-or-split-window</span> ()
    <span class="org-doc">"Cycle between 1 window and 2 windows.</span>

<span class="org-doc">  When splitting the window, the new window is selected, as it</span>
<span class="org-doc">  makes more sense to do something there first.</span>

<span class="org-doc">  The window's contents is unchanged by default.</span>

<span class="org-doc">  Do you want to see another part of the same file?  You've</span>
<span class="org-doc">  nothing to do.</span>

<span class="org-doc">  Do you want to see the last file you were visiting?  Simply</span>
<span class="org-doc">  bury the current buffer (M-&lt;F12&gt;).</span>

<span class="org-doc">  Do you want to go back to the first window?  Switch to</span>
<span class="org-doc">  it (&lt;F6&gt;)."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">cond</span> ((one-window-p t)
           (select-window
            (<span class="org-keyword">if</span> (&gt; (frame-width) split-width-threshold)
                (split-window-horizontally)
              (split-window-vertically))))
          (t
           (delete-other-windows))))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Delete all windows in the selected frame except the selected window.</span>
  (global-set-key (kbd <span class="org-string">"&lt;f5&gt;"</span>) #'leuven-delete-or-split-window)
</pre>
</div>

<p>
The following code flips a two-window frame, so that left is right, or up is
down.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Swap 2 windows.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-swap-windows</span> ()
    <span class="org-doc">"If you have 2 windows, swap them."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">cond</span> ((not (= (count-windows) 2))
           (message <span class="org-string">"[You need exactly 2 windows to swap them.]"</span>))
          (t
           (<span class="org-keyword">let*</span> ((wind-1 (first (window-list)))
                  (wind-2 (second (window-list)))
                  (buf-1 (window-buffer wind-1))
                  (buf-2 (window-buffer wind-2))
                  (start-1 (window-start wind-1))
                  (start-2 (window-start wind-2)))
             (set-window-buffer wind-1 buf-2)
             (set-window-buffer wind-2 buf-1)
             (set-window-start wind-1 start-2)
             (set-window-start wind-2 start-1)))))

  (global-set-key (kbd <span class="org-string">"C-c ~"</span>) #'leuven-swap-windows)
</pre>
</div>

<p>
The following code toggles between horizontal and vertical layout of two
windows.  Useful when Emacs opens the window below instead at the side.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-toggle-window-split</span> ()
    <span class="org-doc">"Toggle between vertical and horizontal split.</span>
<span class="org-doc">  Vertical split shows more of each line, horizontal split shows more lines.</span>
<span class="org-doc">  This code only works for frames with exactly two windows."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">cond</span> ((not (= (count-windows) 2))
           (message <span class="org-string">"[You need exactly 2 windows to toggle the window split.]"</span>))
          (t
           (<span class="org-keyword">let*</span> ((this-win-buffer (window-buffer))
                  (next-win-buffer (window-buffer (next-window)))
                  (this-win-edges (window-edges (selected-window)))
                  (next-win-edges (window-edges (next-window)))
                  (this-win-2nd (not (<span class="org-keyword">and</span> (&lt;= (car this-win-edges)
                                              (car next-win-edges))
                                          (&lt;= (cadr this-win-edges)
                                              (cadr next-win-edges)))))
                  (splitter
                   (<span class="org-keyword">if</span> (= (car this-win-edges)
                          (car (window-edges (next-window))))
                       'split-window-horizontally
                     'split-window-vertically)))
             (delete-other-windows)
             (<span class="org-keyword">let</span> ((first-win (selected-window)))
               (funcall splitter)
               (<span class="org-keyword">if</span> this-win-2nd (other-window 1))
               (set-window-buffer (selected-window) this-win-buffer)
               (set-window-buffer (next-window) next-win-buffer)
               (select-window first-win)
               (<span class="org-keyword">if</span> this-win-2nd (other-window 1)))))))

  (global-set-key (kbd <span class="org-string">"C-c |"</span>) #'leuven-toggle-window-split)
</pre>
</div>

<p>
<code>delete-window</code>: if only one window in frame, <code>delete-frame</code>:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defadvice</span> <span class="org-function-name">delete-window</span> (around delete-window (<span class="org-type">&amp;optional</span> window) activate)
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">save-current-buffer</span>
      (<span class="org-keyword">setq</span> window (<span class="org-keyword">or</span> window (selected-window)))
      (select-window window)
      (<span class="org-keyword">if</span> (one-window-p t)
      (delete-frame)
        ad-do-it (selected-window))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org053ca49" class="outline-3">
<h3 id="org053ca49">Dedicated windows</h3>
<div class="outline-text-3" id="text-org053ca49">
<p>
How to avoid displaying another buffer in a specific window, making the current
window always display this buffer (&ldquo;sticky window&rdquo;).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">toggle-current-window-dedication</span> ()
    <span class="org-doc">"Toggle whether the current active window is dedicated or not."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let*</span> ((window (selected-window))
           (dedicated (window-dedicated-p window)))
      (set-window-dedicated-p window (not dedicated))
      (message <span class="org-string">"[Window %sdedicated to %s]"</span>
               (<span class="org-keyword">if</span> dedicated <span class="org-string">"no longer "</span> <span class="org-string">""</span>)
               (buffer-name))))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Press [pause] key in each window you want to "freeze".</span>
  (global-set-key (kbd <span class="org-string">"&lt;pause&gt;"</span>) #'toggle-current-window-dedication)
</pre>
</div>
</div>
</div>

<div id="outline-container-org791b451" class="outline-3">
<h3 id="org791b451">Displaying a Buffer in a Window</h3>
<div class="outline-text-3" id="text-org791b451">
<p>
Splits screen vertically if the width of the window is large enough.
</p>

<p>
See
<a href="http://stackoverflow.com/questions/1381794/too-many-split-screens-opening-in-emacs">http://stackoverflow.com/questions/1381794/too-many-split-screens-opening-in-emacs</a>
for alternative code&#x2026;
</p>

<p>
See as well <code>split-window-preferred-function</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 20.6 (info "(emacs)Displaying Buffers")</span>

  (leuven--section <span class="org-string">"20.6 (emacs)Pop Up Window"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't allow splitting windows vertically.</span>
  (<span class="org-keyword">setq</span> split-height-threshold nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Minimum width for splitting windows horizontally.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq split-width-threshold (* 2 80))      ; See `</span><span class="org-comment"><span class="org-constant">split-window-sensibly</span></span><span class="org-comment">'.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org6fd38c2" class="outline-3">
<h3 id="org6fd38c2">Window Handling Convenience Features and Customization</h3>
<div class="outline-text-3" id="text-org6fd38c2">
<p>
Use <code>M-x scroll-all-mode</code> to scroll all visible windows together in parallel.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 20 ends here.</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb6826aa" class="outline-2">
<h2 id="orgb6826aa">Frames and Graphical Displays</h2>
<div class="outline-text-2" id="text-orgb6826aa">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 21 (info "(emacs)Frames") and Graphical Displays</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-21-frames <span class="org-string">"21 Frames and Graphical Displays"</span>
</pre>
</div>
</div>

<div id="outline-container-org4bcb063" class="outline-3">
<h3 id="org4bcb063">Mouse Commands for Editing</h3>
<div class="outline-text-3" id="text-org4bcb063">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 21.1 (info "(emacs)Mouse Commands")</span>

  (leuven--section <span class="org-string">"21.1 (emacs)Mouse Commands"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Scroll one line at a time.</span>
  (<span class="org-keyword">setq</span> mouse-wheel-scroll-amount
        '(1
          ((shift) . 1)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Paste at text-cursor, not at mouse-cursor.</span>
  (<span class="org-keyword">setq</span> mouse-yank-at-point t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org9675dac" class="outline-3">
<h3 id="org9675dac">Creating Frames</h3>
<div class="outline-text-3" id="text-org9675dac">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 21.6 (info "(emacs)Creating Frames")</span>

  (leuven--section <span class="org-string">"21.6 (emacs)Creating Frames"</span>)
</pre>
</div>

<ol class="org-ol">
<li>Resize the frame to the size you want.</li>
<li>Enter <code>(frame-parameters)</code> in the <code>*scratch*</code> buffer.</li>
<li>Evaluate the form: place the cursor after the closing parenthesis, and type
<code>C-j</code>, so that the output goes right into the <code>*scratch*</code> buffer.</li>
</ol>

<p>
By putting customizations of <code>default-frame-alist</code> in your init file, you can
control the appearance of <b>all the frames</b> Emacs creates, including the initial
one.
</p>

<div class="note">
<p>
<code>initial-frame-alist</code> is just for overriding properties for the first frame.
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">when</span> (display-graphic-p)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Put Emacs exactly where you want it, every time it starts up.</span>
    (<span class="org-keyword">setq</span> initial-frame-alist
          '((top . 0)
            (left . 0)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Auto-detect the screen dimensions and compute the height of Emacs.</span>
    (add-to-list 'default-frame-alist
                 (cons 'height
                       (/ (-
                           <span class="org-comment-delimiter">;; </span><span class="org-comment">Height of Display 1.</span>
                           (nth 4
                                (assq 'geometry
                                      (car (display-monitor-attributes-list)))) <span class="org-comment-delimiter">; </span><span class="org-comment">XXX Emacs 24.4 needed!</span>
                           177)       <span class="org-comment-delimiter">; </span><span class="org-comment">Allow for Emacs' title bar and taskbar</span>
                                      <span class="org-comment-delimiter">; </span><span class="org-comment">(from the OS).</span>
                          (frame-char-height)))))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Title bar display of visible frames.</span>
  (<span class="org-keyword">setq</span> frame-title-format
        (format <span class="org-string">"%s Emacs%s %s%s of %s - PID: %d"</span>
                (replace-regexp-in-string <span class="org-string">"-.*$"</span> <span class="org-string">""</span>
                                          (capitalize (symbol-name system-type)))
                (<span class="org-keyword">if</span> (string-match <span class="org-string">"^x86_64-.*"</span> system-configuration)
                    <span class="org-string">"-w64"</span>
                  <span class="org-string">"-w32"</span>)
                emacs-version
                (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> (boundp 'emacs-repository-version)
                         emacs-repository-version)
                    (concat <span class="org-string">" ("</span> (substring
                                  (replace-regexp-in-string
                                   <span class="org-string">" .*"</span> <span class="org-string">""</span> emacs-repository-version) 0 7) <span class="org-string">")"</span>)
                  <span class="org-string">""</span>)
                (format-time-string <span class="org-string">"%Y-%m-%d"</span> emacs-build-time)
                (emacs-pid)))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-detach-window</span> ()
    <span class="org-doc">"Close current window and re-open it in new frame."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let</span> ((current-buffer (window-buffer)))
      (delete-window)
      (select-frame (make-frame))
      (set-window-buffer (selected-window) current-buffer)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org0945091" class="outline-3">
<h3 id="org0945091">Frame Commands</h3>
<div class="outline-text-3" id="text-org0945091">
<dl class="org-dl">
<dt><code>toggle-frame-maximized</code> (M-&lt;F10&gt; by default)</dt><dd>Toggle maximization state of the selected frame.  Respect window manager
screen decorations.</dd>

<dt><code>toggle-frame-fullscreen</code> (&lt;F11&gt; by default)</dt><dd>Toggle fullscreen mode of the selected frame.  <b>Hide window manager screen
decorations</b>, giving slightly more screen space to Emacs itself.</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 21.7 (info "(emacs)Frame Commands")</span>

  (leuven--section <span class="org-string">"21.7 (emacs)Frame Commands"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Maximize Emacs frame by default.</span>
  (modify-all-frames-parameters '((fullscreen . maximized)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Full screen.</span>
  (global-set-key (kbd <span class="org-string">"&lt;C-S-f12&gt;"</span>) #'toggle-frame-fullscreen)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfc38d63" class="outline-3">
<h3 id="orgfc38d63">Speedbar Frames</h3>
<div class="outline-text-3" id="text-orgfc38d63">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 21.9 (info "(emacs)Speedbar")</span>

  (leuven--section <span class="org-string">"21.9 (emacs)Speedbar Frames"</span>)

  (<span class="org-keyword">unless</span> (<span class="org-keyword">featurep</span> '<span class="org-constant">helm-config</span>)       <span class="org-comment-delimiter">; </span><span class="org-comment">Helm is better than speedbar!</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Jump to speedbar frame.</span>
    (global-set-key (kbd <span class="org-string">"&lt;f4&gt;"</span>) #'speedbar-get-focus))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Everything browser (into individual source files), or Dired on steroids.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"speedbar"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Number of spaces used for indentation.</span>
    (<span class="org-keyword">setq</span> speedbar-indentation-width 2)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add new extensions for speedbar tagging (allow to expand/collapse</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">sections, etc.) -- do this BEFORE firing up speedbar?</span>
    (speedbar-add-supported-extension
     '(<span class="org-string">".bib"</span> <span class="org-string">".css"</span> <span class="org-string">".jpg"</span> <span class="org-string">".js"</span> <span class="org-string">".nw"</span> <span class="org-string">".org"</span> <span class="org-string">".php"</span> <span class="org-string">".png"</span> <span class="org-string">".R"</span> <span class="org-string">".tex"</span> <span class="org-string">".txt"</span>
       <span class="org-string">".w"</span> <span class="org-string">"README"</span>))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Bind the arrow keys in the speedbar tree.</span>
    (define-key speedbar-mode-map (kbd <span class="org-string">"&lt;right&gt;"</span>) #'speedbar-expand-line)
    (define-key speedbar-mode-map (kbd <span class="org-string">"&lt;left&gt;"</span>)  #'speedbar-contract-line)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Parameters to use when creating the speedbar frame in Emacs.</span>
    (<span class="org-keyword">setq</span> speedbar-frame-parameters '((width . 30)
                                      (height . 45)
                                      (foreground-color . <span class="org-string">"blue"</span>)
                                      (background-color . <span class="org-string">"white"</span>)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Speedbar in the current frame (vs in a new frame).</span>
    (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> (not (locate-library <span class="org-string">"helm-config"</span>))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Helm is better than speedbar!</span>
               (locate-library <span class="org-string">"sr-speedbar"</span>))

      (autoload 'sr-speedbar-toggle <span class="org-string">"sr-speedbar"</span> nil t)
      (global-set-key (kbd <span class="org-string">"&lt;f4&gt;"</span>) #'sr-speedbar-toggle)))
</pre>
</div>

<p>
See NeoTree as well.
</p>
</div>
</div>

<div id="outline-container-org75e4721" class="outline-3">
<h3 id="org75e4721">Scroll Bars</h3>
<div class="outline-text-3" id="text-org75e4721">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 21.12 (info "(emacs)Scroll Bars")</span>

  (leuven--section <span class="org-string">"21.12 (emacs)Scroll Bars"</span>)

  (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> (display-graphic-p)
           <span class="org-comment-delimiter">;; </span><span class="org-comment">(featurep 'powerline)</span>
           )

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Turn scroll bar off.</span>
      (scroll-bar-mode -1)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Position of the vertical scroll bar.</span>
    (<span class="org-keyword">setq-default</span> vertical-scroll-bar 'right))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdcebcd4" class="outline-3">
<h3 id="orgdcebcd4">Tool Bars</h3>
<div class="outline-text-3" id="text-orgdcebcd4">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 21.15 (info "(emacs)Tool Bars")</span>

  (leuven--section <span class="org-string">"21.15 (emacs)Tool Bars"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Turn tool bar off.</span>
  (<span class="org-keyword">when</span> (display-graphic-p)
    (tool-bar-mode -1))
</pre>
</div>
</div>
</div>

<div id="outline-container-org94769d2" class="outline-3">
<h3 id="org94769d2">Using Dialog Boxes</h3>
<div class="outline-text-3" id="text-org94769d2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 21.16 Using (info "(emacs)Dialog Boxes")</span>

  (leuven--section <span class="org-string">"21.16 (emacs)Using Dialog Boxes"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't use dialog boxes to ask questions.</span>
  (<span class="org-keyword">setq</span> use-dialog-box nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't use a file dialog to ask for files.</span>
  (<span class="org-keyword">setq</span> use-file-dialog nil)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfe862f2" class="outline-3">
<h3 id="orgfe862f2">Tooltips</h3>
<div class="outline-text-3" id="text-orgfe862f2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 21.17 (info "(emacs)Tooltips")</span>

  (leuven--section <span class="org-string">"21.17 (emacs)Tooltips"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Disable Tooltip mode (use the echo area for help and GUD tooltips).</span>
  (<span class="org-keyword">unless</span> leuven--console-p (tooltip-mode -1))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 21 ends here.</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org3a64455" class="outline-2">
<h2 id="org3a64455">International Character Set Support</h2>
<div class="outline-text-2" id="text-org3a64455">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 22 (info "(emacs)International") Character Set Support</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-22-international <span class="org-string">"22 International Character Set Support"</span>
</pre>
</div>

<p>
For any user who needs symbols that are not in the 7-bit ASCII set, our
recommendation is to move to Unicode UTF-8.  That is the only encoding that is
the same across all platforms and operating systems that support it.
</p>

<p>
To check your locale settings, you can have a look to what Emacs produce (in a
mail buffer) under &ldquo;Important settings&rdquo; when you type
<code>M-x report-emacs-bug RET foo RET</code>:
</p>

<p>
<b>Important settings</b>:
</p>
<ul class="org-ul">
<li>value of <code>$LC_ALL</code>: <code>nil</code></li>
<li>value of <code>$LC_COLLATE</code>: <code>nil</code></li>
<li>value of <code>$LC_CTYPE</code>: <code>nil</code></li>
<li>value of <code>$LC_MESSAGES</code>: <code>nil</code></li>
<li>value of <code>$LC_MONETARY</code>: <code>nil</code></li>
<li>value of <code>$LC_NUMERIC</code>: <code>nil</code></li>
<li>value of <code>$LC_TIME</code>: <code>nil</code></li>
<li>value of <code>$LANG</code>: <code>en_US.UTF-8</code></li>
<li>value of <code>$XMODIFIERS</code>: <code>nil</code></li>
<li><code>locale-coding-system</code>: <code>utf-8-unix</code></li>
<li><code>default-enable-multibyte-characters</code>: <code>t</code></li>
</ul>

<div class="note">
<p>
If <code>LANG</code> is set, that&rsquo;s enough: all the <code>LC_*</code> default to whatever <code>LANG</code> says, but
you can override them if you set them explicitly.
</p>

</div>
</div>

<div id="outline-container-org24547f1" class="outline-3">
<h3 id="org24547f1">Introduction to International Character Sets</h3>
<div class="outline-text-3" id="text-org24547f1">
<div class="tip">
<p>
To open (or save) a file in UTF-8, you can press <code>C-x RET c utf-8 RET</code>
(<code>universal-coding-system-argument</code>) before the <code>C-x C-f</code> (or <code>C-x C-s</code>).
</p>

</div>

<p>
To help you find all the chars you need to replace by escape sequences, you can
use <code>C-u C-s [^[:ascii:]]</code>.
</p>

<p>
<code>M-x describe-coding-system RET RET</code>
</p>

<p>
To see all the non-ASCII characters you can type with the <code>C-x 8</code> prefix, type
<code>C-x 8 C-h</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 22.1 (info "(emacs)International Chars")</span>

  (leuven--section <span class="org-string">"22.1 (emacs)International Chars"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Keyboard input definitions for ISO 8859-1.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"iso-transl"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add binding for "zero width space".</span>
    (define-key iso-transl-ctl-x-8-map (kbd <span class="org-string">"0"</span>) [?​]))
</pre>
</div>
</div>
</div>

<div id="outline-container-org7592e62" class="outline-3">
<h3 id="org7592e62">Language Environments</h3>
<div class="outline-text-3" id="text-org7592e62">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 22.2 (info "(emacs)Language Environments")</span>

  (leuven--section <span class="org-string">"22.2 (emacs)Language Environments"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Specify your character-set locale.</span>
  (setenv <span class="org-string">"LANG"</span> <span class="org-string">"en_US.utf8"</span>)          <span class="org-comment-delimiter">; </span><span class="org-comment">For `</span><span class="org-comment"><span class="org-constant">svn</span></span><span class="org-comment">' not to report warnings.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">System locale to use for formatting time values.</span>
  (<span class="org-keyword">setq</span> system-time-locale <span class="org-string">"C"</span>)         <span class="org-comment-delimiter">; </span><span class="org-comment">Make sure that the weekdays in the</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">time stamps of your Org mode files and</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">in the agenda appear in English.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq system-time-locale (getenv "LANG"))</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">For weekdays in your locale settings.</span>
</pre>
</div>

<p>
One could use:
</p>
<ul class="org-ul">
<li><code>LC_ALL</code>,</li>
<li><code>LC_COLLATE=C</code> (or <code>LC_COLLATE=POSIX</code>),</li>
<li><code>LC_CTYPE</code>,</li>
<li><code>LC_ALL</code> or</li>
<li><code>LANG</code></li>
</ul>

<p>
but this won&rsquo;t work for a Windows binary (well for the Cygwin version) of Emacs.
</p>
</div>
</div>

<div id="outline-container-orgb5350c6" class="outline-3">
<h3 id="orgb5350c6">Input Methods</h3>
<div class="outline-text-3" id="text-orgb5350c6">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 22.3 (info "(emacs)Input Methods")</span>

  (leuven--section <span class="org-string">"22.3 (emacs)Input Methods"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Get 8-bit characters in terminal mode (Cygwin Emacs).</span>
  (set-input-mode (car (current-input-mode))
                  (nth 1 (current-input-mode))
                  0)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-list-unicode-display</span> (<span class="org-type">&amp;optional</span> regexp)
    <span class="org-doc">"Display a list of unicode characters and their names in a buffer."</span>
    (<span class="org-keyword">interactive</span> <span class="org-string">"sRegexp (default \".*\"): "</span>)
    (<span class="org-keyword">let*</span> ((regexp (<span class="org-keyword">or</span> regexp <span class="org-string">".*"</span>))
           (case-fold-search t)
           (cmp #'(lambda (x y) (&lt; (cdr x) (cdr y))))
           <span class="org-comment-delimiter">;; </span><span class="org-comment">alist like ("name" . code-point).</span>
           (char-alist (sort (cl-remove-if-not #'(lambda (x) (string-match regexp (car x)))
                                               (ucs-names))
                             cmp)))
      (<span class="org-keyword">with-help-window</span> <span class="org-string">"*Unicode characters*"</span>
        (<span class="org-keyword">with-current-buffer</span> standard-output
          (<span class="org-keyword">dolist</span> (c char-alist)
            (insert (format <span class="org-string">"0x%06X\t"</span> (cdr c)))
            (insert (cdr c))
            (insert (format <span class="org-string">"\t%s\n"</span> (car c))))))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgaf14607" class="outline-3">
<h3 id="orgaf14607">Recognizing Coding Systems</h3>
<div class="outline-text-3" id="text-orgaf14607">
<p>
In GNU Emacs, when you specify the coding explicitly in the file via an explicit
<code>coding:</code> cookie, that overrides <code>file-coding-system-alist</code>.
</p>

<p>
XXX Declare PDF files as binary
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 22.6 (info "(emacs)Recognize Coding") Systems</span>

  (leuven--section <span class="org-string">"22.6 (emacs)Recognize Coding Systems"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Default coding system (for new files), also moved to the front of the</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">priority list for automatic detection.</span>
  (prefer-coding-system 'utf-8-unix)    <span class="org-comment-delimiter">; </span><span class="org-comment">Unix flavor for code blocks executed</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">via Org-Babel.</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">https://lists.gnu.org/archive/html/gnu-emacs-sources/2005-12/msg00005.html</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">leuven--do-accent</span> (subst-list)
  <span class="org-doc">"Utility cleanup function."</span>
  (<span class="org-keyword">dolist</span> (pair subst-list)
    (<span class="org-keyword">save-excursion</span>
      (<span class="org-keyword">while</span> (re-search-forward (car pair) nil t)
        (replace-match (cdr pair) t)))))

(<span class="org-keyword">defun</span> <span class="org-function-name">leuven-cleanup-accent-iso-latin-1-to-utf-8</span> ()
  <span class="org-doc">"Replace non-UTF-8 characters."</span>
  (<span class="org-keyword">interactive</span>)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">See https://www.fileformat.info/info/charset/UTF-8/list.htm, then type</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">C-x 8 RET and then the number, followed by RET.</span>
  (leuven--do-accent '((<span class="org-string">"\200"</span> . <span class="org-string">"EUR"</span>)  <span class="org-comment-delimiter">;; </span><span class="org-comment">\342\202\254</span>
                       (<span class="org-string">"\205"</span> . <span class="org-string">"..."</span>)
                       (<span class="org-string">"\222"</span> . <span class="org-string">"’"</span>)    <span class="org-comment-delimiter">;; </span><span class="org-comment">\342\200\231</span>
                       (<span class="org-string">"\223"</span> . <span class="org-string">"\""</span>)
                       (<span class="org-string">"\224"</span> . <span class="org-string">"\""</span>)
                       (<span class="org-string">"\226"</span> . <span class="org-string">"-"</span>)
                       (<span class="org-string">"\227"</span> . <span class="org-string">"--"</span>)
                       (<span class="org-string">"\234"</span> . <span class="org-string">"oe"</span>)
                       (<span class="org-string">"\240"</span> . <span class="org-string">" "</span>)    <span class="org-comment-delimiter">;; </span><span class="org-comment">\302\240</span>
                       (<span class="org-string">"\251"</span> . <span class="org-string">"©"</span>)
                       (<span class="org-string">"\253"</span> . <span class="org-string">"«"</span>)
                       (<span class="org-string">"\260"</span> . <span class="org-string">"°"</span>)
                       (<span class="org-string">"\272"</span> . <span class="org-string">"°"</span>)
                       (<span class="org-string">"\273"</span> . <span class="org-string">"»"</span>)
                       (<span class="org-string">"\277"</span> . <span class="org-string">"¿"</span>)
                       (<span class="org-string">"\300"</span> . <span class="org-string">"À"</span>)
                       (<span class="org-string">"\307"</span> . <span class="org-string">"Ç"</span>)
                       (<span class="org-string">"\311"</span> . <span class="org-string">"É"</span>)
                       (<span class="org-string">"\312"</span> . <span class="org-string">"Ê"</span>)
                       (<span class="org-string">"\340"</span> . <span class="org-string">"à"</span>)    <span class="org-comment-delimiter">;; </span><span class="org-comment">\303\240</span>
                       (<span class="org-string">"\341"</span> . <span class="org-string">"á"</span>)    <span class="org-comment-delimiter">;; </span><span class="org-comment">\303\241</span>
                       (<span class="org-string">"\342"</span> . <span class="org-string">"â"</span>)    <span class="org-comment-delimiter">;; </span><span class="org-comment">\303\242</span>
                       (<span class="org-string">"\344"</span> . <span class="org-string">"ä"</span>)
                       (<span class="org-string">"\347"</span> . <span class="org-string">"ç"</span>)
                       (<span class="org-string">"\350"</span> . <span class="org-string">"è"</span>)    <span class="org-comment-delimiter">;; </span><span class="org-comment">\303\250</span>
                       (<span class="org-string">"\351"</span> . <span class="org-string">"é"</span>)    <span class="org-comment-delimiter">;; </span><span class="org-comment">\303\251</span>
                       (<span class="org-string">"\352"</span> . <span class="org-string">"ê"</span>)
                       (<span class="org-string">"\353"</span> . <span class="org-string">"ë"</span>)
                       (<span class="org-string">"\355"</span> . <span class="org-string">"í"</span>)
                       (<span class="org-string">"\356"</span> . <span class="org-string">"î"</span>)
                       (<span class="org-string">"\357"</span> . <span class="org-string">"ï"</span>)
                       (<span class="org-string">"\361"</span> . <span class="org-string">"ñ"</span>)
                       (<span class="org-string">"\363"</span> . <span class="org-string">"ó"</span>)    <span class="org-comment-delimiter">;; </span><span class="org-comment">\303\263</span>
                       (<span class="org-string">"\364"</span> . <span class="org-string">"ô"</span>)    <span class="org-comment-delimiter">;; </span><span class="org-comment">\303\264</span>
                       (<span class="org-string">"\365"</span> . <span class="org-string">"õ"</span>)
                       (<span class="org-string">"\366"</span> . <span class="org-string">"ö"</span>)
                       (<span class="org-string">"\371"</span> . <span class="org-string">"ù"</span>)
                       (<span class="org-string">"\372"</span> . <span class="org-string">"ú"</span>)
                       (<span class="org-string">"\373"</span> . <span class="org-string">"û"</span>)    <span class="org-comment-delimiter">;; </span><span class="org-comment">\303\273</span>
                       (<span class="org-string">"\374"</span> . <span class="org-string">"ü"</span>)    <span class="org-comment-delimiter">;; </span><span class="org-comment">\303\274</span>
                       )))
</pre>
</div>
</div>
</div>

<div id="outline-container-org50ff135" class="outline-3">
<h3 id="org50ff135">Specifying a File&rsquo;s Coding System</h3>
<div class="outline-text-3" id="text-org50ff135">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 22.7 (info "(emacs)Specify Coding") System of a File</span>

  (leuven--section <span class="org-string">"22.7 (emacs)Specify Coding System of a File"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">To copy and paste to and from Emacs through the clipboard (with coding</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">system conversion).</span>
  (<span class="org-keyword">cond</span> (leuven--win32-p
         (set-selection-coding-system 'compound-text-with-extensions))
        (t
         (set-selection-coding-system 'utf-8)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdf11622" class="outline-3">
<h3 id="orgdf11622">Bidirectional Editing</h3>
<div class="outline-text-3" id="text-orgdf11622">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 22.19 (info "(emacs)Bidirectional Editing")</span>

  (leuven--section <span class="org-string">"22.19 (emacs)Bidirectional Editing"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Faster scrolling (if you never expect to have to display bidirectional</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">scripts, such as Arabic and Hebrew).</span>
  (<span class="org-keyword">setq-default</span> bidi-paragraph-direction 'left-to-right)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 22 ends here.</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf93b2d2" class="outline-2">
<h2 id="orgf93b2d2">Major and Minor Modes</h2>
<div class="outline-text-2" id="text-orgf93b2d2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 23 (info "(emacs)Modes")</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-23-major-and-minor-modes <span class="org-string">"23 Major and Minor Modes"</span>
</pre>
</div>
</div>

<div id="outline-container-org9a7b621" class="outline-3">
<h3 id="org9a7b621">How Major Modes are Chosen</h3>
<div class="outline-text-3" id="text-org9a7b621">
<p>
See &ldquo;Syntax of Regexps&rdquo;:
</p>
<ul class="org-ul">
<li><code>\'</code> matches end of string</li>
<li><code>$</code> matches end of line</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 23.3 (info "(emacs)Choosing Modes")</span>

  (leuven--section <span class="org-string">"23.3 (emacs)Choosing File Modes"</span>)
</pre>
</div>
</div>

<div id="outline-container-org6041f5f" class="outline-4">
<h4 id="org6041f5f">Choice based on the file name</h4>
<div class="outline-text-4" id="text-org6041f5f">
<p>
Instead of superseding the binding in <code>auto-mode-alist</code>, you can replace it
(brute force) with <code>(setcdr (rassq 'old-mode auto-mode-alist) 'new-mode)</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">List of filename patterns.</span>
  (<span class="org-keyword">setq</span> auto-mode-alist
        (append '((<span class="org-string">"\\.log\\'"</span>       . text-mode)
                  <span class="org-comment-delimiter">;; </span><span class="org-comment">("\\.[tT]e[xX]\\'" . latex-mode)</span>
                  <span class="org-comment-delimiter">;; </span><span class="org-comment">("\\.cls\\'"       . LaTeX-mode)</span>
                  (<span class="org-string">"\\.cgi\\'"</span>       . perl-mode)
                  <span class="org-comment-delimiter">;; </span><span class="org-comment">("[mM]akefile"     . makefile-mode)</span>
                  (<span class="org-string">".ssh/config\\'"</span>  . ssh-config-mode)
                  (<span class="org-string">"sshd?_config\\'"</span> . ssh-config-mode)
                  ) <span class="org-warning">auto-mode-alist))</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Major mode for fontifiying ssh config files.</span>
  (autoload 'ssh-config-mode <span class="org-string">"ssh-config-mode"</span>
    <span class="org-doc">"Major mode for fontifiying ssh config files."</span> t)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Helper code for use with the "ledger" command-line tool.</span>
  (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.dat\\'"</span> . ledger-mode))
  (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.journal\\'"</span> . ledger-mode))
  (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.ledger\\'"</span> . ledger-mode))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ledger-commodities"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Default commodity for use in target calculations in ledger reconcile.</span>
    (<span class="org-keyword">setq</span> ledger-reconcile-default-commodity <span class="org-string">"EUR"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">"€"</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Provide custom fontification for ledger-mode.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ledger-fontify"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">If t, the highlight entire xact with state.</span>
    (<span class="org-keyword">setq</span> ledger-fontify-xact-state-overrides nil))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Don't override the highlighting of</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">each posted item in a xact if it is</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">cleared/pending. XXX</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ledger-init"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq ledger-default-date-format "%Y-%m-%d")</span>
    (<span class="org-keyword">setq</span> ledger-default-date-format <span class="org-string">"%Y/%m/%d"</span>)
    )

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"flycheck"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Flycheck integration for ledger files.</span>
    (try-require 'flycheck-ledger))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Major mode for editing comma-separated value files.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"csv-mode-autoloads"</span>

    (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.csv\\'"</span> . csv-mode)))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"csv-mode"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Field separators: a list of *single-character* strings.</span>
    (<span class="org-keyword">setq</span> csv-separators '(<span class="org-string">","</span> <span class="org-string">";"</span>)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgea358f6" class="outline-4">
<h4 id="orgea358f6">Choice based on the interpreter name</h4>
<div class="outline-text-4" id="text-orgea358f6">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">List of interpreters specified in the first line (starts with `#!').</span>
  (<span class="org-keyword">push</span> '(<span class="org-string">"expect"</span> . tcl-mode) interpreter-mode-alist)
</pre>
</div>
</div>
</div>

<div id="outline-container-org93e370a" class="outline-4">
<h4 id="org93e370a">Choice based on the text at the start of the buffer</h4>
<div class="outline-text-4" id="text-org93e370a">
<p>
For a list of buffer beginnings, see <code>magic-mode-alist</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Load generic modes which support e.g. batch files.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(try-require 'generic-x)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 23 ends here.</span>
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org472b030" class="outline-2">
<h2 id="org472b030">Indentation</h2>
<div class="outline-text-2" id="text-org472b030">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 24 (info "(emacs)Indentation")</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-24-indentation <span class="org-string">"24 Indentation"</span>
</pre>
</div>
</div>

<div id="outline-container-org2de6df4" class="outline-3">
<h3 id="org2de6df4">Indentation Commands</h3>
<div class="outline-text-3" id="text-org2de6df4">
<dl class="org-dl">
<dt><code>M-m</code></dt><dd><code>back-to-indentation</code>.</dd>

<dt><code>C-M-\</code></dt><dd>Run the command <code>indent-region</code> (which does the job of the imaginary command
<code>unsuck-html-layout</code> in <code>html-mode</code>).</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 24.1 (info "(emacs)Indentation Commands") and Techniques</span>

  (leuven--section <span class="org-string">"24.1 (emacs)Indentation Commands and Techniques"</span>)

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-indent-buffer</span> ()
    <span class="org-doc">"Indent each non-blank line in the buffer."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">save-excursion</span>
      (indent-region (point-min) (point-max) nil)))
</pre>
</div>

<p>
<b>Code alignment</b> (align declarations).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-align-code</span> (begin end)
    <span class="org-doc">"Align region to equal signs and colons."</span>
    (<span class="org-keyword">interactive</span> <span class="org-string">"r"</span>)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Keep them separate align calls, otherwise colons align with spaces if</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">they're in the same region.</span>
    (align-regexp begin end <span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">\\s-*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">="</span> 1 1)
    (align-regexp begin end <span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">\\s-*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">:"</span> 1 1))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Align your code in a pretty way.</span>
  (global-set-key (kbd <span class="org-string">"C-x \\"</span>) #'leuven-align-code)
  (global-set-key (kbd <span class="org-string">"C-c ="</span>)  #'leuven-align-code)
</pre>
</div>

<p>
For example,
</p>

<pre class="example">
var first = 3,
    second = "oh my god!",
    last = "but not least";
</pre>

<p>
gets reindented like this:
</p>

<pre class="example">
var first  = 3,
    second = "oh my god!",
    last   = "but not least";
</pre>

<div class="tip">
<p>
For <b>filling code</b> (<b>pretty-format</b>&rsquo;ting it, auto-inserting newlines, indents,
etc.), see <code>uncrustify</code>.
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Show vertical lines to guide indentation.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"indent-guide-autoloads-XXX"</span> <span class="org-comment-delimiter">; </span><span class="org-comment">Display problems with CrossMapIntegration.java</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable indent-guide-mode automatically.</span>
    (add-hook 'prog-mode-hook #'indent-guide-mode))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"indent-guide"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Character used as vertical line.</span>
    (<span class="org-keyword">setq</span> indent-guide-char
          (<span class="org-keyword">cond</span> ((char-displayable-p ?\u254E) <span class="org-string">"╎"</span>)
                ((char-displayable-p ?\u2502) <span class="org-string">"│"</span>)
                (t <span class="org-string">":"</span>)))

    (diminish 'indent-guide-mode))
</pre>
</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Look at the `dtrt-indent&rsquo; package</b><br />
nil</div>
</div>
</div>

<div id="outline-container-org99c3b98" class="outline-3">
<h3 id="org99c3b98">Tabs vs. Spaces</h3>
<div class="outline-text-3" id="text-org99c3b98">
<p>
Don&rsquo;t tabify.  Instead, <span class="underline">reindent</span> everything, e.g. with <code>C-M-\</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 24.3 TABs vs. (info "(emacs)Just Spaces")</span>

  (leuven--section <span class="org-string">"24.3 TABs vs. (emacs)Just Spaces"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Indentation can't insert TABs.</span>
  (<span class="org-keyword">setq-default</span> indent-tabs-mode nil)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb37c68b" class="outline-3">
<h3 id="orgb37c68b">Convenience Features for Indentation</h3>
<div class="outline-text-3" id="text-orgb37c68b">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq tab-always-indent 'complete)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 24 ends here.</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb04fefd" class="outline-2">
<h2 id="orgb04fefd">Commands for Human Languages</h2>
<div class="outline-text-2" id="text-orgb04fefd">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 25 Commands for (info "(emacs)Text") Human Languages</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-25-text <span class="org-string">"25 Commands for Human Languages"</span>
</pre>
</div>
</div>

<div id="outline-container-orgf1b59e7" class="outline-3">
<h3 id="orgf1b59e7">Words</h3>
<div class="outline-text-3" id="text-orgf1b59e7">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 25.1 (info "(emacs)Words")</span>

  (leuven--section <span class="org-string">"25.1 (emacs)Words"</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-org485b297" class="outline-3">
<h3 id="org485b297">Sentences</h3>
<div class="outline-text-3" id="text-org485b297">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 25.2 (info "(emacs)Sentences")</span>

  (leuven--section <span class="org-string">"25.2 (emacs)Sentences"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; A single space does end a sentence.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq-default sentence-end-double-space nil) ; see `</span><span class="org-comment"><span class="org-constant">ispell-dictionary</span></span><span class="org-comment">'</span>
</pre>
</div>

<p>
The default value of <code>sentence-end-double-space</code> is good for French as well, as
we put two spaces after a interrogation/question mark. That way, those two
spaces won&rsquo;t be transformed into one&#x2026;
</p>
</div>
</div>

<div id="outline-container-org524cc58" class="outline-3">
<h3 id="org524cc58">Filling Text</h3>
<div class="outline-text-3" id="text-org524cc58">
<p>
There are several <b>no-break space</b> characters required for French punctuation:
</p>

<ul class="org-ul">
<li><b>No-break thin space</b> (<code>202F</code>), known in Unicode as &ldquo;narrow no-break space&rdquo;,
required before <code>?</code>, <code>!</code> and <code>;</code>.</li>

<li><p>
<b>No-break space</b> (<code>00A0</code>), required before <code>:</code> and <code>»</code>, and required after <code>«</code>.
</p>

<p>
It can be inserted with <code>S-SPC</code>:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-nbsp-command</span> ()
    <span class="org-doc">"Insert the no-break space character 00A0."</span>
    (<span class="org-keyword">interactive</span>)
    (insert-char ?\u00A0))

  (global-set-key (kbd <span class="org-string">"S-SPC"</span>) #'leuven-nbsp-command)
</pre>
</div></li>
</ul>

<p>
They could be used to avoid breaking at certain bad places.
</p>

<p>
Another solution to avoid that is to add <code>fill-french-nobreak-p</code> to
<code>fill-nobreak-predicate</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 25.5 (info "(emacs)Filling") Text</span>

  (leuven--section <span class="org-string">"25.5 (emacs)Filling Text"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Line-wrapping beyond that column (when pressing `</span><span class="org-comment"><span class="org-constant">M-q</span></span><span class="org-comment">').</span>
  (<span class="org-keyword">setq-default</span> fill-column 80)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(Un-)fill paragraph.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-fill-or-unfill-paragraph</span> (count)
    <span class="org-doc">"Like `</span><span class="org-doc"><span class="org-constant">fill-paragraph</span></span><span class="org-doc">', but unfill if used twice."</span>
    (<span class="org-keyword">interactive</span> <span class="org-string">"P"</span>)
    (<span class="org-keyword">let</span> ((fill-column
           (<span class="org-keyword">if</span> count
               (prefix-numeric-value count)
             (<span class="org-keyword">if</span> (eq last-command 'leuven-fill-or-unfill-paragraph)
                 (<span class="org-keyword">progn</span> (<span class="org-keyword">setq</span> this-command nil)
                        (point-max))
               fill-column))))
      (fill-paragraph)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">M-q.</span>
  (global-set-key [remap fill-paragraph] #'leuven-fill-or-unfill-paragraph)
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (define-key org-mode-map (kbd <span class="org-string">"M-q"</span>) #'leuven-fill-or-unfill-paragraph))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Prevent breaking lines just before a punctuation mark such as `?' or `:'.</span>
  (add-hook 'fill-nobreak-predicate #'fill-french-nobreak-p)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Activate Auto Fill for all text mode buffers.</span>
  (add-hook 'text-mode-hook #'auto-fill-mode)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-replace-nbsp-by-spc</span> ()
    <span class="org-doc">"Replace all nbsp by normal spaces."</span>
    (<span class="org-keyword">interactive</span> <span class="org-string">"*"</span>)
    (<span class="org-keyword">save-excursion</span>
      (<span class="org-keyword">save-restriction</span>
        (<span class="org-keyword">save-match-data</span>
          (<span class="org-keyword">progn</span>
            (goto-char (point-min))
            (<span class="org-keyword">while</span> (re-search-forward <span class="org-string">"[  ]"</span> nil t)
              (replace-match <span class="org-string">" "</span> nil nil)))))))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-good-old-fill-paragraph</span> ()
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let</span> ((fill-paragraph-function nil)
          (adaptive-fill-function nil))
      (fill-paragraph)))
</pre>
</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Replace &rsquo; by `&rsquo; in Emacs Lisp and by `` in other modes</b><br />
nil</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">(defun leuven-smart-punctuation-apostrophe ()</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">"Replace second apostrophe by backquote in front of symbol."</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(interactive)</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(cond</span>
  <span class="org-comment-delimiter">;;    </span><span class="org-comment">((or (bolp) (not (looking-back "'")))</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">;; Insert just one '.</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">(self-insert-command 1))</span>
  <span class="org-comment-delimiter">;;    </span><span class="org-comment">((save-excursion</span>
  <span class="org-comment-delimiter">;;       </span><span class="org-comment">(backward-char)</span>
  <span class="org-comment-delimiter">;;       </span><span class="org-comment">;; Skip symbol backwards.</span>
  <span class="org-comment-delimiter">;;       </span><span class="org-comment">(and (not (zerop (skip-syntax-backward "w_.")))</span>
  <span class="org-comment-delimiter">;;            </span><span class="org-comment">(not (looking-back "`"))</span>
  <span class="org-comment-delimiter">;;            </span><span class="org-comment">(or (insert-and-inherit "`") t))))</span>
  <span class="org-comment-delimiter">;;    </span><span class="org-comment">(t</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">;; Insert `' around following symbol.</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">(delete-char -1)</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">(unless (looking-back "`") (insert-and-inherit "`"))</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">(save-excursion</span>
  <span class="org-comment-delimiter">;;       </span><span class="org-comment">(skip-syntax-forward "w_.")</span>
  <span class="org-comment-delimiter">;;       </span><span class="org-comment">(unless (looking-at "'") (insert-and-inherit "'"))))))</span>

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-smart-punctuation-quotation-mark</span> ()
    <span class="org-doc">"Replace two following double quotes by French quotes."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let</span> ((dict (<span class="org-keyword">or</span> (<span class="org-keyword">when</span> (boundp 'ispell-local-dictionary)
                      ispell-local-dictionary)
                    (<span class="org-keyword">when</span> (boundp 'ispell-dictionary)
                      ispell-dictionary))))
      (message <span class="org-string">"[&gt;&gt;&gt; %s]"</span> major-mode)
      (<span class="org-keyword">cond</span>
       ((<span class="org-keyword">and</span> (string= dict <span class="org-string">"francais"</span>)
             (eq (char-before) ?\")
             (<span class="org-keyword">or</span> (not (equal mode-name <span class="org-string">"Org"</span>))
                 (not (member (org-element-type (org-element-at-point))
                              '(src-block keyword table dynamic-block)))))
        (backward-delete-char 1)
        (insert <span class="org-string">"«  »"</span>)
        (backward-char 2))
       ((<span class="org-keyword">and</span> (eq (char-before) ?\")
             (derived-mode-p 'latex-mode))
        (backward-delete-char 1)
        (insert <span class="org-string">"\\enquote{}"</span>)
        (backward-char 1))
       (t
        (insert <span class="org-string">"\""</span>)))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--smart-punctuation</span> ()
    <span class="org-doc">"Replace second apostrophe or quotation mark."</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(local-set-key [39] #'leuven-smart-punctuation-apostrophe)</span>
    (local-set-key <span class="org-string">"\""</span> #'leuven-smart-punctuation-quotation-mark))

  (add-hook 'text-mode-hook #'leuven--smart-punctuation)
  (add-hook 'message-mode-hook #'leuven--smart-punctuation)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"key-chord-autoloads"</span>
    (key-chord-mode 1))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Map pairs of simultaneously pressed keys to commands.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"key-chord"</span>

    (key-chord-define-global <span class="org-string">"&lt;&lt;"</span> #'(lambda () (<span class="org-keyword">interactive</span>) (insert <span class="org-string">"«"</span>)))
    (key-chord-define-global <span class="org-string">"&gt;&gt;"</span> #'(lambda () (<span class="org-keyword">interactive</span>) (insert <span class="org-string">"»"</span>)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global "hb" #'describe-bindings) ; dashboard.</span>
    (key-chord-define-global <span class="org-string">"hf"</span> #'describe-function)
    (key-chord-define-global <span class="org-string">"hv"</span> #'describe-variable)

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"expand-region-autoloads"</span> <span class="org-comment-delimiter">; </span><span class="org-comment">Autoloads file.</span>
      (key-chord-define-global <span class="org-string">"hh"</span> #'er/expand-region) <span class="org-comment-delimiter">; </span><span class="org-comment">Autoloaded.</span>
      (key-chord-define-global <span class="org-string">"HH"</span> #'er/contract-region)) <span class="org-comment-delimiter">; </span><span class="org-comment">Autoloaded.</span>

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"avy-autoloads"</span>
      (key-chord-define-global <span class="org-string">"jj"</span> #'avy-goto-word-or-subword-1))

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"dired-x"</span>
      (key-chord-define-global <span class="org-string">"xj"</span> #'dired-jump)) <span class="org-comment-delimiter">; </span><span class="org-comment">Autoloaded?</span>

    (key-chord-define-global <span class="org-string">"vb"</span> #'eval-buffer)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global "vg" #'eval-region) ; 2015-02-17 Crash Gnus `C-u g'</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global "x0" #'delete-window) ; 2015-02-09 Crash Gnus `C-u 3'</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global "x1" #'delete-other-windows) ; 2015-02-05 Crash Gnus `C-u 1'</span>
    (key-chord-define-global <span class="org-string">"xh"</span> #'mark-whole-buffer)
    (key-chord-define-global <span class="org-string">"xk"</span> #'kill-buffer)
    (key-chord-define-global <span class="org-string">"xo"</span> #'other-window) <span class="org-comment-delimiter">; </span><span class="org-comment">box...</span>
    (key-chord-define-global <span class="org-string">"xs"</span> #'save-buffer)

    (key-chord-define-global <span class="org-string">"yy"</span> #'browse-kill-ring)
    (key-chord-define-global <span class="org-string">"zk"</span> #'zap-to-char)

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"hl-anything-autoloads"</span>    <span class="org-comment-delimiter">; </span><span class="org-comment">Package.</span>
      (key-chord-define-global <span class="org-string">"*o"</span> #'hl-global-highlight-on/off)
      (key-chord-define-global <span class="org-string">"*h"</span> #'hl-highlight-thingatpt-global)
      (key-chord-define-global <span class="org-string">"*u"</span> #'hl-unhighlight-all-global)
      (key-chord-define-global <span class="org-string">"*n"</span> #'hl-find-next-thing)
      (key-chord-define-global <span class="org-string">"*p"</span> #'hl-find-prev-thing)
      (key-chord-define-global <span class="org-string">"*r"</span> #'hl-restore-highlights)
      (key-chord-define-global <span class="org-string">"*s"</span> #'hl-save-highlights))

    (key-chord-define-global <span class="org-string">";s"</span> #'set-mark-command)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global "ac" #'align-current)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global "fc" #'flycheck-mode)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "M-2") #'highlight-symbol-occur)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "M-3") #'(lambda () (interactive) (highlight-symbol-jump -1)))</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "M-4") #'(lambda () (interactive) (highlight-symbol-jump 1)))</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global "vg" #'vc-git-grep)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global "''" "`'\C-b")</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global "dq" "\"\"\C-b")</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global ";d" #'dired-jump-other-window)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global "jk" #'dabbrev-expand)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global "JJ" #'xref-find-definitions)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global ",." "&lt;&gt;\C-b")</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global "''" "`'\C-b")</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(key-chord-define-global ",," #'indent-for-comment)</span>
    )
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcca4d53" class="outline-3">
<h3 id="orgcca4d53">Case Conversion Commands</h3>
<div class="outline-text-3" id="text-orgcca4d53">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 25.6 (info "(emacs)Case") Conversion Commands</span>

  (leuven--section <span class="org-string">"25.6 (emacs)Case Conversion Commands"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable the use of some commands without confirmation.</span>
  (mapc #'(lambda (command)
          (put command 'disabled nil))
        <span class="org-comment-delimiter">;; </span><span class="org-comment">Disabled commands.</span>
        '(downcase-region
          upcase-region))
</pre>
</div>
</div>
</div>

<div id="outline-container-orga906bd8" class="outline-3">
<h3 id="orga906bd8">Outline Mode</h3>
<div class="outline-text-3" id="text-orga906bd8">
<p>
Outline is line-oriented and does not distinguish end-of-block.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 25.8 (info "(emacs)Outline Mode")</span>

  (leuven--section <span class="org-string">"25.8 (emacs)Outline Mode"</span>)
</pre>
</div>
</div>

<div id="outline-container-orgd3c20cc" class="outline-4">
<h4 id="orgd3c20cc"><span class="todo TODO">TODO</span> outline-minor-mode (inside plain latex-mode as well)</h4>
<div class="outline-text-4" id="text-orgd3c20cc">
<p>
Though Outline minor mode has NOTHING to do with folding of code as such, some
people have the following code in their <code>ruby-mode-hook</code> to enable code folding
using <code>outline-minor-mode</code> + <code>outline-magic</code>.
</p>

<pre class="example">
(outline-minor-mode 1)
(set (make-local-variable 'outline-regexp) "^[ \t]*\\(?:def\\|class\\|module\\)\\|^[ \t]*###==")
</pre>

<p>
Outline minor mode is also used to collapse Lisp code (i.e., to see in the
buffer just the definition of a function instead of the whole body).
</p>

<p>
See also the library <a href="#org3e27d98">hs-minor-mode</a>.
</p>

<p>
You can use <code>org-cycle</code> in other modes, with <code>outline-minor-mode</code>.
</p>

<p>
See <a href="https://github.com/zk-phi/dotfiles/blob/master/emacs/init.el">https://github.com/zk-phi/dotfiles/blob/master/emacs/init.el</a>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Outline mode commands for Emacs.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"outline"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Bind the outline minor mode functions to an easy to remember prefix</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">key (more accessible than the horrible prefix `C-c @').</span>
    (<span class="org-keyword">setq</span> outline-minor-mode-prefix (kbd <span class="org-string">"C-c C-o"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">like in nXML mode</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Make other `</span><span class="org-comment"><span class="org-constant">outline-minor-mode</span></span><span class="org-comment">' files (LaTeX, etc.) feel the Org</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; mode outline navigation (written by Carsten Dominik).</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(try-require 'outline-magic)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "outline-magic"</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(add-hook 'outline-minor-mode-hook</span>
    <span class="org-comment-delimiter">;;             </span><span class="org-comment">#'(lambda ()</span>
    <span class="org-comment-delimiter">;;               </span><span class="org-comment">(define-key outline-minor-mode-map</span>
    <span class="org-comment-delimiter">;;                 </span><span class="org-comment">(kbd "&lt;S-tab&gt;") #'outline-cycle)</span>
    <span class="org-comment-delimiter">;;               </span><span class="org-comment">(define-key outline-minor-mode-map</span>
    <span class="org-comment-delimiter">;;                 </span><span class="org-comment">(kbd "&lt;M-left&gt;") #'outline-promote)</span>
    <span class="org-comment-delimiter">;;               </span><span class="org-comment">(define-key outline-minor-mode-map</span>
    <span class="org-comment-delimiter">;;                 </span><span class="org-comment">(kbd "&lt;M-right&gt;") #'outline-demote)</span>
    <span class="org-comment-delimiter">;;               </span><span class="org-comment">(define-key outline-minor-mode-map</span>
    <span class="org-comment-delimiter">;;                 </span><span class="org-comment">(kbd "&lt;M-up&gt;") #'outline-move-subtree-up)</span>
    <span class="org-comment-delimiter">;;               </span><span class="org-comment">(define-key outline-minor-mode-map</span>
    <span class="org-comment-delimiter">;;                 </span><span class="org-comment">(kbd "&lt;M-down&gt;") #'outline-move-subtree-down))))</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Extra support for outline minor mode.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(try-require 'out-xtra)</span>


    <span class="org-comment-delimiter">;; </span><span class="org-comment">Org-style folding for a `</span><span class="org-comment"><span class="org-constant">.emacs</span></span><span class="org-comment">' (and much more).</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">FIXME This should be in an `</span><span class="org-comment"><span class="org-constant">eval-after-load</span></span><span class="org-comment">' of Org, so that</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">org-level-N</span></span><span class="org-comment">' are defined when used</span>

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--outline-regexp</span> ()
      <span class="org-doc">"Calculate the outline regexp for the current mode."</span>
      (<span class="org-keyword">let</span> ((comment-starter (replace-regexp-in-string
                              <span class="org-string">"[[:space:]]+"</span> <span class="org-string">""</span> comment-start)))
        (<span class="org-keyword">when</span> (string= comment-start <span class="org-string">";"</span>)
          (<span class="org-keyword">setq</span> comment-starter <span class="org-string">";;"</span>))
        <span class="org-comment-delimiter">;; </span><span class="org-comment">(concat "^" comment-starter "\\*+")))</span>
        (concat <span class="org-string">"^"</span> comment-starter <span class="org-string">"[*]+ "</span>)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Fontify the whole line for headings (with a background color).</span>
    (<span class="org-keyword">setq</span> org-fontify-whole-heading-line t)

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--outline-minor-mode-hook</span> ()
      (<span class="org-keyword">setq</span> outline-regexp (leuven--outline-regexp))
      (<span class="org-keyword">let*</span> ((org-fontify-whole-headline-regexp <span class="org-string">""</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">"\n?")</span>
             (heading-1-regexp
              (concat (substring outline-regexp 0 -1)
                      <span class="org-string">"\\{1\\} </span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">.*"</span> org-fontify-whole-headline-regexp <span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span>))
             (heading-2-regexp
              (concat (substring outline-regexp 0 -1)
                      <span class="org-string">"\\{2\\} </span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">.*"</span> org-fontify-whole-headline-regexp <span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span>))
             (heading-3-regexp
              (concat (substring outline-regexp 0 -1)
                      <span class="org-string">"\\{3\\} </span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">.*"</span> org-fontify-whole-headline-regexp <span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span>))
             (heading-4-regexp
              (concat (substring outline-regexp 0 -1)
                      <span class="org-string">"\\{4,\\} </span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">.*"</span> org-fontify-whole-headline-regexp <span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span>)))
        (font-lock-add-keywords nil
         `((,heading-1-regexp 1 'org-level-1 t)
           (,heading-2-regexp 1 'org-level-2 t)
           (,heading-3-regexp 1 'org-level-3 t)
           (,heading-4-regexp 1 'org-level-4 t)))))

    (add-hook 'outline-minor-mode-hook #'leuven--outline-minor-mode-hook)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add the following as the top line of your `</span><span class="org-comment"><span class="org-constant">.emacs</span></span><span class="org-comment">':</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">; -*- mode: emacs-lisp; eval: (outline-minor-mode 1); -*-</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Now you can add `;;' and `;;*', etc. as headings in your `</span><span class="org-comment"><span class="org-constant">.emacs</span></span><span class="org-comment">'</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">and cycle using `</span><span class="org-comment"><span class="org-constant">&lt;S-tab&gt;</span></span><span class="org-comment">', `</span><span class="org-comment"><span class="org-constant">&lt;M-left&gt;</span></span><span class="org-comment">' and `</span><span class="org-comment"><span class="org-constant">&lt;M-right&gt;</span></span><span class="org-comment">' will collapse</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">or expand all headings respectively.  I am guessing you mean to make</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">segments such as `;; SHORTCUTS' and `;; VARIABLES', this will do</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">that, but not too much more.</span>
    )
</pre>
</div>

<p>
For Emacs Lisp, Stefan Monnier additionally uses:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (add-hook 'outline-minor-mode-hook
              #'(lambda ()
                  (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> outline-minor-mode (derived-mode-p 'emacs-lisp-mode))
                    (hide-sublevels 1000))))
</pre>
</div>

<p>
which starts outline-minor-mode by hiding all the bodies of functions.
</p>

<p>
He also uses <code>reveal-mode</code> which automatically unhides the bodies when you try to
move the cursor into them (so you don&rsquo;t need to remember the key sequences to
use for opening/closing elements).
</p>
</div>
</div>

<div id="outline-container-org6d078aa" class="outline-4">
<h4 id="org6d078aa">org-global-cycle + outline-magic</h4>
<div class="outline-text-4" id="text-org6d078aa">
<p>
The visibility-cycling features are written in a way that they are independent
of the outline setup.  The following setup provides standard Org mode
functionality (headline folding and unfolding) in <code>outline-minor-mode</code> on
<code>C-TAB</code> and <code>S-TAB</code>.  We use <code>C-TAB</code> instead of <code>TAB</code>, because <code>TAB</code> usually
has mode-specific tasks.
</p>

<p>
Note that for <code>C-TAB</code> to work, the cursor needs to be on a headline (the line
where the ellipsis shows).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'outline-minor-mode-hook</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">#'(lambda ()</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">(define-key outline-minor-mode-map (kbd "&lt;C-tab&gt;") #'org-cycle)</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">(define-key outline-minor-mode-map (kbd "&lt;S-tab&gt;") #'org-global-cycle))) ; backtab?</span>
</pre>
</div>

<p>
Now doing
</p>

<p>
M-x find-library RET ox.el RET
</p>

<p>
S-TAB (one or more times)
</p>

<p>
will give you a give quick overview of all the function names.
</p>

<p>
Or check out <code>outline-magic.el</code>, which does this and also provides <b>promotion and
demotion</b> functionality.
</p>
</div>
</div>

<div id="outline-container-org177384b" class="outline-4">
<h4 id="org177384b">org</h4>
<div class="outline-text-4" id="text-org177384b">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  (global-set-key (kbd <span class="org-string">"&lt;S-tab&gt;"</span>) #'org-cycle) <span class="org-comment-delimiter">; </span><span class="org-comment">that works (but on level 1+)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">TODO Look at org-cycle-global and local below, they work better, but</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">still on level 1+</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">TODO Replace it by a function which alternatively does `</span><span class="org-comment"><span class="org-constant">hide-body</span></span><span class="org-comment">' and</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">show-all</span></span><span class="org-comment">'</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org5f7932f" class="outline-4">
<h4 id="org5f7932f">org-struct-mode</h4>
<div class="outline-text-4" id="text-org5f7932f">
<p>
&gt; Experienced users use outline-minor-mode - It takes time to getting used to
&gt; it.
</p>

<p>
You can also use <code>orgstruct-mode</code>, a minor mode that comes with <code>org-mode</code>.
</p>

<p>
<code>org-global-cycle</code> (!= <code>org-cycle-global</code>) now works fine in buffers using
<code>orgstruct-mode</code>.
</p>

<p>
As for handling &ldquo;large&rdquo; files, I use this:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">from Bastien</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; XXX 2010-06-21 Conflicts with outline-minor-mode bindings</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; add a hook to use `</span><span class="org-comment"><span class="org-constant">orgstruct-mode</span></span><span class="org-comment">' in Emacs Lisp buffers</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'emacs-lisp-mode-hook #'orgstruct-mode)</span>

  (<span class="org-keyword">defun</span> <span class="org-function-name">org-cycle-global</span> ()
    (<span class="org-keyword">interactive</span>)
    (org-cycle t))

  (global-set-key (kbd <span class="org-string">"C-M-]"</span>) #'org-cycle-global)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">XXX ok on Emacs Lisp, not on LaTeX</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">S-TAB?</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(defun org-cycle-local ()</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(interactive)</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(save-excursion</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">(move-beginning-of-line nil)</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">(org-cycle)))</span>

  (<span class="org-keyword">defun</span> <span class="org-function-name">org-cycle-local</span> ()
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">ignore-errors</span>
      (end-of-defun)
      (beginning-of-defun))
    (org-cycle))

  (global-set-key (kbd <span class="org-string">"M-]"</span>) #'org-cycle-local)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">XXX ok on Emacs Lisp, not on LaTeX</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">C-M-] and M-] fold the whole buffer or the current defun.</span>
</pre>
</div>

<p>
I made a video to demonstrate it quickly: <a href="https://vimeo.com/55570133">navigating-emacs</a>.
</p>

<p>
This helps me survive in files like <code>org.el</code> and <code>org-agenda.el</code>.
</p>
</div>
</div>

<div id="outline-container-org0dcf6bd" class="outline-4">
<h4 id="org0dcf6bd">fold-dwim</h4>
<div class="outline-text-4" id="text-org0dcf6bd">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-c +") #'fold-dwim-toggle)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-c C-+") #'fold-dwim-show-all)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-c C--") #'fold-dwim-hide-all)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgee7e61e" class="outline-4">
<h4 id="orgee7e61e">fold-dwim-org</h4>
<div class="outline-text-4" id="text-orgee7e61e">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Unified user interface for Emacs folding modes, bound to Org key-strokes.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(try-require 'fold-dwim-org)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">25.8.2</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Toggle display of invisible text.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-toggle-show-everything</span> (<span class="org-type">&amp;optional</span> arg)
    <span class="org-doc">"Show all invisible text."</span>
    (<span class="org-keyword">interactive</span> (list (<span class="org-keyword">or</span> current-prefix-arg 'toggle)))
    (<span class="org-keyword">if</span> (derived-mode-p 'prog-mode)
        (hs-show-all)
      (visible-mode arg)))

  (global-set-key (kbd <span class="org-string">"M-A"</span>) #'leuven-toggle-show-everything) <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">M-S-a</span></span><span class="org-comment">'.</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">hs-hide-all</span> nil <span class="org-doc">"Current state of hideshow for toggling all."</span>)
(make-local-variable 'hs-hide-all)

(<span class="org-keyword">defun</span> <span class="org-function-name">hs-toggle-hiding-all</span> ()
  <span class="org-doc">"Toggle hideshow all."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">setq</span> hs-hide-all (not hs-hide-all))
  (<span class="org-keyword">if</span> hs-hide-all
      (hs-hide-all)
    (hs-show-all)))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org7b19fd4" class="outline-3">
<h3 id="org7b19fd4">Boxquote</h3>
<div class="outline-text-3" id="text-org7b19fd4">
<p>
Use Unicode characters.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(emacs-goodies-el)boxquote")</span>

  (leuven--section <span class="org-string">"(emacs-goodies-el)boxquote"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"boxquote-autoloads"</span>
    (global-set-key (kbd <span class="org-string">"C-c q"</span>) #'boxquote-region))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"boxquote"</span>
    (<span class="org-keyword">setq</span> boxquote-top-and-tail  <span class="org-string">"────"</span>)
    (<span class="org-keyword">setq</span> boxquote-title-format  <span class="org-string">" %s"</span>)
    (<span class="org-keyword">setq</span> boxquote-top-corner    <span class="org-string">"  ┌"</span>)
    (<span class="org-keyword">setq</span> boxquote-side          <span class="org-string">"  │ "</span>)
    (<span class="org-keyword">setq</span> boxquote-bottom-corner <span class="org-string">"  └"</span>))
</pre>
</div>

<p>
In Gnus, you can mark some region with enclosing tags by pressing <code>C-c M-m</code>
(<code>message-mark-inserted-region</code>) or by clicking on <code>&lt;menu-bar&gt; &lt;Message&gt; &lt;Insert
Region Marked&gt;</code>.
</p>

<pre class="example">
--8&lt;---------------cut here---------------start-------------&gt;8---
...
...
...
--8&lt;---------------cut here---------------end---------------&gt;8---
</pre>
</div>
</div>

<div id="outline-container-org4b137b2" class="outline-3">
<h3 id="org4b137b2">Phonetic</h3>
<div class="outline-text-3" id="text-org4b137b2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "phonetic")</span>

  (leuven--section <span class="org-string">"phonetic"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Phonetic spelling.</span>
  (<span class="org-keyword">when</span> (locate-library <span class="org-string">"phonetic"</span>)
    (autoload 'phonetize-region <span class="org-string">"phonetic"</span>
      <span class="org-doc">"Translate the region according to the phonetic alphabet."</span> t))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 25 ends here.</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orge51d507" class="outline-2">
<h2 id="orge51d507">Org Mode (Getting Things Done)</h2>
<div class="outline-text-2" id="text-orge51d507">
<ul class="org-ul">
<li>40 variables most frequently customized in Org
<a href="http://orgmode.org/worg/org-configs/org-customization-survey.html">http://orgmode.org/worg/org-configs/org-customization-survey.html</a></li>

<li>Org config examples
<a href="http://repo.or.cz/w/Worg.git/tree/HEAD:/org-configs">http://repo.or.cz/w/Worg.git/tree/HEAD:/org-configs</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 25.10 Org Mode</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">(info "(org)Top") outline-based notes management and organizer</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-25.10-org-mode <span class="org-string">"25.10 Getting Things Done (with Org mode)"</span>
</pre>
</div>

<p>
After all the configuration has been done, you can easily manage your daily
work and tasks with Org mode.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 1 (info "(org)Introduction")</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 1.2 (info "(org)Installation")</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Autoloads.</span>
  (try-require 'org-loaddefs)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Getting started.</span>
  (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.txt\\'"</span> . org-mode))
  (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.org\\'"</span> . org-mode))
  (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.org_archive\\'"</span> . org-mode))

  (global-set-key (kbd <span class="org-string">"C-c l"</span>) #'org-store-link)
  (global-set-key (kbd <span class="org-string">"C-c c"</span>) #'org-capture)
  (global-set-key (kbd <span class="org-string">"C-c a"</span>) #'org-agenda)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Using links outside Org.</span>
  (global-set-key (kbd <span class="org-string">"C-c L"</span>) #'org-insert-link-global)
  (global-set-key (kbd <span class="org-string">"C-c O"</span>) #'org-open-at-point-global)

  (<span class="org-keyword">when</span> (<span class="org-keyword">or</span> (not (boundp 'org-agenda-files))
            (null org-agenda-files))
    (message <span class="org-string">"[Found no entries in `</span><span class="org-string"><span class="org-constant">org-agenda-files</span></span><span class="org-string">']"</span>)
    (sit-for 1.5))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Display the Org mode manual in Info mode.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-h o") #'org-info) ; In Emacs 25: describe-symbol.</span>
    <span class="org-comment-delimiter">;;                                     </span><span class="org-comment">; XXX Not autoloaded.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Unbind `</span><span class="org-comment"><span class="org-constant">C-j</span></span><span class="org-comment">' and `</span><span class="org-comment"><span class="org-constant">C-</span></span><span class="org-comment">''.</span>
    (define-key org-mode-map (kbd <span class="org-string">"C-j"</span>) nil)
    (define-key org-mode-map (kbd <span class="org-string">"C-'"</span>) nil) <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">org-cycle-agenda-files</span></span><span class="org-comment">'.</span>
    (define-key org-mode-map (kbd <span class="org-string">"&lt;C-S-down&gt;"</span>) nil)
    (define-key org-mode-map (kbd <span class="org-string">"&lt;C-S-up&gt;"</span>) nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Double-clicking on the fringe cycles the corresponding subtree.</span>
    (define-key org-mode-map (kbd <span class="org-string">"&lt;left-fringe&gt; &lt;double-mouse-1&gt;"</span>) #'org-cycle))
</pre>
</div>

<p>
These variables need to be set before Org mode is loaded.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">These variables need to be set before org.el is loaded...</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Face to be used by `</span><span class="org-comment"><span class="org-constant">font-lock</span></span><span class="org-comment">' for highlighting in Org mode Emacs</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; buffers, and tags to be used to convert emphasis fontifiers for HTML</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; export. XXX Format changed! XXX</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-emphasis-alist              ; Remove the strike-through emphasis.</span>
  <span class="org-comment-delimiter">;;       </span><span class="org-comment">'(("*" bold "&lt;b&gt;" "&lt;/b&gt;")</span>
  <span class="org-comment-delimiter">;;         </span><span class="org-comment">("/" italic "&lt;i&gt;" "&lt;/i&gt;")</span>
  <span class="org-comment-delimiter">;;         </span><span class="org-comment">("_" underline "&lt;span style=\"text-decoration:underline;\"&gt;" "&lt;/span&gt;")</span>
  <span class="org-comment-delimiter">;;         </span><span class="org-comment">("=" org-verbatim "&lt;code&gt;" "&lt;/code&gt;" verbatim)</span>
  <span class="org-comment-delimiter">;;         </span><span class="org-comment">("~" org-code "&lt;code&gt;" "&lt;/code&gt;" verbatim)))</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-emphasis-alist</span>
  <span class="org-comment-delimiter">;;       </span><span class="org-comment">'(("&amp;" (:weight ultra-bold :foreground "#000000" :background "#FBFF00"))</span>
  <span class="org-comment-delimiter">;;         </span><span class="org-comment">;; ("?" (:box t))</span>
  <span class="org-comment-delimiter">;;         </span><span class="org-comment">("!" (:weight ultra-bold :foreground "#B40000")) ; = alert in some Wikis</span>
</pre>
</div>

<p>
<code>org-emphasis-alist</code> has a <code>:set</code> handler <code>org-set-emph-re</code> which will do the job of
setting up the regexps. I don&rsquo;t want to call <code>org-set-emph-re</code> directly, instead
I set <code>org-emphasis-alist</code> to itself and let the customize interface call the
handler for me.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Allow both single and double quotes in the border.</span>
    (setcar (nthcdr 2 org-emphasis-regexp-components) <span class="org-string">" \t\r\n,"</span>)
    (custom-set-variables `(org-emphasis-alist ',org-emphasis-alist)))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Single character alphabetical bullets (a, b, c, ..., X, Y, Z) are allowed.</span>
  (<span class="org-keyword">setq</span> org-list-allow-alphabetical t)
</pre>
</div>

<p>
If you use <code>org-emphasis-alist</code> to do simple highlighting, you should better use
<a href="http://www.emacswiki.org/emacs/AddKeywords">font-lock-add-keywords</a>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Libraries that should (always) be loaded along with `</span><span class="org-comment"><span class="org-constant">org.el</span></span><span class="org-comment">'</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(loaded when opening the first Org file).</span>
  (<span class="org-keyword">setq</span> org-modules nil)
</pre>
</div>

<p>
Original value was:
</p>
<ul class="org-ul">
<li><code>org-bbdb</code></li>
<li><code>org-bibtex</code></li>
<li><code>org-docview</code></li>
<li><code>org-gnus</code></li>
<li><code>org-info</code></li>
<li><code>org-jsinfo</code></li>
<li><code>org-irc</code></li>
<li><code>org-mew</code></li>
<li><code>org-mhe</code></li>
<li><code>org-rmail</code></li>
<li><code>org-vm</code></li>
<li><code>org-w3m</code></li>
<li><code>org-wl</code></li>
</ul>

<p>
When you have <code>org-id</code> in <code>org-modules</code>, unique <b>ID&rsquo;s</b> are generated when you link
to a task (using <code>org-id-get-create</code>) &#x2014; instead of links containing <b>headline
text</b>.
</p>

<p>
ID&rsquo;s are saved in <code>~/.emacs.d/.org-id-locations</code> on my system (see
<code>org-id-locations-file</code>).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Check that org-checklist is found before adding it!</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">;; Set the RESET_CHECK_BOXES and LIST_EXPORT_BASENAME properties in items as</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">;; needed.</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(add-to-list 'org-modules 'org-checklist) ; From org-contrib.</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Globally unique ID for Org mode entries (see `</span><span class="org-comment"><span class="org-constant">org-store-link</span></span><span class="org-comment">')</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(takes care of automatically creating unique targets for internal</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">links, see `C-h v org-id-link-to-org-use-id RET').</span>
  (add-to-list 'org-modules 'org-id)
</pre>
</div>

<div class="note">
<p>
If you want to insert a <b>link to a file</b> in an Org mode document, you can also
call <code>org-insert-link</code> (<code>C-c C-l</code>) with a <code>C-u</code> prefix (to get the regular <code>find-file</code>
interface).
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Support for links to Gnus groups and messages from within Org mode.</span>
  (add-to-list 'org-modules 'org-gnus)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Habit tracking code for Org mode.</span>
  (add-to-list 'org-modules 'org-habit)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Make sure to turn `</span><span class="org-comment"><span class="org-constant">org-info</span></span><span class="org-comment">' on in order to link to info nodes.</span>
  (add-to-list 'org-modules 'org-info)
</pre>
</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Look at other modules</b><br />
<ul class="org-ul">
<li><code>org-eval</code></li>
<li><code>org-eval-light</code></li>
<li><code>org-exp-bibtex</code></li>
<li><code>org-exp-blocks</code> (supported by the new exporter out of the box)</li>
<li><code>org-man</code></li>
<li><code>org-mouse</code></li>
<li><code>org-mtags</code></li>
<li><code>org-panel</code></li>
<li><code>org-R</code></li>
</ul>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (add-hook 'org-mode-hook
            #'(lambda ()
                <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Create a binding for `</span><span class="org-comment"><span class="org-constant">org-show-subtree</span></span><span class="org-comment">'.</span>
                <span class="org-comment-delimiter">;; </span><span class="org-comment">(local-set-key (kbd "C-c C-S-s") #'org-show-subtree)</span>
                <span class="org-comment-delimiter">;; </span><span class="org-comment">(local-set-key (kbd "C-c s") #'org-show-subtree)</span>

                <span class="org-comment-delimiter">;; </span><span class="org-comment">(local-set-key (kbd "C-c h") #'hide-other) ; XXX Helm</span>

                <span class="org-comment-delimiter">;; </span><span class="org-comment">Remove some bindings.</span>
                (local-unset-key (kbd <span class="org-string">"C-c SPC"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">Used by Ace Jump.</span>
                (local-unset-key (kbd <span class="org-string">"C-c C-&lt;"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">Used by Multiple Cursors.</span>
                <span class="org-comment-delimiter">;; </span><span class="org-comment">(local-unset-key (kbd "C-c %")) ; XXX</span>
                <span class="org-comment-delimiter">;; </span><span class="org-comment">(local-unset-key (kbd "C-c &amp;")) ; XXX</span>

                ))
</pre>
</div>

<div class="note">
<p>
See <code>(define-key flyspell-mode-map (kbd "C-;") nil))</code> for an alternative manner of
unsetting local keys?
</p>

</div>
</div>

<div id="outline-container-org2dafa96" class="outline-4">
<h4 id="org2dafa96">Activation</h4>
<div class="outline-text-4" id="text-org2dafa96">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"[... Org Introduction]"</span>)

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 1.3 (info "(org)Activation")</span>

    (leuven--section <span class="org-string">"1.3 (org)Activation"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Insert the first line setting Org mode in empty files.</span>
    (<span class="org-keyword">setq</span> org-insert-mode-line-in-empty-file t))
</pre>
</div>
</div>
</div>

<div id="outline-container-org5e1153b" class="outline-3">
<h3 id="org5e1153b">Document Structure</h3>
<div class="outline-text-3" id="text-org5e1153b">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 2 (info "(org)Document Structure")</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"[... Org Document Structure]"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Ellipsis to use in the Org mode outline.</span>
    (<span class="org-keyword">if</span> (char-displayable-p ?\u25BA)    <span class="org-comment-delimiter">; </span><span class="org-comment">This test takes ~ 0.40s hence,</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">wrapped in `</span><span class="org-comment"><span class="org-constant">with-eval-after-load</span></span><span class="org-comment">'.</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">String (black right-pointing pointer).</span>
        (<span class="org-keyword">setq</span> org-ellipsis <span class="org-string">" \u25BA"</span>)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Face.</span>
      (set-face-attribute 'org-ellipsis nil
                          <span class="org-builtin">:box</span> '(<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#999999"</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">#929490</span>
                          <span class="org-builtin">:foreground</span> <span class="org-string">"#999999"</span> <span class="org-builtin">:background</span> <span class="org-string">"#FFF8C0"</span>
                          <span class="org-builtin">:underline</span> nil)

      (<span class="org-keyword">setq</span> org-ellipsis 'org-ellipsis)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">RET follows links (except in tables, where you must use `C-c C-o').</span>
  (<span class="org-keyword">setq</span> org-return-follows-link t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Blank lines.</span>
  (<span class="org-keyword">setq</span> org-blank-before-new-entry
        '(<span class="org-comment-delimiter">;; </span><span class="org-comment">Insert  a blank line before new heading.</span>
          (heading . t)

          <span class="org-comment-delimiter">;; </span><span class="org-comment">Try to make an intelligent decision whether to insert a</span>
          <span class="org-comment-delimiter">;; </span><span class="org-comment">blank line or not before a new item.</span>
          (plain-list-item . auto)))
</pre>
</div>
</div>

<div id="outline-container-orgb7ffb09" class="outline-4">
<h4 id="orgb7ffb09">Headlines</h4>
<div class="outline-text-4" id="text-orgb7ffb09">
<p>
<code>C-e</code> goes <b>right before</b> the end of the invisible region and <code>TAB</code> will unfold as
expected, both in a folded subtree or in a folded drawer.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(org)Headlines")</span>

  (leuven--section <span class="org-string">"2.2 (org)Headlines"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; `</span><span class="org-comment"><span class="org-constant">C-a</span></span><span class="org-comment">' and `</span><span class="org-comment"><span class="org-constant">C-e</span></span><span class="org-comment">' behave specially in headlines and items.</span>
  (<span class="org-keyword">setq</span> org-special-ctrl-a/e 'reversed)
</pre>
</div>

<p>
The package <code>org-inlinetask.el</code> (for <b>tasks independent of outline hierarchy</b>)
installs the key binding <code>C-c C-x t</code> to insert a new <b>inline task</b>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"[... Org Headlines]"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Insert an inline task (independent of outline hierarchy).</span>
    (try-require 'org-inlinetask))      <span class="org-comment-delimiter">; </span><span class="org-comment">Needed.</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-inlinetask"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Initial state (TODO keyword) of inline tasks.</span>
    (<span class="org-keyword">setq</span> org-inlinetask-default-state <span class="org-string">"TODO"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Template for inline tasks in HTML exporter.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(defun leuven--org-html-format-inlinetask</span>
    <span class="org-comment-delimiter">;;     </span><span class="org-comment">(todo todo-type priority text tags contents &amp;optional info)</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">"Format an inline task element for HTML export."</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(let ((todo-kw</span>
    <span class="org-comment-delimiter">;;          </span><span class="org-comment">(if todo</span>
    <span class="org-comment-delimiter">;;              </span><span class="org-comment">(format "&lt;span class=\"%s %s\"&gt;%s&lt;/span&gt; " todo-type todo todo)</span>
    <span class="org-comment-delimiter">;;            </span><span class="org-comment">""))</span>
    <span class="org-comment-delimiter">;;         </span><span class="org-comment">(full-headline-w/o-todo-kw</span>
    <span class="org-comment-delimiter">;;          </span><span class="org-comment">(concat</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">(when priority (format "[#%c] " priority))</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">text</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">(when tags</span>
    <span class="org-comment-delimiter">;;             </span><span class="org-comment">(concat "&amp;nbsp;&amp;nbsp;&amp;nbsp;"</span>
    <span class="org-comment-delimiter">;;                     </span><span class="org-comment">"&lt;span class=\"tag\"&gt;"</span>
    <span class="org-comment-delimiter">;;                     </span><span class="org-comment">(mapconcat #'(lambda (tag)</span>
    <span class="org-comment-delimiter">;;                                  </span><span class="org-comment">(concat "&lt;span class= \"" tag "\"&gt;" tag</span>
    <span class="org-comment-delimiter">;;                                          </span><span class="org-comment">"&lt;/span&gt;"))</span>
    <span class="org-comment-delimiter">;;                                </span><span class="org-comment">tags</span>
    <span class="org-comment-delimiter">;;                                </span><span class="org-comment">"&amp;nbsp;")</span>
    <span class="org-comment-delimiter">;;                     </span><span class="org-comment">"&lt;/span&gt;")))))</span>
    <span class="org-comment-delimiter">;;     </span><span class="org-comment">(concat "&lt;table class=\"inlinetask\" width=\"100%\"&gt;"</span>
    <span class="org-comment-delimiter">;;               </span><span class="org-comment">"&lt;tr&gt;"</span>
    <span class="org-comment-delimiter">;;                 </span><span class="org-comment">"&lt;td valign=\"top\"&gt;&lt;b&gt;" todo-kw "&lt;/b&gt;&lt;/td&gt;"</span>
    <span class="org-comment-delimiter">;;                 </span><span class="org-comment">"&lt;td width=\"100%\"&gt;&lt;b&gt;" full-headline-w/o-todo-kw "&lt;/b&gt;&lt;br /&gt;"</span>
    <span class="org-comment-delimiter">;;                   </span><span class="org-comment">(or contents "") "&lt;/td&gt;"</span>
    <span class="org-comment-delimiter">;;               </span><span class="org-comment">"&lt;/tr&gt;"</span>
    <span class="org-comment-delimiter">;;             </span><span class="org-comment">"&lt;/table&gt;")))</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Function called to format an inlinetask in HTML code.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-html-format-inlinetask-function</span>
    <span class="org-comment-delimiter">;;       </span><span class="org-comment">'leuven--org-html-format-inlinetask)</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Template for inline tasks in LaTeX exporter.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(defun leuven--org-latex-format-inlinetask</span>
    <span class="org-comment-delimiter">;;     </span><span class="org-comment">(todo todo-type priority text tags contents &amp;optional info)</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">"Format an inline task element for LaTeX export."</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(let* ((tags-string (format ":%s:" (mapconcat 'identity tags ":")))</span>
    <span class="org-comment-delimiter">;;          </span><span class="org-comment">(opt-color</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">(if tags</span>
    <span class="org-comment-delimiter">;;               </span><span class="org-comment">(cond ((string-match ":info:" tags-string)</span>
    <span class="org-comment-delimiter">;;                      </span><span class="org-comment">"color=yellow!40")</span>
    <span class="org-comment-delimiter">;;                     </span><span class="org-comment">((string-match ":warning:" tags-string)</span>
    <span class="org-comment-delimiter">;;                      </span><span class="org-comment">"color=orange!40")</span>
    <span class="org-comment-delimiter">;;                     </span><span class="org-comment">((string-match ":error:" tags-string)</span>
    <span class="org-comment-delimiter">;;                      </span><span class="org-comment">"color=red!40")</span>
    <span class="org-comment-delimiter">;;                     </span><span class="org-comment">(t ""))</span>
    <span class="org-comment-delimiter">;;             </span><span class="org-comment">""))</span>
    <span class="org-comment-delimiter">;;          </span><span class="org-comment">(full-headline</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">(concat</span>
    <span class="org-comment-delimiter">;;            </span><span class="org-comment">(when todo</span>
    <span class="org-comment-delimiter">;;              </span><span class="org-comment">(format "{\\color{red}\\textbf{\\textsf{\\textsc{%s}}}} "</span>
    <span class="org-comment-delimiter">;;                      </span><span class="org-comment">todo))</span>
    <span class="org-comment-delimiter">;;            </span><span class="org-comment">(when priority</span>
    <span class="org-comment-delimiter">;;              </span><span class="org-comment">(format "\\textsf{\\framebox{\\#%c}} " priority))</span>
    <span class="org-comment-delimiter">;;            </span><span class="org-comment">text</span>
    <span class="org-comment-delimiter">;;            </span><span class="org-comment">(when tags</span>
    <span class="org-comment-delimiter">;;              </span><span class="org-comment">(format "\\hfill{}:%s:"</span>
    <span class="org-comment-delimiter">;;                      </span><span class="org-comment">(mapconcat 'identity tags ":")))))</span>
    <span class="org-comment-delimiter">;;          </span><span class="org-comment">(opt-rule</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">(if contents</span>
    <span class="org-comment-delimiter">;;               </span><span class="org-comment">"\\\\ \\rule[.3em]{\\textwidth}{0.2pt}\n"</span>
    <span class="org-comment-delimiter">;;             </span><span class="org-comment">""))</span>
    <span class="org-comment-delimiter">;;          </span><span class="org-comment">(opt-contents</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">(or contents "")))</span>
    <span class="org-comment-delimiter">;;     </span><span class="org-comment">;; This requires the `</span><span class="org-comment"><span class="org-constant">todonotes</span></span><span class="org-comment">' package.</span>
    <span class="org-comment-delimiter">;;     </span><span class="org-comment">(format (concat "\\todo[inline,caption={},%s]{\n"</span>
    <span class="org-comment-delimiter">;;                     </span><span class="org-comment">"  %s\n"</span>
    <span class="org-comment-delimiter">;;                     </span><span class="org-comment">"  %s"</span>
    <span class="org-comment-delimiter">;;                     </span><span class="org-comment">"  %s"</span>
    <span class="org-comment-delimiter">;;                     </span><span class="org-comment">"}")</span>
    <span class="org-comment-delimiter">;;             </span><span class="org-comment">opt-color</span>
    <span class="org-comment-delimiter">;;             </span><span class="org-comment">full-headline</span>
    <span class="org-comment-delimiter">;;             </span><span class="org-comment">opt-rule</span>
    <span class="org-comment-delimiter">;;             </span><span class="org-comment">opt-contents)))</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Function called to format an inlinetask in LaTeX code.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-latex-format-inlinetask-function</span>
    <span class="org-comment-delimiter">;;       </span><span class="org-comment">'leuven--org-latex-format-inlinetask)</span>
    )                                   <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "org-inlinetask" ends here.</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">org-latex-format-inlinetask-default-function</span>
    (todo _todo-type priority title tags contents info)
    <span class="org-doc">"Default format function for a inlinetasks.</span>
<span class="org-doc">  See `</span><span class="org-doc"><span class="org-constant">org-latex-format-inlinetask-function</span></span><span class="org-doc">' for details."</span>
    (<span class="org-keyword">let</span> ((full-title
           (concat (<span class="org-keyword">when</span> todo (format <span class="org-string">"\\textbf{\\textsf{\\textsc{%s}}} "</span> todo))
                   (<span class="org-keyword">when</span> priority (format <span class="org-string">"\\framebox{\\#%c} "</span> priority))
                   title
                   (<span class="org-keyword">when</span> tags
                     (format <span class="org-string">"\\hfill{}\\textsc{:%s:}"</span>
                             (mapconcat
                              #'(lambda (tag) (org-latex-plain-text tag info))
                              tags <span class="org-string">":"</span>))))))
      (concat <span class="org-string">"\\begin{center}\n"</span>
              <span class="org-string">"\\fcolorbox{black}{yellow}{\n"</span>
              <span class="org-string">"\\begin{minipage}[c]{\\textwidth}\n"</span>
              full-title <span class="org-string">"\n\n"</span>
              (<span class="org-keyword">and</span> (org-string-nw-p contents)
                   (concat <span class="org-string">"\\rule[.8em]{\\textwidth}{2pt}\n\n"</span> contents))
              <span class="org-string">"\\end{minipage}\n"</span>
              <span class="org-string">"}\n"</span>
              <span class="org-string">"\\end{center}"</span>)))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">setq</span> org-inlinetask-export-templates
        '((latex <span class="org-string">"%s\\footnote{%s\\\\ %s}\\marginpar{\\fbox{\\thefootnote}}"</span>
                 '((<span class="org-keyword">unless</span>
                       (eq todo <span class="org-string">""</span>)
                     (format <span class="org-string">"\\fbox{\\textsc{%s%s}}"</span> todo priority))
                   heading content))))
</pre>
</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Use todonotes</b><br />
<p>
Why use footnotes when you can use <code>todonotes</code>
(<a href="https://www.ctan.org/pkg/todonotes">https://www.ctan.org/pkg/todonotes</a>)?
</p>

<p>
It can even make a <code>list-of-todo-notes</code>.  See also
<a href="http://tex.stackexchange.com/questions/9796/how-to-add-todo-notes">http://tex.stackexchange.com/questions/9796/how-to-add-todo-notes</a> for more
options.
</p>
</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Have a solution for base article, report, book (w/o todonotes)</b><br />
nil</div>
</div>
</div>

<div id="outline-container-orgcc7bebe" class="outline-4">
<h4 id="orgcc7bebe">Visibility cycling</h4>
<div class="outline-text-4" id="text-orgcc7bebe">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(org)Visibility cycling")</span>

  (leuven--section <span class="org-string">"2.3 (org)Visibility cycling"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Switch to OVERVIEW (fold all) at startup.</span>
  (<span class="org-keyword">setq</span> org-startup-folded t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Inhibit startup when preparing agenda buffers -- agenda optimization.</span>
  (<span class="org-keyword">setq</span> org-agenda-inhibit-startup t)   <span class="org-comment-delimiter">; </span><span class="org-comment">XXX</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">setq</span> w32-pass-apps-to-system nil)
  (<span class="org-keyword">setq</span> w32-apps-modifier 'hyper)       <span class="org-comment-delimiter">; </span><span class="org-comment">Apps key.</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Create indirect buffer and narrow it to current subtree.</span>
    (define-key org-mode-map (kbd <span class="org-string">"&lt;H-RET&gt;"</span>) #'org-tree-to-indirect-buffer))
</pre>
</div>

<p>
Note that <b>Imenu</b> does display the current <b>Org subtree</b> in the mode line, not the
full outline path.
</p>
</div>
</div>

<div id="outline-container-org86f7497" class="outline-4">
<h4 id="org86f7497">2.4 Motion</h4>
<div class="outline-text-4" id="text-org86f7497">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(org)Motion")</span>

  (leuven--section <span class="org-string">"2.4 (org)Motion"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Outline-node based navigation similar to the behavior of paredit-mode in</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Lisp files.</span>
  (add-hook 'org-mode-hook
            #'(lambda ()
                <span class="org-comment-delimiter">;; </span><span class="org-comment">(local-set-key (kbd "M-n")   #'outline-next-visible-heading)</span>
                <span class="org-comment-delimiter">;; </span><span class="org-comment">(local-set-key (kbd "C-M-n") #'outline-next-visible-heading)</span>

                <span class="org-comment-delimiter">;; </span><span class="org-comment">(local-set-key (kbd "M-p")   #'outline-previous-visible-heading)</span>
                <span class="org-comment-delimiter">;; </span><span class="org-comment">(local-set-key (kbd "C-M-p") #'outline-previous-visible-heading)</span>

                <span class="org-comment-delimiter">;; </span><span class="org-comment">(local-set-key (kbd "C-M-u") #'outline-up-heading)</span>
))
</pre>
</div>

<p>
Move through an Org file like <code>cd</code> on a file system with <code>org-goto</code>:
<code>C-c C-j /foo/bar/baz RET</code>
</p>

<p>
vs <code>C-u C-c C-j</code>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Headlines in the current buffer are offered via completion</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(interface also used by the `</span><span class="org-comment"><span class="org-constant">refile</span></span><span class="org-comment">' command).</span>
  (<span class="org-keyword">setq</span> org-goto-interface 'outline-path-completion)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-reveal</span> (<span class="org-type">&amp;optional</span> all-siblings)
      <span class="org-doc">"Show all siblings of current level.</span>
<span class="org-doc">    `C-u C-c C-r' does the same as default Org mode: show all hidden siblings."</span>
      (<span class="org-keyword">interactive</span> <span class="org-string">"P"</span>)
      (<span class="org-keyword">if</span> all-siblings
          (org-reveal t)
        (org-show-siblings)))

    (define-key org-mode-map (kbd <span class="org-string">"C-c C-r"</span>) #'leuven-org-reveal))
</pre>
</div>

<p>
See also <a href="#org5714eb2">Sparse trees</a> for behavior when revealing a location.
</p>
</div>
</div>

<div id="outline-container-org1f4d592" class="outline-4">
<h4 id="org1f4d592">Structure editing</h4>
<div class="outline-text-4" id="text-org1f4d592">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(org)Structure editing")</span>

  (leuven--section <span class="org-string">"2.5 (org)Structure editing"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't adapt indentation to outline node level.</span>
  (<span class="org-keyword">setq</span> org-adapt-indentation nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; FIXME Choose the right value!</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-M-RET-may-split-line nil)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org5714eb2" class="outline-4">
<h4 id="org5714eb2">Sparse trees</h4>
<div class="outline-text-4" id="text-org5714eb2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(org)Sparse trees")</span>

  (leuven--section <span class="org-string">"2.6 (org)Sparse trees"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
</pre>
</div>

<p>
To control visibility when revealing a location, see <code>org-show-context-detail</code>:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">when</span> (boundp 'org-show-context-detail)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-show-context-detail '((default . local)))</span>
      (add-to-list 'org-show-context-detail '(tags-tree . ancestors))
      (add-to-list 'org-show-context-detail '(occur-tree . ancestors))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org8d35da3" class="outline-4">
<h4 id="org8d35da3">Plain lists</h4>
<div class="outline-text-4" id="text-org8d35da3">
<p>
An empty line does not end all plain list levels: if you need to separate
consecutive lists with blank lines, always use two of them.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(org)Plain lists")</span>

  (leuven--section <span class="org-string">"2.7 (org)Plain lists"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Maximum indentation for the second line of a description list.</span>
  (<span class="org-keyword">setq</span> org-description-max-indent 3)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't make tab cycle visibility on plain list items.</span>
  (<span class="org-keyword">setq</span> org-cycle-include-plain-lists nil) <span class="org-comment-delimiter">;; </span><span class="org-comment">'integrate?</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-cycle-separator-lines -2)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org4cb97df" class="outline-4">
<h4 id="org4cb97df">Footnotes </h4>
<div class="outline-text-4" id="text-org4cb97df">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(org)Footnotes")</span>

  (leuven--section <span class="org-string">"2.10 (org)Footnotes"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Use `C-c C-x f' to add a footnote, to go back to the message</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">*and* to go to a footnote.</span>
  (global-set-key (kbd <span class="org-string">"C-c C-x f"</span>) #'org-footnote-action)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org16ebc5e" class="outline-3">
<h3 id="org16ebc5e">Tables</h3>
<div class="outline-text-3" id="text-org16ebc5e">
<p>
See <a href="http://orgmode.org/worg/org-tutorials/org-spreadsheet-intro.html">Org as a spreadsheet system: a short introduction</a>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 3 (info "(org)Tables")</span>

  (<span class="org-keyword">setq</span> org-table-use-standard-references 'from)

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 3.1 The (info "(org)Built-in table editor")</span>

  (leuven--section <span class="org-string">"3.1 The (org)Built-in table editor"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Default export parameters for `</span><span class="org-comment"><span class="org-constant">org-table-export</span></span><span class="org-comment">'.</span>
  (<span class="org-keyword">setq</span> org-table-export-default-format <span class="org-string">"orgtbl-to-csv"</span>)

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 3.5 (info "(org)The spreadsheet")</span>

  (leuven--section <span class="org-string">"3.5 (org)The spreadsheet"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-table"</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Some Calc mode settings for use in `</span><span class="org-comment"><span class="org-constant">calc-eval</span></span><span class="org-comment">' for table formulas.</span>
    (setcar (cdr (memq 'calc-float-format org-calc-default-modes))
            '(float 12)))               <span class="org-comment-delimiter">; </span><span class="org-comment">[Default: 8]</span>
</pre>
</div>

<p>
To <b>update all tables</b> in a file, use <code>org-table-recalculate-buffer-tables</code> if the
dependencies are only backwards.
</p>

<p>
If you have dependencies in both directions, to iterate all tables in a file,
in order to converge table-to-table dependencies, use
<code>org-table-iterate-buffer-tables</code>.
</p>
</div>
</div>

<div id="outline-container-orgea32933" class="outline-3">
<h3 id="orgea32933">Hyperlinks</h3>
<div class="outline-text-3" id="text-orgea32933">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 4 (info "(org)Hyperlinks")</span>
</pre>
</div>

<p>
If you insert a <a href="http://">http://</a> link containing equal signs (such as
<a href="http://test/test?name=me">http://test/test?name=me</a>), the verbatim link being inserted in the Org document
has the equal signs escaped, unless you have:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't hexify URL when creating a link.</span>
  (<span class="org-keyword">setq</span> org-url-hexify-p nil)
</pre>
</div>
</div>

<div id="outline-container-org77efbb2" class="outline-4">
<h4 id="org77efbb2">External links</h4>
<div class="outline-text-4" id="text-org77efbb2">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"[... Hyperlinks]"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Open non-existing files.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-open-non-existing-files t)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Function and arguments to call for following `</span><span class="org-comment"><span class="org-constant">mailto</span></span><span class="org-comment">' links.</span>
    (<span class="org-keyword">setq</span> org-link-mailto-program '(compose-mail <span class="org-string">"%a"</span> <span class="org-string">"%s"</span>)))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Support for links to Gnus groups and messages from within Org mode.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-gnus"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Create web links to Google groups or Gmane (instead of Gnus messages).</span>
    (<span class="org-keyword">setq</span> org-gnus-prefer-web-links t))
</pre>
</div>
</div>
</div>

<div id="outline-container-org70c2410" class="outline-4">
<h4 id="org70c2410">Handling links</h4>
<div class="outline-text-4" id="text-org70c2410">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Global identifiers for Org mode entries.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-id"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Storing a link to an Org file will use entry IDs.</span>
    (<span class="org-keyword">setq</span> org-id-link-to-org-use-id
          'create-if-interactive-and-no-custom-id))
</pre>
</div>

<p>
PDF viewer?  See <code>org-file-apps</code>.  Just change to your favorite viewer.  And make
sure that you&rsquo;re calling <code>org-return</code> to open (it&rsquo;s bound to <code>C-m</code>).
</p>

<div class="warning">
<p>
There is no more &ldquo;sexp&rdquo; case in <code>org-file-apps</code> in development version (9.0).  You
can use a function instead.
</p>

</div>

<p>
If I inline an image in an Org file, I can toggle its display with <code>C-c C-x C-v</code>
and resize it to a specific width.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"[... Handling links]"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">4.4 Show inline images when loading a new Org file.</span>
    (<span class="org-keyword">setq</span> org-startup-with-inline-images t) <span class="org-comment-delimiter">; </span><span class="org-comment">Invokes org-display-inline-images.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">4.4 Try to get the width from an #+ATTR.* keyword and fall back on 320px</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">width if none is found.</span>
<span class="org-comment-delimiter">;;    </span><span class="org-comment">(setq org-image-actual-width '(320)) ; crashes Emacs with Org 9?</span>
</pre>
</div>

<p>
Search for backlinks:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-search-backlinks</span> ()
      <span class="org-doc">"Show all entries that point to the current node.  Also show the current</span>
<span class="org-doc">    node itself.</span>

<span class="org-doc">    This makes ID links quasi-bidirectional."</span>
      (<span class="org-keyword">interactive</span>)
      (<span class="org-keyword">let</span> ((org-agenda-files
             (add-to-list 'org-agenda-files (buffer-file-name))))
        (org-search-view nil (org-entry-get nil <span class="org-string">"ID"</span> t))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd6ed49d" class="outline-4">
<h4 id="orgd6ed49d">Link abbreviations</h4>
<div class="outline-text-4" id="text-orgd6ed49d">
<p>
Link abbreviations provide a quick way of linking to resources that are
frequently referenced, so that you can type just the key term instead of the
complete URL.
</p>

<p>
Here is an example: every time you need to use
<a href="http://www.google.com/search?q=searchterms">http://www.google.com/search?q=searchterms</a>, you can just type
<code>[[google:searchterms]]</code> or <code>[[google:searchterms][description]]</code> instead.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Shortcut links.</span>
    (<span class="org-keyword">setq</span> org-link-abbrev-alist
          '((<span class="org-string">"cache"</span> .
             <span class="org-string">"http://www.google.com/search?q=cache:%s"</span>)
            (<span class="org-string">"dictionary"</span> .
             <span class="org-string">"http://www.dict.org/bin/Dict?Database=*&amp;Form=Dict1&amp;Strategy=*&amp;Query=%s"</span>)
            (<span class="org-string">"google"</span> .
             <span class="org-string">"http://www.google.com/search?q=%s"</span>)
            (<span class="org-string">"googlegroups"</span> .
             <span class="org-string">"http://groups.google.com/groups?q=%s"</span>)
            (<span class="org-string">"googlemaps"</span> .
             <span class="org-string">"http://maps.google.com/maps?q=%s"</span>)
            (<span class="org-string">"imdb"</span> .
             <span class="org-string">"http://us.imdb.com/Title?%s"</span>)
            (<span class="org-string">"openstreetmap"</span> .
             <span class="org-string">"http://nominatim.openstreetmap.org/search?q=%s&amp;polygon=1"</span>)
            (<span class="org-string">"wpen"</span> .
             <span class="org-string">"http://en.wikipedia.org/wiki/%s"</span>)
            (<span class="org-string">"wpfr"</span> .
             <span class="org-string">"http://fr.wikipedia.org/wiki/%s"</span>))))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org33b058a" class="outline-3">
<h3 id="org33b058a">&ldquo;TODO&rdquo; Items</h3>
<div class="outline-text-3" id="text-org33b058a">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 5 (info "(org)TODO Items")</span>
</pre>
</div>
</div>

<div id="outline-container-org31ea880" class="outline-4">
<h4 id="org31ea880">Basic TODO functionality</h4>
<div class="outline-text-4" id="text-org31ea880">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 5.1 (info "(org)TODO basics") functionality</span>

  (leuven--section <span class="org-string">"5.1 (org)TODO basics functionality"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">5.1 Select a TODO state and bypass any logging associated with that.</span>
  (<span class="org-keyword">setq</span> org-treat-S-cursor-todo-selection-as-state-change nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Some commands act upon headlines in the active region.</span>
  (<span class="org-keyword">setq</span> org-loop-over-headlines-in-active-region 'start-level)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb75e6c4" class="outline-4">
<h4 id="orgb75e6c4">Extended use of TODO keywords</h4>
<div class="outline-text-4" id="text-orgb75e6c4">
<p>
We use statuses to <b>create a workflow</b> for tasks.
</p>

<p>
The statuses we use are a simple as possible to work well in the context of
work.
</p>

<p>
We use the following 4-letter status keywords:
</p>

<dl class="org-dl">
<dt><code>TODO</code></dt><dd>Approved task, to be done.</dd>

<dt><code>STRT</code></dt><dd>Some progress has already been done on the task.</dd>

<dt><code>WAIT</code></dt><dd>Task delegated to someone else.  Or waiting for some external event to be
able to work on the task.</dd>

<dt><code>SDAY</code></dt><dd>Task to be approved (and eventually done) in the future.</dd>

<dt><code>DONE</code></dt><dd>Task is completed.</dd>

<dt><code>CANX</code></dt><dd>Task is declined (but kept documented, instead of being deleted).</dd>
</dl>

<p>
There is just 1 exception (made on purpose) to the 4-letter scheme:
</p>

<dl class="org-dl">
<dt><code>NEW</code></dt><dd>Proposed task, idea or wish, <b>not approved yet</b>.  Draft.</dd>
</dl>

<p>
One could add a <code>CLSD</code> or <code>VRFD</code> state for bug fixes, for example, which need to be
verified before really closing the task.
</p>

<p>
Extra status for invoices:
</p>

<dl class="org-dl">
<dt><code>DRAFT</code></dt><dd>Invoice created, but you have <b>not sent</b> it to your client.</dd>

<dt><code>UNPAID</code> (or <code>SENT</code>?)</dt><dd>Your client has been notified.</dd>

<dt><code>PAID</code></dt><dd>Your client has <b>paid</b> this invoice &#x2013; you have received their payment.</dd>
</dl>

<p>
(See FreshBooks, LessAccounting and BlinkSale)
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 5.2 Use of (info "(org)TODO extensions")</span>

  (leuven--section <span class="org-string">"5.2 Use of (org)TODO extensions"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">List of TODO entry keyword sequences (+ fast access keys and specifiers</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">for state change logging).</span>
  (<span class="org-keyword">setq</span> org-todo-keywords
        '((sequence <span class="org-string">"NEW(n!)"</span>           <span class="org-comment-delimiter">; </span><span class="org-comment">Proposal, idea (under review), to be</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">prioritized.</span>
                    <span class="org-string">"TODO(t!)"</span>          <span class="org-comment-delimiter">; </span><span class="org-comment">Open, not (yet) started.</span>
                    <span class="org-string">"STRT(s!)"</span>          <span class="org-comment-delimiter">; </span><span class="org-comment">In progress, working on, doing.</span>
                    <span class="org-string">"WAIT(w!)"</span>          <span class="org-comment-delimiter">; </span><span class="org-comment">On hold, to be discussed, assigned,</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">feedback.</span>
                    <span class="org-string">"SDAY(y!)"</span>          <span class="org-comment-delimiter">; </span><span class="org-comment">Someday, maybe, perhaps, wish.</span>
                    <span class="org-string">"|"</span>
                    <span class="org-string">"DONE(d!)"</span>          <span class="org-comment-delimiter">; </span><span class="org-comment">Completed, closed, fixed, resolved,</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">verified.</span>
                    <span class="org-string">"CANX(x!)"</span>)         <span class="org-comment-delimiter">; </span><span class="org-comment">Wontfix, rejected, ignored.</span>

          (sequence <span class="org-string">"QTE(q!)"</span>           <span class="org-comment-delimiter">; </span><span class="org-comment">Planning.</span>
                    <span class="org-string">"QTD(Q!)"</span>           <span class="org-comment-delimiter">; </span><span class="org-comment">Awaiting approval.</span>
                    <span class="org-string">"|"</span>
                    <span class="org-string">"APP(A!)"</span>           <span class="org-comment-delimiter">; </span><span class="org-comment">Approved.</span>
                    <span class="org-string">"REJ(R!)"</span>)          <span class="org-comment-delimiter">; </span><span class="org-comment">Rejected.</span>

          (sequence <span class="org-string">"OPENPO(O!)"</span>
                    <span class="org-string">"|"</span>
                    <span class="org-string">"CLSDPO(C!)"</span>)))
</pre>
</div>

<p>
<code>SDAY</code> is <b>not</b> a completion state (in order not to be struck through).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-faces"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Faces for specific TODO keywords.</span>
    (<span class="org-keyword">setq</span> org-todo-keyword-faces
          '((<span class="org-string">"NEW"</span>  . leuven-org-created-kwd)
            (<span class="org-string">"TODO"</span> . org-todo)
            (<span class="org-string">"STRT"</span> . leuven-org-in-progress-kwd)
            (<span class="org-string">"WAIT"</span> . leuven-org-waiting-for-kwd)
            (<span class="org-string">"SDAY"</span> . leuven-org-someday-kwd)
            (<span class="org-string">"DONE"</span> . org-done)
            (<span class="org-string">"CANX"</span> . org-done)

            (<span class="org-string">"QTE"</span> . leuven-org-quote-kwd)
            (<span class="org-string">"QTD"</span> . leuven-org-quoted-kwd)
            (<span class="org-string">"APP"</span> . leuven-org-approved-kwd)
            (<span class="org-string">"REJ"</span> . leuven-org-rejected-kwd)

            (<span class="org-string">"OPENPO"</span> . leuven-org-openpo-kwd)
            (<span class="org-string">"CLSDPO"</span> . leuven-org-closedpo-kwd)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Org standard faces.</span>
    (set-face-attribute 'org-todo nil
                        <span class="org-builtin">:weight</span> 'bold <span class="org-builtin">:box</span> '(<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#D8ABA7"</span>)
                        <span class="org-builtin">:foreground</span> <span class="org-string">"#D8ABA7"</span> <span class="org-builtin">:background</span> <span class="org-string">"#FFE6E4"</span>)

    (set-face-attribute 'org-done nil
                        <span class="org-builtin">:weight</span> 'bold <span class="org-builtin">:box</span> '(<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#BBBBBB"</span>)
                        <span class="org-builtin">:foreground</span> <span class="org-string">"#BBBBBB"</span> <span class="org-builtin">:background</span> <span class="org-string">"#F0F0F0"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Org non-standard faces.</span>
    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-created-kwd</span>
      '((t <span class="org-builtin">:weight</span> bold <span class="org-builtin">:box</span> (<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#1F8DD6"</span>)
           <span class="org-builtin">:foreground</span> <span class="org-string">"#1F8DD6"</span> <span class="org-builtin">:background</span> <span class="org-string">"#FFEE62"</span>))
      <span class="org-doc">"Face used to display state NEW."</span>)
    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-in-progress-kwd</span>
      '((t <span class="org-builtin">:weight</span> bold <span class="org-builtin">:box</span> (<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#D9D14A"</span>)
           <span class="org-builtin">:foreground</span> <span class="org-string">"#D9D14A"</span> <span class="org-builtin">:background</span> <span class="org-string">"#FCFCDC"</span>))
      <span class="org-doc">"Face used to display state STRT."</span>)
    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-waiting-for-kwd</span>
      '((t <span class="org-builtin">:weight</span> bold <span class="org-builtin">:box</span> (<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#89C58F"</span>)
           <span class="org-builtin">:foreground</span> <span class="org-string">"#89C58F"</span> <span class="org-builtin">:background</span> <span class="org-string">"#E2FEDE"</span>))
      <span class="org-doc">"Face used to display state WAIT."</span>)
    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-someday-kwd</span>
      '((t <span class="org-builtin">:weight</span> bold <span class="org-builtin">:box</span> (<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#9EB6D4"</span>)
           <span class="org-builtin">:foreground</span> <span class="org-string">"#9EB6D4"</span> <span class="org-builtin">:background</span> <span class="org-string">"#E0EFFF"</span>))
      <span class="org-doc">"Face used to display state SDAY."</span>)

    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-quote-kwd</span>
      '((t <span class="org-builtin">:weight</span> bold <span class="org-builtin">:box</span> (<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#FC5158"</span>)
           <span class="org-builtin">:foreground</span> <span class="org-string">"#FC5158"</span> <span class="org-builtin">:background</span> <span class="org-string">"#FED5D7"</span>))
      <span class="org-doc">"Face used to display ."</span>)
    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-quoted-kwd</span>
      '((t <span class="org-builtin">:weight</span> bold <span class="org-builtin">:box</span> (<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#55BA80"</span>)
           <span class="org-builtin">:foreground</span> <span class="org-string">"#55BA80"</span> <span class="org-builtin">:background</span> <span class="org-string">"#DFFFDF"</span>))
      <span class="org-doc">"Face used to display ."</span>)
    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-approved-kwd</span>
      '((t <span class="org-builtin">:weight</span> bold <span class="org-builtin">:box</span> (<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#969696"</span>)
           <span class="org-builtin">:foreground</span> <span class="org-string">"#969696"</span> <span class="org-builtin">:background</span> <span class="org-string">"#F2F2EE"</span>))
      <span class="org-doc">"Face used to display ."</span>)
    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-rejected-kwd</span>
      '((t <span class="org-builtin">:weight</span> bold <span class="org-builtin">:box</span> (<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#42B5FF"</span>)
           <span class="org-builtin">:foreground</span> <span class="org-string">"#42B5FF"</span> <span class="org-builtin">:background</span> <span class="org-string">"#D3EEFF"</span>))
      <span class="org-doc">"Face used to display state REJECTED."</span>)

    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-openpo-kwd</span>
      '((t <span class="org-builtin">:weight</span> bold <span class="org-builtin">:box</span> (<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#FC5158"</span>)
           <span class="org-builtin">:foreground</span> <span class="org-string">"#FC5158"</span> <span class="org-builtin">:background</span> <span class="org-string">"#FED5D7"</span>))
      <span class="org-doc">"Face used to display OPEN purchase order."</span>)
    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-closedpo-kwd</span>
      '((t <span class="org-builtin">:weight</span> bold <span class="org-builtin">:box</span> (<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#969696"</span>)
           <span class="org-builtin">:foreground</span> <span class="org-string">"#969696"</span> <span class="org-builtin">:background</span> <span class="org-string">"#F2F2EE"</span>))
      <span class="org-doc">"Face used to display CLOSED purchase order."</span>))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Block switching entries to DONE if</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">1) there are undone child entries, or</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">2) the parent has an `</span><span class="org-comment"><span class="org-constant">:ORDERED:</span></span><span class="org-comment">' property and there are prior</span>
  <span class="org-comment-delimiter">;;    </span><span class="org-comment">siblings not yet done.</span>
  (<span class="org-keyword">setq</span> org-enforce-todo-dependencies t)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">5.2.7 Don't dim blocked tasks in the agenda display -- agenda optimization.</span>
  (<span class="org-keyword">setq</span> org-agenda-dim-blocked-tasks nil) <span class="org-comment-delimiter">; </span><span class="org-comment">XXX not sure about this one</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Block switching the parent to DONE if there are unchecked checkboxes.</span>
  (<span class="org-keyword">setq</span> org-enforce-todo-checkbox-dependencies t)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgafc380e" class="outline-4">
<h4 id="orgafc380e">Progress logging</h4>
<div class="outline-text-4" id="text-orgafc380e">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 5.3 (info "(org)Progress logging")</span>

  (leuven--section <span class="org-string">"5.3 (org)Progress logging"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; 5.3.1 Don't insert a CLOSED time stamp each time a TODO entry is marked DONE.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-log-done nil)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">5.3.2 The notes will be ordered according to time.</span>
  (<span class="org-keyword">setq</span> org-log-states-order-reversed nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">5.3.2 Insert state change notes and time stamps into a LOGBOOK drawer.</span>
  (<span class="org-keyword">setq</span> org-log-into-drawer t)          <span class="org-comment-delimiter">; </span><span class="org-comment">should be the DEFAULT!</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">~5.3.2 Heading for state change added to entries.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"[... Progress logging]"</span>)

    (setcdr (assq 'state org-log-note-headings)
            <span class="org-string">"State %-12S  -&gt;  %-12s %t"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">"State old -&gt; new + timestamp".</span>
</pre>
</div>

<p>
Warning! The docstring of <code>org-log-note-headings</code> mentions that &ldquo;in fact, it is
<b>not a good idea to change the `state&rsquo; entry</b>, because agenda log mode depends
on the format of these entries.&rdquo;
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-habit"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Show habits for future days.</span>
    (<span class="org-keyword">setq</span> org-habit-show-habits-only-for-today nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Use character "heavy check mark" to show completed days on which a task</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">was done.</span>
    (<span class="org-keyword">setq</span> org-habit-completed-glyph ?\u2714)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Use character "heavy quadruple dash vertical" to identify today.</span>
    (<span class="org-keyword">setq</span> org-habit-today-glyph ?\u250B))
</pre>
</div>
</div>
</div>

<div id="outline-container-org5d10263" class="outline-4">
<h4 id="org5d10263">Breaking down tasks</h4>
<div class="outline-text-4" id="text-org5d10263">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 5.5 (info "(org)Breaking down tasks")</span>

  (leuven--section <span class="org-string">"5.5 (org)Breaking down tasks"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Automatically change a TODO entry to DONE when all children are done.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--org-summary-todo</span> (n-done n-not-done)
    <span class="org-doc">"Switch entry to DONE when all subentries are done, to TODO otherwise."</span>
    (<span class="org-keyword">let</span> (org-log-done org-log-states)  <span class="org-comment-delimiter">; </span><span class="org-comment">turn off logging</span>
      (org-todo (<span class="org-keyword">if</span> (= n-not-done 0) <span class="org-string">"DONE"</span> <span class="org-string">"TODO"</span>))))

  (add-hook 'org-after-todo-statistics-hook #'leuven--org-summary-todo)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb158aaf" class="outline-3">
<h3 id="orgb158aaf">Tags</h3>
<div class="outline-text-3" id="text-orgb158aaf">
<p>
Context (place, time or particular resources for doing a task) and people are
something best implemented with tags.
</p>

<p>
By convention, <b>user-defined tags are written in lowercase</b>; built-in tags with
special meaning are written with all capitals.
</p>

<p>
<code>org-use-tag-inheritance</code> can be setup to a regular expression, for example so
that all tags starting with <code>@</code> or <code>#</code> will be excluded from inheritance with:
</p>

<pre class="example">
(setq org-use-tag-inheritance "^[^@#]")
</pre>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 6 (info "(org)Tags")</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Column to which tags should be indented in a headline.</span>
  (<span class="org-keyword">setq</span> org-tags-column -80)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">6.2 List of tags ("contexts") allowed in Org mode files.</span>
  (<span class="org-keyword">setq</span> org-tag-alist '((<span class="org-builtin">:startgroup</span>  . nil)
                         (<span class="org-string">"work"</span>       . ?w)
                         (<span class="org-string">"personal"</span>   . ?p)
                        (<span class="org-builtin">:endgroup</span>    . nil)
                        (<span class="org-string">"call"</span>        . ?c)
                        (<span class="org-string">"errands"</span>     . ?e)
                        (<span class="org-string">"finance"</span>     . ?f)
                        (<span class="org-string">"mail"</span>        . ?m)

                        (<span class="org-string">"notbillable"</span> . ?B)
                        <span class="org-comment-delimiter">;; </span><span class="org-comment">("reading"  . ?r)</span>
                        <span class="org-comment-delimiter">;; </span><span class="org-comment">("proj"     . ?P)</span>
                        <span class="org-comment-delimiter">;; </span><span class="org-comment">("now"      . XXX)</span>

                        (<span class="org-string">"ARCHIVE"</span>     . ?a) <span class="org-comment-delimiter">; </span><span class="org-comment">speed command + action in task list</span>
                        (<span class="org-string">"crypt"</span>       . ?C)
                        (<span class="org-string">"FLAGGED"</span>     . ??) <span class="org-comment-delimiter">; </span><span class="org-comment">= ASAP</span>
                        ))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Faces for specific tags.</span>
  (<span class="org-keyword">setq</span> org-tag-faces
        '((<span class="org-string">"refile"</span>
           (<span class="org-builtin">:slant</span> italic
            <span class="org-builtin">:foreground</span> <span class="org-string">"#A9876E"</span>))     <span class="org-comment-delimiter">; </span><span class="org-comment">:background "#FCEEB3"</span>
          (<span class="org-string">"work"</span>
           (<span class="org-builtin">:slant</span> italic
            <span class="org-builtin">:foreground</span> <span class="org-string">"#699761"</span>))     <span class="org-comment-delimiter">; </span><span class="org-comment">:background "#C1D996"</span>
          (<span class="org-string">"personal"</span>
           (<span class="org-builtin">:slant</span> italic
            <span class="org-builtin">:foreground</span> <span class="org-string">"#5C88D3"</span>))     <span class="org-comment-delimiter">; </span><span class="org-comment">:background "#BBDDFF"</span>
          (<span class="org-string">"FLAGGED"</span>
           (<span class="org-builtin">:weight</span> bold <span class="org-builtin">:slant</span> italic
            <span class="org-builtin">:foreground</span> <span class="org-string">"#FF0000"</span> <span class="org-builtin">:background</span> <span class="org-string">"#FFFF00"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">:background "#EDC6C8"</span>
          (<span class="org-string">"now"</span>
           (<span class="org-builtin">:slant</span> italic
            <span class="org-builtin">:foreground</span> <span class="org-string">"#000000"</span>))     <span class="org-comment-delimiter">; </span><span class="org-comment">:background "#FFEA80"</span>
          (<span class="org-string">"notbillable"</span>
           (<span class="org-builtin">:slant</span> italic
            <span class="org-builtin">:foreground</span> <span class="org-string">"#8774AF"</span>))     <span class="org-comment-delimiter">; </span><span class="org-comment">:background "#DED0EA"</span>
          ))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">6.2 Exit fast tag selection after first change (toggle this with `</span><span class="org-comment"><span class="org-constant">C-c</span></span><span class="org-comment">').</span>
  (<span class="org-keyword">setq</span> org-fast-tag-selection-single-key t)
</pre>
</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Extend the following function to take <code>filetags</code> into account</b><br />
nil</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Check whether this function removes tags of DIRECT parent</b><br />
nil</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Remove redundant tags of headlines (from David Maus).</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-remove-redundant-tags</span> ()
    <span class="org-doc">"Remove redundant tags of headlines in current buffer.</span>
<span class="org-doc">  A tag is considered redundant if it is local to a headline and inherited by</span>
<span class="org-doc">  a parent headline."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">when</span> (derived-mode-p 'org-mode)
      (<span class="org-keyword">save-excursion</span>
        (org-map-entries
         #'(lambda ()
             (<span class="org-keyword">let</span> ((alltags (split-string
                             (<span class="org-keyword">or</span> (org-entry-get (point) <span class="org-string">"ALLTAGS"</span>) <span class="org-string">""</span>)
                             <span class="org-string">":"</span>))
                   local inherited tag)
               (<span class="org-keyword">dolist</span> (tag alltags)
                 (<span class="org-keyword">if</span> (get-text-property 0 'inherited tag)
                     (<span class="org-keyword">push</span> tag inherited)
                   (<span class="org-keyword">push</span> tag local)))
               (<span class="org-keyword">dolist</span> (tag local)
                 (<span class="org-keyword">when</span> (member tag inherited)
                   (org-toggle-tag tag 'off)))))
         t nil))))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Always offer completion for all tags of all agenda files.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-complete-tags-always-offer-all-agenda-tags t)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org9433598" class="outline-3">
<h3 id="org9433598">Properties and Columns</h3>
<div class="outline-text-3" id="text-org9433598">
<p>
By convention, <b>user-defined properties are capitalized</b>; built-in properties with
special meaning are written with all capitals.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 7 (info "(org)Properties and Columns")</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 7.1 (info "(org)Property syntax")</span>

  (leuven--section <span class="org-string">"7.1 (org)Property syntax"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">List of property/value pairs that can be inherited by any entry.</span>
  (<span class="org-keyword">setq</span> org-global-properties
        '((<span class="org-string">"Effort_ALL"</span> .
           <span class="org-string">"0 0:10 0:30 1:00 2:00 3:00 4:00 5:00 6:00 8:00"</span>
           <span class="org-comment-delimiter">;; </span><span class="org-comment">"0d 1d 2d 3d 4d 5d 6d 7d 8d 10d"</span>
           <span class="org-comment-delimiter">;; </span><span class="org-comment">"0 1:00 4:00 1d 2d 1w 2w"</span>
           )))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgabdcdc6" class="outline-3">
<h3 id="orgabdcdc6">Dates and Times</h3>
<div class="outline-text-3" id="text-orgabdcdc6">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 8 (info "(org)Dates and Times")</span>

  (leuven--section <span class="org-string">"8 (org)Dates and Times"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Insinuate appt if Org mode is loaded.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"[... Org Dates and Times]"</span>)

    (try-require 'appt))
</pre>
</div>
</div>

<div id="outline-container-orgef7d5aa" class="outline-4">
<h4 id="orgef7d5aa">Creating time stamps</h4>
<div class="outline-text-4" id="text-orgef7d5aa">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 8.2 (info "(org)Creating timestamps")</span>

  (leuven--section <span class="org-string">"8.2 (org)Creating time stamps"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Prefer the future for incomplete dates.</span>
  (<span class="org-keyword">setq</span> org-read-date-prefer-future 'time)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Advise `</span><span class="org-comment"><span class="org-constant">org-read-date</span></span><span class="org-comment">' to bury the calendar buffer after selecting a date,</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; so it is out of the way.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(defadvice org-read-date</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(after leuven-bury-calendar-after-org-read-date</span>
  <span class="org-comment-delimiter">;;          </span><span class="org-comment">(&amp;optional with-time to-time from-string prompt</span>
  <span class="org-comment-delimiter">;;          </span><span class="org-comment">default-time default-input) protect)</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">"Bury the *Calendar* buffer after reading a date."</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(bury-buffer "*Calendar*"))</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(ad-activate 'org-read-date)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Number of minutes to round time stamps to.</span>
  (<span class="org-keyword">setq</span> org-time-stamp-rounding-minutes '(1 1))
</pre>
</div>
</div>
</div>

<div id="outline-container-org5984574" class="outline-4">
<h4 id="org5984574">Deadlines and scheduling</h4>
<div class="outline-text-4" id="text-org5984574">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 8.3 (info "(org)Deadlines and scheduling")</span>

  (leuven--section <span class="org-string">"8.3 (org)Deadlines and scheduling"</span>)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Information to record when the scheduling date is modified.</span>
  (<span class="org-keyword">setq</span> org-log-reschedule nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Information to record when the deadline date is modified.</span>
  (<span class="org-keyword">setq</span> org-log-redeadline 'time)
</pre>
</div>
</div>

<div id="outline-container-org9cd26cc" class="outline-5">
<h5 id="org9cd26cc">Inserting deadline/schedule</h5>
<div class="outline-text-5" id="text-org9cd26cc">
<p>
Schedule it with <code>C-c C-s</code>:
</p>

<dl class="org-dl">
<dt><code>RET</code></dt><dd>Today.</dd>

<dt><code>+1d RET</code></dt><dd>Tomorrow.</dd>

<dt><code>+1w RET</code></dt><dd>Next week.</dd>

<dt><code>+4w RET</code></dt><dd>Next &ldquo;month&rdquo;.</dd>
</dl>

<p>
Remove scheduling date with <code>C-u C-c C-s</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Number of days before expiration during which a deadline becomes active.</span>
  (<span class="org-keyword">setq</span> org-deadline-warning-days 7)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Skip deadline prewarning (up to 7 days before the actual deadline) when</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">entry is also scheduled.</span>
  (<span class="org-keyword">setq</span> org-agenda-skip-deadline-prewarning-if-scheduled 7)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't show deadlines when the corresponding item is done.</span>
  (<span class="org-keyword">setq</span> org-agenda-skip-deadline-if-done t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Skip scheduling line if same entry shows because of deadline.</span>
  (<span class="org-keyword">setq</span> org-agenda-skip-scheduled-if-deadline-is-shown t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't show scheduled items in agenda when they are done.</span>
  (<span class="org-keyword">setq</span> org-agenda-skip-scheduled-if-done t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">~8.3 Don't select item by time stamp or -range if it is DONE.</span>
  (<span class="org-keyword">setq</span> org-agenda-skip-timestamp-if-done t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Show all days between the first and the last date.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-timeline-show-empty-dates t)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org8c811c7" class="outline-5">
<h5 id="org8c811c7">Repeated tasks</h5>
<div class="outline-text-5" id="text-org8c811c7">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">TODO state to which a repeater should return the repeating task.</span>
  (<span class="org-keyword">setq</span> org-todo-repeat-to-state <span class="org-string">"TODO"</span>)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org213c9f4" class="outline-4">
<h4 id="org213c9f4">Clocking work time (Time tracking)</h4>
<div class="outline-text-4" id="text-org213c9f4">
<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Resume clocks when opening the first Org file</b><br />
<p>
Alternative to requiring org-clock in every Emacs session.
</p>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 8.4 (info "(org)Clocking work time")</span>

  (leuven--section <span class="org-string">"8.4 (org)Clocking work time"</span>)

  (global-set-key (kbd <span class="org-string">"C-c C-x C-i"</span>) #'org-clock-in)
  (global-set-key (kbd <span class="org-string">"C-c C-x C-j"</span>) #'org-clock-goto)
  (global-set-key (kbd <span class="org-string">"C-c C-x C-o"</span>) #'org-clock-out)

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-helm-org-clock-in</span> (marker)
    <span class="org-doc">"Clock into the item at MARKER"</span>
    (<span class="org-keyword">with-current-buffer</span> (marker-buffer marker)
      (goto-char (marker-position marker))
      (org-clock-in)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Add action "Clock into task" directly from helm-org session</span>
  (<span class="org-keyword">with-eval-after-load</span> 'helm-org
    (nconc helm-org-headings-actions
           (list (cons <span class="org-string">"Clock into task"</span> #'leuven-helm-org-clock-in))))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">The time clocking code for Org mode.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(require 'org-clock)               ;! needed for trying to automatically</span>
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">! re-clock at Emacs startup</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">XXX Under test!</span>
  (add-hook 'org-mode-hook
            #'(lambda ()
                (<span class="org-keyword">require</span> '<span class="org-constant">org-clock</span>)
                (<span class="org-keyword">setq</span> org-clock-persist t)
                (org-clock-persistence-insinuate)))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-clock"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; 8.4 Save both the running clock and the entire clock history when Emacs</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; is closed, and resume it next time Emacs is started up.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-clock-persist t)</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; 8.4 Set up hooks for clock persistence.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(org-clock-persistence-insinuate)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Resume clocking task on clock-in if the clock is open.</span>
    (<span class="org-keyword">setq</span> org-clock-in-resume t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Number of clock tasks to remember in history.</span>
    (<span class="org-keyword">setq</span> org-clock-history-length 35)  <span class="org-comment-delimiter">; </span><span class="org-comment">1-9A-Z</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">8.4.2 Include the current clocking task time in clock reports.</span>
    (<span class="org-keyword">setq</span> org-clock-report-include-clocking-task t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">8.4.2 Format string used when creating CLOCKSUM lines and when generating</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">a time duration (avoid showing days).</span>
    (<span class="org-keyword">setq</span> org-duration-format 'h:mm)    <span class="org-comment-delimiter">; </span><span class="org-comment">Introduced in Emacs 26.1 / Org 9.1.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Format string for the total time cells.</span>
    (<span class="org-keyword">setq</span> org-clock-total-time-cell-format <span class="org-string">"%s"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Format string for the file time cells.</span>
    (<span class="org-keyword">setq</span> org-clock-file-time-cell-format <span class="org-string">"%s"</span>)

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-clock-in-interrupted-task</span> ()
      <span class="org-doc">"Clock back into the task that has been interrupted, if there is one."</span>
      (<span class="org-keyword">interactive</span>)
      (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> (not org-clock-resolving-clocks-due-to-idleness)
               (marker-buffer org-clock-marker)
               (marker-buffer org-clock-interrupted-task))
          (<span class="org-keyword">org-with-point-at</span> org-clock-interrupted-task
            (org-clock-in nil))
        (org-clock-out)))

    (global-set-key (kbd <span class="org-string">"C-c C-x C-q"</span>) #'leuven-org-clock-in-interrupted-task)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">8.4.3 Resolve open clocks if the user is idle more than X minutes.</span>
    (<span class="org-keyword">setq</span> org-clock-idle-time 240)

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--org-switch-to-started</span> (kwd)
      <span class="org-doc">"Switch task state to STRT.</span>
<span class="org-doc">    Skip normal headlines and capture tasks."</span>
      (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> kwd
               (not (string-equal kwd <span class="org-string">"STRT"</span>))
               (not (<span class="org-keyword">and</span> (boundp 'org-capture-mode) org-capture-mode)))
          <span class="org-string">"STRT"</span>
        nil))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">8.4.3 Set task to todo state STRT while clocking it.</span>
    (<span class="org-keyword">setq</span> org-clock-in-switch-to-state 'leuven--org-switch-to-started)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Clock won't be stopped when the clocked entry is marked DONE.</span>
    (<span class="org-keyword">setq</span> org-clock-out-when-done nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Time included for the mode line clock is all time clocked into this task</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">today.</span>
    (<span class="org-keyword">setq</span> org-clock-mode-line-total 'today)
    (<span class="org-keyword">setq</span> org-clock-mode-line-total 'all)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Get an alert (notification) when your planned time is over.</span>
    (<span class="org-keyword">setq</span> org-clock-sound <span class="org-string">"~/Public/Music/Sounds/alarm.wav"</span>)
    <span class="org-comment-delimiter">;;</span><span class="org-comment">! Use start-process to have an external program play the sound to</span>
    <span class="org-comment-delimiter">;;</span><span class="org-comment">! avoid ignored keystrokes until after the sound plays (start-process</span>
    <span class="org-comment-delimiter">;;</span><span class="org-comment">! "ding" nil "play" "~/Public/Music/Sounds/alarm.wav")</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Default range when displaying clocks with `</span><span class="org-comment"><span class="org-constant">org-clock-display</span></span><span class="org-comment">'.</span>
    (<span class="org-keyword">setq</span> org-clock-display-default-range 'untilnow)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Remove the clock line when the resulting time is 0:00.</span>
    (<span class="org-keyword">setq</span> org-clock-out-remove-zero-time-clocks t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; When clocking into a task with a clock entry which has not been</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; closed, resume the clock from that point.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-clock-in-resume t)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Ask the user if they wish to clock out before killing Emacs.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--org-query-clock-out</span> ()
      <span class="org-doc">"Ask the user before clocking out.</span>
<span class="org-doc">    This is a useful function for adding to `</span><span class="org-doc"><span class="org-constant">kill-emacs-query-functions</span></span><span class="org-doc">'."</span>
      (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> (<span class="org-keyword">featurep</span> '<span class="org-constant">org-clock</span>)
               (funcall 'org-clocking-p)
               (y-or-n-p <span class="org-string">"You are currently clocking time, clock out? "</span>))
          (org-clock-out)
        t))                             <span class="org-comment-delimiter">; </span><span class="org-comment">Only fails on keyboard quit or error.</span>

    (add-hook 'kill-emacs-query-functions #'leuven--org-query-clock-out)

    )                                   <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "org-clock" ends here.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb347ab4" class="outline-4">
<h4 id="orgb347ab4">Effort estimates</h4>
<div class="outline-text-4" id="text-orgb347ab4">
<p>
If you have an <code>Effort</code> property defined, the <b>estimated time</b> is also shown in
the mode line, against the <b>actual time</b> spent (reported through <b>time clocking</b>).
</p>

<p>
When clocking in, ask for a time estimate if the property is not yet defined.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 8.5 (info "(org)Effort estimates")</span>

  (leuven--section <span class="org-string">"8.5 (org)Effort estimates"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Add an effort estimate on the fly when clocking in.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--org-ask-effort</span> ()
    <span class="org-doc">"Ask for an effort estimate when clocking in."</span>
    (<span class="org-keyword">unless</span> (org-entry-get (point) <span class="org-string">"Effort"</span>)
      (<span class="org-keyword">let</span> ((effort
             (completing-read
              <span class="org-string">"Estimated time (H:MM): "</span>
              (org-entry-get-multivalued-property (point) <span class="org-string">"Effort"</span>))))
        (<span class="org-keyword">unless</span> (equal effort <span class="org-string">""</span>)
          (org-set-property <span class="org-string">"Effort"</span> effort)))))

  (add-hook 'org-clock-in-prepare-hook #'leuven--org-ask-effort)
</pre>
</div>

<p>
XXX We could forbid an empty answer to the effort estimate question! XXX
</p>

<p>
XXX We could ask for a ranged estimate (best case - worst case).
</p>

<p>
XXX When clocking out, show the remaining effort (allows to re-estimate for
a better schedule).
</p>
</div>
</div>
</div>

<div id="outline-container-org6a326ca" class="outline-3">
<h3 id="org6a326ca">Capture - Refile - Archive</h3>
<div class="outline-text-3" id="text-org6a326ca">
</div>
<div id="outline-container-org5ac2296" class="outline-4">
<h4 id="org5ac2296">Capture</h4>
<div class="outline-text-4" id="text-org5ac2296">
<p>
The ultimate capture tool to <b>quickly add</b> tasks or notes.
</p>

<p>
Structure:
</p>
<ul class="org-ul">
<li>Contacts</li>
<li>Calendar</li>
<li>Tasks</li>
<li>Notes</li>
<li>Journal</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 9 (info "(org)Capture - Refile - Archive")</span>

  (leuven--section <span class="org-string">"9.1 (org)Capture"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">9.1.2 Directory with Org files.</span>
  (<span class="org-keyword">setq</span> org-directory
        (directory-file-name            <span class="org-comment-delimiter">; </span><span class="org-comment">This function removes the final slash.</span>
         (<span class="org-keyword">cond</span> ((file-directory-p <span class="org-string">"~/org/"</span>) <span class="org-string">"~/org/"</span>)
               ((file-directory-p <span class="org-string">"~/org-files/"</span>) <span class="org-string">"~/org-files/"</span>)
               (t <span class="org-string">"~/"</span>))))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">9.1.2 Default target for storing notes.</span>
  (<span class="org-keyword">setq</span> org-default-notes-file          <span class="org-comment-delimiter">; </span><span class="org-comment">Inbox for collecting</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">[Default: "~/.notes"].</span>
        (<span class="org-keyword">if</span> (file-exists-p (concat org-directory <span class="org-string">"/0-refile.org"</span>))
            (concat org-directory <span class="org-string">"/0-refile.org"</span>)
          (concat org-directory <span class="org-string">"/refile.org"</span>)))
</pre>
</div>

<p>
<code>%</code>-escapes:
</p>

<dl class="org-dl">
<dt><code>%a</code></dt><dd>Annotation (<b>link</b>).</dd>

<dt><code>%i</code></dt><dd>Initial content (<b>selected text</b>).</dd>

<dt><code>%?</code></dt><dd>Cursor position.</dd>

<dt><code>%^T</code></dt><dd>Prompt for a date and time.</dd>

<dt><code>%^G</code></dt><dd>Prompt for tags with completion on tags in all agenda files.</dd>

<dt><code>%t</code></dt><dd>Time stamp (date only).</dd>

<dt><code>%^{prompt}</code></dt><dd>Prompt the user for a string.</dd>

<dt><code>%[file]</code></dt><dd>Insert the contents of the file.</dd>

<dt><code>%U</code></dt><dd>Inactive time stamp with date and time.</dd>
</dl>

<p>
Looking at the info manual I found the documentation for &ldquo;immediate-finish&rdquo;, but
not for &ldquo;jump-to-captured&rdquo;. I found it in the code and it seems to be exactly
what I want.
</p>

<p>
Use <code>:jump-to-captured</code> to tell capture to jump to the note after storing it.
</p>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Look at <code>:kill-buffer</code></b><br />
nil</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">9.1.2 templates for the creation of capture buffers</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">("Receipt"   ?r "** %^{BriefDesc} %U %^g\n%?"   "~/Personal/finances.org")</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Fast note taking in Org mode (the ultimate capture tool).</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-capture"</span>

    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"t"</span> <span class="org-string">"Task"</span> entry
                   (file+headline ,org-default-notes-file <span class="org-string">"Tasks"</span>)
                   <span class="org-string">"* NEW %^{Task}%?</span>

<span class="org-string">%i"</span>
                   <span class="org-builtin">:empty-lines</span> 1) <span class="org-warning">t)</span>

    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"T"</span> <span class="org-string">"Task in current file"</span> entry
                   (file+headline
                    (buffer-file-name (org-capture-get <span class="org-builtin">:original-buffer</span>))
                    <span class="org-string">"Tasks"</span>)
                   <span class="org-string">"* TODO %?</span>
<span class="org-string">%U %a %n"</span>
                   <span class="org-builtin">:prepend</span> t) <span class="org-warning">t)</span>

    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"a"</span> <span class="org-string">"Appt"</span> entry
                   (file+headline ,org-default-notes-file <span class="org-string">"Events"</span>)
                   <span class="org-string">"* %^{Appointment}%?</span>
<span class="org-string">%^T</span>

<span class="org-string">%i"</span>
                   <span class="org-builtin">:empty-lines</span> 1) <span class="org-warning">t)</span>
                   <span class="org-comment-delimiter">;; </span><span class="org-comment">TODO Prompt only for date, not time...</span>
</pre>
</div>
</div>

<div id="outline-container-org4f8b64b" class="outline-5">
<h5 id="org4f8b64b"><span class="todo TODO">TODO</span> Ask for refile location</h5>
<div class="outline-text-5" id="text-org4f8b64b">
<p>
Find a location for refiling on capture.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"Z"</span> <span class="org-string">"Refile me!"</span> entry
                   (<span class="org-keyword">function</span> leuven--find-location)
                   <span class="org-string">"** TODO Put this in some other file\n\n"</span>
                   <span class="org-builtin">:prepend</span> t) <span class="org-warning">t)</span>

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--find-location</span> ()
      <span class="org-doc">"Find my CollectBox file and some headline in the current buffer."</span>
      (find-file org-default-notes-file)
      (goto-char (point-min))
      (helm-org-in-buffer-headings)
      (org-forward-heading-same-level 1))
</pre>
</div>
</div>
</div>

<div id="outline-container-org470f45b" class="outline-5">
<h5 id="org470f45b"><span class="todo TODO">TODO</span> Email-to-task</h5>
<div class="outline-text-5" id="text-org470f45b">
<p>
Instantly <b>create tasks</b> and notes <b>from emails</b>, with a <b>link</b> back <b>to the emails</b>.
</p>

<p>
The following rules will apply to interpret an email to a task:
</p>

<dl class="org-dl">
<dt>Email subject</dt><dd>Task name.</dd>

<dt>Person in the <code>From:</code> field</dt><dd>Task creator.</dd>

<dt>Person(s) in the <code>To:</code> field</dt><dd>Task assignee(s).</dd>

<dt>Email body (or selected region)</dt><dd>Inserted into the task&rsquo;s description.</dd>

<dt>Email attachment(s)</dt><dd><p>
Inserted as task&rsquo;s attachment(s).
</p>

<p>
XXX Wouldn&rsquo;t it be great if files attached to email can be quickly added
to the tasks or projects you create?
</p></dd>
</dl>

<p>
Additional parameters can be included via the commands you use:
</p>

<dl class="org-dl">
<dt>Create a <code>TODO</code> Action</dt><dd>Create a new action.</dd>

<dt>Create a <code>TODO</code> Action Remind 3</dt><dd>Create a new action.  Set reminder in 3 days.</dd>

<dt>Create a <code>TODO</code> Action Due Date 7</dt><dd>Create a new action.  Set due date in 7 days.</dd>

<dt>Create a <code>TODO</code> Action of an existing Project</dt><dd>Attach it to something that we&rsquo;re already working on.</dd>

<dt>Create a <code>WAIT</code> Item</dt><dd>Create a new &ldquo;Waiting For&rdquo; item, eventually with an &ldquo;Assignee&rdquo; property.</dd>

<dt>Create a <code>SDAY</code> Item</dt><dd>Create a new &ldquo;Someday&rdquo; item.</dd>

<dt>Create a Reference Item</dt><dd>Create a new &ldquo;Reference&rdquo; item.</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"m"</span> <span class="org-string">"Email processing"</span>) t)

    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"mT"</span> <span class="org-string">"Create a TODO Action + edit"</span> entry
                   (file+headline ,org-default-notes-file <span class="org-string">"Messages"</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">#+FILETAGS: :mail:</span>
                   <span class="org-string">"* TODO %^{Creating action}%? (from %:fromname)</span>
<span class="org-string">%:date-timestamp-inactive</span>

<span class="org-string">#+begin_verse</span>
<span class="org-string">%i</span>
<span class="org-string">#+end_verse</span>

<span class="org-string">From the address &lt;%a&gt;"</span>
                   <span class="org-builtin">:empty-lines</span> 1) <span class="org-warning">t)</span>

    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"mt"</span> <span class="org-string">"Create a TODO Action"</span> entry
                   (file+headline ,org-default-notes-file <span class="org-string">"Messages"</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">#+FILETAGS: :mail:</span>
                   <span class="org-string">"* TODO %:subject%? (from %:fromname)</span>
<span class="org-string">%:date-timestamp-inactive</span>

<span class="org-string">#+begin_verse</span>
<span class="org-string">%i</span>
<span class="org-string">#+end_verse</span>

<span class="org-string">From the address &lt;%a&gt;"</span>
                   <span class="org-builtin">:empty-lines</span> 1
                   <span class="org-builtin">:immediate-finish</span> t) <span class="org-warning">t)</span>

    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"mn"</span> <span class="org-string">"Create a note"</span> entry
                   (file+headline ,org-default-notes-file <span class="org-string">"Notes"</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">#+FILETAGS: :mail:</span>
                   <span class="org-string">"* %:subject%? (from %:fromname)</span>
<span class="org-string">%:date-timestamp-inactive</span>

<span class="org-string">#+begin_verse</span>
<span class="org-string">%i</span>
<span class="org-string">#+end_verse</span>

<span class="org-string">From the address &lt;%a&gt;"</span>
                   <span class="org-builtin">:empty-lines</span> 1
                   <span class="org-builtin">:immediate-finish</span> t) <span class="org-warning">t)</span>
</pre>
</div>

<p>
The property <code>:immediate-finish</code>, when set, immediately files the item without
further prompt (skipping <code>C-c C-c</code>); very handy for quick storing of emails.
</p>

<p>
With the clock options, <code>org-capture</code> automatically clocks in.  When pressing
<code>C-c C-c</code>, it clocks out.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"p"</span> <span class="org-string">"Phone call"</span> entry
                   (file+headline ,org-default-notes-file <span class="org-string">"Phone calls"</span>)
                   <span class="org-string">"* %?"</span>
                   <span class="org-builtin">:clock-in</span> t
                   <span class="org-builtin">:clock-resume</span> t
                   <span class="org-builtin">:empty-lines</span> 1) <span class="org-warning">t)</span>

    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"i"</span> <span class="org-string">"Interruption"</span> entry
                   (file ,org-default-notes-file)
                   <span class="org-string">"A TEMPLATE HERE"</span>
                   <span class="org-builtin">:clock-in</span> t
                   <span class="org-builtin">:clock-resume</span> t) <span class="org-warning">t)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Thought.</span>
    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"n"</span> <span class="org-string">"Note"</span> entry
                   (file+headline ,org-default-notes-file <span class="org-string">"Notes"</span>)
                   <span class="org-string">"* %^{Thought}%?</span>

<span class="org-string">%i"</span>
                   <span class="org-builtin">:empty-lines</span> 1) <span class="org-warning">t)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Shopping list (stuff to buy).</span>
    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"b"</span> <span class="org-string">"Buy"</span> checkitem
                   (file+headline ,org-default-notes-file <span class="org-string">"Shopping"</span>)) <span class="org-warning">t)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add a note to the currently clocked task.</span>
    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"c"</span> <span class="org-string">"Clock sibling"</span> entry
                   (clock)
                   <span class="org-string">"* %^{Title}</span>
<span class="org-string">%U</span>
<span class="org-string">%a</span>

<span class="org-string">%i"</span>) t)

    (add-to-list 'org-capture-templates
                 `(<span class="org-string">"S"</span> <span class="org-string">"Secure safe"</span> entry
                   (file+datetree+prompt <span class="org-string">"~/.dotfiles/.hide/safe.gpg"</span>)
                   <span class="org-string">"* %(format-time-string \"%H:%M\") %^{Entry} %^G</span>
<span class="org-string">%i%?"</span>) t)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;;          </span><span class="org-comment">("w" "org-protocol" entry</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">(file ,org-default-notes-file)</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">"* TODO Review %c</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">%U"</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">:clock-in t</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">:clock-resume t</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">:immediate-finish t)</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">("web-clippings" ?w</span>
    <span class="org-comment-delimiter">;;  </span><span class="org-comment">"* %^{Title} %^g \n  :PROPERTIES:\n  :date: %^t\n  :link: %^{link}\n  :END:\n\n %x %?"</span>
    <span class="org-comment-delimiter">;;  </span><span class="org-comment">"~/org/data.org" "Web Clippings")</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Default `</span><span class="org-comment"><span class="org-constant">org-capture-templates</span></span><span class="org-comment">' key to use.</span>
    (<span class="org-keyword">setq</span> org-protocol-default-template-key <span class="org-string">"w"</span>)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    )                                   <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "org-capture" ends here.</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org5e8310d" class="outline-4">
<h4 id="org5e8310d">Attachments</h4>
<div class="outline-text-4" id="text-org5e8310d">
<p>
Use the following for conveniently accessing your data.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">bug when C-c C-l</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; 4.6 Shortcut links.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-to-list 'org-link-abbrev-alist '(("att" . org-attach-expand-link)))</span>
</pre>
</div>

<p>
Instead of modifying <code>org-link-abbrev-alist</code>, you can also use
</p>

<pre class="example">
#+LINK: att %(org-attach-expand-link)
</pre>


<p>
in your Org buffers.
</p>
</div>
</div>

<div id="outline-container-orga3678d0" class="outline-4">
<h4 id="orga3678d0">Protocols for external access</h4>
<div class="outline-text-4" id="text-orga3678d0">
<p>
Open Org source (and Capture) from Firefox.
</p>

<p>
Have a look at <a href="http://vimeo.com/5662410">Store links in Emacs Org using org-protocol.el</a>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (leuven--section <span class="org-string">"9.4 (org)Protocols"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">9.4 Capture from Firefox (to store links and text).</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-protocol"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Map online URL to an existing working file.</span>
    (add-to-list 'org-protocol-project-alist
                 '(<span class="org-string">"Worg at http://orgmode.org/worg/"</span>
                   <span class="org-builtin">:online-suffix</span> <span class="org-string">".html"</span>
                   <span class="org-builtin">:working-suffix</span> <span class="org-string">".org"</span>
                   <span class="org-builtin">:base-url</span> <span class="org-string">"http://orgmode.org/worg/"</span>
                   <span class="org-builtin">:working-directory</span> <span class="org-string">"~/Public/Repositories/worg/"</span>) <span class="org-warning">t))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org2fa87dd" class="outline-4">
<h4 id="org2fa87dd">Refile and copy</h4>
<div class="outline-text-4" id="text-org2fa87dd">
<p>
Once a date has been scheduled, <b>move the task to the appropriate project</b>, by
using the <b>refile</b> command <code>C-c C-w</code>.  This lets me select (with completion) the
header under which the entry will be placed.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"[... Org Refile]"</span>)

    (<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-org-refile-extra-files</span>
      (<span class="org-keyword">if</span> (file-exists-p <span class="org-string">"~/org/notes/"</span>)
          (directory-files <span class="org-string">"~/org/notes/"</span> t <span class="org-string">"^[</span><span class="org-string"><span class="org-negation-char">^</span></span><span class="org-string">\\.#].*\\.</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">txt</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">org</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">$"</span>)
        nil)
      <span class="org-doc">"List of extra files to be used as targets for refile commands."</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">9.5 Any headline with level &lt;= 3 is a target.</span>
    (<span class="org-keyword">setq</span> org-refile-targets
          `((nil
             <span class="org-builtin">:maxlevel</span> . 4)             <span class="org-comment-delimiter">; </span><span class="org-comment">Current file.</span>
            (,(append org-agenda-files leuven-org-refile-extra-files)
             <span class="org-builtin">:maxlevel</span> . 2)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Cache refile targets to speed up the process.</span>
    (<span class="org-keyword">setq</span> org-refile-use-cache t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">9.5 Provide refile targets as paths, including the file name (without</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">directory) as level 1 of the path.</span>
    (<span class="org-keyword">setq</span> org-refile-use-outline-path 'file)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">9.5 Allow to create new nodes (must be confirmed by the user) as refile</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">targets.</span>
    (<span class="org-keyword">setq</span> org-refile-allow-creating-parent-nodes 'confirm)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Refile only within the current buffer.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-refile-within-current-buffer</span> ()
      <span class="org-doc">"Move the entry at point to another heading in the current buffer."</span>
      (<span class="org-keyword">interactive</span>)
      (<span class="org-keyword">let</span> ((org-refile-targets '((nil <span class="org-builtin">:maxlevel</span> . 4))))
        (org-refile)))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">FIXME Add a smart key binding</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Exclude DONE state tasks from refile targets.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">bh/verify-refile-target</span> ()
      <span class="org-doc">"Exclude TODO keywords with a DONE state from refile targets."</span>
      (not (member (nth 2 (org-heading-components)) org-done-keywords)))

    (<span class="org-keyword">setq</span> org-refile-target-verify-function 'bh/verify-refile-target)
</pre>
</div>
</div>
</div>

<div id="outline-container-org30197f2" class="outline-4">
<h4 id="org30197f2">Archiving</h4>
<div class="outline-text-4" id="text-org30197f2">
<div class="org-src-container">
<pre class="src src-emacs-lisp">    (leuven--section <span class="org-string">"9.6 (org)Archiving"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">9.6.1 Subtrees should be archived in the current file.</span>
    (<span class="org-keyword">setq</span> org-archive-location <span class="org-string">"::* Archive"</span>)

    )
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org8b92228" class="outline-3">
<h3 id="org8b92228">Agenda Views</h3>
<div class="outline-text-3" id="text-org8b92228">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  (leuven--section <span class="org-string">"10 (org)Agenda Views"</span>)

<span class="org-comment-delimiter">;;</span><span class="org-comment">* 10 (info "(org)Agenda Views")</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-agenda"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Multiple same-day time stamps in entry make multiple agenda lines.</span>
    (<span class="org-keyword">setq</span> org-agenda-skip-additional-timestamps-same-entry nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Show outline path in echo area after line motion (though, may bring some</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">slowness).</span>
    (<span class="org-keyword">setq</span> org-agenda-show-outline-path t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">10.0 Restore the window configuration when exiting the agenda.</span>
    (<span class="org-keyword">setq</span> org-agenda-restore-windows-after-quit t)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Speed up agenda by avoiding to update some text properties.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-agenda-ignore-properties '(effort category)) ; org.el</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Normally hide the "someday" (nice-to-have) things.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-agenda-filter-preset '("-SDAY"))</span>
</pre>
</div>
</div>

<div id="outline-container-org21c2552" class="outline-4">
<h4 id="org21c2552">Agenda files</h4>
<div class="outline-text-4" id="text-org21c2552">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 10.1 (info "(org)Agenda files")</span>

    (leuven--section <span class="org-string">"10.1 (org)Agenda files"</span>)

    (<span class="org-keyword">when</span> (boundp 'org-agenda-files)
      (message <span class="org-string">"[Found %s entries in `</span><span class="org-string"><span class="org-constant">org-agenda-files</span></span><span class="org-string">']"</span>
               (length org-agenda-files))
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(sit-for 0.5)</span>
      )
</pre>
</div>

<p>
Avoid any possibility of getting a customized version of <code>org-agenda-files</code> added
at the end of your <code>.emacs</code> file.
</p>

<pre class="example">
    (add-hook 'org-mode-hook
              #'(lambda ()
                  (local-unset-key (kbd "C-c ["))
                  (local-unset-key (kbd "C-c ]"))))
</pre>

<p>
Otherwise, through this hook, every org file is automatically &ldquo;filed&rdquo; and any to
do items inside will be found by the org-mode agenda builder.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add Org files to the agenda when we save them.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">to-agenda-on-save-org-mode-file</span>()
      (<span class="org-keyword">when</span> (string= (message <span class="org-string">"%s"</span> major-mode) <span class="org-string">"org-mode"</span>)
        (org-agenda-file-to-front)))

    (add-hook 'after-save-hook 'to-agenda-on-save-org-mode-file)
</pre>
</div>

<p>
This does mean that when files are deleted or moved the org agenda complains.
</p>
</div>
</div>

<div id="outline-container-orgb0440e3" class="outline-4">
<h4 id="orgb0440e3">The agenda dispatcher</h4>
<div class="outline-text-4" id="text-orgb0440e3">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 10.2 (info "(org)Agenda dispatcher")</span>

    (leuven--section <span class="org-string">"10.2 (org)Agenda dispatcher"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable sticky agenda: `q' key will bury agenda buffers (instead of</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">killing).</span>
    (<span class="org-keyword">setq</span> org-agenda-sticky t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org13b0aa3" class="outline-4">
<h4 id="org13b0aa3">The Built-in agenda views</h4>
<div class="outline-text-4" id="text-org13b0aa3">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 10.3 The (info "(org)Built-in agenda views")</span>

    (leuven--section <span class="org-string">"10.3 (org)Built-in agenda views"</span>)
</pre>
</div>

<p>
Press <code>C-c a a</code> to jump you to this week&rsquo;s task page from anywhere.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Default duration for appointments that only have a starting time.</span>
    (<span class="org-keyword">setq</span> org-agenda-default-appointment-duration nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Duration of an appointment will add to day effort.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-agenda-columns-add-appointments-to-effort-sum t)</span>
</pre>
</div>

<p>
<code>C-c a t</code> should show <b>all</b> the <code>TODO</code> items&#x2026; but&#x2026;
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Show dated entries in the global `</span><span class="org-comment"><span class="org-constant">todo</span></span><span class="org-comment">' list.</span>
    (<span class="org-keyword">setq</span> org-agenda-todo-ignore-with-date nil)
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">!! tricky setting</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Show entries with a time stamp in the global `</span><span class="org-comment"><span class="org-constant">todo</span></span><span class="org-comment">' list.</span>
    (<span class="org-keyword">setq</span> org-agenda-todo-ignore-timestamp nil)
</pre>
</div>

<p>
Don&rsquo;t tell me about stuff that isn&rsquo;t due yet: tasks scheduled in the future
should no longer show up in global todo or tags searches until that date
arrives &#x2013; at which point it will be in all lists.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">10.3.2 Don't show scheduled entries in the global `</span><span class="org-comment"><span class="org-constant">todo</span></span><span class="org-comment">' list.</span>
    (<span class="org-keyword">setq</span> org-agenda-todo-ignore-scheduled 'future)
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">!! Tricky setting.</span>
    (<span class="org-keyword">setq</span> org-agenda-todo-ignore-scheduled nil)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">10.3.2 Don't show entries scheduled in the future in the global</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">todo</span></span><span class="org-comment">' list (until they are within the warning period).</span>
    (<span class="org-keyword">setq</span> org-agenda-todo-ignore-deadlines 'near)
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">!! Tricky setting.</span>
    (<span class="org-keyword">setq</span> org-agenda-todo-ignore-deadlines nil)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">10.3.2 Check also the sublevels of a TODO entry for TODO entries,</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">resulting in potentially much longer `</span><span class="org-comment"><span class="org-constant">todo</span></span><span class="org-comment">' lists.</span>
    (<span class="org-keyword">setq</span> org-agenda-todo-list-sublevels t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">10.3.3 Honor `</span><span class="org-comment"><span class="org-constant">todo</span></span><span class="org-comment">' list `</span><span class="org-comment"><span class="org-constant">org-agenda-todo-ignore...</span></span><span class="org-comment">' options also</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">in the `</span><span class="org-comment"><span class="org-constant">tags-todo</span></span><span class="org-comment">' list.</span>
    (<span class="org-keyword">setq</span> org-agenda-tags-todo-honor-ignore-options t)
</pre>
</div>
</div>

<div id="outline-container-orgeff169f" class="outline-5">
<h5 id="orgeff169f">Advanced Search</h5>
<div class="outline-text-5" id="text-orgeff169f">
<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">10.3.5 List of extra files to be searched by text search commands</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(C-c a s).</span>
    (<span class="org-keyword">setq</span> org-agenda-text-search-extra-files nil) <span class="org-comment-delimiter">; </span><span class="org-comment">org.el</span>

    (<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-org-search-extra-files</span> nil
      <span class="org-doc">"List of extra files to be searched by custom search commands (`R s' and `R S')."</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Turn on individual word search (for Google addicts).</span>
    (<span class="org-keyword">setq</span> org-agenda-search-view-always-boolean t
          org-agenda-search-view-search-words-only t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Match part of a word.</span>
    (<span class="org-keyword">setq</span> org-agenda-search-view-force-full-words nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't search headline for a time-of-day (unwanted side effects).</span>
    (<span class="org-keyword">setq</span> org-agenda-search-headline-for-time nil)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">10.3.6 How to identify stuck projects.</span>
    (<span class="org-keyword">setq</span> org-stuck-projects
          '(<span class="org-string">"+LEVEL=2/-DONE"</span>            <span class="org-comment-delimiter">; </span><span class="org-comment">Identify a project.</span>
            (<span class="org-string">"TODO"</span> <span class="org-string">"STRT"</span>)             <span class="org-comment-delimiter">; </span><span class="org-comment">Todo keywords.</span>
            nil <span class="org-string">""</span>))                    <span class="org-comment-delimiter">; </span><span class="org-comment">Tags, regexp.</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org9292efc" class="outline-4">
<h4 id="org9292efc">Presentation and sorting</h4>
<div class="outline-text-4" id="text-org9292efc">
<p>
See
<a href="http://www.dgtale.ch/index.php?option=com_content&amp;view=article&amp;id=52&amp;Itemid=61">http://www.dgtale.ch/index.php?option=com_content&amp;view=article&amp;id=52&amp;Itemid=61</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 10.4 (info "(org)Presentation and sorting")</span>

    (leuven--section <span class="org-string">"10.4 (org)Presentation and sorting"</span>)
</pre>
</div>

<p>
You can modify <code>org-agenda-prefix-format</code> to show extra information in the lists.
</p>

<div class="note">
<p>
If none of the built-in format specifiers are sufficient, you can use
<code>%(my-function-here)</code> as a specifier and <code>my-function-here</code> will be called on each
headline (to return any kind of string you want).
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">10.4 Format specifications for the prefix of items in the agenda views.</span>
    (<span class="org-keyword">setq</span> org-agenda-prefix-format
          '((agenda   . <span class="org-string">" %-11s%i %?-12t"</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">Agenda.</span>
            (timeline . <span class="org-string">" % s"</span>)         <span class="org-comment-delimiter">; </span><span class="org-comment">Timeline.</span>
            (todo     . <span class="org-string">" %i %-12:c"</span>)   <span class="org-comment-delimiter">; </span><span class="org-comment">Todo, alltodo.</span>
            (tags     . <span class="org-string">" %i %-12:c"</span>)   <span class="org-comment-delimiter">; </span><span class="org-comment">Tags, tags-todo, stuck.</span>
            (search   . <span class="org-string">" %i %-12:c"</span>))) <span class="org-comment-delimiter">; </span><span class="org-comment">Search.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Type "(" in agenda and todo buffers to show category name and task</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">length for each task.</span>
    (<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven--org-agenda-show-tasks-details</span> nil)
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-agenda-toggle-tasks-details</span> ()
      <span class="org-doc">"Hide/show tasks details (category and time estimate) in agenda views."</span>
      (<span class="org-keyword">interactive</span>)
      (<span class="org-keyword">if</span> leuven--org-agenda-show-tasks-details
          (<span class="org-keyword">progn</span>
            (<span class="org-keyword">setq</span> leuven--org-agenda-show-tasks-details nil)
            (<span class="org-keyword">setq</span> org-agenda-prefix-format
                  '((agenda    . <span class="org-string">" %-11s%i %?-12t"</span>)
                    (timeline  . <span class="org-string">" % s"</span>)
                    (todo      . <span class="org-string">" "</span>)
                    (search    . <span class="org-string">" "</span>)
                    (tags      . <span class="org-string">" "</span>))))
        (<span class="org-keyword">setq</span> leuven--org-agenda-show-tasks-details t)
        (<span class="org-keyword">setq</span> org-agenda-prefix-format
              '((agenda   . <span class="org-string">" %-11s%i %-12:c%?-12t%7e "</span>)
                (timeline . <span class="org-string">" % s"</span>)
                (todo     . <span class="org-string">" %i %-12:c"</span>)
                (search   . <span class="org-string">" %i %-12:c"</span>)
                (tags     . <span class="org-string">" %i %-12:c"</span>))))
      (org-agenda-redo))

    (define-key org-agenda-mode-map
      (kbd <span class="org-string">"("</span>) #'leuven-org-agenda-toggle-tasks-details)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Text preceding scheduled items in the agenda view.</span>
    (<span class="org-keyword">setq</span> org-agenda-scheduled-leaders
          '(<span class="org-string">"Scheduled  "</span>
            <span class="org-string">"           "</span>))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Text preceding item pulled into the agenda by inactive time stamps.</span>
    (<span class="org-keyword">setq</span> org-agenda-inactive-leader <span class="org-string">"["</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Text preceding deadline items in the agenda view.</span>
    (<span class="org-keyword">setq</span> org-agenda-deadline-leaders
          '(<span class="org-string">"Deadline   "</span>
            <span class="org-string">"In %d d"</span>                   <span class="org-comment-delimiter">; </span><span class="org-comment">Or "%d d left".</span>
            <span class="org-string">"%d d ago"</span>))

    )                                   <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "org-agenda" ends here.</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-faces"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Faces for showing deadlines in the agenda.</span>
    (<span class="org-keyword">setq</span> org-agenda-deadline-faces
          '((1.0001 . leuven-org-deadline-overdue)
            (0.9999 . leuven-org-deadline-today)
            (0.8571 . leuven-org-deadline-tomorrow) <span class="org-comment-delimiter">; </span><span class="org-comment">= 6/7, see `</span><span class="org-comment"><span class="org-constant">org-deadline-warning-days</span></span><span class="org-comment">'</span>
            (0.0000 . leuven-org-deadline-future)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">See http://www.dgtale.ch/index.php?option=com_content&amp;view=article&amp;id=52&amp;Itemid=61.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Org non-standard faces.</span>
    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-deadline-overdue</span>
      '((t <span class="org-builtin">:foreground</span> <span class="org-string">"#F22659"</span>))
      <span class="org-doc">"Face used to highlight tasks whose due date is in the past."</span>)

    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-deadline-today</span>
      '((t <span class="org-builtin">:weight</span> bold <span class="org-builtin">:foreground</span> <span class="org-string">"#4F4A3D"</span> <span class="org-builtin">:background</span> <span class="org-string">"#FFFFCC"</span>))
      <span class="org-doc">"Face used to highlight tasks whose due date is today."</span>)

    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-deadline-tomorrow</span>
      '((t <span class="org-builtin">:foreground</span> <span class="org-string">"#40A80B"</span>))
      <span class="org-doc">"Face used to highlight tasks whose due date is tomorrow."</span>)

    (<span class="org-keyword">defface</span> <span class="org-variable-name">leuven-org-deadline-future</span>
      '((t <span class="org-builtin">:foreground</span> <span class="org-string">"#40A80B"</span>))
      <span class="org-doc">"Face used to highlight tasks whose due date is for later."</span>))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-agenda"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; 10.4 Column to shift tags to (in agenda items).</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-agenda-tags-column -132)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Right-justify tags in the agenda buffer.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--org-agenda-right-justify-tags</span> ()
      <span class="org-doc">"Justify the tags to the right border of the agenda window."</span>
      (<span class="org-keyword">let</span> ((org-agenda-tags-column (- 2 (window-width))))
        (org-agenda-align-tags)))
    (add-hook 'org-agenda-finalize-hook #'leuven--org-agenda-right-justify-tags))
</pre>
</div>

<p>
Show the time grid in the daily agenda but not in the weekly agenda, except
for today&rsquo;s date:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">10.4.2 Settings for time grid for agenda display.</span>
  (<span class="org-keyword">setq</span> org-agenda-time-grid '((daily remove-match)
                               <span class="org-string">""</span>
                               (0800 1000 1200 1400 1600 1800 2000)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Recent Org-mode.</span>
  (<span class="org-keyword">setq</span> org-agenda-time-grid '((daily today remove-match)
                                (0800 1000 1200 1400 1600 1800 2000)
                                <span class="org-string">"...... "</span> <span class="org-string">""</span>))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">String for the current time marker in the agenda.</span>
  (<span class="org-keyword">setq</span> org-agenda-current-time-string <span class="org-string">"Right now"</span>)
</pre>
</div>

<p>
<code>time-up</code> will only be applied to those items have a time stamp for the day in
question, so that other sorting parameters will not be outranked by <code>time-up</code> for
the rest of the entries.
</p>

<div class="note">
<p>
The file <code>0-refile.org</code> should come first.  My current workaround is to add
<code>:CATEGORY: @refile</code> in its subtrees, as the <code>@</code> symbol is alphabetically before the
letters.
</p>

</div>

<p>
Agenda view: put related tasks together, then by priority.
</p>

<div class="note">
<p>
Not sure about that anymore: the agenda view is to work on tasks, hence prior
tasks (then grouped by project) should arrive ahead; on the opposite, when doing
a review, it&rsquo;s good to have all tasks grouped by project.
</p>

</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Sort agenda by prior, then categ, then date</b><br />
<p>
Inverting <code>category-up</code> and <code>priority-down</code> in the agenda does unexpected
sorting: first by priority (OK), but then by scheduled time (while it should be
grouped by category)!
</p>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">10.4.3 Sorting structure for the agenda items of a single day.</span>
  (<span class="org-keyword">setq</span> org-agenda-sorting-strategy   <span class="org-comment-delimiter">; </span><span class="org-comment">custom value</span>
        '((agenda time-up category-up priority-down effort-down)
          <span class="org-comment-delimiter">;; </span><span class="org-comment">(agenda priority-down time-up category-up effort-down)</span>
          (todo category-up priority-down effort-down)
          (tags category-up priority-down effort-down)
          (search category-up)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Show agenda in the current window, keeping all other windows.</span>
  (<span class="org-keyword">setq</span> org-agenda-window-setup 'current-window)
</pre>
</div>

<p>
With this function, the new sort order is temporary.  Pressing <code>r</code> for refresh
will restore the default sort order for the buffer:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-agenda-change-sorting-strategy</span> (strategy)
    <span class="org-doc">"Change the sorting strategy."</span>
    (<span class="org-keyword">interactive</span> (list
                  (completing-read <span class="org-string">"Choose a strategy: "</span>
                                   (mapcar 'cdr (cdr org-sorting-choice))
                                   nil t)))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">adjust the following types as needed - e.g., add 'agenda, etc.</span>
    (org-agenda-check-type t 'todo 'tags 'search)
    (<span class="org-keyword">let</span> ((org-agenda-sorting-strategy (list (intern strategy))))
  (org-agenda-redo)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgca325e3" class="outline-4">
<h4 id="orgca325e3">Agenda commands</h4>
<div class="outline-text-4" id="text-orgca325e3">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 10.5 (info "(org)Agenda commands")</span>

  (leuven--section <span class="org-string">"10.5 (org)Agenda commands"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Get a compact view during follow mode in the agenda.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--compact-follow</span> ()
    <span class="org-doc">"Make the view compact, then show the necessary minimum."</span>
    (<span class="org-keyword">ignore-errors</span>
      (<span class="org-keyword">save-excursion</span>
        (<span class="org-keyword">while</span> (org-up-heading-safe))
        (hide-subtree)))
    (<span class="org-keyword">let</span> ((org-show-siblings nil)
          (org-show-hierarchy-above t))
      (org-reveal))
    (<span class="org-keyword">save-excursion</span>
      (org-back-to-heading t)
      (show-children)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">FIXME When this is enabled, clicking on a clock line from `v c'</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(log check) does not jump to the right line</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'org-agenda-after-show-hook #'leuven--compact-follow)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">10.5 Number of days to include in overview display.</span>
  (<span class="org-keyword">setq</span> org-agenda-span 'day)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Always start the overview on the current day.</span>
  (<span class="org-keyword">setq</span> org-agenda-start-on-weekday nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Format string for displaying dates in the daily/weekly agenda</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">and in the timeline.</span>
  (<span class="org-keyword">setq</span> org-agenda-format-date
        (concat                         <span class="org-comment-delimiter">; </span><span class="org-comment">"\n"</span>
                <span class="org-string">"%Y-%m-%d"</span> <span class="org-string">" %a "</span>
                <span class="org-comment-delimiter">;; </span><span class="org-comment">(make-string (1- (window-width)) (string-to-char "_"))))</span>
                (make-string 65 (string-to-char <span class="org-string">" "</span>))
                <span class="org-string">"_"</span>
                <span class="org-comment-delimiter">;; </span><span class="org-comment">(make-string 1 ?\u25AE)</span>
                ))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">10.5 Only show clocked entries in agenda log mode (no closed</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">entries, no state changes).</span>
  (<span class="org-keyword">setq</span> org-agenda-log-mode-items '(clock))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">10.5 Parameters for the clocktable in clockreport mode.</span>
  (<span class="org-keyword">setq</span> org-agenda-clockreport-parameter-plist
        '(<span class="org-builtin">:link</span> nil <span class="org-builtin">:maxlevel</span> 3 <span class="org-builtin">:fileskip0</span> t))
  (<span class="org-keyword">setq</span> org-agenda-clockreport-parameter-plist
        '(<span class="org-builtin">:link</span> t <span class="org-builtin">:maxlevel</span> 3 <span class="org-builtin">:fileskip0</span> t))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">10.5 Definition of what constitutes a clocking problem (overlapping</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">clock entries, clocking gaps).</span>
  (<span class="org-keyword">setq</span> org-agenda-clock-consistency-checks
        '(<span class="org-builtin">:max-duration</span> <span class="org-string">"10:00"</span>
          <span class="org-builtin">:min-duration</span> 0
          <span class="org-builtin">:max-gap</span> <span class="org-string">"0:00"</span>
          <span class="org-builtin">:gap-ok-around</span> (<span class="org-string">"4:00"</span>)
          <span class="org-builtin">:default-face</span>
          ((<span class="org-builtin">:weight</span> bold
            <span class="org-builtin">:box</span> (<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#AAEE77"</span>)
            <span class="org-builtin">:foreground</span> <span class="org-string">"black"</span> <span class="org-builtin">:background</span> <span class="org-string">"#BFFA9E"</span>))
          <span class="org-builtin">:gap-face</span>
          ((<span class="org-builtin">:weight</span> bold
            <span class="org-builtin">:box</span> (<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#BBDDFF"</span>)
            <span class="org-builtin">:foreground</span> <span class="org-string">"black"</span> <span class="org-builtin">:background</span> <span class="org-string">"#D0EDFF"</span>))))
</pre>
</div>

<p>
If you press <code>E</code>, it will <b>show</b> the <b>first notes</b> about the tasks.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">10.5 Text prepended to the entry text in agenda buffers.</span>
  (<span class="org-keyword">setq</span> org-agenda-entry-text-leaders <span class="org-string">"               │ "</span>)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">10.5 File to which to add new entries with the `i' key in agenda and</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">calendar (org.el).</span>
  (<span class="org-keyword">setq</span> org-agenda-diary-file <span class="org-string">"~/org/diary.org"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">10.5? Keep filters from one agenda view to the next.</span>
  (<span class="org-keyword">setq</span> org-agenda-persistent-filter t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Faces for specific Priorities (#A, #B and #C).</span>
  (<span class="org-keyword">setq</span> org-priority-faces
        '((?A . (<span class="org-builtin">:foreground</span> <span class="org-string">"#CC0000"</span> <span class="org-builtin">:background</span> <span class="org-string">"#FFE3E3"</span>))
          (?B . (<span class="org-builtin">:foreground</span> <span class="org-string">"#64992C"</span> <span class="org-builtin">:background</span> <span class="org-string">"#EBF4DD"</span>))
          (?C . (<span class="org-builtin">:foreground</span> <span class="org-string">"#64992C"</span> <span class="org-builtin">:background</span> <span class="org-string">"#FFFFFF"</span>))))
</pre>
</div>

<p>
Contextual auto-exclusion for tags in the Agenda view.  For example, I use the
following tags for <code>TODO</code>:
</p>

<dl class="org-dl">
<dt>Phone</dt><dd>Needs a phone.</dd>

<dt>Errands</dt><dd>Done in town.</dd>

<dt>Home</dt><dd>Done at home.</dd>
</dl>

<p>
Now, it&rsquo;s quite easy for my computer to figure out which of these are
possible, based on my location:
</p>

<dl class="org-dl">
<dt>Phone</dt><dd>Am I outside of normal calling hours?</dd>

<dt>Errands</dt><dd>Am I outside of business hours?</dd>

<dt>Home</dt><dd>Does my IP address begin with 192.168?</dd>
</dl>

<p>
I can now define the function <code>leuven--org-auto-exclude-function</code> to auto-exclude
based on this type of context information.
</p>

<p>
All I have to do is type <code>/ RET</code> in the agenda view now, and it excludes based
on my machine&rsquo;s current temporal and physical context.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">10.5 Commands in the agenda buffer.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--weekday-p</span> ()
    <span class="org-doc">"Return t if current day is between Monday and Friday."</span>
    (<span class="org-keyword">let</span> ((dow (nth 6 (decode-time))))
      (<span class="org-keyword">and</span> (&gt; dow 0)
           (&lt; dow 6))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--working-p</span> ()
    <span class="org-doc">"Return t if current time is inside normal working hours.</span>
<span class="org-doc">  Currently: 08:30-12:30 and 13:30-17:30."</span>
    (<span class="org-keyword">let*</span> ((time (decode-time))
           (hour (nth 2 time))
           (mins (nth 1 time)))
      (<span class="org-keyword">and</span> (leuven--weekday-p)
           (<span class="org-keyword">or</span> (<span class="org-keyword">or</span> (<span class="org-keyword">and</span> (= hour 8) (&gt;= mins 30))
                   (<span class="org-keyword">and</span> (&lt; 8 hour) (&lt; hour 12))
                   (<span class="org-keyword">and</span> (= hour 12) (&lt;= mins 30)))
               (<span class="org-keyword">or</span> (<span class="org-keyword">and</span> (= hour 13) (&gt;= mins 30))
                   (<span class="org-keyword">and</span> (&lt; 13 hour) (&lt; hour 17))
                   (<span class="org-keyword">and</span> (= hour 17) (&lt;= mins 30)))))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--calling-hours-p</span> ()
    <span class="org-doc">"Return t if current time is inside normal calling hours.</span>
<span class="org-doc">  Currently: 08:00-21:59."</span>
    (<span class="org-keyword">let*</span> ((hour (nth 2 (decode-time))))
      (<span class="org-keyword">and</span> (&lt;= 8 hour) (&lt;= hour 21))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--org-auto-exclude-function</span> (tag)
    (<span class="org-keyword">and</span> (<span class="org-keyword">cond</span>
          ((string= tag <span class="org-string">"personal"</span>)
           (<span class="org-keyword">with-temp-buffer</span>
             (call-process <span class="org-string">"/sbin/ifconfig"</span> nil t nil <span class="org-string">"en0"</span> <span class="org-string">"inet"</span>)
             (goto-char (point-min))
             (not (re-search-forward <span class="org-string">"inet 192\\.168\\.9\\."</span> nil t))))
          ((<span class="org-keyword">or</span> (string= tag <span class="org-string">"errands"</span>)
               (string= tag <span class="org-string">"call"</span>))
           (<span class="org-keyword">let</span> ((hour (nth 2 (decode-time))))
             (<span class="org-keyword">or</span> (&lt; hour 8) (&gt; hour 21)))))
         (concat <span class="org-string">"-"</span> tag)))

  <span class="org-comment-delimiter">;;</span><span class="org-comment">! Ensure that `</span><span class="org-comment"><span class="org-constant">:refile:</span></span><span class="org-comment">' tags never will be excluded!</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--org-auto-exclude-function</span> (tag)
    (<span class="org-keyword">and</span> (<span class="org-keyword">cond</span>
          ((string= tag <span class="org-string">"personal"</span>)
           (leuven--working-p))
          ((string= tag <span class="org-string">"work"</span>)
           (not (leuven--working-p)))
          ((<span class="org-keyword">or</span> (string= tag <span class="org-string">"errands"</span>)
               (string= tag <span class="org-string">"call"</span>))
           (not (leuven--calling-hours-p))))
         (concat <span class="org-string">"-"</span> tag)))

  (<span class="org-keyword">setq</span> org-agenda-auto-exclude-function 'leuven--org-auto-exclude-function)
</pre>
</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> We should ensure that appointments don&rsquo;t disappear when filtering late at nite</b><br />
<ul class="org-ul">
<li>Look at appointments tagged <code>errands</code></li>
<li>Filter at 23:00 with <code>/ RET</code></li>
<li>Appointments such as &ldquo;going to the doctor&rdquo; will be removed from the agenda
view&#x2026;</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgbac646d" class="outline-4">
<h4 id="orgbac646d">Custom agenda views</h4>
<div class="outline-text-4" id="text-orgbac646d">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Make the block agenda more compact (no agenda span name, no week number, no</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">separator line).</span>
  (<span class="org-keyword">setq</span> org-agenda-compact-blocks t)
  (<span class="org-keyword">setq</span> org-agenda-compact-blocks nil)

  (<span class="org-keyword">setq</span> org-agenda-block-separator
        (propertize (make-string 132 (string-to-char <span class="org-string">"_"</span>))
                    'face '(<span class="org-builtin">:foreground</span> <span class="org-string">"#59ACE2"</span>))) <span class="org-comment-delimiter">; </span><span class="org-comment">lighter version with #C0E2F4</span>
</pre>
</div>

<p>
Links to common agenda views:
</p>
<ul class="org-ul">
<li><a href="(org-agenda nil "a")">(org-agenda nil "a")</a></li>
<li><a href="(org-agenda nil "w")">Show Waiting Tasks</a></li>
<li><a href="(org-agenda nil "p")">Show Projects</a></li>
</ul>

<p>
or even:
</p>

<pre class="example">
[[org-search:+work-boss-TODO="DONE"]]
</pre>


<p>
if you define a new type of link.  See <a href="http://endlessparentheses.com/use-org-mode-links-for-absolutely-anything.html">Use Org-Mode Links for Absolutely Anything</a>
for more.
</p>

<p>
You can as well use your agenda and use <code>/</code> to limit the view to what you want
(<code>C-c a a / TAG</code>).
</p>

<p>
Commands:
</p>
<ul class="org-ul">
<li><a href="ls -l">ls -l</a></li>
<li><a href="pwd">pwd</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 10.6 (info "(org)Custom agenda views")</span>

  (leuven--section <span class="org-string">"10.6 (org)Custom agenda views"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-agenda"</span>
    (<span class="org-keyword">let</span> ((leuven-org-agenda-views
           (concat leuven--directory <span class="org-string">"org-leuven-agenda-views.el"</span>)))
      (<span class="org-keyword">when</span> (file-exists-p leuven-org-agenda-views)
        (load-file leuven-org-agenda-views))))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "org-agenda" ends here.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgef4c289" class="outline-4">
<h4 id="orgef4c289">Display all TODO items from the current directory</h4>
<div class="outline-text-4" id="text-orgef4c289">
<p>
The function <code>leuven-org-todo-list-current-dir</code> will display your tasks from the
current directory (including from local files <code>TODO.org</code> and <code>BUGS.org</code>, for
example).
</p>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Add recursive option to show all tasks from subdir</b><br />
nil</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-todo-list-current-dir</span> ()
    <span class="org-doc">"Produce a view from all Org files in the current directory."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let*</span> ((fname (buffer-file-name))
           (dname (<span class="org-keyword">if</span> fname
                      (<span class="org-keyword">if</span> (file-directory-p fname)
                          fname
                        (file-name-directory fname))
                    default-directory))
           (org-agenda-files (directory-files dname t <span class="org-string">"\\.</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">org</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">txt</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">$"</span>))
           (org-agenda-sorting-strategy '(todo-state-up priority-down))
           (org-agenda-overriding-header
            (format <span class="org-string">"TODO items in directory: %s"</span> dname))
           (org-agenda-sticky nil))
      (message <span class="org-string">"[%s...]"</span> org-agenda-overriding-header)
      (org-todo-list)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">"TODO list" without asking for a directory.</span>
  (global-set-key (kbd <span class="org-string">"&lt;M-S-f6&gt;"</span>) #'leuven-org-todo-list-current-dir)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf866c52" class="outline-4">
<h4 id="orgf866c52">Exporting Agenda Views</h4>
<div class="outline-text-4" id="text-orgf866c52">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 10.7 (info "(org)Exporting Agenda Views")</span>

  (leuven--section <span class="org-string">"10.7 (org)Exporting Agenda Views"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">10.7 Alist of variable/value pairs that should be active during agenda</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">export.</span>
  (<span class="org-keyword">setq</span> org-agenda-exporter-settings
        '((ps-number-of-columns 1)      <span class="org-comment-delimiter">; </span><span class="org-comment">2?</span>
          (ps-landscape-mode t)
          <span class="org-comment-delimiter">;; </span><span class="org-comment">(org-agenda-add-entry-text-maxlines 5)</span>
          (htmlize-output-type 'css)))
</pre>
</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> htmlize-output-type is duplicated lots of times!</b><br />
nil</div>
</div>
</div>

<div id="outline-container-orgad779f1" class="outline-4">
<h4 id="orgad779f1">Agenda column view</h4>
<div class="outline-text-4" id="text-orgad779f1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 10.8 (info "(org)Agenda column view")</span>

  (leuven--section <span class="org-string">"10.8 (org)Agenda column view"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">10.8 Default column format, if no other format has been defined.</span>
  (<span class="org-keyword">setq</span> org-columns-default-format
        <span class="org-comment-delimiter">;; </span><span class="org-comment">"%65ITEM(Task) %DEADLINE(Due Date) %PRIORITY %6CLOCKSUM(Spent) %6Effort(Estim.){:}")</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">"%1BLOCKED %4TODO %CATEGORY %5Effort{:} %50ITEM %20TAGS %21ALLTAGS")</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">"%65ITEM(Task) %4TODO %PRIORITY %6Effort(Estim.) %14SCHEDULED %14DEADLINE(Due Date)")</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">"%65ITEM(Task) %4TODO %PRIORITY %20TAGS %6Effort(Estim.) %14SCHEDULED %14DEADLINE(Due Date)")</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">"%40ITEM(Task) %17Effort(Estimated Effort){:} %CLOCKSUM"</span>
        <span class="org-string">"%60ITEM(Details) %5PRIORITY(Prio) %14SCHEDULED(Scheduled) %15TAGS(Context) %7TODO(To Do) %6CLOCKSUM(Clock) %5Effort(Effort){:} "</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">DUPLICATE Obey `</span><span class="org-comment"><span class="org-constant">eval</span></span><span class="org-comment">' variables -- RISKY!</span>
  (<span class="org-keyword">setq</span> enable-local-eval t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org760cc35" class="outline-4">
<h4 id="org760cc35">Not sorted</h4>
<div class="outline-text-4" id="text-org760cc35">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-agenda"</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">defadvice</span> <span class="org-function-name">org-agenda-switch-to</span>
      (after leuven-org-agenda-switch-to activate)
      <span class="org-doc">"Recenter after jumping to the file which contains the item at point."</span>
      (recenter))
</pre>
</div>
</div>

<div id="outline-container-org6fe3bd7" class="outline-5">
<h5 id="org6fe3bd7">Mouse cursor doesn&rsquo;t highlight agenda lines</h5>
<div class="outline-text-5" id="text-org6fe3bd7">
<p>
XXX Does this work?
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (add-hook 'org-agenda-finalize-hook
              #'(lambda ()
                  (remove-text-properties (point-min) (point-max)
                                          '(mouse-face t))))
</pre>
</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Adding &ldquo;:tangle yes&rdquo; on the above code block results in partial tangling!</b><br />
nil</div>
</div>
</div>

<div id="outline-container-org0e428f5" class="outline-5">
<h5 id="org0e428f5">Emphasize items in agenda</h5>
<div class="outline-text-5" id="text-org0e428f5">
<div class="org-src-container">
<pre class="src src-emacs-lisp">    (add-hook 'org-agenda-finalize-hook
              #'(lambda ()
                  (<span class="org-keyword">let</span> ((inhibit-read-only t))
                    (goto-char (point-min))
                    (org-do-emphasis-faces (point-max)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgceaca55" class="outline-5">
<h5 id="orgceaca55">Mark a task as DONE and create a follow-up task</h5>
<div class="outline-text-5" id="text-orgceaca55">
<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-agenda-mark-done-and-add-followup</span> ()
      <span class="org-doc">"Mark the current TODO as done and add another task after it.</span>
<span class="org-doc">Creates it at the same level as the previous task, so it's better to use</span>
<span class="org-doc">this with to-do items than with projects or headings."</span>
      (<span class="org-keyword">interactive</span>)
      (org-agenda-todo <span class="org-string">"DONE"</span>)
      (org-agenda-switch-to)
      (org-capture 0 <span class="org-string">"t"</span>))

    (define-key org-agenda-mode-map
      (kbd <span class="org-string">"Z"</span>) #'leuven-org-agenda-mark-done-and-add-followup)
</pre>
</div>

<p>
Source: Sacha Chua.
</p>
</div>
</div>

<div id="outline-container-org364001b" class="outline-5">
<h5 id="org364001b">Capture something based on the agenda</h5>
<div class="outline-text-5" id="text-org364001b">
<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-agenda-new</span> ()
      <span class="org-doc">"Create a new note or task at the current agenda item.</span>
<span class="org-doc">Creates it at the same level as the previous task, so it's better to use</span>
<span class="org-doc">this with to-do items than with projects or headings."</span>
      (<span class="org-keyword">interactive</span>)
      (org-agenda-switch-to)
      (org-capture 0))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; New key assignment (overrides `</span><span class="org-comment"><span class="org-constant">org-agenda-next-item</span></span><span class="org-comment">').</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key org-agenda-mode-map (kbd "N") #'leuven-org-agenda-new)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  )
</pre>
</div>

<p>
Source: Sacha Chua.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orgd720f65" class="outline-3">
<h3 id="orgd720f65">Markup for rich export</h3>
<div class="outline-text-3" id="text-orgd720f65">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 11 (info "(org)Markup")</span>

  (leuven--section <span class="org-string">"11 (org)Markup"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-faces"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add a face to #+begin_quote and #+begin_verse blocks.</span>
    (<span class="org-keyword">setq</span> org-fontify-quote-and-verse-blocks t))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"[... Org Markup]"</span>)

    <span class="org-comment-delimiter">;;</span><span class="org-comment">??? Change the face of a headline (as an additional information) if it is</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">marked DONE (to face `</span><span class="org-comment"><span class="org-constant">org-headline-done</span></span><span class="org-comment">').</span>
    (<span class="org-keyword">setq</span> org-fontify-done-headline t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">11.1 Hide the emphasis marker characters.</span>
    (<span class="org-keyword">setq</span> org-hide-emphasis-markers t)  <span class="org-comment-delimiter">; </span><span class="org-comment">Impact on table alignment!</span>
</pre>
</div>
</div>

<div id="outline-container-org98f3a5a" class="outline-4">
<h4 id="org98f3a5a">Images and Tables</h4>
<div class="outline-text-4" id="text-org98f3a5a">
<p>
Automatic screenshot insertion.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-insert-image-or-take-screenshot</span> (name)
      <span class="org-doc">"Insert a link to an already existing image, or else to a screenshot.</span>
<span class="org-doc">    The screenshot is either taken to the given non-existing file name,</span>
<span class="org-doc">    or added into the given directory, defaulting to the current one."</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">FIXME: Should limit to '("pdf" "jpeg" "jpg" "png" "ps" "eps")</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">which is org-export-latex-inline-image-extensions.</span>
      (<span class="org-keyword">interactive</span> <span class="org-string">"GImage name? "</span>)
      (<span class="org-keyword">when</span> (file-directory-p name)
        (<span class="org-keyword">setq</span> name (concat
                    (make-temp-name
                     (expand-file-name
                      (concat (file-name-as-directory name)
                              (subst-char-in-string
                               <span class="org-string">"."</span> <span class="org-string">"-"</span>
                               (file-name-sans-extension
                                (file-name-nondirectory
                                 (buffer-file-name)))))))
                    <span class="org-string">".png"</span>)))
      (<span class="org-keyword">unless</span> (file-exists-p name)
        (<span class="org-keyword">if</span> (file-writable-p name)
            (<span class="org-keyword">progn</span>
              (message <span class="org-string">"[Taking screenshot into %s]"</span> name)
              (call-process <span class="org-string">"import"</span> nil nil nil name)
              (message <span class="org-string">"[Taking screenshot...done]"</span>))
          (<span class="org-warning">error</span> <span class="org-string">"Cannot create image file"</span>)))
      (insert (concat <span class="org-string">"[["</span> name <span class="org-string">"]]"</span>))
      (org-display-inline-images))
</pre>
</div>
</div>
</div>

<div id="outline-container-org47cb980" class="outline-4">
<h4 id="org47cb980">Macro replacement</h4>
<div class="outline-text-4" id="text-org47cb980">
<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Hide the brackets marking macro calls.</span>
    (<span class="org-keyword">setq</span> org-hide-macro-markers t)

    (<span class="org-keyword">defun</span> <span class="org-function-name">org-macro-insert</span> ()
      (<span class="org-keyword">interactive</span>)
      (<span class="org-keyword">let*</span> ((macros (org-macro--collect-macros))
             (macro (completing-read <span class="org-string">"Insert macro: "</span> (mapcar 'car macros)))
             (args (string-match <span class="org-string">"$[[:digit:]]"</span> (cdr (assoc macro macros))))
             pos)
        (insert (format  <span class="org-string">"{{{%s"</span> macro))
        (<span class="org-keyword">when</span> args (insert <span class="org-string">"("</span>) (<span class="org-keyword">setq</span> pos (point)) (insert <span class="org-string">")"</span>))
        (insert <span class="org-string">"}}}"</span>)
        (<span class="org-keyword">when</span> pos (goto-char pos)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org050ed3f" class="outline-4">
<h4 id="org050ed3f">Embedded LaTeX</h4>
<div class="outline-text-4" id="text-org050ed3f">
<p>
To get one entity in the middle of a word, use <code>{}</code>, i.e. some <code>w\entity{}rd</code> (new
exporter only).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">11.7.1 Define user entities to produce special characters.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-entities"</span>

    (add-to-list 'org-entities-user
                 '(<span class="org-string">"ok"</span>
                   <span class="org-comment-delimiter">;; </span><span class="org-comment">\definecolor{checkmark}{HTML}{1FAC21}</span>
                   <span class="org-string">"{\\color{checkmark}\\ding{51}}"</span> nil
                   <span class="org-string">"&lt;font color='green'&gt;&amp;#x2714;&lt;/font&gt;"</span>
                   <span class="org-string">"OK"</span>
                   <span class="org-string">"OK"</span> <span class="org-string">"✔"</span>))

    (add-to-list 'org-entities-user
                 '(<span class="org-string">"nok"</span>
                   <span class="org-comment-delimiter">;; </span><span class="org-comment">\usepackage{pifont}</span>
                   <span class="org-string">"{\\color{red}\\ding{55}}"</span> nil
                   <span class="org-string">"&lt;font color='red'&gt;&amp;#x2718;&lt;/font&gt;"</span>
                   <span class="org-string">"NOK"</span>
                   <span class="org-string">"NOK"</span> <span class="org-string">"✘"</span>)))
</pre>
</div>

<p>
To list all available entities, run <code>M-x org-entities-help</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">11.7.2 Interpret "_" and "^" for display when braces are used.</span>
  (<span class="org-keyword">setq</span> org-use-sub-superscripts '{})

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; 11.7.3 Convert LaTeX fragments to images when exporting to HTML (using MathJax).</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-export-with-latex t)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Highlight LaTeX and related syntax.</span>
  (<span class="org-keyword">setq</span> org-highlight-latex-and-related '(latex script entities))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Show entities as UTF8 characters.</span>
  (<span class="org-keyword">setq</span> org-pretty-entities t)          <span class="org-comment-delimiter">; </span><span class="org-comment">emsp, etc.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Pretty entity display doesn't include formatting sub/superscripts.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-pretty-entities-include-sub-superscripts nil)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org3e93543" class="outline-3">
<h3 id="org3e93543">Exporting</h3>
<div class="outline-text-3" id="text-org3e93543">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 12 (info "(org)Exporting")</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Bind the exporter dispatcher to a key sequence.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"[... Org Exporting]"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Libraries in this list will be loaded once the export framework is needed.</span>
    (<span class="org-keyword">setq</span> org-export-backends '(ascii html icalendar latex odt md))

    (define-key org-mode-map (kbd <span class="org-string">"C-c C-e"</span>) #'org-export-dispatch))
</pre>
</div>

<p>
For Org buffers, add an enhanced version of <code>save-buffer</code> which does:
</p>

<ol class="org-ol">
<li>Save buffer (updating dynamic blocks and tables)</li>
<li>Execute the code blocks, and save once again</li>
<li>Tangle code blocks, if any to be tangled</li>
<li>Export to HTML and PDF, if such files already exist</li>
<li>Call <code>send-patch</code>?</li>
</ol>

<p>
Notes:
</p>
<ul class="org-ul">
<li>Use the asynchronous export (if possible, so that I don&rsquo;t loose time, or let
it open to the value of that var)?</li>
<li>Different behaviors can be obtained with <code>C-u</code> (or <code>C-u C-u</code>)</li>
</ul>

<p>
Why not adding a recursive functionality as well (in Emacs Lisp too), to be
launched from Dired?
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>

    (<span class="org-keyword">defun</span> <span class="org-function-name">org-save-buffer-and-do-related</span> ()
      <span class="org-doc">"Save buffer, execute/tangle code blocks, and export to HTML/PDF."</span>
      (<span class="org-keyword">interactive</span>)
      (<span class="org-keyword">let*</span> ((orgfile (buffer-file-name))
             (base-name (file-name-base orgfile))
             (mdfile (concat base-name <span class="org-string">".md"</span>))
             (htmlfile (concat base-name <span class="org-string">".html"</span>))
             (texfile (concat base-name <span class="org-string">".tex"</span>))
             (pdffile (concat base-name <span class="org-string">".pdf"</span>)))
        (save-buffer)                   <span class="org-comment-delimiter">; </span><span class="org-comment">See other commands in</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">before-save-hook</span></span><span class="org-comment">':</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">org-update-all-dblocks</span></span><span class="org-comment">'</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">org-table-iterate-buffer-tables</span></span><span class="org-comment">'.</span>
        (<span class="org-keyword">when</span> (derived-mode-p 'org-mode)
          (<span class="org-keyword">measure-time</span> <span class="org-string">"Restarted Org mode"</span> (org-mode-restart))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Update information from one of the</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">special #+KEYWORD lines</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">(like `C-c C-c')</span>

          <span class="org-comment-delimiter">;; </span><span class="org-comment">Linting for Org documents.</span>
          (<span class="org-keyword">when</span> (try-require <span class="org-string">"org-lint"</span>)
            (<span class="org-keyword">measure-time</span> <span class="org-string">"Linted Org mode"</span>
                          (<span class="org-keyword">if</span> (org-lint)
                              (<span class="org-keyword">progn</span>
                                (message <span class="org-string">"[You should run `</span><span class="org-string"><span class="org-constant">org-lint</span></span><span class="org-string">'!!!]"</span>)
                                (beep)
                                (sit-for 1)))))

          <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Update the results in the Org buffer.</span>
          <span class="org-comment-delimiter">;; </span><span class="org-comment">(org-babel-execute-buffer)    ; In this case, better than</span>
          <span class="org-comment-delimiter">;;                               </span><span class="org-comment">; (add-hook 'org-export-first-hook</span>
          <span class="org-comment-delimiter">;;                               </span><span class="org-comment">;           #'org-babel-execute-buffer):</span>
          <span class="org-comment-delimiter">;;                               </span><span class="org-comment">; executed only once for both exports.</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">It'd make sense to eval all code blocks which have :cache yes or :exports</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">results or both... And, before that, to delete all code block results!?</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Well, almost all code blocks: not the ones of "cached" blocks (they may have</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">taken a long time to be computed, or may not be computable another time), nor</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">the ones with a caption on the results block...</span>

          (<span class="org-keyword">measure-time</span> <span class="org-string">"Buffer saved"</span>
           (<span class="org-keyword">let</span> ((before-save-hook nil))
             (save-buffer)))
          (<span class="org-keyword">measure-time</span> <span class="org-string">"Buffer tangled"</span>
           (org-babel-tangle))
          (<span class="org-keyword">when</span> (file-exists-p mdfile)
            (<span class="org-keyword">if</span> (file-newer-than-file-p orgfile mdfile)
                (<span class="org-keyword">measure-time</span> <span class="org-string">"Buffer exported to Markdown"</span>
                 (org-md-export-to-markdown))
              (message <span class="org-string">"[Markdown is up to date with Org file]"</span>)))
          (<span class="org-keyword">when</span> (file-exists-p htmlfile)
            (<span class="org-keyword">if</span> (file-newer-than-file-p orgfile htmlfile)
                (<span class="org-keyword">measure-time</span> <span class="org-string">"Buffer exported to HTML"</span>
                 (org-html-export-to-html))
              (message <span class="org-string">"[HTML is up to date with Org file]"</span>)))
          (<span class="org-keyword">when</span> (<span class="org-keyword">or</span> (file-exists-p texfile) (file-exists-p pdffile))
            (<span class="org-keyword">if</span> (<span class="org-keyword">or</span> (<span class="org-keyword">and</span> (file-exists-p pdffile)
                         (file-newer-than-file-p orgfile pdffile))
                    (<span class="org-keyword">and</span> (file-exists-p texfile)
                         (not (file-exists-p pdffile))))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Previous PDF export failed.</span>
                (<span class="org-keyword">measure-time</span> <span class="org-string">"Buffer exported to PDF LaTeX"</span>
                 (<span class="org-keyword">if</span> (string-match <span class="org-string">"^#\\+BEAMER_THEME: "</span> (buffer-string))
                     (org-beamer-export-to-pdf)
                   (org-latex-export-to-pdf)))
              (message <span class="org-string">"[PDF is up to date with Org file]"</span>)))
          (beep))))

    (define-key org-mode-map (kbd <span class="org-string">"&lt;f9&gt;"</span>) #'org-save-buffer-and-do-related))
</pre>
</div>

<div class="note">
<p>
When called non-interactively, <code>org-lint</code> returns the reports, as an alist or nil,
so it can be used as a predicate.
</p>

</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Execute all code blocks in buffer</b><br />
<p>
Ce qui serait mieux :
</p>

<ul class="org-ul">
<li>executer tout dans le buffer (sauf les never, évidemment)</li>
<li>exporter en let-bind&rsquo;ant eval à never&#x2026; SAUF POUR DES BLOCKS DONT ON NE
VOULAIT PAS LE RÉSULTAT (TROP LONG, PAR EXEMPLE) DANS LE BUFFER MAIS QUE L&rsquo;ON
VEUT À L&rsquo;EXPORT !!</li>
</ul>

<p>
Ansi, on aurait les valeurs à jour dans le buffer Org, et les deux exports
(HTML et PDF) seraient identiques entre eux, et avec le buffer Org.
</p>
</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Check that SETUPFILES (like for Bigblow) or INCLUDE files exist</b><br />
<p>
Before exporting&#x2026;
</p>
</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Map through inline code blocks to remove inline results</b><br />
<p>
<code>(org-babel-map-inline-src-blocks nil (org-babel-remove-inline-result))</code>
</p>
</div>
</div>

<div id="outline-container-org5456e31" class="outline-4">
<h4 id="org5456e31">Export options</h4>
<div class="outline-text-4" id="text-org5456e31">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 12.2 (info "(org)Export options")</span>

  (leuven--section <span class="org-string">"12.2 (org)Export options"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Org generic export engine.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ox"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">12.3 Don't insert a time stamp into the exported file.</span>
    (<span class="org-keyword">setq</span> org-export-time-stamp-file nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">13.1.5 Export all drawers (including properties).</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-export-with-drawers t)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Default language of HTML export (see `</span><span class="org-comment"><span class="org-constant">org-export-language-setup</span></span><span class="org-comment">' XXX).</span>
    (<span class="org-keyword">setq</span> org-export-default-language <span class="org-string">"en"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Include priority cookies in export.</span>
    (<span class="org-keyword">setq</span> org-export-with-priority t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Activate smart quotes during export (convert " to \og, \fg in French).</span>
    (<span class="org-keyword">setq</span> org-export-with-smart-quotes t) <span class="org-comment-delimiter">; </span><span class="org-comment">curly quotes in HTML</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Interpret "_" and "^" for export when braces are used.</span>
    (<span class="org-keyword">setq</span> org-export-with-sub-superscripts '{})

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Allow #+BIND to define local variable values for export.</span>
    (<span class="org-keyword">setq</span> org-export-allow-bind-keywords t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Exported stuff will not be pushed onto the kill ring.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-export-copy-to-kill-ring nil) ; new default since 2014-04-17</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Export and publishing commands will run in background.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-export-in-background t)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Use a non-intrusive export dispatcher.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-export-dispatch-use-expert-ui t)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Export snippet translations.</span>
    (add-to-list 'org-export-snippet-translation-alist
                 '(<span class="org-string">"h"</span> . <span class="org-string">"html"</span>))
    (add-to-list 'org-export-snippet-translation-alist
                 '(<span class="org-string">"l"</span> . <span class="org-string">"latex"</span>))
    (add-to-list 'org-export-snippet-translation-alist
                 '(<span class="org-string">"b"</span> . <span class="org-string">"beamer"</span>))

    )                                   <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "ox" ends here.</span>
</pre>
</div>

<p>
Eric Schulte has proposed the <code>by-backend</code> function (updated by Nicolas Goaziou)
for <b>backend-dependent execution</b> (for example, conditionally export TikZ to an
SVG image on HTML export and insert TikZ &ldquo;as is&rdquo; on PDF export):
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defmacro</span> <span class="org-function-name">by-backend</span> (<span class="org-type">&amp;rest</span> body)
    `(<span class="org-keyword">case</span> org-export-current-backend ,@body))
</pre>
</div>

<p>
See <a href="http://orgmode.org/worg/org-contrib/babel/languages/ob-doc-LaTeX.html#sec-4-3">Backend dependent execution &#x2013; conditionally export tikz to SVG on HTML export</a>
for more information.
</p>
</div>
</div>

<div id="outline-container-orgfbef609" class="outline-4">
<h4 id="orgfbef609">Export settings</h4>
<div class="outline-text-4" id="text-orgfbef609">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 12.3 Export settings</span>

  (<span class="org-keyword">setq</span> org-export-exclude-tags '(<span class="org-string">"noexport"</span> <span class="org-string">"crypt"</span>))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgaf5358d" class="outline-4">
<h4 id="orgaf5358d">HTML export</h4>
<div class="outline-text-4" id="text-orgaf5358d">
<p>
To get a start for your CSS file, use the command
<code>M-x org-export-htmlize-generate-css</code> to extract class definitions.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 12.5 (info "(org)HTML export")</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Org HTML export engine.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ox-html"</span>

    (<span class="org-keyword">setq</span> org-html-checkbox-type 'unicode)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Output type to be used by htmlize when formatting code snippets.</span>
    (<span class="org-keyword">setq</span> org-html-htmlize-output-type 'css)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; URL pointing to a CSS file defining text colors for htmlized Emacs</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; buffers.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-org-htmlized-css-url "style.css")</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; XML declaration.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-html-xml-declaration</span>
    <span class="org-comment-delimiter">;;       </span><span class="org-comment">'(("html" . "&lt;!-- &lt;xml version=\"1.0\" encoding=\"%s\"&gt; --&gt;")</span>
    <span class="org-comment-delimiter">;;         </span><span class="org-comment">("was-html" . "&lt;?xml version=\"1.0\" encoding=\"%s\"?&gt;")</span>
    <span class="org-comment-delimiter">;;         </span><span class="org-comment">("php" . "&lt;?php echo \"&lt;?xml version=\\\"1.0\\\" encoding=\\\"%s\\\" ?&gt;\"; ?&gt;")))</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Coding system for HTML export.</span>
    (<span class="org-keyword">setq</span> org-html-coding-system 'utf-8)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Format for the HTML postamble.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-html-postamble</span>
    <span class="org-comment-delimiter">;;       </span><span class="org-comment">"  &lt;div id=\"footer\"&gt;&lt;div id=\"copyright\"&gt;\n    &amp;copy; %d %a\n  &lt;/div&gt;&lt;/div&gt;")</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">13.1.5 Don't include the JavaScript snippets in exported HTML files.</span>
    (<span class="org-keyword">setq</span> org-html-head-include-scripts nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; 12.5.9 Turn inclusion of the default CSS style off.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-html-head-include-default-style nil)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">      <span class="org-comment-delimiter">;; </span><span class="org-comment">HTML checkbox output.</span>
      (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--checkbox-filter</span> (item backend info)
        (<span class="org-keyword">when</span> (org-export-derived-backend-p backend 'html)
          (replace-regexp-in-string
           <span class="org-string">"\\`.*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">&lt;code&gt;\\[</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">X</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">&amp;#xa0;</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">-</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">\\]&lt;/code&gt;</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">.*$"</span>
           #'(lambda (rep)
               (<span class="org-keyword">let</span> ((check (match-string 2 rep)))
                 (<span class="org-keyword">cond</span> ((equal check <span class="org-string">"X"</span>) <span class="org-string">"&amp;#x2611;"</span>)
                       ((equal check <span class="org-string">"-"</span>) <span class="org-string">"&amp;#x2610;"</span>)
                       (t <span class="org-string">"&amp;#x2610;"</span>))))
           item
           nil nil 1)))
      (add-to-list 'org-export-filter-item-functions
                   'leuven--checkbox-filter)

    )                                   <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "ox-html" ends here.</span>
</pre>
</div>

<p>
Emacs 23+ users: in order to avoid &ldquo;Invalid face&rdquo; errors, you need to use the
version of <code>htmlize</code> made available by Carsten Dominik in <code>org-mode/contrib/lisp</code>
directory.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(emacs-goodies-el)htmlize")</span>

  (leuven--section <span class="org-string">"(emacs-goodies-el)htmlize"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">HTML-ize font-lock buffers.</span>
  (autoload 'htmlize-buffer <span class="org-string">"htmlize"</span>
    <span class="org-doc">"Convert BUFFER to HTML, preserving colors and decorations."</span> t)
  (autoload 'htmlize-region <span class="org-string">"htmlize"</span>
    <span class="org-doc">"Convert the region to HTML, preserving colors and decorations."</span> t)
  (autoload 'htmlize-file <span class="org-string">"htmlize"</span>
    <span class="org-doc">"Load FILE, fontify it, convert it to HTML, and save the result."</span> t)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"htmlize"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Output type of generated HTML.</span>
    (<span class="org-keyword">setq</span> htmlize-output-type 'css)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">XXX Override output type `</span><span class="org-comment"><span class="org-constant">inline-css</span></span><span class="org-comment">' used for htmlizing a region.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">htmlize-region-for-paste</span> (beg end)
      <span class="org-doc">"Htmlize the region and return just the HTML as a string.</span>
<span class="org-doc">    This forces the `</span><span class="org-doc"><span class="org-constant">css</span></span><span class="org-doc">' style and only returns the HTML body, but without the</span>
<span class="org-doc">    BODY tag.  This should make it useful for inserting the text to another HTML</span>
<span class="org-doc">    buffer."</span>
      (<span class="org-keyword">let*</span> ((htmlize-output-type 'css)  <span class="org-comment-delimiter">; </span><span class="org-comment">Was `</span><span class="org-comment"><span class="org-constant">inline-css</span></span><span class="org-comment">'.</span>
             (htmlbuf (htmlize-region beg end)))
        (<span class="org-keyword">unwind-protect</span>
            (<span class="org-keyword">with-current-buffer</span> htmlbuf
              (buffer-substring
               (plist-get htmlize-buffer-places 'content-start)
               (plist-get htmlize-buffer-places 'content-end)))
          (kill-buffer htmlbuf))))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Charset declared by the resulting HTML documents.</span>
    (<span class="org-keyword">setq</span> htmlize-html-charset <span class="org-string">"utf-8"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Non-ASCII characters (codes in the 128-255 range) are copied to</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">HTML without modification -- if your HTML is in Unicode.</span>
    (<span class="org-keyword">setq</span> htmlize-convert-nonascii-to-entities nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Key binding.</span>
    (global-set-key (kbd <span class="org-string">"M-P"</span>) #'htmlize-buffer)

    )                                   <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "htmlize" ends here.</span>
</pre>
</div>

<p>
To get around PostScript problems, you can write the buffer to your browser
and then print from there, and in color.
</p>

<p>
This adds a Quick Print option to your menu bar (under File).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Quick print preview (to Web browser) with `</span><span class="org-comment"><span class="org-constant">htmlize-view-buffer</span></span><span class="org-comment">'.</span>
  (autoload 'htmlize-view-buffer <span class="org-string">"htmlize-view"</span>
    <span class="org-doc">"Convert buffer to html preserving faces and view in web browser."</span> t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Same key binding as Org export to HTML (open in browser).</span>
  (global-set-key (kbd <span class="org-string">"C-c C-e h o"</span>) #'htmlize-view-buffer)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">View current buffer as html in web browser.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"htmlize-view"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add "Quick Print" entry to file menu.</span>
    (htmlize-view-add-to-files-menu))
</pre>
</div>

<p>
Now, you can print from the browser in (complete) Unicode, using your system&rsquo;s
capabilities.
</p>
</div>
</div>

<div id="outline-container-org78c87c6" class="outline-4">
<h4 id="org78c87c6">LaTeX and PDF export</h4>
<div class="outline-text-4" id="text-org78c87c6">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 12.6 (info "(org)LaTeX and PDF export")</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (leuven--section <span class="org-string">"12.6 (org)LaTeX and PDF export"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">LaTeX back-end.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ox-latex"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Markup for TODO keywords and for tags, as a printf format.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--org-latex-format-headline</span>
        (todo todo-type priority text tags <span class="org-type">&amp;optional</span> info)
      <span class="org-doc">"Default function for formatting the headline's text."</span>
      (concat (<span class="org-keyword">when</span> todo
                (format <span class="org-string">"{%s\\textbf{\\textsc{\\textsf{%s}}}} "</span>
                        (<span class="org-keyword">cond</span> ((equal todo-type 'todo) <span class="org-string">"\\color{red}"</span>)
                              ((equal todo-type 'done) <span class="org-string">"\\color{teal}"</span>)
                              (t <span class="org-string">"\\color{gray}"</span>))
                        todo))
              (<span class="org-keyword">when</span> priority
                (format <span class="org-string">"\\framebox{\\#%c} "</span> priority))
              text
              (<span class="org-keyword">when</span> tags
                (format <span class="org-string">"\\hfill{}\\fbox{\\textsc{%s}}"</span>
                <span class="org-comment-delimiter">;; </span><span class="org-comment">XXX source of "undefined control sequence"?</span>
                  (mapconcat 'identity tags <span class="org-string">":"</span>)))))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Function for formatting the headline's text.</span>
    (<span class="org-keyword">setq</span> org-latex-format-headline-function
          'leuven--org-latex-format-headline)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Default width for images.</span>
    (<span class="org-keyword">setq</span> org-latex-image-default-width <span class="org-string">".75\\linewidth"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Format string for links with unknown path type.</span>
    (<span class="org-keyword">setq</span> org-latex-link-with-unknown-path-format <span class="org-string">"\\colorbox{red}{%s}"</span>)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Default process to convert LaTeX fragments to image files.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-preview-latex-default-process 'imagemagick)</span>
</pre>
</div>

<p>
Look at the variable <code>org-latex-remove-logfiles</code>, which controls whether some
of the files produced by LaTeX (<code>org-latex-logfiles-extensions</code>) are removed.
</p>

<div class="warning">
<p>
Under Windows Emacs, <code>executable-find</code> searches for <code>latexmk.exe</code> only; it <b>never</b>
<b>will find the Cygwin symlink</b> to <code>latexmk.pl</code>, though Cygwin bin directory is first
in the PATH.
</p>

<p>
OTOH, when commands will be launched by the Org export process, as that will run
in the Bash/Zsh shell, Org will call the first match for <code>latexmk</code>, hence the one
from Cygwin&#x2026;
</p>

<p>
Not very coherent!
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--change-pdflatex-program</span> (backend)
      <span class="org-doc">"Automatically run XeLaTeX, if asked, when exporting to LaTeX."</span>

      (<span class="org-keyword">when</span> (equal org-export-current-backend <span class="org-string">"latex"</span>)

        (<span class="org-keyword">let*</span> ((org-latex-pdf-engine-full-path
                (<span class="org-keyword">cond</span> ((string-match <span class="org-string">"^#\\+LATEX_CMD: xelatex"</span> (buffer-string))
                       (<span class="org-keyword">or</span> (executable-find <span class="org-string">"xelatex"</span>)
                           (<span class="org-warning">error</span> <span class="org-string">"Please install XeLaTeX."</span>)))
                      (t
                       (<span class="org-keyword">or</span> (executable-find <span class="org-string">"pdflatex"</span>)
                           (<span class="org-warning">error</span> <span class="org-string">"Please install PDFLaTeX."</span>)))))

               (org-latex-pdf-command
                (<span class="org-keyword">cond</span> ((executable-find <span class="org-string">"latexmk"</span>)
                       <span class="org-string">"latexmk"</span>)
                      (t
                       (file-name-base org-latex-pdf-engine-full-path))))
                                          <span class="org-comment-delimiter">; </span><span class="org-comment">"xelatex" or "pdflatex".</span>

               (latex-file
                (<span class="org-keyword">cond</span> ((string-match <span class="org-string">"^/usr/bin/"</span> org-latex-pdf-engine-full-path)
                       <span class="org-string">"$(cygpath -m %f)"</span>)
                      (t
                       <span class="org-string">"%f"</span>))))

          (message <span class="org-string">"[LaTeX engine: %s]"</span> org-latex-pdf-engine-full-path)
          (message <span class="org-string">"[LaTeX command: %s]"</span> org-latex-pdf-command)

          (<span class="org-keyword">setq</span> org-latex-pdf-process
                (<span class="org-keyword">cond</span> ((equal org-latex-pdf-command <span class="org-string">"latexmk"</span>)
                       `(<span class="org-comment-delimiter">;; </span><span class="org-comment">"echo f = %f" "echo quotedf = '%f'" "echo cygpath = $(cygpath %f)"</span>
                         <span class="org-string">"latexmk --version"</span>
                         ,(concat <span class="org-string">"latexmk -cd -f -pdf -pdflatex="</span> (file-name-base org-latex-pdf-engine-full-path) <span class="org-string">" "</span> latex-file
                                  <span class="org-string">" &amp;&amp; latexmk -c"</span>))) <span class="org-comment-delimiter">; </span><span class="org-comment">Clean up all nonessential files.</span>
                      ((equal org-latex-pdf-command <span class="org-string">"xelatex"</span>)
                       `(,(concat <span class="org-string">"xelatex -interaction=nonstopmode -output-directory=%o "</span> latex-file)
                         ,(concat <span class="org-string">"xelatex -interaction=nonstopmode -output-directory=%o "</span> latex-file)
                         ,(concat <span class="org-string">"xelatex -interaction=nonstopmode -output-directory=%o "</span> latex-file)))
                      (t
                       `(,(concat <span class="org-string">"pdflatex -interaction=nonstopmode -output-directory=%o "</span> latex-file)
                         ,(concat <span class="org-string">"pdflatex -interaction=nonstopmode -output-directory=%o "</span> latex-file)
                         ,(concat <span class="org-string">"pdflatex -interaction=nonstopmode -output-directory=%o "</span> latex-file)))))
          (message <span class="org-string">"[Export command: %S]"</span> org-latex-pdf-process)
          )))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Hook run before parsing an export buffer.</span>
    (add-hook 'org-export-before-parsing-hook #'leuven--change-pdflatex-program)
</pre>
</div>

<div class="warning">
<p>
As of 2015-09-29, it seems that <code>LATEX_COMPILER</code> is the keyword to use the above
functionality in standard Org mode!
</p>

</div>

<div class="note">
<p>
If LaTeXmk succeeds, the <code>.tex</code> file should be removed as well (as we can produce
it independently anyway); but adding <code>rm $(cygpath %f)</code> did not do the trick (in
Windows Emacs, well in Cygwin Emacs!?)&#x2026;
</p>

</div>

<div class="tip">
<p>
You can clear out this individual function by calling <code>remove-hook</code>:
</p>

<pre class="example">
(remove-hook 'org-export-before-parsing-hook #'leuven--change-pdflatex-program)
</pre>

</div>

<p>
You can easily customize this variable on a per file basis.  If you seldom use
<code>bibtex</code>, have the default be to run <code>pdflatex</code> just once or twice.  Then, for any
Org file that needs <code>bibtex</code>, simply put in the following line (or a variation
thereof):
</p>

<div class="org-src-container">
<pre class="src src-org"><span class="org-org-meta-line">#+BIND: org-latex-pdf-process ("pdflatex %b" "bibtex %b" "pdflatex %b" "pdflatex %b")</span>
</pre>
</div>

<p>
Also, you can use <code>latexmk</code> (in TeX Live) which can save you some time when it
is not necessary to rebuild index and/or bibliography.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Export source code using `</span><span class="org-comment"><span class="org-constant">listings</span></span><span class="org-comment">' (instead of `</span><span class="org-comment"><span class="org-constant">verbatim</span></span><span class="org-comment">').</span>
    (<span class="org-keyword">setq</span> org-latex-listings t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">12.6.2 Default packages to be inserted in the header.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Include the `</span><span class="org-comment"><span class="org-constant">listings</span></span><span class="org-comment">' package for fontified source code.</span>
    (add-to-list 'org-latex-packages-alist '(<span class="org-string">""</span> <span class="org-string">"listings"</span>) t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Include the `</span><span class="org-comment"><span class="org-constant">xcolor</span></span><span class="org-comment">' package for colored source code.</span>
    (add-to-list 'org-latex-packages-alist '(<span class="org-string">""</span> <span class="org-string">"xcolor"</span>) t)
</pre>
</div>

<p>
When using the <code>utf8</code> option to <code>inputenc</code> (and not <code>utf8x</code> which should be avoided,
as it uses <code>ucs</code> which is no longer maintained), we have 2 solutions to support
the UTF-8 <b>no-break space</b>:
</p>

<ul class="org-ul">
<li><p>
Convert it in Org mode, when exporting (via a filter), or
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Filter for no-break spaces.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--latex-filter-nbsp</span> (text backend info)
      <span class="org-doc">"Convert no-break spaces when exporting to LaTeX/Beamer."</span>
      (<span class="org-keyword">when</span> (memq backend '(latex beamer))
        (replace-regexp-in-string <span class="org-string">" "</span> <span class="org-string">"~"</span> text)))

    (add-to-list 'org-export-filter-plain-text-functions
                 'leuven--latex-filter-nbsp)
</pre>
</div></li>

<li><p>
Convert it in LaTeX:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Convert `</span><span class="org-comment"><span class="org-constant">nbsp</span></span><span class="org-comment">' to its LaTeX equivalent.</span>
    (add-to-list 'org-latex-packages-alist
                 (concat <span class="org-string">"\\ifdefined\\DeclareUnicodeCharacter{"</span>
                         <span class="org-string">"\\DeclareUnicodeCharacter{00A0}{~}"</span>
                         <span class="org-string">"}\\fi"</span>) <span class="org-warning">t)</span>
</pre>
</div></li>
</ul>

<p>
XXX The first one is better because &#x2026; (see mail of Daniel Flipo)
</p>

<p>
The exporter will <b>add</b> a language option to the LaTeX <code>babel</code> package according to
the <code>#+LANGUAGE:</code> keyword (only) if:
</p>

<ul class="org-ul">
<li>The <code>babel</code> package is explicitly loaded (in preamble), <span class="underline">and</span></li>
<li>The language is different from the one set by the user.</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Include the `</span><span class="org-comment"><span class="org-constant">babel</span></span><span class="org-comment">' package for language-specific hyphenation and</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">typography.</span>
    (add-to-list 'org-latex-packages-alist '(<span class="org-string">"french"</span> <span class="org-string">"babel"</span>) t)
</pre>
</div>

<p>
What about <code>apacite</code> and <code>tikz</code> in <code>org-latex-packages-alist</code>?
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--change-pdflatex-packages</span> (backend)
      <span class="org-doc">"Automatically select the LaTeX packages to include (depending on PDFLaTeX</span>
<span class="org-doc">    vs. XeLaTeX) when exporting When exporting to LaTeX."</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Unconditionally remove `</span><span class="org-comment"><span class="org-constant">inputenc</span></span><span class="org-comment">' from all the default packages.</span>
      (<span class="org-keyword">setq</span> org-latex-packages-alist
            (delete '(<span class="org-string">"AUTO"</span> <span class="org-string">"inputenc"</span> t)
                    org-latex-packages-alist))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Unconditionally remove `</span><span class="org-comment"><span class="org-constant">fontenc</span></span><span class="org-comment">' from all the default packages.</span>
      (<span class="org-keyword">setq</span> org-latex-packages-alist
            (delete '(<span class="org-string">"T1"</span> <span class="org-string">"fontenc"</span> t)
                    org-latex-packages-alist))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Unconditionally remove `</span><span class="org-comment"><span class="org-constant">textcomp</span></span><span class="org-comment">' from all the default packages.</span>
      (<span class="org-keyword">setq</span> org-latex-packages-alist
            (delete '(<span class="org-string">""</span> <span class="org-string">"textcomp"</span> t)
                    org-latex-packages-alist))

      (<span class="org-keyword">if</span> (string-match <span class="org-string">"^#\\+LATEX_CMD: xelatex"</span> (buffer-string))
          <span class="org-comment-delimiter">;; </span><span class="org-comment">Packages to include when XeLaTeX is used.</span>
          (<span class="org-keyword">setq</span> org-export-latex-packages-alist
                '((<span class="org-string">""</span> <span class="org-string">"fontspec"</span> t)
                  (<span class="org-string">""</span> <span class="org-string">"xunicode"</span> t)
                  <span class="org-comment-delimiter">;; </span><span class="org-comment">Add here things like `</span><span class="org-comment"><span class="org-constant">\setmainfont{Georgia}</span></span><span class="org-comment">'.</span>
                  ))

        <span class="org-comment-delimiter">;; </span><span class="org-comment">Packages to include when PDFLaTeX is used.</span>
        (<span class="org-keyword">setq</span> org-export-latex-packages-alist
              '((<span class="org-string">"AUTO"</span> <span class="org-string">"inputenc"</span> t)
                (<span class="org-string">"T1"</span> <span class="org-string">"fontenc"</span> t)
                (<span class="org-string">""</span> <span class="org-string">"textcomp"</span> t))))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Packages to always include.</span>
      (add-to-list 'org-export-latex-packages-alist
                   '(<span class="org-string">"frenchb"</span> <span class="org-string">"babel"</span>) t))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Hook run before parsing an export buffer.</span>
    (add-hook 'org-export-before-parsing-hook #'leuven--change-pdflatex-packages)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">12.6.5 Default position for LaTeX figures.</span>
    (<span class="org-keyword">setq</span> org-latex-default-figure-position <span class="org-string">"!htbp"</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-org3bb811b" class="outline-4">
<h4 id="org3bb811b">&ldquo;Ignore heading + promote children&rdquo; tag</h4>
<div class="outline-text-4" id="text-org3bb811b">
<p>
The actual contents of an abstract can be rather large.
</p>

<p>
To be able to put it into a collapsable headline <b>without exporting the
headline</b>, but <b>well its contents</b>, you can add a <code>ignore</code> tag to remove the
headline:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--org-export-ignore-headlines</span> (data backend info)
      <span class="org-doc">"Remove headlines tagged \"ignore\" retaining contents and promoting children.</span>
<span class="org-doc">    Each headline tagged \"ignore\" will be removed retaining its</span>
<span class="org-doc">    contents and promoting any children headlines to the level of the</span>
<span class="org-doc">    parent."</span>
      (org-element-map data 'headline
        #'(lambda (object)
            (<span class="org-keyword">when</span> (member <span class="org-string">"ignore"</span> (org-element-property <span class="org-builtin">:tags</span> object))
              (<span class="org-keyword">let</span> ((level-top (org-element-property <span class="org-builtin">:level</span> object))
                    level-diff)
                (mapc #'(lambda (el)
                          <span class="org-comment-delimiter">;; </span><span class="org-comment">Recursively promote all nested headlines.</span>
                          (org-element-map el 'headline
                            #'(lambda (el)
                                (<span class="org-keyword">when</span> (equal 'headline (org-element-type el))
                                  (<span class="org-keyword">unless</span> level-diff
                                    (<span class="org-keyword">setq</span> level-diff (- (org-element-property <span class="org-builtin">:level</span> el)
                                                        level-top)))
                                  (org-element-put-property el
                                                            <span class="org-builtin">:level</span> (- (org-element-property <span class="org-builtin">:level</span> el)
                                                                      level-diff)))))
                          <span class="org-comment-delimiter">;; </span><span class="org-comment">Insert back into parse tree.</span>
                          (org-element-insert-before el object))
                      (org-element-contents object)))
              (org-element-extract-element object)))
        info nil)
      data)

    (add-hook 'org-export-filter-parse-tree-functions
              #'leuven--org-export-ignore-headlines)
</pre>
</div>

<p>
In addition, it promotes all headlines under the removed <code>ignore</code>-tagged
headline.  This is useful to support structures like the following:
</p>

<div class="org-src-container">
<pre class="src src-org"><span class="org-comment"># Wrapping an abstract in a headline</span>

<span class="org-org-level-1">* Abstract                                                             </span><span class="org-org-level-1"><span class="org-org-tag">:ignore:</span></span>
<span class="org-org-meta-line">#+LaTeX: \begin{abstract}</span>
<span class="org-org-meta-line">#+HTML: &lt;div id="abstract"&gt;</span>
...
<span class="org-org-meta-line">#+HTML: &lt;/div&gt;</span>
<span class="org-org-meta-line">#+LaTeX: \end{abstract}</span>

<span class="org-comment"># Placing References under a headline (using ox-bibtex in contrib)</span>

<span class="org-org-level-1">* References                                                           </span><span class="org-org-level-1"><span class="org-org-tag">:ignore:</span></span>
<span class="org-org-meta-line">#+BIBLIOGRAPHY: dissertation plain</span>

<span class="org-comment"># Inserting an appendix for LaTeX using the appendix package.</span>

<span class="org-org-level-1">* Appendix                                                             </span><span class="org-org-level-1"><span class="org-org-tag">:ignore:</span></span>
<span class="org-org-meta-line">#+LaTeX: \begin{appendices}</span>
<span class="org-org-level-2">** Reproduction</span>
<span class="org-org-level-2">** Data Sets</span>
<span class="org-org-level-2">** Tooling</span>
<span class="org-org-level-2">** Definitions</span>
<span class="org-org-meta-line">#+LaTeX: \end{appendices}</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    )                                   <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "ox-latex" ends here.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org0b1da16" class="outline-4">
<h4 id="org0b1da16">LaTeX Beamer and PDF export</h4>
<div class="outline-text-4" id="text-org0b1da16">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">12.6.6 Beamer class export.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(require 'ox-beamer)</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ox-beamer"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Default title of a frame containing an outline.</span>
    (<span class="org-keyword">setq</span> org-beamer-outline-frame-title <span class="org-string">"Plan"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">[default: "Outline"]</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org23800f3" class="outline-4">
<h4 id="org23800f3">OpenDocument Text (ODT)</h4>
<div class="outline-text-4" id="text-org23800f3">
<p>
ODT export is not loaded by default.  You will have to load it explicitly or to
add it to <code>org-export-backends</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ox-odt"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Convert "odt" format to "doc" format.</span>
    (<span class="org-keyword">setq</span> org-odt-preferred-output-format <span class="org-string">"doc"</span>)

    (<span class="org-keyword">when</span> leuven--cygwin-p
      (setcdr (assoc <span class="org-string">"LibreOffice"</span> org-odt-convert-processes)
              <span class="org-string">"soffice --headless --convert-to %f%x --outdir \"$(cygpath -m %d)\" \"$(cygpath -m %i)\""</span>)))
</pre>
</div>

<div class="tip">
<p>
With the amazing <code>ox-pandoc</code>, you can <b>export to <code>.docx</code> directly</b>.  No need to go
through LaTeX!
</p>

</div>
</div>
</div>

<div id="outline-container-org7a29929" class="outline-4">
<h4 id="org7a29929">Markdown</h4>
<div class="outline-text-4" id="text-org7a29929">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">major mode for editing Markdown-formatted text.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"markdown-mode-autoloads"</span>
    (add-to-list 'auto-mode-alist '(<span class="org-string">"README\\.md\\'"</span> . gfm-mode)))
</pre>
</div>

<p>
See <a href="https://gist.github.com/fredRos/0e3a845de95ec654538f">https://gist.github.com/fredRos/0e3a845de95ec654538f</a> to setup emacs to
render a README.md very similarly to how github will do it; except it also works
offline.
</p>

<p>
Have Firefox reload the page on demand using the <a href="https://addons.mozilla.org/en-US/firefox/addon/auto-reload/">Auto Reload</a> extension.
</p>
</div>
</div>
</div>

<div id="outline-container-org389f060" class="outline-3">
<h3 id="org389f060">Publishing</h3>
<div class="outline-text-3" id="text-org389f060">
<p>
Publish related Org mode files as a website.
</p>

<div class="warning">
<p>
It can be used for generating different PDF files from the same source file&#x2026;
See <a href="http://orgmode.org/worg/org-tutorials/org-latex-export.html#sec-9-2">9.2 The Multiple Export Case</a>.
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 13 (info "(org)Publishing")</span>

  (leuven--section <span class="org-string">"13 (org)Publishing"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ox-publish"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Show message about files *not* published.</span>
    (<span class="org-keyword">setq</span> org-publish-list-skipped-files nil)
</pre>
</div>
</div>

<div id="outline-container-org0217b82" class="outline-4">
<h4 id="org0217b82">Uploading files</h4>
<div class="outline-text-4" id="text-org0217b82">
<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; 13.2 Always publish all files.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; (do not use time stamp checking for skipping unmodified files)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-publish-use-timestamps-flag nil)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge9e2a9a" class="outline-4">
<h4 id="orge9e2a9a">Triggering publication</h4>
<div class="outline-text-4" id="text-orge9e2a9a">
<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">13.4 Force publishing all files.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-publish-all-force</span> ()
      (<span class="org-keyword">interactive</span>)
      (org-publish-all t)))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgd75d5a3" class="outline-3">
<h3 id="orgd75d5a3">Working With Source Code</h3>
<div class="outline-text-3" id="text-orgd75d5a3">
<p>
Literate programming and reproducible research.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 14 (info "(org)Working With Source Code")</span>
</pre>
</div>

<p>
Automate the redisplay of inline images, so that the images are always
up-to-date.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ob-core"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Make the images in the Emacs buffer automatically refresh after</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">execution.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'org-babel-after-execute-hook</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">#'(lambda ()</span>
    <span class="org-comment-delimiter">;;             </span><span class="org-comment">(org-display-inline-images nil t))) ; DOESN'T WORK!</span>
    <span class="org-comment-delimiter">;;                                     </span><span class="org-comment">; More efficient with refresh == t.</span>

    (add-hook 'org-babel-after-execute-hook #'org-display-inline-images))
</pre>
</div>
</div>

<div id="outline-container-orgec1703d" class="outline-4">
<h4 id="orgec1703d">Editing source code</h4>
<div class="outline-text-4" id="text-orgec1703d">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.2 (info "(org)Editing source code")</span>

  (leuven--section <span class="org-string">"14.2 (org)Editing source code"</span>)
</pre>
</div>

<p>
Mapping between languages (listings in LaTeX) and their major mode (in Emacs).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-src"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Mapping languages to their major mode (for editing the source code block</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">with `C-c '') -- when the language name doesn't match exactly the</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">language mode.</span>
    (add-to-list 'org-src-lang-modes '(<span class="org-string">"dot"</span> . graphviz-dot))
    (add-to-list 'org-src-lang-modes '(<span class="org-string">"js"</span> . js2)))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Display the source code edit buffer in the current window, keeping all</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">other windows.</span>
  (<span class="org-keyword">setq</span> org-src-window-setup 'current-window)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">FIXME Bind this to the correct keys.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-babel-expand-src-block</span> ()
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let</span> ((org-src-window-setup 'reorganize-frame))
      (org-babel-expand-src-block)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Indent the content of a source code block.</span>
  (<span class="org-keyword">setq</span> org-edit-src-content-indentation 2)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Fontify code in code blocks (highlight syntax in the Org buffer).</span>
  (<span class="org-keyword">setq</span> org-src-fontify-natively t)     <span class="org-comment-delimiter">;</span><span class="org-comment">! Create overlay</span>
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">! `</span><span class="org-comment"><span class="org-constant">org-block-background</span></span><span class="org-comment">' and remove</span>
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">! text property `</span><span class="org-comment"><span class="org-constant">org-block</span></span><span class="org-comment">'.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Preserve spaces and `</span><span class="org-comment"><span class="org-constant">TAB</span></span><span class="org-comment">' characters in source code blocks.</span>
  (<span class="org-keyword">setq</span> org-src-preserve-indentation t) <span class="org-comment-delimiter">; </span><span class="org-comment">Or add a `</span><span class="org-comment"><span class="org-constant">-i</span></span><span class="org-comment">' flag to you source block.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Same effect for `</span><span class="org-comment"><span class="org-constant">TAB</span></span><span class="org-comment">' as in the language major mode buffer (indenting</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">properly when hitting the `</span><span class="org-comment"><span class="org-constant">TAB</span></span><span class="org-comment">' key).</span>
  (<span class="org-keyword">setq</span> org-src-tab-acts-natively t)


  <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "org"</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(message "[... Org Editing source code]")</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; Allow indent region in the code edit buffer (according to language).</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(defun leuven-org-indent-region (&amp;optional arg)</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">(interactive "P")</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">(or (org-babel-do-key-sequence-in-edit-buffer (kbd "C-M-\\"))</span>
  <span class="org-comment-delimiter">;;         </span><span class="org-comment">(indent-region arg)))</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; Make `C-c C-v C-x C-M-\' more convenient.</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(define-key org-mode-map (kbd "C-M-\\") #'leuven-org-indent-region))</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Prevent auto-filling in src blocks.</span>
  (<span class="org-keyword">setq</span> org-src-prevent-auto-filling t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; with-eval-after-load...</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'org-src-mode-hook</span>
  <span class="org-comment-delimiter">;;           </span><span class="org-comment">#'(lambda ()</span>
  <span class="org-comment-delimiter">;;             </span><span class="org-comment">(define-key org-src-mode-map (kbd "&lt;f2&gt;") #'org-edit-src-save)))</span>
</pre>
</div>

<p>
C-c TAB
Toggle the visibility of existing tags in the buffer.  This can be used as a
cheap preview (sgml-tags-invisible).
</p>

<p>
View just the source-code blocks within the current Org-babel file (something
logically equivalent to &ldquo;tangle&rdquo;, but without creating a separate file).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defvar</span> <span class="org-variable-name">only-code-overlays</span> nil
    <span class="org-doc">"Overlays hiding non-code blocks."</span>)
  (make-variable-buffer-local 'only-code-overlays)

  (<span class="org-keyword">defun</span> <span class="org-function-name">hide-non-code</span> ()
    <span class="org-doc">"Hide non-code-block content of the current Org mode buffer."</span>
    (<span class="org-keyword">interactive</span>)
    (add-to-invisibility-spec '(non-code))
    (<span class="org-keyword">let</span> (begs ends)
      (<span class="org-keyword">save-excursion</span>
        (goto-char (point-min))
        (<span class="org-keyword">while</span> (re-search-forward org-babel-src-block-regexp nil t)
          (<span class="org-keyword">push</span> (match-beginning 5) begs)
          (<span class="org-keyword">push</span> (match-end 5)       ends))
        (map 'list #'(lambda (beg end)
                       (<span class="org-keyword">let</span> ((ov (make-overlay beg end)))
                         (<span class="org-keyword">push</span> ov only-code-overlays)
                         (overlay-put ov 'invisible 'non-code)))
             (cons (point-min) (reverse ends))
             (append (reverse begs) (list (point-max)))))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">show-non-code</span> ()
    <span class="org-doc">"Show non-code-block content of the current Org mode buffer."</span>
    (<span class="org-keyword">interactive</span>)
    (mapc 'delete-overlay only-code-overlays))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">org-kill-ring-save-code-block</span> ()
      <span class="org-doc">"Save the current code block as if killed, but don't kill it."</span>
      (<span class="org-keyword">interactive</span>)
      (<span class="org-keyword">save-excursion</span>
        (<span class="org-keyword">let</span> (beg end)
          (search-backward <span class="org-string">"begin_src"</span>)
          (beginning-of-line)
          (forward-line 1)
          (<span class="org-keyword">setq</span> beg (point))
          (search-forward <span class="org-string">"end_src"</span>)
          (beginning-of-line)
          (<span class="org-keyword">setq</span> end (point))
          (copy-region-as-kill beg end)
          (message <span class="org-string">"[Copied the current code block]"</span>))))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Copy current code block.</span>
    (define-key org-mode-map (kbd <span class="org-string">"H-w"</span>) #'org-kill-ring-save-code-block))
</pre>
</div>
</div>
</div>

<div id="outline-container-org471ab4a" class="outline-4">
<h4 id="org471ab4a">Evaluating code blocks</h4>
<div class="outline-text-4" id="text-org471ab4a">
<p>
See:
</p>
<ul class="org-ul">
<li><code>org-babel-default-header-args</code></li>
<li><code>org-babel-default-inline-header-args</code></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.5 (info "(org)Evaluating code blocks")</span>

  (leuven--section <span class="org-string">"14.5 (org)Evaluating code blocks"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">I don't want to execute code blocks with `C-c C-c' (evaluate code</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">block only with `C-c C-v e').</span>
  (<span class="org-keyword">setq</span> org-babel-no-eval-on-ctrl-c-ctrl-c t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Languages for which Org-babel will raise literate programming errors when</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">noweb references can not be resolved.</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ob-core"</span>
    (add-to-list 'org-babel-noweb-error-langs <span class="org-string">"emacs-lisp"</span>))
</pre>
</div>

<p>
Write error messages to the Messages buffer for invalid <code>org-sbe</code> calls.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Debugging org-sbe calls.</span>
  (<span class="org-keyword">defadvice</span> <span class="org-function-name">org-sbe</span> (around get-err-msg activate)
    <span class="org-doc">"Issue messages at errors."</span>
    (<span class="org-keyword">condition-case</span> err
        (<span class="org-keyword">progn</span>
      ad-do-it)
      (<span class="org-warning">error</span>
       (message <span class="org-string">"[Error in org-sbe: %S]"</span> err)
       (<span class="org-warning">signal</span> (car err) (cdr err)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orge6f5c3c" class="outline-4">
<h4 id="orge6f5c3c">Languages</h4>
<div class="outline-text-4" id="text-orge6f5c3c">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ob-exp"</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Template used to export the body of code blocks.</span>
    (<span class="org-keyword">setq</span> org-babel-exp-code-template
          <span class="org-comment-delimiter">;; </span><span class="org-comment">(concat "\n==:\n"</span>
                  org-babel-exp-code-template)
          <span class="org-comment-delimiter">;; </span><span class="org-comment">)</span>
    )

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Keep lower-case.</span>
  (<span class="org-keyword">setq</span> org-babel-results-keyword <span class="org-string">"results"</span>)
</pre>
</div>

<p>
Customize the <code>org-babel-load-languages</code> variable to enable support for
languages which can be evaluated in Org mode buffers.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.7 (info "(org)Languages")</span>

  (leuven--section <span class="org-string">"14.7 (org)Languages"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">FIXME Test executable-find (of Rterm, gnuplot, ruby, etc.) before</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">setting language to yes...</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"[... Org Languages]"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Configure Babel to support most languages.</span>
    (add-to-list 'org-babel-load-languages '(R        . t)) <span class="org-comment-delimiter">; </span><span class="org-comment">Requires R and ess-mode.</span>
    (add-to-list 'org-babel-load-languages '(awk      . t))
    (add-to-list 'org-babel-load-languages '(ditaa    . t)) <span class="org-comment-delimiter">; </span><span class="org-comment">Sudo aptitude install openjdk-6-jre.</span>
    (add-to-list 'org-babel-load-languages '(dot      . t))
    (add-to-list 'org-babel-load-languages '(java     . t))
    (add-to-list 'org-babel-load-languages '(latex    . t)) <span class="org-comment-delimiter">; </span><span class="org-comment">Shouldn't you use #+begin/end_latex blocks instead?</span>
    (add-to-list 'org-babel-load-languages '(ledger   . t)) <span class="org-comment-delimiter">; </span><span class="org-comment">Requires ledger.</span>
    (add-to-list 'org-babel-load-languages '(makefile . t))
    (add-to-list 'org-babel-load-languages '(org      . t))
    (add-to-list 'org-babel-load-languages '(python   . t))
    (add-to-list 'org-babel-load-languages '(shell    . t)) <span class="org-comment-delimiter">; </span><span class="org-comment">Org mode 8.2 (Emacs 26.1).</span>
    (add-to-list 'org-babel-load-languages '(sql      . t))

    (org-babel-do-load-languages        <span class="org-comment-delimiter">; </span><span class="org-comment">Loads org, gnus-sum, etc...</span>
     'org-babel-load-languages org-babel-load-languages)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Don't use getline for command-line editing and assert interactive use.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq org-babel-R-command</span>
    <span class="org-comment-delimiter">;;       </span><span class="org-comment">(concat org-babel-R-command " --ess"))</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Accented characters on graphics.</span>
    (<span class="org-keyword">setq</span> org-babel-R-command
          (concat org-babel-R-command <span class="org-string">" --encoding=UTF-8"</span>))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">R commands are displayed in the process buffer.</span>
    (<span class="org-keyword">setq</span> org-babel-R-eval-visibly t)   <span class="org-comment-delimiter">; </span><span class="org-comment">XXX Under test</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Check for the support of (inline) source block languages.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">org-src-block-check</span> ()
      (<span class="org-keyword">interactive</span>)
      (org-element-map (org-element-parse-buffer)
        '(src-block inline-src-block)
        #'(lambda (sb)
            (<span class="org-keyword">let</span> ((language (org-element-property <span class="org-builtin">:language</span> sb)))
              (<span class="org-keyword">cond</span> ((null language)
                     (<span class="org-warning">error</span> <span class="org-string">"Missing language at line %d in %s"</span>
                            (line-number-at-pos
                             (org-element-property <span class="org-builtin">:post-affiliated</span> sb))
                            (buffer-name)))
                    <span class="org-comment-delimiter">;; </span><span class="org-comment">((and (not (assoc-string language org-babel-load-languages))</span>
                    <span class="org-comment-delimiter">;;       </span><span class="org-comment">(not (assoc-string language org-src-lang-modes))</span>
                    <span class="org-comment-delimiter">;;       </span><span class="org-comment">;; (locate-library (concat language "-mode")) ; would allow `</span><span class="org-comment"><span class="org-constant">sh-mode</span></span><span class="org-comment">'</span>
                    <span class="org-comment-delimiter">;;       </span><span class="org-comment">)</span>
                    <span class="org-comment-delimiter">;;                       </span><span class="org-comment">; XXX This should be stricter: must be</span>
                    <span class="org-comment-delimiter">;;                       </span><span class="org-comment">; in org-babel-load-languages for</span>
                    <span class="org-comment-delimiter">;;                       </span><span class="org-comment">; evaluated code blocks. Must be in both</span>
                    <span class="org-comment-delimiter">;;                       </span><span class="org-comment">; other cases for edited code blocks.</span>
                    <span class="org-comment-delimiter">;;  </span><span class="org-comment">(error "Unknown language `</span><span class="org-comment"><span class="org-constant">%s</span></span><span class="org-comment">' at line %d in `</span><span class="org-comment"><span class="org-constant">%s</span></span><span class="org-comment">'"</span>
                    <span class="org-comment-delimiter">;;         </span><span class="org-comment">language</span>
                    <span class="org-comment-delimiter">;;         </span><span class="org-comment">(line-number-at-pos</span>
                    <span class="org-comment-delimiter">;;          </span><span class="org-comment">(org-element-property :post-affiliated sb))</span>
                    <span class="org-comment-delimiter">;;         </span><span class="org-comment">(buffer-name)))</span>
                    ))))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">(message "[Source blocks checked in %s]"</span>
      <span class="org-comment-delimiter">;;          </span><span class="org-comment">(buffer-name (buffer-base-buffer)))</span>
      )

    (add-hook 'org-mode-hook #'org-src-block-check t))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Place this at the end to ensure that</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">errors do not stop applying other</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">functions in the `</span><span class="org-comment"><span class="org-constant">org-mode-hook</span></span><span class="org-comment">' (such</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">as switching the dictionary).</span>
</pre>
</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Why isn&rsquo;t diff-mode.el found?</b><br />
<p>
<a href="file:///home/fni/.dotfiles/local/org/Org-for-dummies.html">file:///home/fni/.dotfiles/local/org/Org-for-dummies.html</a>
</p>
</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Check src blocks in  <b>temp</b> buffers?</b><br />
nil</div>

<p>
<code>screen</code> offers support for interactive terminals.  Mostly shell scripts.  Heavily
inspired by <code>eev</code>.
</p>

<p>
Eric Schulte believes <code>screen</code> has more of a focus on sustained interaction with
an interactive terminal.
</p>
</div>
</div>

<div id="outline-container-org449b943" class="outline-4">
<h4 id="org449b943">Prettier (or at least fancier) code block delimiters</h4>
<div class="outline-text-4" id="text-org449b943">
<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">defun</span> <span class="org-function-name">prettier-org-code-blocks</span> ()
      (<span class="org-keyword">interactive</span>)
      (font-lock-add-keywords nil
        '((<span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string"><span class="org-warning">\</span></span><span class="org-string">+begin_src</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span>
           (0 (<span class="org-keyword">progn</span> (compose-region (match-beginning 1) (match-end 1) ?¦)
                     nil)))
          (<span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string"><span class="org-warning">\</span></span><span class="org-string">+end_src</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span>
           (0 (<span class="org-keyword">progn</span> (compose-region (match-beginning 1) (match-end 1) ?¦)
                     nil))))))

    (add-hook 'org-mode-hook #'prettier-org-code-blocks)
</pre>
</div>
</div>
</div>

<div id="outline-container-org2c7647c" class="outline-4">
<h4 id="org2c7647c">Library of Babel</h4>
<div class="outline-text-4" id="text-org2c7647c">
<div class="note">
<p>
As the LOB contains code blocks of different languages, and as we now <b>check that
languages are known</b>, this section 14.6 has been moved <b>after</b> the section 14.7
where we <b>load languages</b> such as R, etc.
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 14.6 (info "(org)Library of Babel")</span>

  (leuven--section <span class="org-string">"14.6 (org)Library of Babel"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Load the NAMED code blocks defined in Org mode files into the library of</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Babel (global `</span><span class="org-comment"><span class="org-constant">org-babel-library-of-babel</span></span><span class="org-comment">' variable).</span>
    (<span class="org-keyword">let</span> ((lob-file (concat (file-name-directory (locate-library <span class="org-string">"org"</span>))
                            <span class="org-string">"../doc/library-of-babel.org"</span>)))
      (<span class="org-keyword">when</span> (file-exists-p lob-file)
        (org-babel-lob-ingest lob-file))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orge085492" class="outline-4">
<h4 id="orge085492">Key bindings and useful functions</h4>
<div class="outline-text-4" id="text-orge085492">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  (leuven--section <span class="org-string">"14.11 (org)Key bindings and useful functions"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ob-core"</span>

    (<span class="org-keyword">defadvice</span> <span class="org-function-name">org-babel-next-src-block</span>
      (after leuven-org-babel-next-src-block activate)
      <span class="org-doc">"Recenter after jumping to the next source block."</span>
      (recenter))

    (<span class="org-keyword">defadvice</span> <span class="org-function-name">org-babel-previous-src-block</span>
      (after leuven-org-babel-previous-src-block activate)
      <span class="org-doc">"Recenter after jumping to the previous source block."</span>
      (recenter)))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org7d1226a" class="outline-3">
<h3 id="org7d1226a">Miscellaneous</h3>
<div class="outline-text-3" id="text-org7d1226a">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 15 (info "(org)Miscellaneous")</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">From Dan Davison.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-switch-to-org-scratch</span> ()
    <span class="org-doc">"Switch to a temp Org buffer.  If the region is active, insert it."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let</span> ((contents (<span class="org-keyword">and</span> (use-region-p)
                         (buffer-substring (region-beginning)
                                           (region-end)))))
      (find-file <span class="org-string">"/tmp/org-scratch.org"</span>)
      (<span class="org-keyword">if</span> contents (insert contents))))
</pre>
</div>
</div>

<div id="outline-container-orgcfb7338" class="outline-4">
<h4 id="orgcfb7338">Change PROPERTY drawer location</h4>
<div class="outline-text-4" id="text-orgcfb7338">
<p>
<span class="timestamp-wrapper"><span class="timestamp">[2014-10-28 Tue]</span></span>
</p>

<p>
Find all entries where :PROPERTIES: is not the first item listed.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">org-check-property-drawers</span> ()
    (<span class="org-keyword">interactive</span>)
    (org-element-map (org-element-parse-buffer 'element) 'headline
      #'(lambda (h)
          (<span class="org-keyword">and</span> (org-element-map h 'drawer
                 #'(lambda (d) (equal (org-element-property <span class="org-builtin">:name</span> d) <span class="org-string">"PROPERTIES"</span>))
                 nil t 'headline)
               (<span class="org-keyword">let</span> ((begin (org-element-property <span class="org-builtin">:begin</span> h)))
                 (message <span class="org-string">"[Entry with erroneous properties drawer at %d]"</span> begin)
                 begin)))))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">org-repair-property-drawers</span> ()
    <span class="org-doc">"Fix properties drawers in current buffer.</span>
<span class="org-doc">  Ignore non Org buffers."</span>
    (<span class="org-keyword">when</span> (derived-mode-p 'org-mode)
      (<span class="org-keyword">org-with-wide-buffer</span>
       (goto-char (point-min))
       (<span class="org-keyword">let</span> ((case-fold-search t)
             (inline-re (<span class="org-keyword">and</span> (<span class="org-keyword">featurep</span> '<span class="org-constant">org-inlinetask</span>)
                             (concat (org-inlinetask-outline-regexp)
                                     <span class="org-string">"END[ \t]*$"</span>))))
         (org-map-entries
          #'(lambda ()
              (<span class="org-keyword">unless</span> (<span class="org-keyword">and</span> inline-re (looking-at-p inline-re))
                (<span class="org-keyword">save-excursion</span>
                  (<span class="org-keyword">let</span> ((end (<span class="org-keyword">save-excursion</span> (outline-next-heading) (point))))
                    (forward-line)
                    (<span class="org-keyword">when</span> (looking-at-p org-planning-line-re) <span class="org-comment-delimiter">; </span><span class="org-comment">Org-8.3.</span>
                      (forward-line))
                    (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> (&lt; (point) end)
                               (not (looking-at-p org-property-drawer-re))
                               (<span class="org-keyword">save-excursion</span>
                                 (<span class="org-keyword">and</span> (re-search-forward org-property-drawer-re end t)
                                      (eq (org-element-type
                                           (<span class="org-keyword">save-match-data</span> (org-element-at-point)))
                                          'drawer))))
                      (insert (delete-and-extract-region
                               (match-beginning 0)
                               (min (1+ (match-end 0)) end)))
                      (<span class="org-keyword">unless</span> (bolp) (insert <span class="org-string">"\n"</span>))))))))))))

  (<span class="org-keyword">when</span> (boundp 'org-planning-line-re)
    (add-hook 'org-mode-hook #'org-repair-property-drawers))
</pre>
</div>
</div>
</div>

<div id="outline-container-org270214a" class="outline-4">
<h4 id="org270214a">Ispell</h4>
<div class="outline-text-4" id="text-org270214a">
<div class="note">
<p>
The <code>leuven--org-switch-dictionary</code> function is called as well on each code block
(at least, in emails that are being read), in buffers called <code>*fontification*</code>.
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--org-switch-dictionary</span> ()
    <span class="org-doc">"Set language if Flyspell is enabled and `#+LANGUAGE:' is on top 8 lines."</span>
    (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> (boundp 'ispell-dictionary-alist)
               ispell-dictionary-alist)
      (<span class="org-keyword">save-excursion</span>
        (goto-char (point-min))
        (forward-line 8)
        (<span class="org-keyword">let</span> (lang dict
              (dict-alist '((<span class="org-string">"en"</span> . <span class="org-string">"american"</span>)
                            (<span class="org-string">"fr"</span> . <span class="org-string">"francais"</span>))))
          (<span class="org-keyword">when</span> (re-search-backward <span class="org-string">"#\\+LANGUAGE: +</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[[:alpha:]_]*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span> 1 t)
            (<span class="org-keyword">setq</span> lang (match-string 1))
            (<span class="org-keyword">setq</span> dict (cdr (assoc lang dict-alist)))
            (<span class="org-keyword">if</span> dict
                (<span class="org-keyword">progn</span>
                  (ispell-change-dictionary dict)
                  (force-mode-line-update))
              (message <span class="org-string">"[No Ispell dictionary for language `</span><span class="org-string"><span class="org-constant">%s</span></span><span class="org-string">' (see file `</span><span class="org-string"><span class="org-constant">%s</span></span><span class="org-string">')]"</span>
                       lang (file-name-base))
              (sit-for 1.5)))))))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Guess dictionary.</span>
  (add-hook 'org-mode-hook #'leuven--org-switch-dictionary)
</pre>
</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Avoid (error &ldquo;Undefined dictionary: american&rdquo;)</b><br />
<p>
when dictionaries are not installed. IN FACT, ISPELL IS NOT AT ALL INSTALLED!
</p>

<p>
Check out for valid dictionaries:
(append ispell-local-dictionary-alist ispell-dictionary-alist)
</p>
</div>
</div>
</div>

<div id="outline-container-org42a2c7c" class="outline-4">
<h4 id="org42a2c7c">Easy templates</h4>
<div class="outline-text-4" id="text-org42a2c7c">
<p>
Lower-case in <code>BEGIN_SRC</code> and other keywords: do not stand out!
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 15.2 (info "(org)Easy Templates")</span>

  (leuven--section <span class="org-string">"15.2 (org)Easy Templates"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"[... Org Easy Templates]"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">New format in Org 9.2.</span>
    (add-to-list 'org-structure-template-alist '(<span class="org-string">"n"</span> . <span class="org-string">"note"</span>))
    (add-to-list 'org-structure-template-alist '(<span class="org-string">"w"</span> . <span class="org-string">"warning"</span>))
    (add-to-list 'org-structure-template-alist '(<span class="org-string">"t"</span> . <span class="org-string">"tip"</span>))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Begin/end example markers will be inserted in lower case.</span>
    (<span class="org-keyword">setq</span> org-babel-uppercase-example-markers nil)
    )
</pre>
</div>
</div>
</div>

<div id="outline-container-org05c8ceb" class="outline-4">
<h4 id="org05c8ceb">Speed keys</h4>
<div class="outline-text-4" id="text-org05c8ceb">
<p>
Activate single letter commands (for example, outline navigation with <code>f</code>, <code>b</code>, <code>n</code>,
and <code>p</code>) at beginning of a headline:
</p>

<dl class="org-dl">
<dt><code>f</code></dt><dd><code>org-forward-same-level</code>.</dd>

<dt><code>b</code></dt><dd><code>org-backward-same-level</code>.</dd>

<dt><code>n</code></dt><dd><code>outline-next-visible-heading</code>.</dd>

<dt><code>p</code></dt><dd><code>outline-previous-visible-heading</code>.</dd>
</dl>

<p>
For navigating blocks:
</p>

<dl class="org-dl">
<dt>F</dt><dd><code>org-next-block</code>.</dd>

<dt>B</dt><dd><code>org-previous-block</code>.</dd>
</dl>

<div class="tip">
<p>
Use <code>?</code> at the start of an Org header to see which speed commands we have.
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 15.3 (info "(org)Speed keys")</span>

  (leuven--section <span class="org-string">"15.3 (org)Speed keys"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"[... Org Speek keys]"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Activate single letter commands at beginning of a headline.</span>
    (<span class="org-keyword">setq</span> org-use-speed-commands t)

    (add-to-list 'org-speed-commands-user '(<span class="org-string">"d"</span> org-todo <span class="org-string">"DONE"</span>))
    (add-to-list 'org-speed-commands-user '(<span class="org-string">"y"</span> org-todo-yesterday <span class="org-string">"DONE"</span>))
    (add-to-list 'org-speed-commands-user '(<span class="org-string">"s"</span> call-interactively 'org-schedule))
    (add-to-list 'org-speed-commands-user '(<span class="org-string">"N"</span> org-narrow-to-subtree))
    (add-to-list 'org-speed-commands-user '(<span class="org-string">"W"</span> widen))
    (add-to-list 'org-speed-commands-user '(<span class="org-string">"k"</span> org-cut-subtree))
</pre>
</div>
</div>

<div id="outline-container-orgecc4fc2" class="outline-5">
<h5 id="orgecc4fc2">Convert Windows Apps key to Hyper</h5>
<div class="outline-text-5" id="text-orgecc4fc2">
<p>
Here are more obvious key bindings to <b>execute</b> (than <code>C-c C-v C-e</code> and company)
using &ldquo;hyper&rdquo;:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Run current line (mapped to H-r).</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Run from beginning of code block to current line (mapped to H-a?).</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Run from current line to end of code block (mapped to H-e?).</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Run current code block.</span>
    (define-key org-mode-map (kbd <span class="org-string">"H-e"</span>) #'org-babel-execute-maybe)

    (<span class="org-keyword">defun</span> <span class="org-function-name">org-babel-force-execute-src-block</span> ()
      <span class="org-doc">"Force execution of the current source code block."</span>
      (<span class="org-keyword">interactive</span>)
      (org-babel-execute-src-block nil nil '((<span class="org-builtin">:eval</span> . <span class="org-string">"yes"</span>))))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Run current code block (force execution).</span>
    (define-key org-mode-map (kbd <span class="org-string">"H-f"</span>) #'org-babel-force-execute-src-block)
</pre>
</div>

<p>
To <b>tangle</b>:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (define-key org-mode-map (kbd <span class="org-string">"H-t"</span>) #'org-babel-tangle)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  )
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org20f5c80" class="outline-4">
<h4 id="org20f5c80">Code evaluation and security issues</h4>
<div class="outline-text-4" id="text-org20f5c80">
<p>
For security resons, evaluation is not turned on by default.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 15.4 (info "(org)Code evaluation security") issues</span>

  (leuven--section <span class="org-string">"15.4 (org)Code evaluation security issues"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ob-core"</span>

    <span class="org-comment-delimiter">;;</span><span class="org-comment">!! Don't be prompted on every code block evaluation.</span>
    (<span class="org-keyword">setq</span> org-confirm-babel-evaluate nil))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ob-core"</span>

    (<span class="org-keyword">defface</span> <span class="org-variable-name">org-block-executing</span>
      '((t <span class="org-builtin">:background</span> <span class="org-string">"#FFE0FF"</span>))
      <span class="org-doc">"Face used for the source block background when executed."</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Change the color of code blocks while they are being executed.</span>
    (<span class="org-keyword">defadvice</span> <span class="org-function-name">org-babel-execute-src-block</span> (around progress nil activate)
      <span class="org-doc">"Create an overlay indicating when code block is running."</span>
      (<span class="org-keyword">let</span> ((o (make-overlay (org-element-property <span class="org-builtin">:begin</span> (org-element-at-point))
                             (1- (org-element-property <span class="org-builtin">:end</span> (org-element-at-point))))))
        (recenter)
        (overlay-put o 'face 'org-block-executing)
        (<span class="org-keyword">measure-time</span> <span class="org-string">"Executed code block"</span> ad-do-it)
        (delete-overlay o))))
</pre>
</div>

<div class="note">
<p>
We&rsquo;ve disabled the advice <code>ad-Advice-org-babel-execute-src-block</code> because of the
error message <code>`recenter'ing a window that does not display current-buffer</code> when
exporting <code>gnus-leuven.txt</code> to HTML.
</p>

</div>
</div>
</div>

<div id="outline-container-orge45ec65" class="outline-4">
<h4 id="orge45ec65">A cleaner outline view</h4>
<div class="outline-text-4" id="text-orge45ec65">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 15.8 A (info "(org)Clean view")</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"[... Org Clean view]"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">15.8 Don't skip even levels for the outline.</span>
    (<span class="org-keyword">setq</span> org-odd-levels-only nil))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb915659" class="outline-4">
<h4 id="orgb915659">Interaction with other packages</h4>
<div class="outline-text-4" id="text-orgb915659">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 15.10 (info "(org)Interaction")</span>

  (leuven--section <span class="org-string">"15.10 (org)Interaction"</span>)
</pre>
</div>

<div class="note">
<p>
On <span class="timestamp-wrapper"><span class="timestamp">[2015-05-01 Fri]</span></span>, in commit <code>49a656a</code>, Nicolas Goaziou has removed
<code>org-babel-src-name-w-name-regexp</code>, and replaced it by the function call
<code>(org-babel-named-src-block-regexp-for-name)</code>.
</p>

<p>
Until modification of the following code, it has been disabled, as it breaks
Org&#x2026;
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Support shift-selection for making and enlarging regions when the cursor</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">is not in a special context.</span>
    (<span class="org-keyword">setq</span> org-support-shift-select t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Maximum level for Imenu access to Org mode headlines.</span>
    (<span class="org-keyword">setq</span> org-imenu-depth 3)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Extension of Imenu.</span>
    (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> (<span class="org-keyword">featurep</span> '<span class="org-constant">ob-core</span>)      <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">org-babel</span></span><span class="org-comment">' has been loaded.</span>
               (<span class="org-keyword">featurep</span> '<span class="org-constant">imenu</span>))       <span class="org-comment-delimiter">; </span><span class="org-comment">Imenu has been loaded.</span>

      (<span class="org-keyword">setq</span> org-src-blocks-imenu-generic-expression
            `((<span class="org-string">"Snippets"</span> ,org-babel-src-name-w-name-regexp 2)))

      (add-hook 'org-mode-hook
                #'(lambda ()
                    (<span class="org-keyword">setq</span> imenu-generic-expression
                          org-src-blocks-imenu-generic-expression))))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Alternative to Imenu.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">dan/find-in-buffer</span> ()
      (<span class="org-keyword">interactive</span>)
      (<span class="org-keyword">let</span> ((targets
             `((<span class="org-string">"&lt;named src blocks&gt;"</span> . ,org-babel-src-name-regexp)
               (<span class="org-string">"&lt;src block results&gt;"</span> . ,org-babel-result-regexp))))
        (occur
         (cdr
          (assoc
           (completing-read <span class="org-string">"Find: "</span> (mapcar #'car targets)) targets)))
        (other-window 1))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org5dbb98d" class="outline-4">
<h4 id="org5dbb98d">Org-crypt</h4>
<div class="outline-text-4" id="text-org5dbb98d">
<p>
Org-crypt provides for encrypting individual entries in an otherwise
non-encrypted file.
</p>

<p>
To later decrypt an entry that&rsquo;s encrypted, use <code>M-x org-decrypt-entry</code> or <code>C-c
C-r</code> (fits nicely with the meaning of &ldquo;reveal&rdquo;).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Keep my encrypted data (like account passwords) in my Org mode files with</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">a special tag instead.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"[... Org Crypt]"</span>)

    (try-require 'org-crypt))           <span class="org-comment-delimiter">; </span><span class="org-comment">Loads org, gnus-sum, etc...</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-crypt"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Encrypt all entries before saving.</span>
    (org-crypt-use-before-save-magic)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Which tag is used to mark headings to be encrypted.</span>
    (<span class="org-keyword">setq</span> org-tags-exclude-from-inheritance '(<span class="org-string">"crypt"</span>)))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgd022428" class="outline-3">
<h3 id="orgd022428">Other</h3>
<div class="outline-text-3" id="text-orgd022428">
<p>
Anonymize Org contents (sanitize the sensitive data).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-scramble-contents</span> ()
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let</span> ((tree (org-element-parse-buffer)))
      (org-element-map tree
          '(code comment comment-block example-block fixed-width keyword link
            node-property plain-text verbatim)
        #'(lambda (obj)
            (<span class="org-keyword">cl-case</span> (org-element-type obj)
              ((code comment comment-block example-block fixed-width keyword
                     node-property verbatim)
               (<span class="org-keyword">let</span> ((value (org-element-property <span class="org-builtin">:value</span> obj)))
                 (org-element-put-property
                  obj <span class="org-builtin">:value</span> (replace-regexp-in-string <span class="org-string">"[[:alnum:]]"</span> <span class="org-string">"x"</span> value))))
              (link
               (<span class="org-keyword">unless</span> (string= (org-element-property <span class="org-builtin">:type</span> obj) <span class="org-string">"radio"</span>)
                 (org-element-put-property obj <span class="org-builtin">:raw-link</span> <span class="org-string">"http://orgmode.org"</span>)))
              (plain-text
               (org-element-set-element
                obj (replace-regexp-in-string <span class="org-string">"[[:alnum:]]"</span> <span class="org-string">"x"</span> obj)))))
        nil nil nil t)
      (<span class="org-keyword">let</span> ((buffer (get-buffer-create <span class="org-string">"*Scrambled text*"</span>)))
        (<span class="org-keyword">with-current-buffer</span> buffer
          (insert (org-element-interpret-data tree))
          (goto-char (point-min)))
        (switch-to-buffer buffer))))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't pad tangled code with newlines.</span>
  (<span class="org-keyword">setq</span> org-babel-tangle-pad-newline nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Use relative path names in links from tangled source back the Org file.</span>
  (<span class="org-keyword">setq</span> org-babel-tangle-use-relative-file-links t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">How to combine blocks of the same name during tangling.</span>
  (<span class="org-keyword">setq</span> org-babel-tangle-named-block-combination 'append)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Speed up tangling dramatically (a couple of orders of magnitude).</span>
  (<span class="org-keyword">setq</span> org-babel-use-quick-and-dirty-noweb-expansion t)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">:noweb-ref feature must NOT be used!</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Minimum number of lines for output *block* (placed in a</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">#+begin_example...#+end_example) vs. output marked as literal by</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">inserting a *colon* at the beginning of the lines.</span>
  (<span class="org-keyword">setq</span> org-babel-min-lines-for-block-output 2)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; FIXME Make this the default behavior</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Grab the last line too, when selecting a subtree.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(org-end-of-subtree nil t)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Backend aware export preprocess hook.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--org-export-preprocess-hook</span> ()
    <span class="org-doc">"Backend-aware export preprocess hook."</span>
    (<span class="org-keyword">save-excursion</span>
      (<span class="org-keyword">when</span> (eq org-export-current-backend 'latex)
        <span class="org-comment-delimiter">;; </span><span class="org-comment">ignoreheading tag for bibliographies and appendices.</span>
        (<span class="org-keyword">let*</span> ((tag <span class="org-string">"ignoreheading"</span>))
          <span class="org-comment-delimiter">;; </span><span class="org-comment">(goto-char (point-min))</span>
          <span class="org-comment-delimiter">;; </span><span class="org-comment">(while (re-search-forward (concat ":" tag ":") nil t)</span>
          <span class="org-comment-delimiter">;; </span><span class="org-comment">(delete-region (point-at-bol) (point-at-eol)))</span>
          (org-map-entries
           #'(lambda ()
               (delete-region (point-at-bol) (point-at-eol)))
           (concat <span class="org-string">":"</span> tag <span class="org-string">":"</span>))))
      (<span class="org-keyword">when</span> (eq org-export-current-backend 'html)
        <span class="org-comment-delimiter">;; </span><span class="org-comment">set custom css style class based on matched tag</span>
        (<span class="org-keyword">let*</span> ((match <span class="org-string">"Qn"</span>))
          (org-map-entries
           #'(lambda ()
               (org-set-property <span class="org-string">"HTML_CONTAINER_CLASS"</span> <span class="org-string">"inlinetask"</span>))
           match)))))

  (add-hook 'org-export-preprocess-hook #'leuven--org-export-preprocess-hook)
</pre>
</div>

<p>
Promote ignoreheading. Works in ASCII backend too:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">yz/org-export-ignore-headline</span> (backend)
    <span class="org-doc">"Ignore headlines with tag `</span><span class="org-doc"><span class="org-constant">ignoreheading</span></span><span class="org-doc">'."</span>
    (<span class="org-keyword">save-excursion</span>
      (<span class="org-keyword">let</span> ((org-allow-promoting-top-level-subtree t))
        (org-map-entries
         #'(lambda ()
             (<span class="org-keyword">when</span> (member <span class="org-string">"ignoreheading"</span> (org-get-tags-at nil 'local))
               (org-promote-subtree)
               (delete-region (line-beginning-position) (line-end-position))))))))

  (add-hook 'org-export-before-parsing-hook #'yz/org-export-ignore-headline)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">insert-one-equal-or-two</span> ()
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">cond</span>
     ((<span class="org-keyword">or</span> (bolp) (not (looking-back <span class="org-string">"="</span>)))
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Insert just one =.</span>
      (self-insert-command 1))
     ((<span class="org-keyword">save-excursion</span>
        (backward-char)
        <span class="org-comment-delimiter">;; </span><span class="org-comment">Skip symbol backwards.</span>
        (<span class="org-keyword">and</span> (not (zerop (skip-syntax-backward <span class="org-string">"w_."</span>)))
             (not (looking-back <span class="org-string">"="</span>))
             (<span class="org-keyword">or</span> (insert-and-inherit <span class="org-string">"="</span>) t))))
     (t
      <span class="org-comment-delimiter">;; </span><span class="org-comment">insert == around following symbol.</span>
      (delete-char -1)
      (<span class="org-keyword">unless</span> (looking-back <span class="org-string">"="</span>) (insert-and-inherit <span class="org-string">"="</span>))
      (<span class="org-keyword">save-excursion</span>
        (skip-syntax-forward <span class="org-string">"w_."</span>)
        (<span class="org-keyword">unless</span> (looking-at <span class="org-string">"="</span>) (insert-and-inherit <span class="org-string">"="</span>))))))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Must be in eval-after-load "org"?</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key org-mode-map (kbd "=") #'insert-one-equal-or-two)</span>
</pre>
</div>

<p>
Export the current subtree into an email body, using <b>properties</b> to populate
the mail message:
</p>

<ul class="org-ul">
<li><code>MAIL_SUBJECT</code> or subtree heading -&gt; &ldquo;Subject&rdquo;</li>
<li><code>MAIL_TO</code> -&gt; &ldquo;To&rdquo;</li>
<li><code>MAIL_CC</code> -&gt; &ldquo;Cc</li>
<li><code>MAIL_BCC</code> -&gt; &ldquo;BCc&rdquo;</li>
<li><code>MAIL_FMT</code> -&gt; determines the format of the email (e.g., <code>org</code> by default, <code>ascii</code>
or <code>html</code>)</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org"</span>
    (message <span class="org-string">"[... Org Mime]"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Using Org mode to send buffer/subtree per mail.</span>
    (try-require 'org-mime))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-mime"</span>

    (add-hook 'org-mode-hook
              #'(lambda ()
                  (local-set-key (kbd <span class="org-string">"C-c m"</span>) #'org-mime-subtree)))

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-mail-subtree</span> ()
      (<span class="org-keyword">interactive</span>)
      (org-agenda-goto)
      (org-mime-subtree))

    (add-hook 'org-agenda-mode-hook
              #'(lambda ()
                  (local-set-key (kbd <span class="org-string">"C-c m"</span>) #'leuven-mail-subtree)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add a `</span><span class="org-comment"><span class="org-constant">mail_composed</span></span><span class="org-comment">' property with the current time when</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">org-mime-subtree</span></span><span class="org-comment">' is called.</span>
    (add-hook 'org-mime-send-subtree-hook
              #'(lambda ()
                  (org-entry-put (point) <span class="org-string">"mail_composed"</span> (current-time-string)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org020b4d5" class="outline-3">
<h3 id="org020b4d5">A.3 Adding hyperlink types</h3>
<div class="outline-text-3" id="text-org020b4d5">
<p>
For more flexibility, you can use a URL-like syntax which could then export
conditionally on the output format.
</p>

<p>
See <a href="http://orgmode.org/worg/org-tutorials/org-latex-export.html#sec-10-3">http://orgmode.org/worg/org-tutorials/org-latex-export.html#sec-10-3</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** A.3 (info "(org)Adding hyperlink types")</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "org"</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(message "[... Org Adding hyperlink types]")</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; Define a new link type (`</span><span class="org-comment"><span class="org-constant">latex</span></span><span class="org-comment">') whose path argument can hold the name of</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; any LaTeX command.</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(org-link-set-parameters</span>
  <span class="org-comment-delimiter">;;    </span><span class="org-comment">"latex" nil</span>
  <span class="org-comment-delimiter">;;    </span><span class="org-comment">#'(lambda (path desc format)</span>
  <span class="org-comment-delimiter">;;        </span><span class="org-comment">(cond</span>
  <span class="org-comment-delimiter">;;         </span><span class="org-comment">((eq format 'html)</span>
  <span class="org-comment-delimiter">;;          </span><span class="org-comment">(format "&lt;span class=\"%s\"&gt;%s&lt;/span&gt;" path desc))</span>
  <span class="org-comment-delimiter">;;         </span><span class="org-comment">((eq format 'latex)</span>
  <span class="org-comment-delimiter">;;          </span><span class="org-comment">(format "\\%s{%s}" path desc)))))</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; Add background color by using custom links like [[bgcolor:red][Warning!]].</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(org-link-set-parameters</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">"bgcolor" nil</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">#'(lambda (path desc format)</span>
  <span class="org-comment-delimiter">;;         </span><span class="org-comment">(cond</span>
  <span class="org-comment-delimiter">;;          </span><span class="org-comment">((eq format 'html)</span>
  <span class="org-comment-delimiter">;;           </span><span class="org-comment">(format "&lt;span style=\"background-color:%s;\"&gt;%s&lt;/span&gt;" path desc))</span>
  <span class="org-comment-delimiter">;;          </span><span class="org-comment">((eq format 'latex)</span>
  <span class="org-comment-delimiter">;;           </span><span class="org-comment">(format "\\colorbox{%s}{%s}" path desc))</span>
  <span class="org-comment-delimiter">;;          </span><span class="org-comment">(t</span>
  <span class="org-comment-delimiter">;;           </span><span class="org-comment">(format "BGCOLOR LINK (%s): {%s}{%s}" format path desc))))))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org4208440" class="outline-3">
<h3 id="org4208440">A.5 Tables and lists in arbitrary syntax</h3>
<div class="outline-text-3" id="text-org4208440">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-org-send-all-buffer-tables</span> ()
    <span class="org-doc">"Export all Org tables of the LaTeX document to their corresponding LaTeX tables."</span>
     (<span class="org-keyword">interactive</span>)
     (org-table-map-tables
        #'(lambda ()
            (orgtbl-send-table 'maybe))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org780e260" class="outline-3">
<h3 id="org780e260">A.6 Dynamic blocks</h3>
<div class="outline-text-3" id="text-org780e260">
<div class="note">
<p>
For some (yet) unknown reason, <code>leuven--org-update-buffer-before-save</code> gets added
to a local copy of the global variable <code>before-save-hook</code>.  We now decided to add
it to the hook outside of Org (not anymore in an <code>with-eval-after-load</code> form).
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** A.6 (info "(org)Dynamic blocks")</span>

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--org-update-buffer-before-save</span> ()
    <span class="org-doc">"Update all dynamic blocks and all tables in the buffer before save."</span>
    (<span class="org-keyword">when</span> (derived-mode-p 'org-mode)
      (message <span class="org-string">"[Update Org buffer %s]"</span>
               (file-name-nondirectory (buffer-file-name)))
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(sit-for 1.5)</span>
      (<span class="org-keyword">let</span> ((cache-long-scans nil)      <span class="org-comment-delimiter">; </span><span class="org-comment">Make `</span><span class="org-comment"><span class="org-constant">forward-line</span></span><span class="org-comment">' much faster and</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">thus `</span><span class="org-comment"><span class="org-constant">org-goto-line</span></span><span class="org-comment">', `</span><span class="org-comment"><span class="org-constant">org-table-sum</span></span><span class="org-comment">',</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">etc.</span>
            (fly-state (<span class="org-keyword">and</span> (boundp 'flyspell-mode)
                            (<span class="org-keyword">if</span> flyspell-mode 1 -1)))
            (buffer-undo-list buffer-undo-list)) <span class="org-comment-delimiter">; </span><span class="org-comment">For goto-chg.</span>
        (<span class="org-keyword">and</span> fly-state (flyspell-mode -1))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Temporarily disable Flyspell to avoid</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">checking the following modifications</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">of the buffer.</span>
        (<span class="org-keyword">measure-time</span> <span class="org-string">"Realigned all tags"</span> (org-align-all-tags))
        (<span class="org-keyword">measure-time</span> <span class="org-string">"Updated all dynamic blocks"</span> (org-update-all-dblocks))
        (<span class="org-keyword">measure-time</span> <span class="org-string">"Re-applied formulas to all tables"</span>
                      (org-table-iterate-buffer-tables))
        (<span class="org-keyword">when</span> (file-exists-p (buffer-file-name (current-buffer)))
          (leuven-org-remove-redundant-tags))
        (<span class="org-keyword">and</span> fly-state (flyspell-mode fly-state)))))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Make sure that all dynamic blocks and all tables are always up-to-date.</span>
  (add-hook 'before-save-hook #'leuven--org-update-buffer-before-save)
</pre>
</div>
</div>
</div>

<div id="outline-container-org8736627" class="outline-3">
<h3 id="org8736627">Org-contrib</h3>
<div class="outline-text-3" id="text-org8736627">
</div>
<div id="outline-container-orge0129c0" class="outline-4">
<h4 id="orge0129c0">Org-effectiveness</h4>
<div class="outline-text-4" id="text-orge0129c0">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "org"</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(message "[... Org Effectiveness]")</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(try-require 'org-effectiveness)</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(with-eval-after-load "org-effectiveness"</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;     </span><span class="org-comment">(add-hook 'org-mode-hook</span>
  <span class="org-comment-delimiter">;;               </span><span class="org-comment">#'(lambda ()</span>
  <span class="org-comment-delimiter">;;                 </span><span class="org-comment">(org-effectiveness-count-todo)</span>
  <span class="org-comment-delimiter">;;                 </span><span class="org-comment">(sit-for 0.2)))))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb97621f" class="outline-4">
<h4 id="orgb97621f">Org-notmuch</h4>
<div class="outline-text-4" id="text-orgb97621f">
<p>
Link emails from Org files.
</p>
</div>
</div>

<div id="outline-container-orga13845e" class="outline-4">
<h4 id="orga13845e">Google Weather</h4>
<div class="outline-text-4" id="text-orga13845e">
<pre class="example">
* Weather

%%(org-google-weather "Lille" "en-gb")
</pre>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Add weather forecast in your Org agenda.</span>
  (autoload 'org-google-weather <span class="org-string">"org-google-weather"</span>
    <span class="org-doc">"Return Org entry with the weather for LOCATION in LANGUAGE."</span> t)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-google-weather"</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(try-require 'url)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add the city.</span>
    (<span class="org-keyword">setq</span> org-google-weather-format <span class="org-string">"%C %i %c, %l°-%h°"</span>))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 25.10-org-mode ends here.</span>
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org10e0e6d" class="outline-2">
<h2 id="org10e0e6d">TeX</h2>
<div class="outline-text-2" id="text-org10e0e6d">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 25.11 (info "(emacs)TeX Mode")</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-25.11-tex-mode <span class="org-string">"25.11 TeX Mode"</span>
</pre>
</div>

<div class="warning">
<p>
Emacs ships with <code>tex-mode.el</code> but that&rsquo;s a separate thing from AUCTeX.  All
AUCTeX functions start with <code>TeX-*</code> or <code>LaTeX-*</code> (case matters) or <code>font-latex-*</code>.
</p>

</div>
</div>

<div id="outline-container-orgccdde24" class="outline-3">
<h3 id="orgccdde24">Native TeX Mode</h3>
<div class="outline-text-3" id="text-orgccdde24">
<dl class="org-dl">
<dt><code>tex-mode</code> or <code>latex-mode</code></dt><dd>Default Emacs built-in (La)TeX mode (menu <code>TeX</code>; text <code>LaTeX</code> displayed in the
mode line).</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (leuven--section <span class="org-string">"25.11 (emacs)TeX Mode"</span>)
</pre>
</div>

<p>
Under Windows, in the <b>native</b> TeX mode, <code>shell-file-name</code> must be <code>cmdproxy.exe</code> to:
</p>

<ul class="org-ul">
<li>avoid the error &ldquo;comint-send-string: writing to process: invalid argument,
tex-shell&rdquo;, and</li>

<li>properly quote <code>tex-start-commands</code>.</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Get colored PDFLaTeX output.</span>
  (<span class="org-keyword">define-derived-mode</span> <span class="org-function-name">latex-output-mode</span> fundamental-mode <span class="org-string">"LaTeX-Output"</span>
    <span class="org-doc">"Simple mode for colorizing LaTeX output."</span>
    (set (make-local-variable 'font-lock-defaults)
         '(((<span class="org-string">"^!.*"</span> .
             compilation-error-face)    <span class="org-comment-delimiter">; </span><span class="org-comment">LaTeX error</span>
            (<span class="org-string">"^-+$"</span> .
             compilation-info-face)     <span class="org-comment-delimiter">; </span><span class="org-comment">Latexmk separator</span>
            (<span class="org-string">"^Package .* Warning: .*"</span> .
             compilation-warning-face)
            (<span class="org-string">"Reference .* undefined"</span> .
             compilation-warning-face)
            (<span class="org-string">"^</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(?:</span></span><span class="org-string">Overfull</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">Underfull</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">Tight</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">Loose</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">.*"</span> .
             font-lock-string-face)
            (<span class="org-string">"^LaTeX Font Warning:"</span> .
             font-lock-string-face)
            <span class="org-comment-delimiter">;; </span><span class="org-comment">...</span>
            ))))

  (<span class="org-keyword">defadvice</span> <span class="org-function-name">TeX-recenter-output-buffer</span>
    (after leuven-colorize-latex-output activate)
    (<span class="org-keyword">with-selected-window</span> (get-buffer-window (TeX-active-buffer))
      (latex-output-mode)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd2d0df7" class="outline-3">
<h3 id="orgd2d0df7">AUCTeX</h3>
<div class="outline-text-3" id="text-orgd2d0df7">
<dl class="org-dl">
<dt><code>TeX-mode</code> or <code>LaTeX-mode</code></dt><dd>AUCTeX (menus <code>Preview</code>, <code>LaTeX</code>, <code>Command</code> and <code>Ref</code>; text <code>LaTeX/P</code> displayed in
the mode line).</dd>
</dl>

<p>
AUCTeX supports TeX and extensions such as LaTeX.  For LaTeX, there is a
(major) <code>LaTeX-mode</code> in AUCTeX which runs (in this order):
</p>

<ol class="org-ol">
<li><code>text-mode-hook</code>, then</li>
<li><code>TeX-mode-hook</code>, and then</li>
<li>a hook <code>LaTeX-mode-hook</code> special to the LaTeX mode.</li>
</ol>

<p>
If you need to make a customization via a hook which is only relevant for the
LaTeX mode, put it into the <code>LaTeX-mode-hook</code>; if it is relevant for any AUCTeX
mode, add it to <code>TeX-mode-hook</code> and if it is relevant for all text modes, append
it to <code>text-mode-hook</code>.
</p>

<p>
AUCTeX defines the <code>tex-mode.el</code> mode names as alias of its own modes: it
aliases <code>(la)tex-mode</code> to <code>(La)TeX-mode</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (leuven--section <span class="org-string">"25.11 (emacs)AUCTeX Mode"</span>)

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 1.2 (info "(auctex)Installation") of AUCTeX</span>

  (try-require 'tex-site)<span class="org-comment-delimiter">;</span><span class="org-comment">XXX</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Support for LaTeX documents.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"latex"</span>
</pre>
</div>

<p>
You can detect the <b>successful activation of AUCTeX</b>: after loading a LaTeX
file, AUCTeX gives you a <code>Command</code> menu.
</p>

<ul class="org-ul">
<li>Press <code>C-c C-c File RET RET</code> to run <code>dvips</code> (note that the command is <code>File</code> and
not <code>Dvips</code> as one might expect)</li>

<li>Press <code>C-c C-c Print RET RET</code> to run <code>GSview</code> (also somewhat misleading name)</li>

<li>If you want to print the document, do it from <code>GSview</code>.</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; LaTeX-sensitive spell checking</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'tex-mode-hook</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">#'(lambda ()</span>
    <span class="org-comment-delimiter">;;             </span><span class="org-comment">(make-local-variable 'ispell-parser)</span>
    <span class="org-comment-delimiter">;;             </span><span class="org-comment">(setq ispell-parser 'tex)))</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 2.1 (info "(auctex)Quotes")</span>

    (leuven--section <span class="org-string">"2.1 (auctex)Quotes"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Insert right brace with suitable macro after typing left brace.</span>
    (<span class="org-keyword">setq</span> LaTeX-electric-left-right-brace t)

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 2.6 (info "(auctex)Completion")</span>

    (leuven--section <span class="org-string">"2.6 (auctex)Completion"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">If this is non-nil when AUCTeX is loaded, the TeX escape character `\'</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">will be bound to `</span><span class="org-comment"><span class="org-constant">TeX-electric-macro</span></span><span class="org-comment">'.</span>
    (<span class="org-keyword">setq</span> TeX-electric-escape t)

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 2.8 (info "(auctex)Indenting")</span>

    (leuven--section <span class="org-string">"2.8 (auctex)Indenting"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Leave the `</span><span class="org-comment"><span class="org-constant">tikzpicture</span></span><span class="org-comment">' code unfilled when doing `</span><span class="org-comment"><span class="org-constant">M-q</span></span><span class="org-comment">'.</span>
    (add-to-list 'LaTeX-indent-environment-list '(<span class="org-string">"tikzpicture"</span>))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Auto-indentation (suggested by the AUCTeX manual -- instead of adding</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">a local key binding to `</span><span class="org-comment"><span class="org-constant">RET</span></span><span class="org-comment">' in the `</span><span class="org-comment"><span class="org-constant">LaTeX-mode-hook</span></span><span class="org-comment">').</span>
    (<span class="org-keyword">setq</span> TeX-newline-function 'newline-and-indent)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 4.1 Executing (info "(auctex)Commands")</span>

    (leuven--section <span class="org-string">"4.1 Executing (auctex)Commands"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add a command to execute on the LaTeX document.</span>
    (add-to-list 'TeX-command-list
                 '(<span class="org-string">"XeLaTeX"</span> <span class="org-string">"%`xelatex%(mode)%' %t"</span> TeX-run-TeX nil t))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-to-list 'TeX-command-list</span>
    <span class="org-comment-delimiter">;;              </span><span class="org-comment">'("latexmk" "(run-latexmk)"</span>
    <span class="org-comment-delimiter">;;                </span><span class="org-comment">TeX-run-function nil t :help "Run latexmk") t)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq TeX-command-default "latexmk")</span>

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--LaTeX-mode-hook</span> ()

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Default command to run in the LaTeX buffer.</span>
      (<span class="org-keyword">setq</span> TeX-command-default         <span class="org-comment-delimiter">; </span><span class="org-comment">TeX-engine?</span>
            (<span class="org-keyword">save-excursion</span>
              (<span class="org-keyword">save-restriction</span>
                (widen)
                (goto-char (point-min))
                (<span class="org-keyword">let</span> ((re (concat
                           <span class="org-string">"^\\s-*\\\\usepackage</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(?:</span></span><span class="org-string">\\[</span><span class="org-string"><span class="org-constant">.*\\</span></span><span class="org-string">]</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">?"</span>
                           <span class="org-string">"{.*\\&lt;</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(?:</span></span><span class="org-string">font</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">math</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">spec\\&gt;.*}"</span>)))
                  (<span class="org-keyword">save-match-data</span>
                    (<span class="org-keyword">if</span> (re-search-forward re 3000 t)
                        <span class="org-string">"XeLaTeX"</span>
                      <span class="org-string">"LaTeX"</span>))))))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Minor mode for hiding and revealing macros and environments.</span>
      (TeX-fold-mode t))

    (add-hook 'LaTeX-mode-hook #'leuven--LaTeX-mode-hook)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't ask user for permission to save files before starting TeX.</span>
    (<span class="org-keyword">setq</span> TeX-save-query nil)

    (<span class="org-keyword">defun</span> <span class="org-function-name">TeX-default</span> ()
      <span class="org-doc">"Choose the default command from `C-c C-c'."</span>
      (<span class="org-keyword">interactive</span>)
      (TeX-save-document <span class="org-string">""</span>)          <span class="org-comment-delimiter">; </span><span class="org-comment">or just use `</span><span class="org-comment"><span class="org-constant">TeX-save-query</span></span><span class="org-comment">'</span>
      (execute-kbd-macro (kbd <span class="org-string">"C-c C-c RET"</span>)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Rebind the "compile command" to default command from `C-c C-c' (in LaTeX</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">mode only).</span>
    (define-key LaTeX-mode-map (kbd <span class="org-string">"&lt;f9&gt;"</span>) #'TeX-default)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Use PDF mode by default (instead of DVI).</span>
    (<span class="org-keyword">setq-default</span> TeX-PDF-mode t)
</pre>
</div>

<p>
A decent viewer reloads the PDF automatically when the file has changed while
staying on the same page (no need to close &amp; reopen).
</p>

<p>
Support for forward search with PDF files means that the viewer jumps to the
page in the output file corresponding to the position in the source file.
Currently, this only works if you use the pdfsync LaTeX package and xpdf or
SumatraPDF as your PDF viewer.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 4.2 (info "(auctex)Viewing") the formatted output</span>

    (leuven--section <span class="org-string">"4.2 (auctex)Viewing the formatted output"</span>)

    (<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven--sumatrapdf-command</span>
      (concat leuven--windows-program-files-dir <span class="org-string">"SumatraPDF/SumatraPDF.exe"</span>)
      <span class="org-doc">"Path to the SumatraPDF executable."</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Use a saner PDF viewer (evince, SumatraPDF).</span>
    (setcdr (assoc <span class="org-string">"^pdf$"</span> TeX-output-view-style)
            (<span class="org-keyword">cond</span> ((<span class="org-keyword">or</span> leuven--win32-p leuven--cygwin-p)
                   `(<span class="org-string">"."</span> (concat <span class="org-string">"\""</span> ,leuven--sumatrapdf-command <span class="org-string">"\" %o"</span>)))
                  (t
                   '(<span class="org-string">"."</span> <span class="org-string">"evince %o"</span>))))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">For AUCTeX 11.86+.</span>
    (<span class="org-keyword">when</span> (<span class="org-keyword">or</span> leuven--win32-p leuven--cygwin-p)
      (<span class="org-keyword">when</span> (boundp 'TeX-view-program-list)
        (add-to-list 'TeX-view-program-list
                     `(<span class="org-string">"SumatraPDF"</span>
                       ,(list (concat <span class="org-string">"\""</span> leuven--sumatrapdf-command <span class="org-string">"\" %o"</span>))))))

    (<span class="org-keyword">when</span> (<span class="org-keyword">or</span> leuven--win32-p leuven--cygwin-p)
      (setcdr (assoc 'output-pdf TeX-view-program-selection)
              '(<span class="org-string">"SumatraPDF"</span>)))
</pre>
</div>

<div class="tip">
<p>
Under Windows, we could open the PDF file with <code>start "" xxx.pdf</code> (in a command
prompt).
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 4.7 (info "(auctex)Documentation")</span>
</pre>
</div>

<p>
<code>C-c ?</code> (or <code>M-x TeX-doc</code>) displays documentation for a package.
</p>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> TeX-doc does not provide a list of available keywords for completion</b><br />
<p>
Nor a default when point is on a command name&#x2026;
</p>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 5.2 (info "(auctex)Multifile") Documents</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Assume that the file is a master file itself.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq-default TeX-master t)</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 5.3 Automatic (info "(auctex)Parsing Files")</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable parse on load (if no style hook is found for the file).</span>
    (<span class="org-keyword">setq</span> TeX-parse-self t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable automatic save of parsed style information when saving the buffer.</span>
    (<span class="org-keyword">setq</span> TeX-auto-save t)

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 5.4 (info "(auctex)Internationalization")</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; XXX Insert a literal hyphen.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq LaTeX-babel-insert-hyphen nil)</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 5.5 (info "(auctex)Automatic") Customization</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">TODO Add beamer.el to TeX-style-path</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">*** 5.5.1 (info "(auctex)Automatic Global") Customization for the Site</span>

    (leuven--section <span class="org-string">"5.5.1 (auctex)Automatic Global Customization for the Site"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Directory containing automatically generated TeX information.</span>
    (<span class="org-keyword">setq</span> TeX-auto-global
          (concat user-emacs-directory <span class="org-string">"auctex-auto-generated-info/"</span>))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Must end with a slash.</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">*** 5.5.3 (info "(auctex)Automatic Local") Customization for a Directory</span>

    (leuven--section <span class="org-string">"5.5.3 (auctex)Automatic Local Customization for a Directory"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Directory containing automatically generated TeX information.</span>
    (<span class="org-keyword">setq</span> TeX-auto-local (concat user-emacs-directory <span class="org-string">"auctex-auto-generated-info/"</span>))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Must end with a slash.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org1f819ef" class="outline-3">
<h3 id="org1f819ef">Preview-LaTeX</h3>
<div class="outline-text-3" id="text-org1f819ef">
<p>
You can detect the successful activation of <code>preview-latex</code>: after loading a
LaTeX file, <code>preview-latex</code> gives you a <code>Preview</code> menu.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(preview-latex)Top")</span>

    (leuven--section <span class="org-string">"(preview-latex)Top"</span>)

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"preview"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Path to `</span><span class="org-comment"><span class="org-constant">gs</span></span><span class="org-comment">' command (for format conversions).</span>
      (<span class="org-keyword">setq</span> preview-gs-command
        (<span class="org-keyword">cond</span> (leuven--win32-p
               (<span class="org-keyword">or</span> (executable-find <span class="org-string">"gswin32c.exe"</span>)
                   <span class="org-string">"C:/texlive/2015/tlpkg/tlgs/bin/gswin32c.exe"</span>))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Default value.</span>
              (t
               (<span class="org-keyword">or</span> (executable-find <span class="org-string">"rungs"</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">For Cygwin Emacs.</span>
                   <span class="org-string">"/usr/bin/gs"</span>))))
      (leuven--file-exists-and-executable-p preview-gs-command)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Scale factor for included previews.</span>
      (<span class="org-keyword">setq</span> preview-scale-function 1.2))
</pre>
</div>

<div class="note">
<p>
This is also called when exporting from Org to PDF.  Why?
</p>

<p>
To show it, just edit the path to <code>gswin32c</code> and you&rsquo;ll see a message &ldquo;Can&rsquo;t find
executable&rdquo; in the echo area.
</p>

</div>
</div>
</div>

<div id="outline-container-orgf7eb36e" class="outline-3">
<h3 id="orgf7eb36e">RefTeX</h3>
<div class="outline-text-3" id="text-orgf7eb36e">
<p>
AUCTeX is fantastic, and RefTeX just makes things better.
</p>

<p>
To fill in <code>\ref{}</code> and <code>\cite{}</code> commands, you can use <code>C-c &amp;</code>
(<code>reftex-view-crossref</code>).
</p>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Conflict with YASnippet prefix key and <code>org-mark-ring</code>-push</b><br />
nil</div>

<p>
A Table of Contents of the entire (multifile) document with browsing
capabilities is available with <code>C-c =</code>.  Hitting <code>l</code> there will show all the labels
and cites.
</p>

<p>
Labels can be created with <code>C-c (</code> and referenced with <code>C-c )</code>.  When referencing,
you get a menu with all labels of a given type and context of the label
definition.  The selected label is inserted as a <code>\ref</code> macro.
</p>

<p>
Citations can be made with <code>C-c [</code> which will use a regular expression to pull out
a <b>formatted</b> list of articles from your BibTeX database.  The selected citation
is inserted as a <code>\cite</code> macro.
</p>

<p>
Index entries can be made with <code>C-c /</code> which indexes the word at point or the
current selection.  More general index entries are created with <code>C-c &lt;</code>.
<code>C-c &gt;</code> displays the compiled index.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (add-hook 'LaTeX-mode-hook #'reftex-mode) <span class="org-comment-delimiter">; </span><span class="org-comment">with AUCTeX LaTeX mode</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Minor mode with distinct support for `</span><span class="org-comment"><span class="org-constant">\label</span></span><span class="org-comment">', `</span><span class="org-comment"><span class="org-constant">\ref</span></span><span class="org-comment">', `</span><span class="org-comment"><span class="org-constant">\cite</span></span><span class="org-comment">' and</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">\index</span></span><span class="org-comment">' in LaTeX.</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"reftex"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Turn all plug-ins on.</span>
      (<span class="org-keyword">setq</span> reftex-plug-into-AUCTeX t)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Use a separate selection buffer for each label type -- so the menu</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">generally comes up faster.</span>
      (<span class="org-keyword">setq</span> reftex-use-multiple-selection-buffers t))
</pre>
</div>
</div>
</div>

<div id="outline-container-org791a844" class="outline-3">
<h3 id="org791a844">BibTeX</h3>
<div class="outline-text-3" id="text-org791a844">
<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">BibTeX mode.</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"bibtex"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Current BibTeX dialect.</span>
      (<span class="org-keyword">setq</span> bibtex-dialect 'biblatex))

    )                                   <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "latex" ends here.</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 25.11-tex-mode ends here.</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org31d145e" class="outline-2">
<h2 id="org31d145e">SGML and HTML Modes</h2>
<div class="outline-text-2" id="text-org31d145e">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-25-text <span class="org-string">"25 Commands for Human Languages"</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 25.12 (info "(emacs)HTML Mode")</span>

  (leuven--section <span class="org-string">"25.12 (emacs)HTML Mode"</span>)
</pre>
</div>
</div>

<div id="outline-container-org1e401f7" class="outline-3">
<h3 id="org1e401f7">HTML</h3>
<div class="outline-text-3" id="text-org1e401f7">
</div>
<div id="outline-container-org7df23ff" class="outline-4">
<h4 id="org7df23ff">html-mode</h4>
<div class="outline-text-4" id="text-org7df23ff">
<p>
The default HTML mode, derived from SGML mode (see the HTML and SGML menus),
works quite well for editing HTML4 documents (whose tags don&rsquo;t have to close).
</p>

<dl class="org-dl">
<dt><code>C-c C-v</code></dt><dd><b>View</b> your file <b>in your browser</b> (<code>browse-url-of-buffer</code>).</dd>

<dt><code>C-c C-b</code> (or <code>C-c &lt;left&gt;</code>)</dt><dd>Jump to the opening HTML tag (<code>sgml-skip-tag-backward</code>).</dd>

<dt><code>C-c C-f</code> (or <code>C-c &lt;right&gt;</code>)</dt><dd>Jump to the closing HTML tag (<code>sgml-skip-tag-forward</code>).</dd>

<dt><code>C-c TAB</code></dt><dd>Hide all of the angle-bracketed tags in the buffer (<code>sgml-tags-invisible</code>).
This can be used as a cheap <b>preview</b> of <b>just the bare text</b>.</dd>

<dt><code>C-c /</code></dt><dd><code>sgml-close-tag</code>.</dd>

<dt><code>C-M-i</code></dt><dd><code>ispell-complete-word</code>.</dd>
</dl>
</div>
</div>

<div id="outline-container-orgfba67bc" class="outline-4">
<h4 id="orgfba67bc">html-helper-mode</h4>
<div class="outline-text-4" id="text-orgfba67bc">
<p>
You might also want to consider <code>html-helper-mode</code>, which has a lot more
features than plain <code>html-mode</code>:
</p>

<ul class="org-ul">
<li>autocompletion,</li>
<li>auto-insertion of closing tags&#x2026; and</li>
<li>a lot more.</li>
</ul>

<p>
When you open a buffer for HTML editing, a didactic HTML menu appears, so you
can use your mouse to invoke commands.
</p>

<p>
Using the prefix-arg (<code>C-u</code>) to relevant HTML tags, <code>html-helper-mode</code> will put
tags around a region you&rsquo;ve specified.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">when</span> (locate-library <span class="org-string">"html-helper-mode"</span>)

    (autoload 'html-helper-mode <span class="org-string">"html-helper-mode"</span>
      <span class="org-doc">"Mode for editing HTML documents."</span> t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Invoke html-helper-mode automatically on .html files.</span>
    (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.html?\\'"</span> . html-helper-mode))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Invoke html-helper-mode automatically on .asp files.</span>
    (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.asp\\'"</span> . html-helper-mode))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Invoke html-helper-mode automatically on .jsp files.</span>
    (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.jsp\\'"</span> . html-helper-mode)))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org30e9568" class="outline-3">
<h3 id="org30e9568">XHTML</h3>
<div class="outline-text-3" id="text-org30e9568">
<p>
<a href="#org74fc797">nXML</a> seems to be the most recommended mode to view and edit well-formed <b>XHTML</b>
(reformulation of HTML as an XML application).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.xhtml?\\'"</span> . xml-mode))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Alias for `</span><span class="org-comment"><span class="org-constant">nxml-mode</span></span><span class="org-comment">'.</span>
</pre>
</div>

<p>
Alternatively, you can use <a href="http://ourcomments.org/Emacs/nXhtml/doc/nxhtml.html">nXhtml</a> mode, derived from nXML mode.  It adds a lot
of things useful for <b>XHTML</b> files with mixed content:
</p>

<ul class="org-ul">
<li>handling <b>multiple major modes</b> (Mumamo) in one buffer (for CSS, JS, PHP and
similar things): get the correct syntax highlighting and indentation for
each of them,</li>
<li>folding,</li>
<li>improved interface to Tidy (?),</li>
<li>etc.</li>
</ul>

<p>
Though, it takes a while to load.
</p>
</div>
</div>

<div id="outline-container-orgcf58fcb" class="outline-3">
<h3 id="orgcf58fcb">web-mode</h3>
<div class="outline-text-3" id="text-orgcf58fcb">
<p>
<a href="http://web-mode.org/">web-mode</a> is another alternative for editing HTML documents embedding CSS/JS and
blocks (client/server side).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"web-mode-autoloads"</span>
    (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.aspx\\'"</span>   . web-mode))
    (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.axvw\\'"</span>   . web-mode)) <span class="org-comment-delimiter">; </span><span class="org-comment">ARCHIBUS view.</span>
    (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.html?\\'"</span>  . web-mode))
    (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.jsp\\'"</span>    . web-mode))
    (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.x[ms]l\\'"</span> . web-mode))
    (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.xhtml?\\'"</span> . web-mode)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Major mode for editing web templates.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"web-mode"</span>

    (define-key web-mode-map (kbd <span class="org-string">"C--"</span>)      #'web-mode-fold-or-unfold)
    (define-key web-mode-map (kbd <span class="org-string">"C-+"</span>)      #'web-mode-fold-or-unfold)
    (define-key web-mode-map (kbd <span class="org-string">"M-("</span>)      #'web-mode-element-wrap)

    (define-key web-mode-map (kbd <span class="org-string">"M-h"</span>)      #'web-mode-mark-and-expand)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Moving.</span>
    (define-key web-mode-map (kbd <span class="org-string">"M-n"</span>)      #'web-mode-tag-next)
    (define-key web-mode-map (kbd <span class="org-string">"C-M-e"</span>)    #'web-mode-element-end)
    (define-key web-mode-map (kbd <span class="org-string">"M-&lt;down&gt;"</span>) #'web-mode-element-sibling-next) <span class="org-comment-delimiter">;; </span><span class="org-comment">end or next? XXX</span>

    (define-key web-mode-map (kbd <span class="org-string">"M-p"</span>)      #'web-mode-tag-previous)
    (define-key web-mode-map (kbd <span class="org-string">"C-M-p"</span>)    #'web-mode-tag-previous)
    (define-key web-mode-map (kbd <span class="org-string">"C-M-a"</span>)    #'web-mode-element-previous)
    (define-key web-mode-map (kbd <span class="org-string">"M-&lt;up&gt;"</span>)   #'web-mode-element-sibling-previous)

    (define-key web-mode-map (kbd <span class="org-string">"C-M-u"</span>)    #'web-mode-element-parent)

    (define-key web-mode-map (kbd <span class="org-string">"C-M-d"</span>)    #'web-mode-element-child)


(<span class="org-keyword">defun</span> <span class="org-function-name">web-mode-edit-element-elements-end-inside</span> ()
  (<span class="org-keyword">interactive</span>)
  (web-mode-element-end)
  (backward-char))

(<span class="org-keyword">defun</span> <span class="org-function-name">web-mode-edit-element-utils-x-position</span> (fx)
  (<span class="org-keyword">save-excursion</span>
    (funcall fx)
    (point)))

(<span class="org-keyword">defun</span> <span class="org-function-name">web-mode-edit-element-utils-fnil</span> (val f)
  (<span class="org-keyword">if</span> val val
    (funcall f)))

(<span class="org-keyword">defun</span> <span class="org-function-name">web-mode-edit-element-elements-sibling-next-p</span> ()
  (<span class="org-keyword">let</span> ((parent-position
         (web-mode-edit-element-utils-fnil
          (<span class="org-keyword">save-excursion</span>
            (web-mode-element-beginning)
            (web-mode-element-parent-position))
          'point))
        (tag-next-position
         (web-mode-edit-element-utils-x-position
          (<span class="org-keyword">lambda</span> ()
            (web-mode-edit-element-elements-end-inside)
            (web-mode-tag-next)
            (web-mode-element-beginning)))))
    (not (= parent-position tag-next-position))))




(<span class="org-keyword">defun</span> <span class="org-function-name">web-mode-edit-element-elements-sibling-next-or-next-parent</span> ()
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">if</span> (web-mode-edit-element-elements-sibling-next-p)
      (web-mode-element-sibling-next)
    (web-mode-element-parent)
    (web-mode-element-sibling-next)))


    (define-key web-mode-map (kbd <span class="org-string">"M-&lt;down&gt;"</span>) #'web-mode-edit-element-elements-sibling-next-or-next-parent)





<span class="org-comment-delimiter">;; </span><span class="org-comment">XXX What about Fold Tag Attributes?</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">C-M-a           c-beginning-of-defun</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">C-M-e           c-end-of-defun</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">C-M-h           c-mark-function</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">C-M-j           c-indent-new-comment-line</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">C-M-q           c-indent-exp</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">M-a             c-beginning-of-statement</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">M-e             c-end-of-statement</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">M-j             c-indent-new-comment-line</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">M-q             c-fill-paragraph</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Script element left padding.</span>
    (<span class="org-keyword">setq</span> web-mode-script-padding
          (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> (boundp 'standard-indent) standard-indent) standard-indent 4))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Style element left padding.</span>
    (<span class="org-keyword">setq</span> web-mode-style-padding
          (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> (boundp 'standard-indent) standard-indent) standard-indent 4))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">CSS indentation level.</span>
    (<span class="org-keyword">setq-default</span> web-mode-css-indent-offset
                  (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> (boundp 'standard-indent) standard-indent) standard-indent 4))

    (<span class="org-keyword">setq-default</span> web-mode-attr-indent-offset
                  (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> (boundp 'standard-indent) standard-indent) standard-indent 4))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Code (JavaScript, php, etc.) indentation level.</span>
    (<span class="org-keyword">setq-default</span> web-mode-code-indent-offset
                  (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> (boundp 'standard-indent) standard-indent) standard-indent 4))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">XXX Check out ab-pm-cf-wr-newother.axvw.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Auto-pairing.</span>
    (<span class="org-keyword">setq</span> web-mode-enable-auto-pairing t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable element highlight.</span>
    (<span class="org-keyword">setq</span> web-mode-enable-current-element-highlight t) <span class="org-comment-delimiter">; </span><span class="org-comment">web-mode-current-element-highlight-face.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable block face (useful for setting background of &lt;style&gt;).</span>
    (<span class="org-keyword">setq</span> web-mode-enable-block-face t) <span class="org-comment-delimiter">; </span><span class="org-comment">web-mode-block-face.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable part face (useful for setting background of &lt;script&gt;).</span>
    (<span class="org-keyword">setq</span> web-mode-enable-part-face t) <span class="org-comment-delimiter">; </span><span class="org-comment">web-mode-part-face.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Comment style : 1 = default, 2 = force server comments outside a block.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq web-mode-comment-style 2)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">(flycheck-add-mode 'html-tidy 'web-mode)</span>
</pre>
</div>

<p>
Show XML path on the modeline or in an header?
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">ARCHIBUS Imenu.</span>
    (add-to-list 'web-mode-imenu-regexp-list
                 '(<span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">dataSource</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string"> id=\"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[a-zA-Z0-9_]*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span> 1 2 <span class="org-string">" "</span>))
    (add-to-list 'web-mode-imenu-regexp-list
                 '(<span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">panel</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string"> .*id=\"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[a-zA-Z0-9_]*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span> 1 2 <span class="org-string">" "</span>))
    (add-to-list 'web-mode-imenu-regexp-list
                 '(<span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">button</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">.*id=\"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[a-zA-Z0-9_]*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span> 1 2 <span class="org-string">" "</span>))
    (add-to-list 'web-mode-imenu-regexp-list
                 '(<span class="org-string">"id=\"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[a-zA-Z0-9_]*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">.*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">button</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span> 2 1 <span class="org-string">" "</span>))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">setq</span> web-mode-imenu-generic-expression
          '(
            (<span class="org-string">"DataSource"</span> <span class="org-string">"&lt;dataSource[ ]*id=\"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[a-zA-Z0-9-_./#]*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">\"[ ]*&gt;"</span> 1)
            <span class="org-comment-delimiter">;; </span><span class="org-comment">("Includes" "&lt;cfinclude[ ]*template=\"\\([a-zA-Z0-9-_./#]*\\)\"[ ]*&gt;" 1)</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">("Cases" "&lt;cfcase[ ]*value=\"\\([a-zA-Z0-9-_,. ]*\\)\".*&gt;" 1)</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">("Forms" "&lt;form.*action[ ]*=[ ]*\"\\([a-zA-Z0-9-_#.\?=]*\\)\".*&gt;" 1)</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">("Queries" "&lt;cfquery.*name[ ]*=[ ]*\"\\([a-zA-Z0-9-_#.]*\\)\".*&gt;" 1)</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">("Loops" "&lt;\\(cfloop\\|cfoutput\\).*\\(list\\|to\\|query\\)[ ]*=[ ]*\"\\([a-zA-Z0-9-_#.=]*\\)\".*&gt;" 3)</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">("JSFunctions" "function[ ]*\\([a-zA-Z0-9-_]*\\)[ ]*(.*)" 1)</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">("Content" "&lt;cfcontent.*type=\"\\([a-zA-Z0-9-_./]*\\)\".*&gt;" 1)</span>
            <span class="org-comment-delimiter">;;                             </span><span class="org-comment">;cfmodule, cflocation, cftransaction, cfabort, cfif?, add cfform to forms, cflock</span>
            ))

    (add-hook 'web-mode-hook
              #'(lambda ()
                  (<span class="org-keyword">setq</span> imenu-generic-expression
                        web-mode-imenu-generic-expression)))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Highlight `</span><span class="org-comment"><span class="org-constant">saveWorkflowRuleId</span></span><span class="org-comment">' in AXVW files.</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    )
</pre>
</div>
</div>
</div>

<div id="outline-container-org74fc797" class="outline-3">
<h3 id="org74fc797">XML</h3>
<div class="outline-text-3" id="text-org74fc797">
<p>
nXML mode (default for editing XML files, since GNU Emacs 23.2) does:
</p>

<ul class="org-ul">
<li>real-time <b>validation against a schema in RELAX NG</b> (actually RNC, i.e. the
&ldquo;Compact&rdquo; Syntax): <code>C-c C-n</code> (assuming RNG validation is on),</li>

<li><b>code completion</b> against the RNG schema.</li>
</ul>

<p>
Some key bindings:
</p>

<dl class="org-dl">
<dt><code>C-M-n</code></dt><dd>Move forward over one element (<code>nxml-forward-element</code>).</dd>

<dt><code>C-M-p</code></dt><dd>Move backward over one element (<code>nxml-backward-element</code>).</dd>

<dt><code>C-M-u</code></dt><dd>Move up the element structure (<code>nxml-backward-up-element</code>).</dd>

<dt><code>C-M-d</code></dt><dd>Move down the element structure (<code>nxml-down-element</code>).</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"nxml-mode"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Indent 4 spaces (for the children of an element relative to the start-tag).</span>
    (<span class="org-keyword">setq</span> nxml-child-indent 4)

    (<span class="org-keyword">setq</span> nxml-slash-auto-complete-flag t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Remove the binding of `C-c C-x' (`</span><span class="org-comment"><span class="org-constant">nxml-insert-xml-declaration</span></span><span class="org-comment">'), used by</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Org timeclocking commands.</span>
    (define-key nxml-mode-map (kbd <span class="org-string">"C-c C-x"</span>) nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">View the buffer contents in a browser.</span>
    (define-key nxml-mode-map (kbd <span class="org-string">"C-c C-v"</span>) #'browse-url-of-buffer)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">XXX Normally bound to</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">rng-validate-mode</span></span><span class="org-comment">'.</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Fix XML folding.</span>
    (add-to-list 'hs-special-modes-alist
                 '(nxml-mode
                   <span class="org-string">"&lt;!--</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">&lt;[</span><span class="org-string"><span class="org-negation-char">^</span></span><span class="org-string">/&gt;]*[</span><span class="org-string"><span class="org-negation-char">^</span></span><span class="org-string">/]&gt;"</span>
                   <span class="org-string">"--&gt;</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">&lt;/[</span><span class="org-string"><span class="org-negation-char">^</span></span><span class="org-string">/&gt;]*[</span><span class="org-string"><span class="org-negation-char">^</span></span><span class="org-string">/]&gt;"</span>
                   <span class="org-string">"&lt;!--"</span>
                   nxml-forward-element
                   nil))

    (add-hook 'nxml-mode-hook 'hs-minor-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-org08555af" class="outline-3">
<h3 id="org08555af">Highlight the closing tag (Pair highlighting)</h3>
<div class="outline-text-3" id="text-org08555af">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Highlight the current SGML tag context (`</span><span class="org-comment"><span class="org-constant">hl-tags-face</span></span><span class="org-comment">').</span>
  (try-require 'hl-tags-mode)
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"hl-tags-mode"</span>

    (add-hook 'html-mode-hook
              #'(lambda ()
                  (<span class="org-keyword">require</span> '<span class="org-constant">sgml-mode</span>)
                  <span class="org-comment-delimiter">;; </span><span class="org-comment">When `</span><span class="org-comment"><span class="org-constant">html-mode-hook</span></span><span class="org-comment">' is called from `</span><span class="org-comment"><span class="org-constant">html-helper-mode</span></span><span class="org-comment">'.</span>
                  (hl-tags-mode 1)))      <span class="org-comment-delimiter">; </span><span class="org-comment">XXX Can't we simplify this form?</span>

    (add-hook 'nxml-mode-hook
              #'(lambda ()
                  (<span class="org-keyword">when</span> (&lt; (buffer-size) large-file-warning-threshold) <span class="org-comment-delimiter">; </span><span class="org-comment">View large files.</span>
                    (hl-tags-mode 1))))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'web-mode-hook #'hl-tags-mode)</span>
    )
</pre>
</div>
</div>
</div>

<div id="outline-container-org5a6faea" class="outline-3">
<h3 id="org5a6faea">CSS</h3>
<div class="outline-text-3" id="text-org5a6faea">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">TODO: Handle media queries</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">TODO: Handle wrapped lines</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">TODO: Ignore vendor prefixes</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-sort-css-properties</span> ()
    <span class="org-doc">"Sort CSS properties alphabetically."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let</span> ((start (search-forward <span class="org-string">"{"</span>))
          (end (search-forward <span class="org-string">"}"</span>)))
      (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> start end)
        (sort-lines nil start end)
        (sort-declarations))))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 25 ends here.</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org7a8a7a8" class="outline-2">
<h2 id="org7a8a7a8">Editing Programs</h2>
<div class="outline-text-2" id="text-org7a8a7a8">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 26 Editing (info "(emacs)Programs")</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-26-programs <span class="org-string">"26 Editing Programs"</span>
</pre>
</div>

<p>
Keyboard shortcuts:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Command</th>
<th scope="col" class="org-left">Emacs</th>
<th scope="col" class="org-left">Sublime Text</th>
<th scope="col" class="org-left">IntelliJ IDEA</th>
<th scope="col" class="org-left">TextMate</th>
<th scope="col" class="org-left">Atom</th>
<th scope="col" class="org-left">Webstorm</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Move line up</td>
<td class="org-left">C-S-up</td>
<td class="org-left">C-S-up</td>
<td class="org-left">M-S-up</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">C-up</td>
<td class="org-left">M-S-up</td>
</tr>

<tr>
<td class="org-left">Move line down</td>
<td class="org-left">C-S-down</td>
<td class="org-left">C-S-down</td>
<td class="org-left">M-S-down</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">C-down</td>
<td class="org-left">M-S-down</td>
</tr>

<tr>
<td class="org-left">Scroll line up</td>
<td class="org-left">C-up</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Scroll line down</td>
<td class="org-left">C-down</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Swap the current and next line.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-move-line-down</span> ()
    <span class="org-doc">"Move the current line down one line."</span>
    (<span class="org-keyword">interactive</span>)
    (forward-line 1)
    (transpose-lines 1)
    (forward-line -1))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Swap the current and previous line.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-move-line-up</span> ()
    <span class="org-doc">"Move the current line up one line."</span>
    (<span class="org-keyword">interactive</span>)
    (transpose-lines 1)
    (forward-line -2))

  (add-hook 'prog-mode-hook
            #'(lambda ()
                (local-set-key (kbd <span class="org-string">"&lt;C-S-down&gt;"</span>) #'leuven-move-line-down)
                (local-set-key (kbd <span class="org-string">"&lt;C-S-up&gt;"</span>)   #'leuven-move-line-up)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Sublime Text and js2-refactor.</span>
                (local-set-key (kbd <span class="org-string">"&lt;M-S-down&gt;"</span>) #'leuven-move-line-down)
                (local-set-key (kbd <span class="org-string">"&lt;M-S-up&gt;"</span>)   #'leuven-move-line-up)))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">IntelliJ IDEA.</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Move caret down and up in the editor.</span>
  (add-hook 'prog-mode-hook
            #'(lambda ()
                <span class="org-comment-delimiter">;; </span><span class="org-comment">Scroll text of current window upward by one line.</span>
                (local-set-key (kbd <span class="org-string">"&lt;C-up&gt;"</span>)   (kbd <span class="org-string">"C-u 1 C-v"</span>))

                <span class="org-comment-delimiter">;; </span><span class="org-comment">Scroll text of current window downward by one line.</span>
                (local-set-key (kbd <span class="org-string">"&lt;C-down&gt;"</span>) (kbd <span class="org-string">"C-u 1 M-v"</span>))))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Sublime Text + SQL Management Studio + IntelliJ IDEA.</span>
</pre>
</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Add &ldquo;move view&rdquo; up/down on C-up/down</b><br />
<p>
See an example in SQL Server Management Studio
</p>
</div>
</div>

<div id="outline-container-org443e4c1" class="outline-3">
<h3 id="org443e4c1">Major Modes for Programming Languages</h3>
<div class="outline-text-3" id="text-org443e4c1">
<p>
Have a look at:
</p>
<ul class="org-ul">
<li><a href="http://cedet.sourceforge.net">CEDET</a> for development in AWK, C/C++, C#, Calc, Erlang, Java, JavaScript, Make,
PHP, Python, Ruby and Scheme,</li>
<li><a href="http://common-lisp.net/project/slime">SLIME</a> for Common Lisp development,</li>
<li>JDEE for Java programs.</li>
</ul>

<p>
Emacs tool for Emacs Lisp code analysis (to keep overview of the function calls
and dependecies between functions/variables): byte-compile-generate-call-tree
</p>

<p>
Also <code>who-calls.el</code>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 26.1 Major Modes for (info "(emacs)Program Modes")</span>

  (leuven--section <span class="org-string">"26.1 Major Modes for (emacs)Program Modes"</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-org1bacaee" class="outline-3">
<h3 id="org1bacaee">Top-Level Definitions, or Defuns</h3>
<div class="outline-text-3" id="text-org1bacaee">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 26.2 Top-Level Definitions, or (info "(emacs)Defuns")</span>

  (leuven--section <span class="org-string">"26.2 Top-Level Definitions, or (emacs)Defuns"</span>)
</pre>
</div>
</div>

<div id="outline-container-org241d422" class="outline-4">
<h4 id="org241d422">Navigating Between Methods</h4>
<div class="outline-text-4" id="text-org241d422">
<p>
Keyboard shortcuts:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Command</th>
<th scope="col" class="org-left">Emacs</th>
<th scope="col" class="org-left">Leuven</th>
<th scope="col" class="org-left">IntelliJ IDEA</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Move beginning of defun</td>
<td class="org-left">C-M-a</td>
<td class="org-left">M-up</td>
<td class="org-left">M-up</td>
</tr>

<tr>
<td class="org-left">Move end of defun</td>
<td class="org-left">C-M-e</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Move beginning of next defun</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">M-down</td>
<td class="org-left">M-down</td>
</tr>
</tbody>
</table>

<p>
Use <code>M-up</code> and <code>M-down</code> keys to quickly jump to the <b>previous</b> or <b>next function</b>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-beginning-of-next-defun</span> ()
    <span class="org-doc">"Move forward to the beginning of next defun."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let</span> ((current-prefix-arg -1))
      (call-interactively 'beginning-of-defun)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Next Method.</span>
  (global-set-key (kbd <span class="org-string">"&lt;M-down&gt;"</span>) #'leuven-beginning-of-next-defun)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Previous Method.</span>
  (global-set-key (kbd <span class="org-string">"&lt;M-up&gt;"</span>)   #'beginning-of-defun) <span class="org-comment-delimiter">; </span><span class="org-comment">C-M-a.</span>
</pre>
</div>

<p>
Imenu is a great tool allowing you to <b>go to a function definition</b> (by name), but
only if the definition is <b>in the buffer you are currently editing</b> (it won&rsquo;t jump
and open another file).
</p>

<p>
<code>font-lock-mode-hook</code> is run after entering a major mode. You can make use of this
to add an Imenu index to the menu bar in any mode that supports Imenu.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Making buffer indexes as menus.</span>
  (try-require 'imenu)                  <span class="org-comment-delimiter">; </span><span class="org-comment">Awesome!</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"imenu"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Imenu should always rescan the buffers.</span>
    (<span class="org-keyword">setq</span> imenu-auto-rescan t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add Imenu to the menu bar in any mode that supports it.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">try-to-add-imenu</span> ()
      (<span class="org-keyword">condition-case</span> nil
          (imenu-add-to-menubar <span class="org-string">"Outline"</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">Imenu index.</span>
        (<span class="org-warning">error</span> nil)))
    (add-hook 'font-lock-mode-hook #'try-to-add-imenu)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Bind Imenu from the mouse.</span>
    (global-set-key [S-mouse-3] #'imenu)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">String to display in the mode line when current function is unknown.</span>
    (<span class="org-keyword">setq</span> which-func-unknown <span class="org-string">"(Top Level)"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Show current function in mode line (based on Imenu).</span>
    (which-function-mode 1)             <span class="org-comment-delimiter">; </span><span class="org-comment">~ Stickyfunc mode (in header line)</span>
</pre>
</div>

<p>
Truncate the current function name (for the mode line):
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--which-func-current</span> ()
      (<span class="org-keyword">let</span> ((current (gethash (selected-window) which-func-table)))
        (<span class="org-keyword">if</span> current
            (truncate-string-to-width current 30 nil nil <span class="org-string">"..."</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">30 = OK!</span>
          which-func-unknown)))

    (<span class="org-keyword">setq</span> which-func-format
          `(<span class="org-string">"["</span> (<span class="org-builtin">:propertize</span> (<span class="org-builtin">:eval</span> (leuven--which-func-current))
                             local-map ,which-func-keymap
                             face which-func
                             mouse-face mode-line-highlight
                             help-echo <span class="org-string">"mouse-1: go to beginning\n\</span>
<span class="org-string">mouse-2: toggle rest visibility\n\</span>
<span class="org-string">mouse-3: go to end"</span>) <span class="org-string">"]"</span>)))
</pre>
</div>

<p>
<code>helm-imenu-in-all-buffers</code> command pops an Helm interface with all the <b>Imenu tags</b>
<b>across all buffers with the same mode as the current one</b>.
</p>

<div class="note">
<p>
In a sense, it is similar to <code>etag</code> selection, but works only for the <i>open</i>
buffers &#x2013; you don&rsquo;t get thousands of symbols from <code>etags</code> to deal with.  And this
is often more convenient as you don&rsquo;t have to explicitly build the <code>etags</code> table.
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Keybinding to quickly jump to a symbol in buffer.</span>
    (global-set-key [remap imenu] #'helm-imenu)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Helm Imenu tag selection across all buffers (with the same mode).</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-c i") #'helm-imenu-in-all-buffers)</span>
  )

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Helm interface for Imenu.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm-imenu"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Delimit types of candidates and his value</span>
    (<span class="org-keyword">setq</span> helm-imenu-delimiter <span class="org-string">": "</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Do not directly jump to the definition even if there is just on candidate.</span>
    (<span class="org-keyword">setq</span> helm-imenu-execute-action-at-once-if-one nil))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0b9862e" class="outline-3">
<h3 id="org0b9862e">Indentation for Programs</h3>
<div class="outline-text-3" id="text-org0b9862e">
<p>
Changing the &ldquo;hanginess&rdquo; of a brace and then reindenting, will not move the
brace to a different line.  For this, you&rsquo;re better off getting an external
program like GNU <code>indent</code>, which will rearrange brace location, among other
things.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 26.3 (info "(emacs)Program Indent")ation</span>

    (leuven--section <span class="org-string">"26.3 (emacs)Program Indentation"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Turn on auto-fill mode in Lisp modes.</span>
    (add-hook 'lisp-mode-hook #'auto-fill-mode)
    (add-hook 'emacs-lisp-mode-hook #'auto-fill-mode)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Auto-indentation: automatically jump to the "correct" column when the RET</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">key is pressed while editing a program (act as if you pressed `</span><span class="org-comment"><span class="org-constant">C-j</span></span><span class="org-comment">').</span>
    (add-hook 'prog-mode-hook
              #'(lambda ()
                  (local-set-key (kbd <span class="org-string">"&lt;RET&gt;"</span>) #'newline-and-indent)
                  (local-set-key (kbd <span class="org-string">"C-j"</span>) #'newline)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(defun back-to-indentation-or-beginning ()</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(interactive)</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(if (/= (point) (line-beginning-position))</span>
    <span class="org-comment-delimiter">;;       </span><span class="org-comment">(beginning-of-line)</span>
    <span class="org-comment-delimiter">;;     </span><span class="org-comment">(back-to-indentation)))</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(defun align-with-spaces (beg end)</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">"Align selected using only spaces for whitespace."</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(interactive "r")</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(let ((indent-tabs-mode nil))</span>
    <span class="org-comment-delimiter">;;     </span><span class="org-comment">(align beg end)))</span>

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"sh-script"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Use the SMIE code for navigation and indentation.</span>
      (<span class="org-keyword">setq</span> sh-use-smie t))
</pre>
</div>
</div>
</div>

<div id="outline-container-org74f5c20" class="outline-3">
<h3 id="org74f5c20">Commands for Editing with Parentheses</h3>
<div class="outline-text-3" id="text-org74f5c20">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 26.4 Commands for Editing with (info "(emacs)Parentheses")</span>

  (leuven--section <span class="org-string">"26.4 Commands for Editing with (emacs)Parentheses"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Check for unbalanced parentheses in the current buffer.</span>
  (<span class="org-keyword">dolist</span> (mode '(emacs-lisp clojure js2 js))
    (add-hook (intern (format <span class="org-string">"%s-mode-hook"</span> mode))
              #'(lambda ()
                  (add-hook 'after-save-hook 'check-parens nil t))))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Move cursor to offscreen open-paren when close-paren is inserted.</span>
  (<span class="org-keyword">setq</span> blink-matching-paren 'jump-offscreen) <span class="org-comment-delimiter">; </span><span class="org-comment">XXX Doesn't work when</span>
                                              <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">show-paren-mode</span></span><span class="org-comment">' is enabled.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Highlight matching paren.</span>
  (show-paren-mode 1)
  (<span class="org-keyword">setq</span> show-paren-style 'mixed)
  (<span class="org-keyword">setq</span> show-paren-ring-bell-on-mismatch t)

(<span class="org-keyword">setq</span> show-paren-when-point-inside-paren t)
(<span class="org-keyword">setq</span> show-paren-when-point-in-periphery t)
</pre>
</div>
</div>

<div id="outline-container-org6af05d1" class="outline-4">
<h4 id="org6af05d1">Rainbow Parentheses</h4>
<div class="outline-text-4" id="text-org6af05d1">
<p>
Automagically highlight matching parentheses in source code.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Highlight nested parens, brackets, braces a different color at each depth.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"rainbow-delimiters-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable rainbow-delimiters in programming modes.</span>
    (add-hook 'prog-mode-hook #'rainbow-delimiters-mode))
</pre>
</div>

<p>
To customize it, see
<a href="http://yoo2080.wordpress.com/2013/12/21/small-rainbow-delimiters-tutorial/">http://yoo2080.wordpress.com/2013/12/21/small-rainbow-delimiters-tutorial/</a>.
</p>
</div>
</div>

<div id="outline-container-org07b5f2a" class="outline-4">
<h4 id="org07b5f2a">Navigating to Parentheses</h4>
<div class="outline-text-4" id="text-org07b5f2a">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">XXX Navigate to the code block start.</span>
  (global-set-key (kbd <span class="org-string">"C-)"</span>) #'forward-sexp)
  (global-set-key (kbd <span class="org-string">"C-("</span>) #'backward-sexp)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Jump to matching parenthesis.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-goto-matching-paren</span> (arg)
    <span class="org-doc">"Go to the matching parenthesis, if on a parenthesis."</span>
    (<span class="org-keyword">interactive</span> <span class="org-string">"p"</span>)
    (<span class="org-keyword">cond</span> ((looking-at <span class="org-string">"\\s</span><span class="org-string"><span class="org-warning">\</span></span><span class="org-string">("</span>) (forward-list 1) (backward-char 1))
          ((looking-at <span class="org-string">"\\s</span><span class="org-string"><span class="org-warning">\</span></span><span class="org-string">)"</span>) (forward-char 1) (backward-list 1))))

  (global-set-key (kbd <span class="org-string">"C-S-)"</span>) #'leuven-goto-matching-paren)
  (global-set-key (kbd <span class="org-string">"C-°"</span>)   #'leuven-goto-matching-paren)
</pre>
</div>
</div>
</div>

<div id="outline-container-org44759dd" class="outline-4">
<h4 id="org44759dd">Matching Parentheses</h4>
<div class="outline-text-4" id="text-org44759dd">
<p>
Balanced editing: inserting two matching parentheses at once, etc.
</p>

<ul class="org-ul">
<li>autopair</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"autopair-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Attempts to wrap the selected region.</span>
    (<span class="org-keyword">setq</span> autopair-autowrap t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable Autopair-Global mode.</span>
    (autopair-global-mode 1))
</pre>
</div>

<ul class="org-ul">
<li><p>
<code>electric-pair-mode</code> (in Emacs, since 24.1)
</p>

<p>
Here&rsquo;s a quick summary (<code>|</code> marks point):
</p>

<ul class="org-ul">
<li>typing <code>((((</code> makes            <code>((((|))))</code></li>
<li>typing <code>))))</code> afterwards makes <code>(((())))|</code></li>
<li>if the buffer has too many closers, an opener before them will <b>not</b> autopair</li>
<li>if the buffer has too many openers, a closer after them will <b>not</b> autoskip</li>
<li>in a mixed parenthesis situation with <code>[]</code>&rsquo;s and <code>()</code>&rsquo;s, it tries to do
sensible things</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable automatic parens pairing (Electric Pair mode).</span>
  (electric-pair-mode 1)

  (<span class="org-keyword">defvar</span> <span class="org-variable-name">org-electric-pairs</span>
    '(
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(?\* . ?\*)</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(?/ . ?/)</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(?_ . ?_)</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(?= . ?=)                      ; Too much used in code blocks.</span>
      (?~ . ?~))
    <span class="org-doc">"Electric pairs for Org mode."</span>)     <span class="org-comment-delimiter">; </span><span class="org-comment">See `</span><span class="org-comment"><span class="org-constant">org-emphasis-alist</span></span><span class="org-comment">'.</span>

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--org-add-electric-pairs</span> ()
    (<span class="org-keyword">setq-local</span> electric-pair-pairs (append electric-pair-pairs org-electric-pairs))
    (<span class="org-keyword">setq-local</span> electric-pair-text-pairs electric-pair-pairs)) <span class="org-comment-delimiter">; </span><span class="org-comment">In comments.</span>

  (add-hook 'org-mode-hook #'leuven--org-add-electric-pairs)
</pre>
</div>

<p>
Alternatives: <a href="http://emacs.stackexchange.com/questions/17284/adding-tilde-to-electric-pairs-in-org-mode/17341#17341">http://emacs.stackexchange.com/questions/17284/adding-tilde-to-electric-pairs-in-org-mode/17341#17341</a>
</p>

<p>
As of Emacs 24.4, this mode is greatly improved and matches autopair.el in
functionality (also recommended by the autopair author).
</p>

<ul class="org-ul">
<li><p>
<b>paredit</b> is (was?) the thing to use for Emacs Lisp!
</p>

<p>
Paredit-kill kills text until next paren or double quote!  Also exists now in
smartparens strict mode&#x2026;
</p></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Minor mode for editing parentheses.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"paredit-autoloads"</span>

    (add-hook 'emacs-lisp-mode-hook #'paredit-mode)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Common Lisp editing extensions.</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"redshank"</span>    <span class="org-comment-delimiter">; </span><span class="org-comment">Requires `</span><span class="org-comment"><span class="org-constant">paredit</span></span><span class="org-comment">'.</span>

      (add-hook 'emacs-lisp-mode-hook #'redshank-mode)))
</pre>
</div>

<p>
Use it in ELisp; use smartparens in other modes (NOT globally!)
</p>

<p>
Keep looking at the <a href="http://www.emacswiki.org/emacs/PareditCheatsheet">cheatsheet</a> until you&rsquo;ve got the hang of it.
</p>

<p>
<a href="http://danmidwood.com/content/2014/11/21/animated-paredit.html">The Animated Guide to Paredit</a>
</p>

<ul class="org-ul">
<li><p>
<b>smartparens</b>
</p>

<p>
Pair can be simple as parentheses or brackets, or can be programming tokens
such as <code>if</code> &#x2026; <code>fi</code> or <code>if</code> &#x2026; <code>end</code> in many languages (see face
<code>sp-show-pair-match-face</code>).
</p>

<p>
If you get into any serious lisp coding, check out <code>paredit</code> &#x2013; it forces you to
always have balanced brackets in the file, thus avoiding a whole class of
silly but hard-to-spot mistakes on lines ending with and avalanche of <code>)))))</code>.
</p>

<p>
If you are less into bondage &amp; submission, <code>smartparens.el</code> is another option,
it <b>helps</b> to have balanced brackets without breaking your will ;-)
</p>

<p>
It is more about ease-of-coding than B&amp;D.
</p>

<div class="note">
<p>
If we believe Xiao Hanyu, smartparens is the future, it is the ultimate
solution for paren pairs management in Emacs world.  It is flexible, uniform
and highly customizable.  It is also bundled with a comprehensive
documentation, besides a Wiki, you can also <code>M-x sp-cheat-sheet</code> to get live
examples, which, I think, is really a innovative feature.
</p>

</div>

<p>
<b>Bug 18785: Emacs hangs with Org mode when point is in LOGBOOK.</b>
</p>

<dl class="org-dl">
<dt><code>C-M-e</code> (<code>sp-up-sexp</code>)</dt><dd>Move forward out of one level of parentheses.</dd>

<dt><code>C-M-u</code> (<code>sp-backward-up-sexp</code>)</dt><dd>Move backward out of one level of parentheses.</dd>

<dt><code>C-M-&lt;backspace&gt;</code> (<code>sp-splice-sexp-killing-backward</code>)</dt><dd><p>
Unwrap the current list and kill all the expressions between start of
this list and the point.
</p>

<p>
This one&rsquo;s surpisingly useful for writing prose.
</p></dd>

<dt><code>C-S-&lt;backspace&gt;</code> or <code>M-R</code> ? (<code>sp-splice-sexp-killing-around</code>)</dt><dd>Unwrap the current list and kill everything inside except next
expression.</dd>

<dt><code>C-&lt;right&gt;</code> (<code>sp-forward-slurp-sexp</code>)</dt><dd>Add sexp following the current list in it by moving the closing
delimiter.</dd>

<dt><code>C-&lt;left&gt;</code> (<code>sp-forward-barf-sexp</code>)</dt><dd>Remove the last sexp in the current list by moving the closing delimiter.</dd>
</dl></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Automatic insertion, wrapping and paredit-like navigation with user defined</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">pairs.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"smartparens-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Default configuration for smartparens package.</span>
    (<span class="org-keyword">require</span> '<span class="org-constant">smartparens-config</span>)       <span class="org-comment-delimiter">; </span><span class="org-comment">Keybinding management, markdown-mode,</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">org-mode, (la)tex-mode, Lisp modes,</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">C++, PHP.</span>
    (global-set-key <span class="org-string">"\M-R"</span> #'sp-splice-sexp-killing-around) <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">sp-raise-sexp</span></span><span class="org-comment">'.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Toggle Smartparens mode in all buffers.</span>
    (smartparens-global-mode 1)         <span class="org-comment-delimiter">; </span><span class="org-comment">How to disable this in large files?</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Toggle Show-Smartparens mode in all buffers.</span>
    (show-smartparens-global-mode 1)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Remove local pairs in Text mode.</span>
    (sp-local-pair 'text-mode <span class="org-string">"'"</span> nil <span class="org-builtin">:actions</span> nil)
    (sp-local-pair 'text-mode <span class="org-string">"\""</span> nil <span class="org-builtin">:actions</span> nil)

    (<span class="org-keyword">push</span> 'latex-mode sp-ignore-modes-list)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">require</span> '<span class="org-constant">smartparens-org</span>)
</pre>
</div>

<p>
Combining the regular <code>kill-line</code> with <code>sp-kill-sexp</code>: <code>kill-line</code> everywhere, and
<code>sp-kill-sexp</code> with a prefix.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-sp-kill-maybe</span> (arg)
      (<span class="org-keyword">interactive</span> <span class="org-string">"P"</span>)
      (<span class="org-keyword">if</span> (consp arg)
          (sp-kill-sexp)
        (kill-line arg)))

    (global-set-key [remap kill-line] #'leuven-sp-kill-maybe)
</pre>
</div>

<p>
<code>turn-on-smartparens-strict-mode</code> adds years to one&rsquo;s life to allow for more
hacking.  Seriously.  XXX
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Enable smartparens-strict-mode in all Lisp modes.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(mapc #'(lambda (mode)</span>
    <span class="org-comment-delimiter">;;         </span><span class="org-comment">(add-hook (intern (format "%s-hook" (symbol-name mode)))</span>
    <span class="org-comment-delimiter">;;                   </span><span class="org-comment">#'smartparens-strict-mode))</span>
    <span class="org-comment-delimiter">;;       </span><span class="org-comment">sp--lisp-modes)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    )
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org3effb30" class="outline-3">
<h3 id="org3effb30">Manipulating Comments</h3>
<div class="outline-text-3" id="text-org3effb30">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 26.5 (info "(emacs)Comments")</span>

  (leuven--section <span class="org-string">"26.5 (emacs)Comments"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Always comments out empty lines.</span>
  (<span class="org-keyword">setq</span> comment-empty-lines t)

  (<span class="org-keyword">unless</span> (locate-library <span class="org-string">"smart-comment-autoloads-XXX"</span>)

    (<span class="org-keyword">defadvice</span> <span class="org-function-name">comment-dwim</span> (around leuven-comment activate)
      <span class="org-doc">"When called interactively with no active region, comment a single line instead."</span>
      (<span class="org-keyword">if</span> (<span class="org-keyword">or</span> (use-region-p) (not (called-interactively-p 'any)))
          ad-do-it
        (comment-or-uncomment-region (line-beginning-position)
                                     (line-end-position))
        (message <span class="org-string">"[Commented line]"</span>))))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"smart-comment-autoloads-XXX"</span>

    (global-set-key (kbd <span class="org-string">"M-;"</span>) #'smart-comment))
</pre>
</div>
</div>
</div>

<div id="outline-container-org1252ac2" class="outline-3">
<h3 id="org1252ac2">Documentation Lookup</h3>
<div class="outline-text-3" id="text-org1252ac2">
<p>
Function argument hint.  Highlight the arguments in
<code>eldoc-highlight-function-argument</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 26.6 (info "(emacs)Documentation") Lookup</span>

  (leuven--section <span class="org-string">"26.6 (emacs)Documentation Lookup"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Idle time to wait before printing documentation.</span>
  (<span class="org-keyword">setq</span> eldoc-idle-delay 0.2)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Resize echo area to fit documentation.</span>
  (<span class="org-keyword">setq</span> eldoc-echo-area-use-multiline-p t)
</pre>
</div>

<p>
New minor mode <code>global-eldoc-mode</code> is enabled by default in Emacs 25.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Show the function arglist or the variable docstring in the echo area.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-eldoc-mode)                 ; In Emacs 25.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org3e27d98" class="outline-3">
<h3 id="org3e27d98">Hideshow minor mode (code folding)</h3>
<div class="outline-text-3" id="text-org3e27d98">
<p>
XXX See <a href="http://stackoverflow.com/questions/2399612/why-is-there-no-code-folding-in-emacs">http://stackoverflow.com/questions/2399612/why-is-there-no-code-folding-in-emacs</a>
</p>

<p>
Hideshow can <b>fold</b> and unfold (i.e. hide and un-hide) logical blocks of <b>code</b> in
many programming modes.
</p>

<p>
<code>hs-minor-mode.el</code> collapses code for a lot of languages, not only Lisp.  See
<a href="#orga906bd8">outline-minor-mode</a> as well.
</p>

<p>
And the pretty awesome <code>hideshow-org</code>.  Folding made useful.
</p>

<p>
Keyboard shortcuts:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Command</th>
<th scope="col" class="org-left">Emacs</th>
<th scope="col" class="org-left">Sublime Text</th>
<th scope="col" class="org-left">Visual Studio</th>
<th scope="col" class="org-left">Webstorm</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Fold (collapse) region</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">C-S-[</td>
<td class="org-left">C-S-[</td>
<td class="org-left">C--</td>
</tr>

<tr>
<td class="org-left">Unfold (uncollapse) region</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">C-S-]</td>
<td class="org-left">C-S-]</td>
<td class="org-left">C-+</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">Fold (collpase) All regions</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">C-k C-0</td>
<td class="org-left">C-S--</td>
</tr>

<tr>
<td class="org-left">Unfold (uncollapse) All regions</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">C-k C-j</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">C-S-+</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">Fold (collapse) Tag Attributes</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">C-k C-t</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 26.7 (info "(emacs)Hideshow") minor mode</span>

  (leuven--section <span class="org-string">"26.7 (emacs)Hideshow minor mode"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable Hideshow (code folding) for programming modes.</span>
  (add-hook 'prog-mode-hook #'hs-minor-mode)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"hideshow"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Unhide both code and comment hidden blocks when doing incremental search.</span>
    (<span class="org-keyword">setq</span> hs-isearch-open t)

    (<span class="org-keyword">defadvice</span> <span class="org-function-name">goto-line</span> (after expand-after-goto-line activate compile)
      (<span class="org-keyword">save-excursion</span> (hs-show-block)))

    (<span class="org-keyword">defadvice</span> <span class="org-function-name">xref-find-definitions</span> (after expand-after-xref-find-definitions activate compile)
      (<span class="org-keyword">save-excursion</span> (hs-show-block)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Change those really awkward key bindings with `@' in the middle.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Folding / Expand block.</span>
    (define-key hs-minor-mode-map (kbd <span class="org-string">"&lt;C-kp-add&gt;"</span>)        #'hs-show-block)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`C-c @ C-s' (expand current fold)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Folding / Collapse block.</span>
    (define-key hs-minor-mode-map (kbd <span class="org-string">"&lt;C-kp-subtract&gt;"</span>)   #'hs-hide-block)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`C-c @ C-h' (collapse current fold)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Folding / Expand All.</span>
    (define-key hs-minor-mode-map (kbd <span class="org-string">"&lt;C-S-kp-add&gt;"</span>)      #'hs-show-all)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`C-c @ C-M-s' (expand all folds)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Folding / Collapse All.</span>
    (define-key hs-minor-mode-map (kbd <span class="org-string">"&lt;C-S-kp-subtract&gt;"</span>) #'hs-hide-all)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`C-c @ C-M-h' (collapse all folds)</span>

    (<span class="org-keyword">defcustom</span> <span class="org-variable-name">hs-face</span> 'hs-face
      <span class="org-doc">"*Specify the face to to use for the hidden region indicator"</span>
      <span class="org-builtin">:type</span> 'face
      <span class="org-builtin">:group</span> 'hideshow)

    (<span class="org-keyword">defface</span> <span class="org-variable-name">hs-face</span>
      '((t <span class="org-builtin">:box</span> (<span class="org-builtin">:line-width</span> 1 <span class="org-builtin">:color</span> <span class="org-string">"#777777"</span>) <span class="org-builtin">:foreground</span> <span class="org-string">"#9A9A6A"</span> <span class="org-builtin">:background</span> <span class="org-string">"#F3F349"</span>))
      <span class="org-doc">"Face to hightlight the \"...\" area of hidden regions"</span>
      <span class="org-builtin">:group</span> 'hideshow)

    (<span class="org-keyword">defun</span> <span class="org-function-name">hs-display-code-line-counts</span> (ov)
      (<span class="org-keyword">when</span> (eq 'code (overlay-get ov 'hs))
        (overlay-put ov 'display (propertize <span class="org-string">"..."</span> 'face 'hs-face))))

    (<span class="org-keyword">setq</span> hs-set-up-overlay 'hs-display-code-line-counts)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Hide all top level blocks.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'find-file-hook #'hs-hide-all)</span>
)
</pre>
</div>
</div>
</div>

<div id="outline-container-orge11bfbe" class="outline-3">
<h3 id="orge11bfbe">Completion for Symbol Names</h3>
<div class="outline-text-3" id="text-orge11bfbe">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 26.8 (info "(emacs)Symbol Completion")</span>

  (leuven--section <span class="org-string">"26.8 (emacs)Symbol Completion"</span>)
</pre>
</div>

<p>
It&rsquo;s more or less a convention that each language mode binds its symbol
completion command (<code>completion-at-point</code>) to <code>&lt;M-tab&gt;</code>.
</p>

<div class="note">
<p>
If Semantic mode is enabled, it tries to use the <b>Semantic parser data</b> for
completion.
</p>

<p>
If Semantic mode is not enabled or fails at performing completion, it tries to
complete using the <b>selected tags table</b>.
</p>

<p>
If in Emacs Lisp mode, it performs completion using the function, variable, or
property names defined in the current Emacs session.
</p>

</div>

<p>
Note that <code>&lt;M-tab&gt;</code> is used by many window managers themselves (typically for
switching between windows) and is not passed to applications.
</p>

<p>
In that case, you should:
</p>

<ul class="org-ul">
<li>type <code>ESC TAB</code> or <code>C-M-i</code> for completion, or</li>

<li>bind the command normally bound to <code>&lt;M-tab&gt;</code> to a key that is convenient for
you to hit, such as <code>&lt;C-tab&gt;</code>.</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">When you hit `</span><span class="org-comment"><span class="org-constant">&lt;C-tab&gt;</span></span><span class="org-comment">', call the command normally bound to `</span><span class="org-comment"><span class="org-constant">&lt;M-tab&gt;</span></span><span class="org-comment">'.</span>
  (global-set-key (kbd <span class="org-string">"&lt;C-tab&gt;"</span>)
    #'(lambda ()
        (<span class="org-keyword">interactive</span>)
        (call-interactively (key-binding (kbd <span class="org-string">"&lt;M-tab&gt;"</span>)))))
</pre>
</div>

<p>
See also <a href="#orgf08f88d">Dabbrev</a>, Emacs&rsquo; standard autocompletion (on by default).
</p>
</div>
</div>

<div id="outline-container-orgbe9379c" class="outline-3">
<h3 id="orgbe9379c">Glasses minor mode</h3>
<div class="outline-text-3" id="text-orgbe9379c">
<p>
Add overlays to use a different face for the capital letters in symbols like
<code>CamelCaseUnreadableSymbol</code>, to make them easier to read.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 26.9 (info "(emacs)Glasses") minor mode</span>

  (leuven--section <span class="org-string">"26.9 (emacs)Glasses minor mode"</span>)

  (add-hook 'ess-mode-hook          #'glasses-mode)
  (add-hook 'inferior-ess-mode-hook #'glasses-mode)
  (add-hook 'java-mode-hook         #'glasses-mode)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"glasses"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">String to be displayed as a visual separator in unreadable identifiers.</span>
    (<span class="org-keyword">setq</span> glasses-separator <span class="org-string">""</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">No display change.</span>
    (<span class="org-keyword">setq</span> glasses-original-separator <span class="org-string">""</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Face to be put on capitals of an identifier looked through glasses.</span>
    (make-face 'leuven-glasses-face)
    (set-face-attribute 'leuven-glasses-face nil <span class="org-builtin">:weight</span> 'bold)
    (<span class="org-keyword">setq</span> glasses-face 'leuven-glasses-face)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Avoid the black foreground set in</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">emacs-leuven-theme</span></span><span class="org-comment">' to face `</span><span class="org-comment"><span class="org-constant">bold</span></span><span class="org-comment">'.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Set properties of glasses overlays.</span>
    (glasses-set-overlay-properties)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">No space between an identifier and an opening parenthesis.</span>
    (<span class="org-keyword">setq</span> glasses-separate-parentheses-p nil))
</pre>
</div>

<p>
subword-mode : M-f/M-b in <code>CamelCaseUnreadableSymbol</code>.
</p>
</div>
</div>

<div id="outline-container-orgde15f1b" class="outline-3">
<h3 id="orgde15f1b">C and related modes</h3>
<div class="outline-text-3" id="text-orgde15f1b">
</div>
<div id="outline-container-org6f0395b" class="outline-4">
<h4 id="org6f0395b">Eclim</h4>
<div class="outline-text-4" id="text-org6f0395b">
<p>
<a href="http://eclim.org/">Eclim</a> provides the ability to <b>bring <a href="http://www.eclipse.org/">Eclipse</a> code editing features</b> (to Vim, but
also to other editors thanks to third party clients):
</p>

<ul class="org-ul">
<li>&ldquo;true&rdquo; <b>code completion</b> (i.e., only context-sensitive completions),</li>
<li><b>code validation</b> (report any validation errors found),</li>
<li>searching for declarations or references, and</li>
<li><a href="http://eclim.org/features.html">many more</a>.</li>
</ul>

<p>
The initial goal was to provide Eclipse <b>Java</b> functionality, but support for
various other languages (<b>C/C++</b>, HTML/CSS, Groovy, JavaScript, <b>PHP</b>, <b>Python</b>, <b>Ruby</b>,
XML/DTD/XSD, etc.) has been added.
</p>

<p>
See <a href="https://github.com/senny/emacs-eclim/issues/178">https://github.com/senny/emacs-eclim/issues/178</a>.
</p>
</div>

<div id="outline-container-org5e8d546" class="outline-5">
<h5 id="org5e8d546">Download / install</h5>
<div class="outline-text-5" id="text-org5e8d546">
<ol class="org-ol">
<li>Install <a href="http://www.eclipse.org/downloads/">Eclipse</a>.</li>
<li>Install <a href="http://eclim.org/install.html">Eclim</a> (see <code>vim.skip</code> and <code>vim.skip.hint</code>).</li>
<li>Install <a href="https://github.com/senny/emacs-eclim">Emacs-eclim</a> from MELPA.</li>
</ol>
</div>
</div>

<div id="outline-container-org768803d" class="outline-5">
<h5 id="org768803d">Getting started</h5>
<div class="outline-text-5" id="text-org768803d">
<p>
You should <b>create an Eclipse project first</b>, and then you can create a Java file
and open it in Emacs.  Open plain Java file without creating an Eclipse project
will not work.
</p>

<div class="note">
<p>
&ldquo;Could not find eclipse project for &lt;file&gt;.java&rdquo;?  Are you using <b>Cygwin Emacs</b>
with a Windows Java installation?  <code>/cygdrive</code> paths won&rsquo;t be understood&#x2026;
</p>

</div>
</div>
</div>

<div id="outline-container-org8da6c6e" class="outline-5">
<h5 id="org8da6c6e">The Eclim daemon</h5>
<div class="outline-text-5" id="text-org8da6c6e">
<p>
Eclimd (Eclim&rsquo;s daemon) can run without a graphical Eclipse, but you can also
run it from plain Eclipse.  So whenever you need some eclipse&rsquo;s functionalities
that aren&rsquo;t (yet) supported by either <code>emacs-eclim</code> or <code>eclim</code>, you can switch to it
(e.g. the debugger or the profiler).
</p>
</div>
</div>

<div id="outline-container-orgab7b712" class="outline-5">
<h5 id="orgab7b712"><a href="http://eclim.org/faq.html">FAQ / Troubleshooting</a></h5>
<div class="outline-text-5" id="text-orgab7b712">
<p>
To tell eclim <b>which Eclipse workspace to use</b>, you can start eclimd like so:
</p>

<div class="org-src-container">
<pre class="src src-shell">eclimd -Dosgi.instance.area.default=@user.home/another_workspace
</pre>
</div>
</div>
</div>

<div id="outline-container-org1153bee" class="outline-5">
<h5 id="org1153bee">Core functionality</h5>
<div class="outline-text-5" id="text-org1153bee">
<dl class="org-dl">
<dt><code>M-x eclim-project-build</code></dt><dd>Triggers a <b>build</b> of <b>the current project</b>.</dd>

<dt>M-x eclim-run-class</dt><dd><b>Run the current class</b>.</dd>

<dt><code>C-c C-e t</code> (or <code>M-x eclim-run-junit</code>)</dt><dd><b>Run</b> the current <b>JUnit</b> class or method at point.</dd>
</dl>

<p>
Browsing:
</p>

<dl class="org-dl">
<dt>C-c C-e h (M-x eclim-java-hierarchy)</dt><dd>Class hierarchy tree.</dd>

<dt>C-c C-e f t (M-x eclim-java-find-type)</dt><dd>Types.</dd>

<dt><code>C-c C-e f d</code> (<code>M-x eclim-java-find-declaration</code> or <code>M-.</code> in Emacs-Leuven)</dt><dd><b>Find</b> and display the <b>declaration</b> of the <b>Java identifier at point</b>.</dd>

<dt><code>C-c C-e f r</code> (<code>M-x eclim-java-find-references</code>)</dt><dd><b>Find</b> and display <b>references</b> for the <b>Java identifier at point</b>
= list callers.
= Find Usages?</dd>
</dl>

<p>
Problems and Errors:
</p>

<dl class="org-dl">
<dt><code>C-c C-e b</code> (<code>M-x eclim-problems</code>)</dt><dd><b>Show current compilation problems</b> in a separate window.</dd>

<dt><code>C-c C-e o</code> (<code>M-x eclim-problems-open</code>)</dt><dd>Opens a new window inside the current frame showing the current project
<b>compilation problems</b>.</dd>
</dl>

<p>
Projects:
</p>

<dl class="org-dl">
<dt><code>C-c C-e p c</code> (<code>M-x eclim-project-create</code>)</dt><dd>Not documented.</dd>

<dt><code>M-x eclim-manage-projects</code></dt><dd><b>Manage all your eclim projects</b> in one buffer.</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">An interface to the Eclipse IDE.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"emacs-eclim-autoloads-XXX"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable Eclim mode in Java.</span>
    (add-hook 'java-mode-hook #'eclim-mode))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"eclim"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Find Eclim installation.</span>
    (<span class="org-keyword">setq</span> eclim-executable
          (<span class="org-keyword">or</span> (executable-find <span class="org-string">"eclim"</span>)
              (concat leuven--windows-program-files-dir <span class="org-string">"eclipse/eclim.bat"</span>)))
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq eclim-executable "C:/PROGRA~2/eclipse/eclim.bat")</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq eclim-executable "C:/Users/Fabrice/Downloads/eclipse/eclim.bat")</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-to-list 'eclim-eclipse-dirs</span>
    <span class="org-comment-delimiter">;;              </span><span class="org-comment">(concat leuven--windows-program-files-dir "eclipse/eclim"))</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Print debug messages.</span>
    (<span class="org-keyword">setq</span> eclim-print-debug-messages t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add key binding.</span>
    (define-key eclim-mode-map (kbd <span class="org-string">"M-."</span>) #'eclim-java-find-declaration)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Display compilation error messages in the echo area.</span>
    (<span class="org-keyword">setq</span> help-at-pt-display-when-idle t)
    (<span class="org-keyword">setq</span> help-at-pt-timer-delay 0.1)
    (help-at-pt-set-timer)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add the emacs-eclim source.</span>
    (<span class="org-keyword">require</span> '<span class="org-constant">ac-emacs-eclim-source</span>)

    <span class="org-comment-delimiter">;;</span><span class="org-comment">! Limit `</span><span class="org-comment"><span class="org-constant">ac-sources</span></span><span class="org-comment">' to Eclim source.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">ac-emacs-eclim-java-setup</span> ()
      (<span class="org-keyword">setq</span> ac-sources '(ac-source-emacs-eclim)))
   <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq ac-sources (delete 'ac-source-words-in-same-mode-buffers ac-sources))</span>

    (ac-emacs-eclim-config)
</pre>
</div>

<p>
<a href="https://github.com/senny/emacs-eclim/wiki/Code-Completion">https://github.com/senny/emacs-eclim/wiki/Code-Completion</a>
</p>

<div class="note">
<p>
There are 2 Eclim Company-mode backends:
</p>
<ul class="org-ul">
<li><code>company-eclim</code>, the built-in one.</li>
<li><code>company-emacs-eclim</code>, which is a bit more feature-rich (it uses YASnippet, for
instance), and also a bit buggier.</li>
</ul>

</div>

<p>
See <a href="http://java-coders.com/p/tsdh/emacs-eclim">http://java-coders.com/p/tsdh/emacs-eclim</a> for Company.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Configure company-mode.</span>
    (<span class="org-keyword">require</span> '<span class="org-constant">company-emacs-eclim</span>)
    (company-emacs-eclim-setup)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Control the Eclim daemon from Emacs.</span>
    (<span class="org-keyword">require</span> '<span class="org-constant">eclimd</span>)

    )
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb2efb1c" class="outline-3">
<h3 id="orgb2efb1c">Java</h3>
</div>

<div id="outline-container-org84f3430" class="outline-3">
<h3 id="org84f3430">JavaScript</h3>
<div class="outline-text-3" id="text-org84f3430">
</div>
<div id="outline-container-org4a692d5" class="outline-4">
<h4 id="org4a692d5">JS2-mode</h4>
<div class="outline-text-4" id="text-org4a692d5">
<p>
The default <b>indentation</b> style for <code>switch case</code> is preferred and quite popular
among JS developers.
</p>

<ul class="org-ul">
<li>Crockford&rsquo;s style also goes with this.
<a href="http://javascript.crockford.com/code.html">http://javascript.crockford.com/code.html</a></li>

<li>JavaScript
<a href="https://github.com/bengourley/js-style-guide">https://github.com/bengourley/js-style-guide</a> (so it&rsquo;s not only Crockford)</li>

<li>Java
<a href="http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-142311.html#468">http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-142311.html#468</a></li>
</ul>

<p>
Config examples:
</p>
<ul class="org-ul">
<li><a href="https://github.com/cjohansen/.emacs.d/blob/98ddde2a17b1d0c6181891561bc01aaf570376ae/setup-js2-mode.el">https://github.com/cjohansen/.emacs.d/blob/98ddde2a17b1d0c6181891561bc01aaf570376ae/setup-js2-mode.el</a></li>
</ul>

<p>
Vidéo:
</p>
<ul class="org-ul">
<li><a href="https://www.youtube.com/watch?v=dbxoo-qEmcg">Some stuff you can do in Emacs in JavaScript</a></li>
</ul>

<p>
Key bindings:
</p>

<dl class="org-dl">
<dt><code>M-.</code> (<code>js2-jump-to-definition</code>)</dt><dd>Jump to the definition of an object&rsquo;s property, variable or function.</dd>

<dt>M-,</dt><dd>Pop back to where <code>M-x xref-find-definitions</code> was last invoked.</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"js2-mode-autoloads"</span>

    (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.js\\'</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">\\.json\\'"</span> . js2-mode)))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"js2-mode"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add highlighting of many ECMA built-in functions.</span>
    (<span class="org-keyword">setq</span> js2-highlight-level 3)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Delay in secs before re-parsing after user makes changes.</span>
    (<span class="org-keyword">setq-default</span> js2-idle-timer-delay 0.1)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">js2-line-break</span></span><span class="org-comment">' in mid-string will make it a string concatenation.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">The '+' will be inserted at the end of the line.</span>
    (<span class="org-keyword">setq</span> js2-concat-multiline-strings 'eol)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq js2-mode-show-parse-errors nil)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't emit Ecma strict-mode warnings.</span>
    (<span class="org-keyword">setq</span> js2-mode-show-strict-warnings nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Let Flycheck handle parse errors.</span>
    (<span class="org-keyword">setq</span> js2-strict-missing-semi-warning nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; List of any extern names you'd like to consider always declared.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq js2-global-externs '("View")) ; ARCHIBUS.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Treat unused function arguments like declared-but-unused variables.</span>
    (<span class="org-keyword">setq</span> js2-warn-about-unused-function-arguments t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Augment the default indent-line behavior with cycling among several</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">computed alternatives.</span>
    (<span class="org-keyword">setq</span> js2-bounce-indent-p t)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgca04fc6" class="outline-4">
<h4 id="orgca04fc6">JS2-refactor</h4>
<div class="outline-text-4" id="text-orgca04fc6">
<p>
The <code>js2-refactor</code> mode should start with <code>C-c C-m</code> (that is, <code>C-c RET</code>) and then
a two-letter mnemonic shortcut.
</p>

<p>
List of available <b>refactorings</b>:
</p>

<dl class="org-dl">
<dt>lt (log-this)</dt><dd><b>Adds a console.log()</b> statement for what is at point (or region).</dd>

<dt><code>rv</code> (<code>rename-var</code>)</dt><dd><b>Renames</b> the <b>variable</b> on point and all occurrences in its lexical scope.</dd>

<dt><code>ev</code> (<code>extract-var</code>)</dt><dd>Takes a <b>marked expression</b> and replaces it with a <b>var</b>.</dd>

<dt><code>ip</code> (<code>introduce-parameter</code>)</dt><dd>Changes the <b>marked expression</b> to a <b>parameter</b> in a local function.</dd>

<dt><code>ef</code> (<code>extract-function</code>)</dt><dd><b>Extracts</b> the marked expressions out into a new named <b>function</b>.</dd>

<dt><code>em</code> (<code>extract-method</code>)</dt><dd><b>Extracts</b> the marked expressions out into a new named <b>method</b> in an object
literal.</dd>

<dt><code>vt</code> (<code>var-to-this</code>)</dt><dd>Changes <b>local ~var</b> a~ to be <code>this.a</code> (<b>instance variable</b>) instead.</dd>

<dt><code>lp</code> (<code>localize-parameter</code>)</dt><dd>Changes a parameter to a local var in a local function.</dd>

<dt><code>eo</code> (<code>expand-object</code>)</dt><dd>Converts a one line object literal to multiline.</dd>

<dt><code>co</code> (<code>contract-object</code>)</dt><dd>Converts a multiline object literal to one line.</dd>

<dt><code>eu</code> (<code>expand-function</code>)</dt><dd>Converts a one line function to multiline (expecting semicolons as
statement delimiters).</dd>

<dt><code>cu</code> (<code>contract-function</code>)</dt><dd>Converts a multiline function to one line (expecting semicolons as
statement delimiters).</dd>

<dt><code>ea</code> (<code>expand-array</code>)</dt><dd>Converts a one line array to multiline.</dd>

<dt><code>ca</code> (<code>contract-array</code>)</dt><dd>Converts a multiline array to one line.</dd>

<dt><code>wi</code> (<code>wrap-buffer-in-iife</code>)</dt><dd>Wraps the entire buffer in an immediately invoked function expression.</dd>

<dt><code>ig</code> (<code>inject-global-in-iife</code>)</dt><dd>Creates a shortcut for a marked global by injecting it in the wrapping
immediately invoked function expression.</dd>

<dt><code>ag</code> (<code>add-to-globals-annotation</code>)</dt><dd>Creates a <code>/*global */</code> annotation if it is missing, and adds the var at
point to it.</dd>

<dt><code>iv</code> (<code>inline-var</code>)</dt><dd>Replaces all instances of a variable with its initial value.</dd>

<dt><code>ao</code> (<code>arguments-to-object</code>)</dt><dd>Replaces arguments to a function call with an object literal of named
arguments.  Requires YASnippet.</dd>

<dt><code>3i</code> (<code>ternary-to-if</code>)</dt><dd>Converts ternary operator to if-statement.</dd>

<dt><code>sv</code> (<code>split-var-declaration</code>)</dt><dd>Splits a <code>var</code> with multiple vars declared, into several <code>var</code> statements.</dd>

<dt><code>uw</code> (<code>unwrap</code>)</dt><dd>Replaces the parent statement with the selected region.</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"js2-refactor-autoloads"</span>
    (add-hook 'js2-mode-hook #'js2-refactor-mode)

    (js2r-add-keybindings-with-prefix <span class="org-string">"C-c C-m"</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">eg. extract variable with</span>
                                                 <span class="org-comment-delimiter">; </span><span class="org-comment">`C-c C-m ev`.</span>
    )
)
</pre>
</div>
</div>
</div>

<div id="outline-container-org149b3b4" class="outline-4">
<h4 id="org149b3b4">Xref-js2</h4>
<div class="outline-text-4" id="text-org149b3b4">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Xref-js2</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge1900e6" class="outline-4">
<h4 id="orge1900e6">Imenu</h4>
<div class="outline-text-4" id="text-orge1900e6">
<p>
<a href="http://emacs.stackexchange.com/questions/2658/how-to-display-the-list-of-functions-in-imenu-and-collapse-uncollapse-functions">http://emacs.stackexchange.com/questions/2658/how-to-display-the-list-of-functions-in-imenu-and-collapse-uncollapse-functions</a>
NOTE &#x2013; Solution 2 refers to (better) outlining support!!
</p>

<p>
See ARCHIBUS Controller spec at
<a href="http://www.archibus.com/ai/abizfiles/v19.2_help/system-management/Content/wc_views/Adv_Views_Techniques/using_js_to_extend_views/Basic_controller_programming.htm">http://www.archibus.com/ai/abizfiles/v19.2_help/system-management/Content/wc_views/Adv_Views_Techniques/using_js_to_extend_views/Basic_controller_programming.htm</a>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Below regex list could be used in both js-mode and js2-mode.</span>
  (<span class="org-keyword">setq</span> javascript-common-imenu-regex-list
        <span class="org-comment-delimiter">;; </span><span class="org-comment">Items are in reverse order because they are rendered in reverse.</span>
        `((<span class="org-string">"Function"</span>                        <span class="org-string">"^[ \t]*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[a-zA-Z0-9_$.]+</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">[ \t]*:[ \t]*function[ \t]*("</span> 1)

          (<span class="org-string">"Auto-Wiring Panel Event _after"</span>  <span class="org-string">"^[ \t]*.*_after</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[a-zA-Z0-9_$.]+</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">[ \t]*:[ \t]*function[ \t]*("</span> 1)
          (<span class="org-string">"Auto-Wiring Panel Event _on"</span>     <span class="org-string">"^[ \t]*.*_on</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[a-zA-Z0-9_$.]+</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">[ \t]*:[ \t]*function[ \t]*("</span> 1)
          (<span class="org-string">"Auto-Wiring Panel Event _before"</span> <span class="org-string">"^[ \t]*.*_before</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[a-zA-Z0-9_$.]+</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">[ \t]*:[ \t]*function[ \t]*("</span> 1)

          (<span class="org-string">"Auto-Wiring View Event 1"</span>        <span class="org-string">"^[ \t]*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">afterInitialDataFetch</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">[ \t]*:[ \t]*function[ \t]*("</span> 1)
          (<span class="org-string">"Auto-Wiring View Event 0"</span>        <span class="org-string">"^[ \t]*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">afterViewLoad</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">[ \t]*:[ \t]*function[ \t]*("</span> 1)

          (<span class="org-string">"Variable"</span>                        <span class="org-string">"^[ \t]*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[a-zA-Z_.]+</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">: [</span><span class="org-string"><span class="org-negation-char">^</span></span><span class="org-string">f]"</span> 1)

          (<span class="org-string">"Controller Extension"</span>            <span class="org-string">"var[ \t]*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[</span><span class="org-string"><span class="org-negation-char">^</span></span><span class="org-string"> \t]+</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">[ \t]*= View.extendController("</span> 1)
          (<span class="org-string">"Controller Extension"</span>            <span class="org-string">"var[ \t]*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[</span><span class="org-string"><span class="org-negation-char">^</span></span><span class="org-string"> \t]+</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">[ \t]*= .*[cC]ontroller.*extend("</span> 1)
          (<span class="org-string">"Controller"</span>                      <span class="org-string">"var[ \t]*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[</span><span class="org-string"><span class="org-negation-char">^</span></span><span class="org-string"> \t]+</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">[ \t]*= View.createController("</span> 1)
          ))
</pre>
</div>

<p>
See <a href="http://blog.binchen.org/posts/why-emacs-is-better-editor-part-two.html">http://blog.binchen.org/posts/why-emacs-is-better-editor-part-two.html</a>:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">{{ Patching Imenu in js2-mode</span>
(<span class="org-keyword">setq</span> js2-imenu-extra-generic-expression javascript-common-imenu-regex-list)

(<span class="org-keyword">defvar</span> <span class="org-variable-name">js2-imenu-original-item-lines</span> nil
  <span class="org-doc">"List of line information of original Imenu items."</span>)

(<span class="org-keyword">defun</span> <span class="org-function-name">js2-imenu--get-line-start-end</span> (pos)
  (<span class="org-keyword">let</span> (b e)
    (<span class="org-keyword">save-excursion</span>
      (goto-char pos)
      (<span class="org-keyword">setq</span> b (line-beginning-position))
      (<span class="org-keyword">setq</span> e (line-end-position)))
    (list b e)))

(<span class="org-keyword">defun</span> <span class="org-function-name">js2-imenu--get-pos</span> (item)
  (<span class="org-keyword">let</span> (val)
    (<span class="org-keyword">cond</span>
     ((integerp item)
      (<span class="org-keyword">setq</span> val item))

     ((markerp item)
      (<span class="org-keyword">setq</span> val (marker-position item))))

    val))

(<span class="org-keyword">defun</span> <span class="org-function-name">js2-imenu--get-extra-item-pos</span> (item)
  (<span class="org-keyword">let</span> (val)
    (<span class="org-keyword">cond</span>
     ((integerp item)
      (<span class="org-keyword">setq</span> val item))

     ((markerp item)
      (<span class="org-keyword">setq</span> val (marker-position item)))

     <span class="org-comment-delimiter">;; </span><span class="org-comment">plist</span>
     ((<span class="org-keyword">and</span> (listp item) (listp (cdr item)))
      (<span class="org-keyword">setq</span> val (js2-imenu--get-extra-item-pos (cadr item))))

     <span class="org-comment-delimiter">;; </span><span class="org-comment">alist</span>
     ((<span class="org-keyword">and</span> (listp item) (not (listp (cdr item))))
      (<span class="org-keyword">setq</span> val (js2-imenu--get-extra-item-pos (cdr item)))))

    val))

(<span class="org-keyword">defun</span> <span class="org-function-name">js2-imenu--extract-line-info</span> (item)
  <span class="org-doc">"Recursively parse the original imenu items created by js2-mode.</span>
<span class="org-doc">The line numbers of items will be extracted."</span>
  (<span class="org-keyword">let</span> (val)
    (<span class="org-keyword">if</span> item
      (<span class="org-keyword">cond</span>
       <span class="org-comment-delimiter">;; </span><span class="org-comment">Marker or line number</span>
       ((<span class="org-keyword">setq</span> val (js2-imenu--get-pos item))
        (<span class="org-keyword">push</span> (js2-imenu--get-line-start-end val)
              js2-imenu-original-item-lines))

       <span class="org-comment-delimiter">;; </span><span class="org-comment">The item is Alist, example: (hello . 163)</span>
       ((<span class="org-keyword">and</span> (listp item) (not (listp (cdr item))))
        (<span class="org-keyword">setq</span> val (js2-imenu--get-pos (cdr item)))
        (<span class="org-keyword">if</span> val (<span class="org-keyword">push</span> (js2-imenu--get-line-start-end val)
                      js2-imenu-original-item-lines)))

       <span class="org-comment-delimiter">;; </span><span class="org-comment">The item is a Plist</span>
       ((<span class="org-keyword">and</span> (listp item) (listp (cdr item)))
        (js2-imenu--extract-line-info (cadr item))
        (js2-imenu--extract-line-info (cdr item)))

       <span class="org-comment-delimiter">;;</span><span class="org-comment">Error handling</span>
       (t (message <span class="org-string">"[Impossible to here! item=%s]"</span> item)
          )))
    ))

(<span class="org-keyword">defun</span> <span class="org-function-name">js2-imenu--item-exist</span> (pos lines)
  <span class="org-doc">"Try to detect does POS belong to some LINE"</span>
  (<span class="org-keyword">let</span> (rlt)
    (<span class="org-keyword">dolist</span> (line lines)
      (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> (&lt; pos (cadr line)) (&gt;= pos (car line)))
          (<span class="org-keyword">setq</span> rlt t)))
    rlt))

(<span class="org-keyword">defun</span> <span class="org-function-name">js2-imenu--is-item-already-created</span> (item)
  (<span class="org-keyword">unless</span> (js2-imenu--item-exist
           (js2-imenu--get-extra-item-pos item)
           js2-imenu-original-item-lines)
    item))

(<span class="org-keyword">defun</span> <span class="org-function-name">js2-imenu--check-single-item</span> (r)
  (<span class="org-keyword">cond</span>
   ((<span class="org-keyword">and</span> (listp (cdr r)))
    (<span class="org-keyword">let</span> (new-types)
      (<span class="org-keyword">setq</span> new-types
            (delq nil (mapcar 'js2-imenu--is-item-already-created (cdr r))))
      (<span class="org-keyword">if</span> new-types (setcdr r (delq nil new-types))
        (<span class="org-keyword">setq</span> r nil))))
   (t (<span class="org-keyword">if</span> (js2-imenu--item-exist (js2-imenu--get-extra-item-pos r)
                                 js2-imenu-original-item-lines)
          (<span class="org-keyword">setq</span> r nil))))
  r)

(<span class="org-keyword">defun</span> <span class="org-function-name">js2-imenu--remove-duplicate-items</span> (extra-rlt)
  (delq nil (mapcar 'js2-imenu--check-single-item extra-rlt)))

(<span class="org-keyword">defun</span> <span class="org-function-name">js2-imenu--merge-imenu-items</span> (rlt extra-rlt)
  <span class="org-doc">"RLT contains imenu items created from AST.</span>
<span class="org-doc">EXTRA-RLT contains items parsed with simple regex.</span>
<span class="org-doc">Merge RLT and EXTRA-RLT, items in RLT has *higher* priority."</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Clear the lines.</span>
  (set (make-variable-buffer-local 'js2-imenu-original-item-lines) nil)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Analyze the original imenu items created from AST,</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">I only care about line number.</span>
  (<span class="org-keyword">dolist</span> (item rlt)
    (js2-imenu--extract-line-info item))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">@see https://gist.github.com/redguardtoo/558ea0133daa72010b73#file-hello-js</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">EXTRA-RLT sample:</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">((function ("hello" . #&lt;marker 63&gt;) ("bye" . #&lt;marker 128&gt;))</span>
  <span class="org-comment-delimiter">;;  </span><span class="org-comment">(controller ("MyController" . #&lt;marker 128))</span>
  <span class="org-comment-delimiter">;;  </span><span class="org-comment">(hellworld . #&lt;marker 161&gt;))</span>
  (<span class="org-keyword">setq</span> extra-rlt (js2-imenu--remove-duplicate-items extra-rlt))
  (append rlt extra-rlt))

(eval-after-load 'js2-mode
  '(<span class="org-keyword">progn</span>
     (<span class="org-keyword">defadvice</span> <span class="org-function-name">js2-mode-create-imenu-index</span> (around leuven-js2-mode-create-imenu-index activate)
       (<span class="org-keyword">let</span> (rlt extra-rlt)
         ad-do-it
         (<span class="org-keyword">setq</span> extra-rlt
               (<span class="org-keyword">save-excursion</span>
                 (imenu--generic-function js2-imenu-extra-generic-expression)))
         (<span class="org-keyword">setq</span> ad-return-value (js2-imenu--merge-imenu-items ad-return-value extra-rlt))
         ad-return-value))))
<span class="org-comment-delimiter">;; </span><span class="org-comment">}}</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--archibus-js-imenu-make-index</span> ()
    (<span class="org-keyword">save-excursion</span>
      (imenu--generic-function leuven-archibus-javascript-common-imenu-regex-list)))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Imenu support for frameworks and structural patterns.</span>
    (js2-imenu-extras-setup)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">defun</span> <span class="org-function-name">js2-imenu-record-object-clone-extend</span> ()
      (<span class="org-keyword">let*</span> ((node (js2-node-at-point (1- (point)))))
      (<span class="org-keyword">when</span> (js2-call-node-p node)
        (<span class="org-keyword">let*</span> ((args (js2-call-node-args node))
               (methods (second args))
               (super-class (first args))
               (parent (js2-node-parent node)))
          (<span class="org-keyword">when</span> (js2-object-node-p methods)
            (<span class="org-keyword">let</span> ((subject (<span class="org-keyword">cond</span> ((js2-var-init-node-p parent)
                                  (js2-var-init-node-target parent))
                                 ((js2-assign-node-p parent)
                                  (js2-assign-node-left parent)))))
              (<span class="org-keyword">when</span> subject
                (js2-record-object-literal methods
                                           (js2-compute-nested-prop-get subject)
                                           (js2-node-abs-pos methods)))))))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org42c9ddc" class="outline-4">
<h4 id="org42c9ddc">Others</h4>
<div class="outline-text-4" id="text-org42c9ddc">
<p>
Highlight every variable in its own, consistent color &#x2013; &ldquo;semantic highlighting&rdquo;
or &ldquo;hashed highlighting&rdquo; (in
<a href="http://www.wilfred.me.uk/blog/2014/09/27/the-definitive-guide-to-syntax-highlighting/">http://www.wilfred.me.uk/blog/2014/09/27/the-definitive-guide-to-syntax-highlighting/</a>).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Color identifiers based on their names.</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"color-identifiers-mode-autoloads"</span>
      (add-hook 'js2-mode-hook 'color-identifiers-mode))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">JS-comint.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key js2-mode-map (kbd "C-c b")   #'js-send-buffer)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key js2-mode-map (kbd "C-c C-b") #'js-send-buffer-and-go)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; js2-mode steals TAB, let's steal it back for yasnippet</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(defun js2-tab-properly ()</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(interactive)</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(let ((yas-fallback-behavior 'return-nil))</span>
    <span class="org-comment-delimiter">;;     </span><span class="org-comment">(unless (yas-expand)</span>
    <span class="org-comment-delimiter">;;       </span><span class="org-comment">(indent-for-tab-command)</span>
    <span class="org-comment-delimiter">;;       </span><span class="org-comment">(if (looking-back "^\s*")</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">(back-to-indentation)))))</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key js2-mode-map (kbd "TAB") #'js2-tab-properly)</span>
</pre>
</div>

<p>
There are 4 popular JavaScript Linting tools:
</p>

<ol class="org-ol">
<li>JSLint (the oldest),</li>
<li>JSHint,</li>
<li>JSCS and</li>
<li>ESLint.</li>
</ol>

<p>
We prefer <code>eslint</code> over <code>jshint</code>.
</p>

<p>
Install Node and <code>npm</code> (the package manager for JavaScript):
</p>
<ul class="org-ul">
<li>Install <a href="https://nodejs.org/en/download/">https://nodejs.org/en/download/</a>.</li>
<li>Run <code>node -v</code> (to see if <code>node</code> is correctly installed).</li>
<li>Type <code>npm</code> at the command prompt.</li>
<li>Run <code>npm -v</code> (to see if <code>npm</code> is correctly installed).</li>
</ul>

<p>
Install ESLint (globally) using <code>npm</code>:
</p>
<ul class="org-ul">
<li>Type <code>npm install -g eslint</code>.</li>
<li>Type <code>eslint -v</code> at the command prompt (to view version and confirm that it&rsquo;s
in your <code>PATH</code>).</li>
<li>Set up a configuration file with <code>eslint --init</code>.</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;; </span><span class="org-comment">Disable JSHint since we prefer ESLint checking.</span>
(<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"flycheck"</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq-default flycheck-disabled-checkers</span>
  <span class="org-comment-delimiter">;;               </span><span class="org-comment">(append flycheck-disabled-checkers</span>
  <span class="org-comment-delimiter">;;                       </span><span class="org-comment">'(javascript-jshint)))</span>

  (<span class="org-keyword">setq-default</span> flycheck-disabled-checkers
                (append flycheck-disabled-checkers
                        '(javascript-eslint)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; use eslint with web-mode for jsx files</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(flycheck-add-mode 'javascript-eslint 'web-mode)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'js2-mode-hook</span>
    <span class="org-comment-delimiter">;;           </span><span class="org-comment">#'(lambda () (flycheck-select-checker "javascript-eslint")))</span>

  (add-hook 'js2-mode-hook
            (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--js2-mode-setup</span> ()
              (flycheck-mode t)
              <span class="org-comment-delimiter">;; </span><span class="org-comment">(when (executable-find "eslint")</span>
              <span class="org-comment-delimiter">;;   </span><span class="org-comment">(flycheck-select-checker 'javascript-eslint))</span>
              ))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq flycheck-display-errors-function</span>
  <span class="org-comment-delimiter">;;       </span><span class="org-comment">'flycheck-display-error-messages-unless-error-list)</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; (setq flycheck-standard-error-navigation nil)</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq flycheck-global-modes '(not erc-mode</span>
  <span class="org-comment-delimiter">;;                                   </span><span class="org-comment">message-mode</span>
  <span class="org-comment-delimiter">;;                                   </span><span class="org-comment">git-commit-mode</span>
  <span class="org-comment-delimiter">;;                                   </span><span class="org-comment">view-mode</span>
  <span class="org-comment-delimiter">;;                                   </span><span class="org-comment">outline-mode</span>
  <span class="org-comment-delimiter">;;                                   </span><span class="org-comment">text-mode</span>
  <span class="org-comment-delimiter">;;                                   </span><span class="org-comment">org-mode))</span>
  )
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key js2-mode-map (kbd "C-c d") #'my/insert-or-flush-debug)</span>

    (<span class="org-keyword">defvar</span> <span class="org-variable-name">my/debug-counter</span> 1)
    (<span class="org-keyword">defun</span> <span class="org-function-name">my/insert-or-flush-debug</span> (<span class="org-type">&amp;optional</span> reset beg end)
      (<span class="org-keyword">interactive</span> <span class="org-string">"pr"</span>)
      (<span class="org-keyword">cond</span>
       ((= reset 4)
        (<span class="org-keyword">save-excursion</span>
          (flush-lines <span class="org-string">"console.log('DEBUG: [0-9]+"</span> (point-min) (point-max))
          (<span class="org-keyword">setq</span> my/debug-counter 1)))
       ((region-active-p)
        (<span class="org-keyword">save-excursion</span>
          (goto-char end)
          (insert <span class="org-string">");\n"</span>)
          (goto-char beg)
          (insert (format <span class="org-string">"console.log('DEBUG: %d', "</span> my/debug-counter))
          (<span class="org-keyword">setq</span> my/debug-counter (1+ my/debug-counter))
          (js2-indent-line)))
       (t
        <span class="org-comment-delimiter">;; </span><span class="org-comment">Wrap the region in the debug.</span>
        (insert (format <span class="org-string">"console.log('DEBUG: %d');\n"</span> my/debug-counter))
        (<span class="org-keyword">setq</span> my/debug-counter (1+ my/debug-counter))
        (backward-char 3)
        (js2-indent-line))))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;   </span><span class="org-comment">(setup "jquery-doc"</span>
<span class="org-comment-delimiter">;;     </span><span class="org-comment">(setup-hook 'js-mode-hook 'jquery-doc-setup)</span>
<span class="org-comment-delimiter">;;     </span><span class="org-comment">(setup-after "popwin"</span>
<span class="org-comment-delimiter">;;       </span><span class="org-comment">(push '("^\\*jQuery doc" :regexp t) popwin:special-display-config))</span>
<span class="org-comment-delimiter">;;     </span><span class="org-comment">(setup-keybinds js-mode-map</span>
<span class="org-comment-delimiter">;;       </span><span class="org-comment">"&lt;f1&gt; s" 'jquery-doc)))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7bb1f72" class="outline-4">
<h4 id="org7bb1f72">Tern</h4>
<div class="outline-text-4" id="text-org7bb1f72">
<p>
Tern is a stand-alone <b>code analyzer</b> for JavaScript.  Features provided are:
</p>

<ul class="org-ul">
<li><b>Auto-completion</b> on variables and properties.</li>
<li>When the point is in a <b>function argument</b> list, show <b>argument names and types</b>
at the bottom of the screen.</li>
<li><b>Find type</b> of an expression.</li>
<li><b>Jump to definition</b> of something.</li>
<li>Automatic <b>refactoring</b> (<b>rename variable</b>).</li>
</ul>

<p>
The following additional keys are bound:
</p>

<dl class="org-dl">
<dt>M-.</dt><dd><b>Jump to</b> the <b>definition</b> of the thing under the cursor.</dd>

<dt>M-,</dt><dd>Brings you back to last place you were when you pressed <code>M-.</code>.</dd>

<dt>C-c C-r</dt><dd>Rename the variable under the cursor.</dd>

<dt>C-c C-c</dt><dd>Find the type of the thing under the cursor.</dd>

<dt>C-c C-d</dt><dd>Find docs of the thing under the cursor.  Press again to open the
associated URL (if any).</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">when</span> (executable-find <span class="org-string">"tern"</span>)
      (add-hook 'js-mode-hook  #'tern-mode)
      (add-hook 'js2-mode-hook #'tern-mode)
      (add-hook 'web-mode-hook #'tern-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-org9c54850" class="outline-4">
<h4 id="org9c54850">Skewer: live web development with Emacs</h4>
<div class="outline-text-4" id="text-org9c54850">
<p>
Skewer lets you send HTML, CSS, and JavaScript fragments to a browser.
</p>

<p>
See <a href="https://www.youtube.com/watch?v=4tyTgyzUJqM">Skewer &#x2013; Emacs browser interaction</a>.
</p>

<div class="tip">
<p>
You may need to start Chrome with <code>chrome --allow-running-insecure-content</code>, if
you&rsquo;re using the user script with HTTPS sites.
</p>

</div>

<p>
Kick things off with <code>run-skewer</code>, and then:
</p>

<dl class="org-dl">
<dt><code>C-x C-e</code> (<code>skewer-eval-last-expression</code>)</dt><dd><b>Evaluate the form before the point</b> and display the result in the
minibuffer.  If given a prefix argument, insert the result into the current
buffer.</dd>

<dt><code>C-M-x</code> (<code>skewer-eval-defun</code>)</dt><dd><b>Evaluate the top-level form around the point</b>.</dd>

<dt><code>C-c C-k</code> (<code>skewer-load-buffer</code>)</dt><dd><b>Load the current buffer.</b></dd>

<dt><code>C-c C-z</code> (<code>skewer-repl</code>)</dt><dd><b>Select the REPL buffer</b>.</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">(require 'css-mode)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key css-mode-map (kbd "C-c i") #'emr-css-toggle-important)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"skewer-mode-autoloads-XXX"</span> <span class="org-comment-delimiter">; </span><span class="org-comment">Not using it yet.</span>
    (add-hook 'js2-mode-hook 'skewer-mode)
    (add-hook 'css-mode-hook 'skewer-css-mode)
    (add-hook 'html-mode-hook 'skewer-html-mode))
</pre>
</div>

<p>
To ensure that everything is working correctly:
</p>

<ol class="org-ol">
<li>Open a new buffer with the name <code>myskewer.js</code>.</li>
<li>Enable <code>JS2-mode</code> (a dependency of skewer).</li>
<li>Enable <code>skewer-mode</code>.</li>
<li><code>M-x run-skewer</code> (a browser opens, go back to <code>myskewer.js</code>).</li>
<li>Type <code>alert("hello");</code> and hit <code>C-x C-e</code> at the end of that line.</li>
<li>Go back to the browser.</li>
</ol>

<p>
You should see an alert box on the page.
</p>

<p>
To tell Skewer to load the HTML (as shown in the demo), place your downloaded
files into <code>~/public_html</code> then follow the instructions for <a href="https://github.com/skeeto/skewer-mode#manual-version">Manual version</a>. Once
that is done, visit <code>localhost:8080</code> in your browser.
</p>
</div>
</div>
</div>

<div id="outline-container-org94fb42f" class="outline-3">
<h3 id="org94fb42f">SQL</h3>
<div class="outline-text-3" id="text-org94fb42f">
<p>
Working with SQL databases.
</p>

<dl class="org-dl">
<dt>C-c C-b (M-x sql-send-buffer)</dt><dd></dd>


<dt>C-c C-c (M-x sql-send-paragraph)</dt><dd></dd>


<dt>C-c C-r (M-x sql-send-region)</dt><dd></dd>


<dt>C-c C-n (M-x sql-send-line-and-next)</dt><dd>Send the current line to the SQL process and advances to the next line,
skipping whitespace and comments.</dd>

<dt>C-c C-s (M-x sql-send-string)</dt><dd></dd>


<dt>C-c C-l a (M-x sql-list-all)</dt><dd></dd>


<dt>C-c C-l t (M-x sql-list-table)</dt><dd></dd>


<dt>C-c C-i (M-x sql-product-interactive)</dt><dd>Start SQLi session.</dd>

<dt>C-c C-z (M-x sql-show-sqli-buffer)</dt><dd>Show the current SQLi buffer.</dd>
</dl>

<p>
Server list.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">require</span> '<span class="org-constant">sql</span>)

  (<span class="org-keyword">setq</span> sql-connection-alist
        '((localhost_HQ     (sql-product  'ms)
                            (sql-port     1433)
                            (sql-server   <span class="org-string">"localhost"</span>)
                            (sql-user     <span class="org-string">"afm"</span>)
                            (sql-password <span class="org-string">"afm"</span>)
                            (sql-database <span class="org-string">"ARCHIBUS_23_1_HQ"</span>))

          (localhost_Schema (sql-product  'ms)
                            (sql-port     1433)
                            (sql-server   <span class="org-string">"localhost"</span>)
                            (sql-user     <span class="org-string">"afm"</span>)
                            (sql-password <span class="org-string">"afm"</span>)
                            (sql-database <span class="org-string">"ARCHIBUS_23_1_Schema"</span>))

          (localhost_PFlow  (sql-product  'ms)
                            (sql-port     1433)
                            (sql-server   <span class="org-string">"localhost"</span>)
                            (sql-user     <span class="org-string">""</span>)
                            (sql-password <span class="org-string">""</span>)
                            (sql-database <span class="org-string">"PFlowXiphias"</span>))

          (localhost_CSPO   (sql-product  'oracle)
                            (sql-port     1521)
                            (sql-server   <span class="org-string">"localhost"</span>)
                            (sql-user     <span class="org-string">"afm"</span>)
                            (sql-password <span class="org-string">"AFM"</span>)
                            (sql-database <span class="org-string">"CSPOv213"</span>))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">sql-localhost_HQ</span> ()
    (<span class="org-keyword">interactive</span>)
    (sql-connect-preset 'localhost_HQ))

  (<span class="org-keyword">defun</span> <span class="org-function-name">sql-localhost_Schema</span> ()
    (<span class="org-keyword">interactive</span>)
    (sql-connect-preset 'localhost_Schema))

  (<span class="org-keyword">defun</span> <span class="org-function-name">sql-localhost_CSPO</span> ()
    (<span class="org-keyword">interactive</span>)
    (sql-connect-preset 'localhost_CSPO))

  (<span class="org-keyword">defun</span> <span class="org-function-name">sql-localhost_PFlow</span> ()
    (<span class="org-keyword">interactive</span>)
    (sql-connect-preset 'localhost_PFlow))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">This makes all it all happen via M-x sql-localhost_HQ, etc.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">sql-connect-preset</span> (name)
    <span class="org-doc">"Connect to a predefined SQL connection listed in `</span><span class="org-doc"><span class="org-constant">sql-connection-alist</span></span><span class="org-doc">'"</span>
    (eval `(<span class="org-keyword">let</span> ,(cdr (assoc name sql-connection-alist))
             (<span class="org-keyword">flet</span> ((sql-get-login (<span class="org-type">&amp;rest</span> what))) <span class="org-comment-delimiter">; </span><span class="org-comment">In sql.el.</span>
               (sql-product-interactive sql-product)))))
</pre>
</div>

<p>
See <a href="https://truongtx.me/2014/08/23/setup-emacs-as-an-sql-database-client">https://truongtx.me/2014/08/23/setup-emacs-as-an-sql-database-client</a>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (add-hook 'sql-mode-hook
            #'(lambda ()
                (<span class="org-keyword">setq</span> truncate-lines t)
                (sql-highlight-ms-keywords)
                (<span class="org-keyword">setq</span> sql-send-terminator t)
                (<span class="org-keyword">setq</span> comint-process-echoes t)))

  (add-hook 'sql-interactive-mode-hook
            #'(lambda ()
                (<span class="org-keyword">setq</span> truncate-lines t)
                (<span class="org-keyword">setq</span> comint-process-echoes t)
                <span class="org-comment-delimiter">;; </span><span class="org-comment">(text-scale-decrease 1)</span>
                (<span class="org-keyword">setq-local</span> show-trailing-whitespace nil)))
</pre>
</div>

<p>
Basic config for MS SQL.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Default login parameters to connect to Microsoft procSQL Server.</span>
  (<span class="org-keyword">setq</span> sql-ms-login-params
        '((user     <span class="org-builtin">:default</span> <span class="org-string">"afm"</span>)
          (database <span class="org-builtin">:default</span> <span class="org-string">"ARCHIBUS_23_1_HQ"</span>)
          (server   <span class="org-builtin">:default</span> <span class="org-string">"localhost"</span>)
          (port     <span class="org-builtin">:default</span> 1433)))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">setq</span> sql-ms-program <span class="org-string">"sqlcmd"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Force Emacs to use CP 850 for every sqlcmd process (for accents) and</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">force DOS line endings.</span>
  (add-to-list 'process-coding-system-alist '(<span class="org-string">"sqlcmd"</span> . cp850-dos))
  (add-to-list 'process-coding-system-alist '(<span class="org-string">"osql"</span> . cp850-dos))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq sql-ms-options (quote ("-w" "65535" "-h" "20000" )))</span>
  (<span class="org-keyword">setq</span> sql-ms-options '(<span class="org-string">"-w"</span> <span class="org-string">"65535"</span>))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">setq</span> sql-ms-program <span class="org-string">"tsql"</span>)

  (<span class="org-keyword">setq</span> sql-ms-options (remove <span class="org-string">"-n"</span> sql-ms-options))
  (<span class="org-keyword">setq</span> sql-ms-options nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Redefined.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">sql-comint-ms</span> (product options)
    <span class="org-doc">"Create comint buffer and connect to Microsoft SQL Server."</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Put all parameters to the program (if defined) in a list and call</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">make-comint.</span>
    (message <span class="org-string">"[Leuven Options: %s]"</span> options)
    (<span class="org-keyword">let</span> ((params options))
      (<span class="org-keyword">if</span> (not (string= <span class="org-string">""</span> sql-server))
          (<span class="org-keyword">setq</span> params (append (list <span class="org-string">"-S"</span> sql-server) params)))
      (<span class="org-keyword">if</span> (not (string= <span class="org-string">""</span> sql-database))
          (<span class="org-keyword">setq</span> params (append (list <span class="org-string">"-D"</span> sql-database) params)))
      (<span class="org-keyword">if</span> (not (string= <span class="org-string">""</span> sql-user))
          (<span class="org-keyword">setq</span> params (append (list <span class="org-string">"-U"</span> sql-user) params)))
      (<span class="org-keyword">if</span> (not (string= <span class="org-string">""</span> sql-password))
          (<span class="org-keyword">setq</span> params (append (list <span class="org-string">"-P"</span> sql-password) params))
        (<span class="org-keyword">if</span> (string= <span class="org-string">""</span> sql-user)
            <span class="org-comment-delimiter">;; </span><span class="org-comment">if neither user nor password is provided, use system credentials.</span>
            (<span class="org-keyword">setq</span> params (append (list <span class="org-string">"-E"</span>) params))
          <span class="org-comment-delimiter">;; </span><span class="org-comment">If -P is passed to ISQL as the last argument without a password, it's</span>
          <span class="org-comment-delimiter">;; </span><span class="org-comment">considered null.</span>
          (<span class="org-keyword">setq</span> params (append params (list <span class="org-string">"-P"</span>)))))
      (message <span class="org-string">"[Leuven Params: %s]"</span> params)
      (sql-comint product params)))
</pre>
</div>

<p>
Basic config for Oracle.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (add-to-list 'process-coding-system-alist '(<span class="org-string">"sqlplus"</span> . windows-1252))
</pre>
</div>

<p>
Have a look at <a href="https://www.emacswiki.org/emacs/SqlPlus">https://www.emacswiki.org/emacs/SqlPlus</a>.
</p>

<p>
When using sql-send-region to execute a query in a SQLi buffer, the table
formatting is off because the column names are printed on the same row as the
the prompt. By adding a newline before the comint output we can make sure
everything lines up nice. This will add a preceding newline to every comint
output, even queries run at the prompt - though the extra line isn&rsquo;t too
noticeable.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defvar</span> <span class="org-variable-name">sql-last-prompt-pos</span> 1
    <span class="org-doc">"position of last prompt when added recording started"</span>)
  (make-variable-buffer-local 'sql-last-prompt-pos)
  (put 'sql-last-prompt-pos 'permanent-local t)

  (<span class="org-keyword">defun</span> <span class="org-function-name">sql-add-newline-first</span> (output)
    <span class="org-doc">"Add newline to beginning of OUTPUT for `</span><span class="org-doc"><span class="org-constant">comint-preoutput-filter-functions</span></span><span class="org-doc">'</span>
<span class="org-doc">    This fixes up the display of queries sent to the inferior buffer</span>
<span class="org-doc">    programatically."</span>
    (<span class="org-keyword">let</span> ((begin-of-prompt
           (<span class="org-keyword">or</span> (<span class="org-keyword">and</span> comint-last-prompt-overlay
                    <span class="org-comment-delimiter">;; </span><span class="org-comment">sometimes this overlay is not on prompt</span>
                    (<span class="org-keyword">save-excursion</span>
                      (goto-char (overlay-start comint-last-prompt-overlay))
                      (looking-at-p comint-prompt-regexp)
                      (point)))
               1)))
      (<span class="org-keyword">if</span> (&gt; begin-of-prompt sql-last-prompt-pos)
          (<span class="org-keyword">progn</span>
            (<span class="org-keyword">setq</span> sql-last-prompt-pos begin-of-prompt)
            (concat <span class="org-string">"\n"</span> output))
        output)))

  (<span class="org-keyword">defun</span> <span class="org-function-name">sqli-add-hooks</span> ()
    <span class="org-doc">"Add hooks to `</span><span class="org-doc"><span class="org-constant">sql-interactive-mode-hook</span></span><span class="org-doc">'."</span>
    (add-hook 'comint-preoutput-filter-functions
              'sql-add-newline-first))

  (add-hook 'sql-interactive-mode-hook 'sqli-add-hooks)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">starting SQL mode loading sql-indent / sql-complete</span>
(eval-after-load <span class="org-string">"sql"</span>
  '(<span class="org-keyword">progn</span>
     (load-library <span class="org-string">"sql-indent"</span>)
     <span class="org-comment-delimiter">;; </span><span class="org-comment">(load-library "sql-complete")</span>
     <span class="org-comment-delimiter">;; </span><span class="org-comment">(load-library "sql-transform")</span>
))
</pre>
</div>
</div>

<div id="outline-container-org7c7b809" class="outline-4">
<h4 id="org7c7b809">Troubleshooting</h4>
<div class="outline-text-4" id="text-org7c7b809">
<ol class="org-ol">
<li>Start with <code>ping</code>:</li>
</ol>

<pre class="example">
ping myhost
</pre>


<ol class="org-ol">
<li>Test with <code>telnet</code>:</li>
</ol>

<pre class="example">
telnet myhost 1433
</pre>


<ol class="org-ol">
<li>Test with <code>tsql</code>:</li>
</ol>

<pre class="example">
tsql -H myhost -p 1433 -U sa   # Bypassing `/etc/freetds/freetds.conf'.
tsql -S myserver -U sa         # Using `/etc/freetds/freetds.conf'.
</pre>


<p>
or <code>sqsh</code>:
</p>

<pre class="example">
sqsh -S myhost -p 1433 -U sa   # Bypassing `/etc/freetds/freetds.conf'.
</pre>


<p>
You need to write your command like this
</p>

<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> * <span class="org-keyword">FROM</span> c_props
<span class="org-doc">go</span>
</pre>
</div>

<p>
Alternatively, in <code>sqsh</code>, if you set the <code>semicolon_hack</code> variable (which turns on
the ability to use a semicolon as a sort of in-line go), you can do:
</p>

<div class="org-src-container">
<pre class="src src-sql"><span class="org-keyword">SELECT</span> * <span class="org-keyword">FROM</span> c_props;
</pre>
</div>
</div>
</div>

<div id="outline-container-org651d61d" class="outline-4">
<h4 id="org651d61d">Indenting</h4>
<div class="outline-text-4" id="text-org651d61d">
<p>
<a href="http://emacs.stackexchange.com/questions/13214/automatically-formatting-sql-code">http://emacs.stackexchange.com/questions/13214/automatically-formatting-sql-code</a>
Emacs does not come anything useful for sql indenting.
The best thing out there is sql-indent.el
Which doesn&rsquo;t do auto-indenting only on command indentation.
I have found it pretty useful at times.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"sql-indent"</span>
    (add-hook 'sql-mode-hook 'sqlind-setup))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf625593" class="outline-4">
<h4 id="orgf625593"><a href="https://www.emacswiki.org/emacs/SqlBeautify">https://www.emacswiki.org/emacs/SqlBeautify</a></h4>
</div>

<div id="outline-container-org5beccf6" class="outline-4">
<h4 id="org5beccf6">Word case</h4>
<div class="outline-text-4" id="text-org5beccf6">
<p>
Automatically convert SQL <b>keywords to</b> the <b>upper case</b> (see general well-known
<a href="http://stackoverflow.com/questions/522356/what-sql-coding-standard-do-you-follow">coding standards</a> and styles for SQL).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"sqlup-mode-autoloads"</span>
    (add-hook 'sql-mode-hook 'sqlup-mode)
    (add-hook 'sql-interactive-mode-hook 'sqlup-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-org8873e2d" class="outline-4">
<h4 id="org8873e2d">SQL Remove Square Brackets</h4>
<div class="outline-text-4" id="text-org8873e2d">
<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 26 ends here.</span>
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org6c7220c" class="outline-2">
<h2 id="org6c7220c">Compiling and Testing Programs</h2>
<div class="outline-text-2" id="text-org6c7220c">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 27 (info "(emacs)Building") Compiling and Testing Programs</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-27-building <span class="org-string">"27 Compiling and Testing Programs"</span>
</pre>
</div>
</div>

<div id="outline-container-orgbb0b591" class="outline-3">
<h3 id="orgbb0b591">Running Compilations under Emacs</h3>
<div class="outline-text-3" id="text-orgbb0b591">
<p>
My build command: <code>cd /path/to/Makefile &amp;&amp; make -f Makefile</code>.
</p>

<p>
You don&rsquo;t need a <code>Makefile</code> to perform simple tasks, because <code>make</code> knows a lot of
built in rules out of the box.  For example, to compile a <code>.c</code> source file <code>foo.c</code>
into a program <code>foo</code>, all you need is say <code>make -k foo</code>, and <code>make</code> will do it even
without a <code>Makefile</code>.
</p>

<p>
XXX Compiling with <code>ant</code>?
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 27.1 Running (info "(emacs)Compilation")s under Emacs</span>

  (leuven--section <span class="org-string">"27.1 Running (emacs)Compilations under Emacs"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Invoke a compiler with the same command as in the last invocation of</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">compile</span></span><span class="org-comment">'.</span>
  (autoload 'recompile <span class="org-string">"compile"</span>
    <span class="org-doc">"Re-compile the program including the current buffer."</span> t)

  (global-set-key (kbd <span class="org-string">"&lt;f9&gt;"</span>) #'recompile)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Scroll the `</span><span class="org-comment"><span class="org-constant">*compilation*</span></span><span class="org-comment">' buffer window to follow output as it appears.</span>
  (<span class="org-keyword">setq</span> compilation-scroll-output t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Number of lines in a compilation window.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq compilation-window-height 8)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Always kill a running compilation process before starting a new one.</span>
  (<span class="org-keyword">setq</span> compilation-always-kill t)
</pre>
</div>

<p>
Make the compilation window go away &#x2013; if there were no compilation errors:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">compile-hide-window-if-successful</span> (cur-buffer msg)
    (<span class="org-keyword">if</span> (string-match <span class="org-string">"exited abnormally"</span> msg)
        <span class="org-comment-delimiter">;; </span><span class="org-comment">There were errors.</span>
        (message <span class="org-string">"[Compilation errors, press C-x ` to visit]"</span>)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">No errors, make compilation window go away in 0.5 sec</span>
      (run-at-time 0.5 nil
                   'delete-windows-on cur-buffer)
      (message <span class="org-string">"[No compilation errors!]"</span>)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-to-list 'compilation-finish-functions #'compile-hide-window-if-successful)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">compile-goto-first-error</span> (cur-buffer msg)
    (<span class="org-keyword">with-current-buffer</span> cur-buffer
      (goto-char (point-min))
      (compilation-next-error 1)
      (beep)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-to-list 'compilation-finish-functions #'compile-goto-first-error)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">compile-scroll-eob</span> (cur-buffer msg)
    (<span class="org-keyword">let</span> ((win (get-buffer-window cur-buffer))
          (current (selected-window)))
      (<span class="org-keyword">when</span> win
        (select-window win)
        (<span class="org-keyword">with-current-buffer</span> cur-buffer
          (<span class="org-keyword">when</span> (&gt; (line-number-at-pos (point-max)) (window-height))
            (goto-char (point-max))
            (recenter (window-height))))
        (select-window current))))

  (add-to-list 'compilation-finish-functions #'compile-scroll-eob)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defvar</span> <span class="org-variable-name">make-clean-command</span> <span class="org-string">"make clean all"</span>
    <span class="org-doc">"*Command used by the `</span><span class="org-doc"><span class="org-constant">make-clean</span></span><span class="org-doc">' function."</span>)

  (<span class="org-keyword">defun</span> <span class="org-function-name">make-clean</span> (<span class="org-type">&amp;optional</span> arg)
    <span class="org-doc">"Run a make clean."</span>
    (<span class="org-keyword">interactive</span> <span class="org-string">"P"</span>)
    (<span class="org-keyword">require</span> '<span class="org-constant">compile</span>)                  <span class="org-comment-delimiter">; </span><span class="org-comment">Needed for compile-internal.</span>
    (<span class="org-keyword">if</span> arg
        (<span class="org-keyword">setq</span> make-clean-command
              (read-string <span class="org-string">"Command: "</span> make-clean-command)))
    (save-some-buffers (not compilation-ask-about-save) nil)
    (compile-internal make-clean-command <span class="org-string">"No more errors"</span>))

  (global-set-key (kbd <span class="org-string">"&lt;S-f9&gt;"</span>) #'make-clean)
</pre>
</div>

<p>
You&rsquo;re debugging Bash code?  I normally use <code>mode-compile.el</code> for this.
Basically, it runs Bash with lots of debug output.
</p>
</div>

<div id="outline-container-orgf4e9b59" class="outline-4">
<h4 id="orgf4e9b59">Java</h4>
<div class="outline-text-4" id="text-orgf4e9b59">
<p>
Compile within Emacs using <code>ant</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven--ant-command-history</span> nil
    <span class="org-doc">"Ant command history variable"</span>)

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-ant</span>(<span class="org-type">&amp;optional</span> args)
    <span class="org-doc">"Runs ant in the current project. Starting at the directory</span>
<span class="org-doc">     where the file being visited resides, a search is made for</span>
<span class="org-doc">     build.xml recursively. A maven command is made from the first</span>
<span class="org-doc">     directory where the build.xml file is found is then displayed in</span>
<span class="org-doc">     the minibuffer. The command can be edited as needed and then</span>
<span class="org-doc">     executed. Errors are navigate to as in any other compile mode"</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let</span> ((fn (buffer-file-name)))
      (<span class="org-keyword">let</span> ((dir (file-name-directory fn)))
        (<span class="org-keyword">while</span> (<span class="org-keyword">and</span> (not (file-exists-p (concat dir <span class="org-string">"/build.xml"</span>)))
                    (not (equal dir (file-truename (concat dir <span class="org-string">"/.."</span>)))))
          (<span class="org-keyword">setf</span> dir (file-truename (concat dir <span class="org-string">"/.."</span>))))
        (<span class="org-keyword">if</span> (not (file-exists-p (concat dir <span class="org-string">"/build.xml"</span>)))
            (message <span class="org-string">"[No build.xml found]"</span>)
          (compile (read-from-minibuffer <span class="org-string">"Command: "</span>
                                         (concat <span class="org-string">"ant -emacs -f "</span>
                                         dir <span class="org-string">"/build.xml compile"</span>) <span class="org-warning">nil</span>
                                         nil
                                         'leuven--ant-command-history))))))

  (add-hook 'java-mode-hook
            #'(lambda ()
                (local-set-key <span class="org-string">"&lt;f9&gt;"</span> 'leuven-ant)))
</pre>
</div>

<p>
See smart-compile.el!
</p>

<p>
See jdc.el
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Use Java for class files decompiled with Jad.</span>
  (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.jad\\'"</span> . java-mode))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Color identifiers based on their names.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"color-identifiers-mode-autoloads"</span>
    (add-hook 'java-mode-hook 'color-identifiers-mode))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org35b950b" class="outline-3">
<h3 id="org35b950b">Compilation Mode</h3>
<div class="outline-text-3" id="text-org35b950b">
<p>
When Emacs visits the locus of an error message, it momentarily highlights the
relevant source line.  The duration of this highlight is determined by the
variable <code>next-error-highlight</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 27.2 (info "(emacs)Compilation Mode")</span>

  (leuven--section <span class="org-string">"27.2 (emacs)Compilation Mode"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Automatically jump to the first error during compilation.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq compilation-auto-jump-to-first-error t)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Display the next compiler error message.</span>
  (global-set-key (kbd <span class="org-string">"&lt;f10&gt;"</span>)   #'next-error) <span class="org-comment-delimiter">; </span><span class="org-comment">C-M-down in IntelliJ IDEA.</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Also on `M-g n', `M-g M-n' and `C-x `'.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Display the previous compiler error message.</span>
  (global-set-key (kbd <span class="org-string">"&lt;S-f10&gt;"</span>) #'previous-error) <span class="org-comment-delimiter">; </span><span class="org-comment">C-M-up in IntelliJ IDEA.</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Also on `M-g p' and `M-g M-p'.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Display the first compiler error message.</span>
  (global-set-key (kbd <span class="org-string">"&lt;C-f10&gt;"</span>) #'first-error)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Prefer fringe.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq next-error-highlight 'fringe-arrow)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Highlight and parse the whole compilation output as soon as it arrives.</span>
  (<span class="org-keyword">setq</span> compile-auto-highlight t)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcff247c" class="outline-3">
<h3 id="orgcff247c">Searching with Grep under Emacs</h3>
<div class="outline-text-3" id="text-orgcff247c">
<p>
Find files matching some regexp, and click on the hyperlinks to the files to
locate your match.
</p>

<p>
The commands
</p>

<ul class="org-ul">
<li><code>lgrep</code> (local search, with <code>grep-template</code>) and</li>
<li><code>rgrep</code> (<b>recursive</b> search, with <code>grep-find-template</code>)</li>
</ul>

<p>
are somehow more user-friendly than the <code>M-x grep</code> command.
</p>

<p>
The doc string of <code>grep-use-null-device</code> which explains that, with its default
value <code>auto-detect</code>, Emacs invokes Grep once with <code>/dev/null</code> appended (causing the
search to return no results) for the purposes of detecting how to invoke it
thereafter.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 27.4 (info "(emacs)Grep Searching") under Emacs</span>

  (leuven--section <span class="org-string">"27.4 (emacs)Grep Searching under Emacs"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"grep"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Run `</span><span class="org-comment"><span class="org-constant">grep</span></span><span class="org-comment">' via `</span><span class="org-comment"><span class="org-constant">find</span></span><span class="org-comment">', with user-friendly interface.</span>
    (global-set-key (kbd <span class="org-string">"C-c 3"</span>) #'rgrep)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Ignore case distinctions in the default `</span><span class="org-comment"><span class="org-constant">grep</span></span><span class="org-comment">' command.</span>
    (grep-apply-setting 'grep-command <span class="org-string">"grep -i -H -n -e "</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Do not append `</span><span class="org-comment"><span class="org-constant">null-device</span></span><span class="org-comment">' (`</span><span class="org-comment"><span class="org-constant">/dev/null</span></span><span class="org-comment">' or `</span><span class="org-comment"><span class="org-constant">NUL</span></span><span class="org-comment">') to `</span><span class="org-comment"><span class="org-constant">grep</span></span><span class="org-comment">' commands.</span>
    (grep-apply-setting 'grep-use-null-device nil)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Not necessary if the `</span><span class="org-comment"><span class="org-constant">grep</span></span><span class="org-comment">' program</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">used supports the `</span><span class="org-comment"><span class="org-constant">-H</span></span><span class="org-comment">' option.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">For Windows.</span>
    (<span class="org-keyword">when</span> leuven--win32-p
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Default find command for `M-x grep-find'.</span>
      (grep-apply-setting 'grep-find-command '(<span class="org-string">"findstr /sn *"</span> . 13)))
</pre>
</div>

<p>
To exclude files from <code>lgrep</code> and <code>rgrep</code> results (if you use <code>rgrep</code> instead of
<code>grep-find</code>), you can set up ignored files/dirs in advance:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"grep"</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Files to ignore for MEPLA.</span>
    (add-to-list 'grep-find-ignored-files <span class="org-string">"archive-contents"</span>)

    (add-to-list 'grep-find-ignored-files <span class="org-string">"*-min.js"</span>)
    (add-to-list 'grep-find-ignored-files <span class="org-string">"*.min.js"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Files to ignore for ARCHIBUS.</span>
    (add-to-list 'grep-find-ignored-files <span class="org-string">"ab-core.js"</span>)
    (add-to-list 'grep-find-ignored-files <span class="org-string">"ab-pgnav.js"</span>)
    (add-to-list 'grep-find-ignored-files <span class="org-string">"ab-view.js"</span>)
    (add-to-list 'grep-find-ignored-files <span class="org-string">"app.js"</span>)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-to-list 'grep-find-ignored-files "cordova.js")</span>
    (add-to-list 'grep-find-ignored-files <span class="org-string">"dx.archibus.js"</span>)
    (add-to-list 'grep-find-ignored-files <span class="org-string">"app.css"</span>)
    (add-to-list 'grep-find-ignored-files <span class="org-string">"sencha-touch.css"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Directories to ignore for ARCHIBUS.</span>
    (add-to-list 'grep-find-ignored-directories <span class="org-string">"ckeditor"</span>)
    (add-to-list 'grep-find-ignored-directories <span class="org-string">"common/mobile"</span>))
</pre>
</div>

<div class="note">
<p>
<code>helm-ag</code> and <code>helm-projectile-grep</code> also use the settings of the
<code>grep-find-ignored-*</code> variables.
</p>

</div>
</div>

<div id="outline-container-orgb354ec7" class="outline-4">
<h4 id="orgb354ec7">Ripgrep</h4>
<div class="outline-text-4" id="text-orgb354ec7">
<p>
alias rg=&rsquo;rg &#x2013;color always&rsquo;
</p>

<p>
rg &#x2013;column &#x2013;line-number &#x2013;no-heading &#x2013;fixed-strings &#x2013;ignore-case &#x2013;no-ignore &#x2013;hidden &#x2013;follow &#x2013;glob &ldquo;!.git/*&rdquo; &#x2013;color &ldquo;always&rdquo;
</p>

<p>
rg -S &#x2013;no-heading
</p>

<p>
helm-ag-base-command &ldquo;rg &#x2013;no-heading&rdquo;
</p>

<p>
Option <code>--sort-files</code> sorts results by file path, but disables all parallelism and
runs search in a single thread.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">when</span> (executable-find <span class="org-string">"rgXXX"</span>)        <span class="org-comment-delimiter">; </span><span class="org-comment">ripgrep.</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Default grep command for `M-x grep'.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(grep-apply-setting 'grep-command "ag --nogroup --numbers ")</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Default command to run for `M-x lgrep'.</span>
      (grep-apply-setting 'grep-template <span class="org-string">"rg --no-heading -H -uu -g &lt;F&gt; &lt;R&gt; &lt;D&gt;"</span>)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Default find command for `M-x grep-find'.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(grep-apply-setting 'grep-find-command '("ag --noheading --column " . 25))</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Default command to run for `M-x rgrep'.</span>
      (grep-apply-setting 'grep-find-template
                          <span class="org-string">"find &lt;D&gt; &lt;X&gt; -type f &lt;F&gt; -exec rg &lt;C&gt; --no-heading -H &lt;R&gt; /dev/null {} +"</span>))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">&lt;D&gt;</span></span><span class="org-comment">' = path.</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">&lt;X&gt;</span></span><span class="org-comment">' for the find options to restrict</span>
                                        <span class="org-comment-delimiter">;       </span><span class="org-comment">directory list.</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">&lt;F&gt;</span></span><span class="org-comment">' = glob.</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">------------------------------------</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">&lt;C&gt;</span></span><span class="org-comment">' for the place to put `</span><span class="org-comment"><span class="org-constant">-i</span></span><span class="org-comment">' if the</span>
                                        <span class="org-comment-delimiter">;       </span><span class="org-comment">search is case-insensitive.</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">&lt;R&gt;</span></span><span class="org-comment">' = pattern.</span>
</pre>
</div>

<p>
See <a href="https://stackoverflow.com/questions/45526670/rgrep-in-emacs-to-use-ripgrep">https://stackoverflow.com/questions/45526670/rgrep-in-emacs-to-use-ripgrep</a>.
</p>

<p>
Some problems with ripgrep:
</p>
<ul class="org-ul">
<li>no match highlighting,</li>
<li>error parsing regex when string is, for example, <code>Handler().update</code> or <code>myFunc(</code>.</li>
</ul>

<p>
find . -name &ldquo;*.log&rdquo; -type f -print0 | xargs -I _ sh -c &rsquo;iconv -f utf16 -t utf8 _ | grep runPMGeneration&rsquo;
</p>
</div>
</div>

<div id="outline-container-org2e21ace" class="outline-4">
<h4 id="org2e21ace">The Silver Searcher</h4>
<div class="outline-text-4" id="text-org2e21ace">
<p>
Ag, the silver searcher (in Cygwin!):
</p>
<ul class="org-ul">
<li><a href="https://github.com/howardabrams/dot-files/blob/master/emacs.org">https://github.com/howardabrams/dot-files/blob/master/emacs.org</a></li>
<li><a href="https://www.reddit.com/r/emacs/comments/3fr4ro/how_do_you_grep/">https://www.reddit.com/r/emacs/comments/3fr4ro/how_do_you_grep/</a></li>
</ul>

<p>
Ag output options:
</p>

<dl class="org-dl">
<dt><code>--[no]color</code></dt><dd>Print <b>color</b> codes in results.</dd>

<dt><code>--column</code></dt><dd>Print <b>column numbers</b> in results.</dd>

<dt><code>--[no]heading</code></dt><dd></dd>


<dt><code>--[no]group</code></dt><dd>Same as <code>--[no]break --[no]heading</code>.</dd>

<dt><code>--line-numbers</code> (or <code>--numbers</code>)</dt><dd>Print <b>line numbers</b> even for streams.</dd>
</dl>

<p>
Ag search options:
</p>

<dl class="org-dl">
<dt><code>--depth</code></dt><dd>Search up to <b><code>NUM</code> directories deep</b> (Default: <code>25</code>).</dd>

<dt><code>--ignore-case</code></dt><dd>Match <b>case insensitively</b>.</dd>

<dt><code>--all-text</code></dt><dd>Search <b>all text files</b> (doesn&rsquo;t include hidden files).</dd>
</dl>

<div class="org-src-container">
<pre class="src src-shell">ag %s -l --nocolor --hidden -g <span class="org-string">""</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Prefer rg &gt; ag.</span>
    (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> (executable-find <span class="org-string">"agXXX"</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">XXX Need to fix base dir and file extensions!!!</span>
               (not (executable-find <span class="org-string">"rg"</span>)))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Default grep command for `M-x grep'.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(grep-apply-setting 'grep-command "ag --nogroup --numbers ")</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Default command to run for `M-x lgrep'.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(grep-apply-setting 'grep-template "ag --depth 0 &lt;R&gt; &lt;F&gt;")</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Default find command for `M-x grep-find'.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(grep-apply-setting 'grep-find-command '("ag --noheading --column " . 25))</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Default command to run for `M-x rgrep' (`C-c 3').</span>
      (grep-apply-setting 'grep-find-template
                          <span class="org-string">"ag --color --nogroup --line-numbers &lt;R&gt; ."</span>))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">&lt;D&gt;</span></span><span class="org-comment">' for the base directory.</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">&lt;X&gt;</span></span><span class="org-comment">' for the find options to restrict</span>
                                        <span class="org-comment-delimiter">;       </span><span class="org-comment">directory list.</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">&lt;F&gt;</span></span><span class="org-comment">' for the find options to limit</span>
                                        <span class="org-comment-delimiter">;       </span><span class="org-comment">the files matched.</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">------------------------------------</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">&lt;C&gt;</span></span><span class="org-comment">' for the place to put `</span><span class="org-comment"><span class="org-constant">-i</span></span><span class="org-comment">' if the</span>
                                        <span class="org-comment-delimiter">;       </span><span class="org-comment">search is case-insensitive.</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">&lt;R&gt;</span></span><span class="org-comment">' for the regular expression to</span>
                                        <span class="org-comment-delimiter">;       </span><span class="org-comment">search for.</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">      <span class="org-comment-delimiter">;; </span><span class="org-comment">Default command to run for `M-x rgrep' (`C-c 3').</span>
      (grep-apply-setting 'grep-find-template
                          <span class="org-string">"find &lt;D&gt; &lt;X&gt; -type f &lt;F&gt; -print0 | \"xargs\" -0 grep &lt;C&gt; -nH -e &lt;R&gt;"</span>)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">This is how compilers number the first column, usually 1 or 0.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq-default grep-first-column 1)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Use `find -print0' and `xargs -0'.</span>
    (<span class="org-keyword">setq</span> grep-find-use-xargs 'gnu))    <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "grep" ends here.</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Run `</span><span class="org-comment"><span class="org-constant">grep</span></span><span class="org-comment">' via `</span><span class="org-comment"><span class="org-constant">find</span></span><span class="org-comment">', with user-friendly interface.</span>
  (global-set-key (kbd <span class="org-string">"C-c 3"</span>) #'rgrep)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org68ba600" class="outline-3">
<h3 id="org68ba600">Finding Syntax Errors On The Fly</h3>
<div class="outline-text-3" id="text-org68ba600">
<p>
Flycheck (aka &ldquo;Flymake done right&rdquo;) can perform static code analysis <b>on-the-fly</b>,
and <b>highlight warnings and errors</b> in the code immediately as you are editing it,
if you made a mistake.
</p>

<p>
To <b>list all errors in the current buffer</b>, you can popup an error list with
<code>C-c ! l</code> (<code>M-x flycheck-list-errors</code>).
</p>

<p>
(See <a href="https://github.com/steelbrain/linter">https://github.com/steelbrain/linter</a> in Atom.)
</p>

<p>
In the error list window the following keybindings are available:
</p>

<dl class="org-dl">
<dt><code>n</code></dt><dd>Move to the <b>next error</b>.</dd>

<dt><code>p</code></dt><dd>Move to the <b>previous error</b>.</dd>

<dt><code>q</code></dt><dd>Hide the error list window.</dd>

<dt><code>RET</code></dt><dd>Jump to the location of the error at point.</dd>

<dt><code>g</code></dt><dd>Refresh the error list, by triggering a new syntax check in the associated
buffer.</dd>

<dt><code>S</code></dt><dd>Sort the error list by the column at point. Press repeatedly to inverse the
sorting order.</dd>
</dl>

<div class="note">
<p>
<code>C-c ! v</code> (or <code>M-x flycheck-verify-setup</code>) is a diagnostic tool which displays
diagnostic information about the active checker in your current buffer.  Useful
if you have <code>$PATH</code> issues or are missing the checker entirely on your system.
</p>

</div>

<p>
XXX Display errors in the right fringe
</p>

<div class="tip">
<p>
<code>FlyC-</code>, in the mode line, either means that there is <b>no checker</b> or that it got
interrupted. See <code>flycheck-mode-line-status-text</code> for more information.
</p>

</div>

<p>
Navigate:
</p>
<ul class="org-ul">
<li>Next Highlighted Error (F2)</li>
<li>Previous Highlighted Error (Shift+F2).</li>
</ul>

<p>
<a href="http://www.flycheck.org/en/latest/user/error-reports.html">!FlyC: See errors in buffers</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 27.5 (info "(emacs)Flymake")</span>

  (leuven--section <span class="org-string">"27.5 (emacs)Flymake"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Modern on-the-fly syntax checking.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"flycheck-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable Flycheck mode in all programming modes. XXX Should not in Java?</span>
    (add-hook 'prog-mode-hook  #'flycheck-mode)

    (add-hook 'LaTeX-mode-hook #'flycheck-mode)

    (global-set-key (kbd <span class="org-string">"M-g l"</span>) #'flycheck-list-errors))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"flycheck"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Delay in seconds before displaying errors at point.</span>
    (<span class="org-keyword">setq</span> flycheck-display-errors-delay 0.3)

    (<span class="org-keyword">setq</span> flycheck-indication-mode 'left-fringe) <span class="org-comment-delimiter">; </span><span class="org-comment">See init.el.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Indicate errors and warnings via icons in the right fringe.</span>
    (<span class="org-keyword">setq</span> flycheck-indication-mode 'right-fringe)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Remove newline checks, since they would trigger an immediate check when</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">we want the `</span><span class="org-comment"><span class="org-constant">flycheck-idle-change-delay</span></span><span class="org-comment">' to be in effect while editing.</span>
    (<span class="org-keyword">setq</span> flycheck-check-syntax-automatically
          '(save
            idle-change
            <span class="org-comment-delimiter">;; </span><span class="org-comment">new-line</span>
            mode-enabled))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Each buffer get its local `</span><span class="org-comment"><span class="org-constant">flycheck-idle-change-delay</span></span><span class="org-comment">' because of the</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">buffer-sensitive adjustment above.</span>
    (make-variable-buffer-local 'flycheck-idle-change-delay)

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--adjust-flycheck-automatic-syntax-eagerness</span> ()
      <span class="org-doc">"Adjust how often we check for errors based on if there are any.</span>

<span class="org-doc">This lets us fix any errors as quickly as possible, but in</span>
<span class="org-doc">a clean buffer we're an order of magnitude laxer about checking."</span>
      (<span class="org-keyword">setq</span> flycheck-idle-change-delay
            (<span class="org-keyword">if</span> (assq 'error (flycheck-count-errors flycheck-current-errors))
                <span class="org-comment-delimiter">; </span><span class="org-comment">only check for REAL errors (original source: Magnar Sveen)</span>
                1
              20)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Functions to run after each syntax check.</span>
    (add-hook 'flycheck-after-syntax-check-hook
              #'leuven--adjust-flycheck-automatic-syntax-eagerness)
</pre>
</div>

<p>
A summary of the inspection results for the current file is shown in the colored
mode line on bottom.  Make it blue!
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Change mode line color with Flycheck status.</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"flycheck-color-mode-line"</span>
      (add-hook 'flycheck-mode-hook 'flycheck-color-mode-line-mode)))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Provide an error display function to show errors in a tooltip.</span>
  (<span class="org-keyword">with-eval-after-load</span> 'flycheck
    (flycheck-pos-tip-mode)) <span class="org-comment-delimiter">; </span><span class="org-comment">XXX Check if defined.</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (global-set-key (kbd <span class="org-string">"C-x C-S-e"</span>) #'elint-current-buffer)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"elint"</span>
    (add-to-list 'elint-standard-variables 'current-prefix-arg)
    (add-to-list 'elint-standard-variables 'command-line-args-left)
    (add-to-list 'elint-standard-variables 'buffer-file-coding-system)
    (add-to-list 'elint-standard-variables 'emacs-major-version)
    (add-to-list 'elint-standard-variables 'window-system))
</pre>
</div>
</div>
</div>

<div id="outline-container-org4bab522" class="outline-3">
<h3 id="org4bab522">Running Debuggers Under Emacs</h3>
<div class="outline-text-3" id="text-org4bab522">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 27.6 Running (info "(emacs)Debuggers") Under Emacs</span>

  (leuven--section <span class="org-string">"27.6 Running (emacs)Debuggers Under Emacs"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"gdb-mi"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable Gdb-Many-Windows mode.</span>
    (<span class="org-keyword">setq</span> gdb-many-windows t))          <span class="org-comment-delimiter">; </span><span class="org-comment">The only important parameter for GDB.</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(define-key jde-mode-map [f8]   'jdibug-step-over)
(define-key jde-mode-map [M-f8] 'jdibug-step-into)
(define-key jde-mode-map [f7]   'jdibug-step-out)
(define-key jde-mode-map [M-f7] 'jdibug-resume)
</pre>
</div>
</div>
</div>

<div id="outline-container-org834a12e" class="outline-3">
<h3 id="org834a12e">Debugging Lisp programs</h3>
<div class="outline-text-3" id="text-org834a12e">
<p>
Emacs has the basic debugger/stack trace, but it also has the Edebug facility,
which is very powerful, for the more complex situation.
</p>

<p>
With that source-level debugger for Emacs Lisp, you can:
</p>
<ul class="org-ul">
<li>step through evaluation, stopping before and after each expression,</li>
<li>set conditional or unconditional breakpoints.</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** Debugging Lisp programs</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Source-level debugger for Emacs Lisp.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"edebug"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Display a trace of function entry and exit.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq edebug-trace t)</span>
</pre>
</div>

<p>
While <code>edebug</code>&rsquo;ging, use <code>T</code> to view a trace buffer (<code>*edebug-trace*</code>).  Emacs will
quickly execute the rest of your code, printing out the arguments and return
values for each expression it evaluates.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">defadvice</span> <span class="org-function-name">edebug-overlay-arrow</span> (around leuven-highlight-line activate)
      <span class="org-doc">"Highlight line currently being Edebug'ged."</span>
      (<span class="org-keyword">require</span> '<span class="org-constant">hl-line</span>)
      (hl-line-mode)
      ad-do-it)

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-edebug-quit</span> ()
      <span class="org-doc">"Stop Edebug'ging and remove highlighting."</span>
      (<span class="org-keyword">interactive</span>)
      (hl-line-mode -1)
      (top-level))

    (define-key edebug-mode-map [remap top-level] #'leuven-edebug-quit))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb246be4" class="outline-3">
<h3 id="orgb246be4">Executing Lisp Expressions</h3>
<div class="outline-text-3" id="text-orgb246be4">
<p>
Just as in C, C++, Java, Perl, Python, etc, Lisp code is kept in files.  All
the normal editing operations are performed on files.  In this respect, hacking
in Lisp is like hacking in any other language that you are used to.  What&rsquo;s
different is that what you are hacking is a running Lisp program.  When you
edit a function definition or add a new one, you compile it into a running
program.  There is no compile, link, run, debug cycle as you know it from C or
Java.
</p>

<p>
Ponder that for a minute.
</p>

<p>
When you fix a bug in a C function, you have to recompile, relink, and reload
your program before you can test the fix.  You don&rsquo;t do that in Lisp.  You make
the fix and then go straight to testing it.  This process can be even faster
than fixing a bug in a scripting language like Perl.
</p>
</div>
</div>

<div id="outline-container-orgdb15d85" class="outline-3">
<h3 id="orgdb15d85">Libraries of Lisp Code for Emacs</h3>
<div class="outline-text-3" id="text-orgdb15d85">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 27.8 (info "(emacs)Lisp Libraries") for Emacs</span>

  (leuven--section <span class="org-string">"27.8 (emacs)Lisp Libraries"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Remove *.elc when save.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">remove-elc-on-save</span> ()
    <span class="org-doc">"If you're saving an elisp file, likely the .elc is no longer valid."</span>
    (make-local-variable 'after-save-hook)
    (add-hook 'after-save-hook
              #'(lambda ()
                  (<span class="org-keyword">if</span> (file-exists-p (concat buffer-file-name <span class="org-string">"c"</span>))
                      (delete-file (concat buffer-file-name <span class="org-string">"c"</span>))))))

  (add-hook 'emacs-lisp-mode-hook #'remove-elc-on-save)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Force load of `</span><span class="org-comment"><span class="org-constant">.el</span></span><span class="org-comment">' files when they are newer than the `</span><span class="org-comment"><span class="org-constant">.elc</span></span><span class="org-comment">' files.</span>
  (<span class="org-keyword">setq</span> load-prefer-newer t)            <span class="org-comment-delimiter">; </span><span class="org-comment">From Emacs 24.4.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgee32d35" class="outline-3">
<h3 id="orgee32d35">Evaluating Emacs Lisp Expressions</h3>
<div class="outline-text-3" id="text-orgee32d35">
<dl class="org-dl">
<dt><code>C-x C-e</code></dt><dd>Evaluate the Emacs Lisp expression before point, and print the value in
the echo area (<code>eval-last-sexp</code>).</dd>

<dt><code>C-M-x</code> (in Emacs Lisp mode)</dt><dd>Evaluate the defun containing or after point, and print the value in the
echo area (<code>eval-defun</code>).</dd>
</dl>

<p>
To (attempt to) cleanly reevaluate a buffer of Emacs Lisp code, use
<code>nuke-and-eval</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 27.9 (info "(emacs)Lisp Eval") Expressions</span>

  (leuven--section <span class="org-string">"27.9 (emacs)Lisp Eval Expressions"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable the use of the command `</span><span class="org-comment"><span class="org-constant">eval-expression</span></span><span class="org-comment">' without confirmation.</span>
  (put 'eval-expression 'disabled nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Maximum depth of lists to print in the result of the evaluation commands</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">before abbreviating them.</span>
  (<span class="org-keyword">setq</span> eval-expression-print-level nil) <span class="org-comment-delimiter">; </span><span class="org-comment">No limit.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Maximum length of lists to print in the result of the evaluation commands</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">before abbreviating them.</span>
  (<span class="org-keyword">setq</span> eval-expression-print-length nil) <span class="org-comment-delimiter">; </span><span class="org-comment">No limit.</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Limit serving to catch infinite recursions for you before they</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; cause actual stack overflow in C, which would be fatal for Emacs.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq max-lisp-eval-depth 600)        ; 1000?</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">eval-and-replace</span> ()
    <span class="org-doc">"Replace the preceding sexp with its value."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let</span> ((value (eval (preceding-sexp))))
      (kill-sexp -1)
      (insert (format <span class="org-string">"%S"</span> value))))

  (global-set-key (kbd <span class="org-string">"C-c e"</span>) #'eval-and-replace)
</pre>
</div>

<p>
For on-the-fly evaluation/substitution of Emacs Lisp code, see
<a href="https://github.com/Fuco1/litable">https://github.com/Fuco1/litable</a>.
</p>

<p>
See demo of it: <a href="http://www.youtube.com/watch?v=TMoPuv-xXMM">http://www.youtube.com/watch?v=TMoPuv-xXMM</a>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Dynamic evaluation replacement with Emacs.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"litable-autoloads"</span>

    (add-hook 'lisp-interaction-mode-hook #'litable-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-org47d00a1" class="outline-3">
<h3 id="org47d00a1">Lisp Interaction Buffers (<code>*scratch*</code>)</h3>
<div class="outline-text-3" id="text-org47d00a1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 27.10 (info "(emacs)Lisp Interaction") Buffers</span>

  (leuven--section <span class="org-string">"27.10 (emacs)Lisp Interaction Buffers"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't display the "Welcome to GNU Emacs" buffer on startup.</span>
  (<span class="org-keyword">setq</span> inhibit-startup-screen t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't insert instructions in the `</span><span class="org-comment"><span class="org-constant">*scratch*</span></span><span class="org-comment">' buffer at startup.</span>
  (<span class="org-keyword">setq</span> initial-scratch-message nil)
</pre>
</div>

<p>
Don&rsquo;t use any specific mode for the initial buffer.  That ensure that no Lisp
or Org specific stuff gets loaded at each startup time.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Major mode command symbol to use for the initial `</span><span class="org-comment"><span class="org-constant">*scratch*</span></span><span class="org-comment">' buffer.</span>
  (<span class="org-keyword">setq</span> initial-major-mode 'fundamental-mode)
</pre>
</div>

<p>
<b>That code must be used in the <code>.emacs</code> file (or libraries loaded from it).</b>
Otherwise, <code>*scratch*</code> will already have been created, in the default major
mode.
</p>

<p>
To evaluate a non-interactive command, simply use <code>IELM</code>.
</p>
</div>
</div>

<div id="outline-container-org5f82040" class="outline-3">
<h3 id="org5f82040">Switching to a Buffer in a Window</h3>
<div class="outline-text-3" id="text-org5f82040">
<p>
Emacs&rsquo;s windows are locked in an eternal fight with their user as they fight
over screen estate and what buffer is allowed to be shown where. The concept of
strongly dedicated window is alien to most Emacs users as it&rsquo;s fairly byzantine
to figure out. This variable, which is customizable, will let you decide how
buffer switching works when a window and its buffer are fundamentally
entwined. I recommend you set it to <code>prompt</code> if you are curious about its effects,
as that will prompt you to decide what to do next &#x2013; no doubt annoying in the
long run, but useful for figuring out how Emacs&rsquo;s windowing mechanics work.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">setq</span> switch-to-buffer-in-dedicated-window 'prompt)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 27 ends here.</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf134b99" class="outline-2">
<h2 id="orgf134b99">Maintaining Programs</h2>
<div class="outline-text-2" id="text-orgf134b99">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 28 (info "(emacs)Maintaining") Programs</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-28-maintaining <span class="org-string">"28 Maintaining Programs"</span>
</pre>
</div>
</div>

<div id="outline-container-org4bb7919" class="outline-3">
<h3 id="org4bb7919">Version Control</h3>
<div class="outline-text-3" id="text-org4bb7919">
<p>
A unified Emacs UI for interacting with Git, SVN and other VCS (Version Control
Systems) in a generic way &#x2013; a real timesaver.
</p>

<dl class="org-dl">
<dt><code>C-x v d</code></dt><dd>Open Dired buffer in VC-mode.</dd>

<dt><code>C-x v v</code></dt><dd>Take appropriate &ldquo;next&rdquo; action (add, commit).</dd>

<dt><code>C-x v r</code> (or <code>M-!</code> ?)</dt><dd>Switch Git branches.</dd>

<dt><code>C-x v +</code></dt><dd>vc-update.</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 28.1 (info "(emacs)Version Control")</span>

  (leuven--section <span class="org-string">"28.1 (emacs)Version Control"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq vc-follow-symlinks t)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq vc-follow-symlinks nil)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq vc-allow-async-revert t)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq vc-git-diff-switches '("-w" "-U3")) ;; XXX What about mnemonicprefix=true?</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">;; When opening a file that is a symbolic link, don't ask whether I</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">;; want to follow the link. Just do it</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(setq find-file-visit-truename t)</span>
</pre>
</div>
</div>

<div id="outline-container-orgb6cda6b" class="outline-4">
<h4 id="orgb6cda6b">Version Control and the Mode Line</h4>
<div class="outline-text-4" id="text-orgb6cda6b">
<p>
&ldquo;Unmodified-according-to-VC&rdquo; buffers use <code>-</code> as a separator in their VC
indicator, and modified buffers have <code>:</code> (e.g., <code>CVS-1.2</code> vs. <code>CVS:1.2</code>).  The
tooltip over the VC indicator also says more explicitly.
</p>

<div class="inlinetask">
<b>Lisp expression in mode-line-format</b><br />
<p>
The Lisp expressions supported in <code>mode-line-format</code> are those documented in the
manual, and nothing else.  In particular, the <code>:eval</code> part must appear
explicitly, and any symbol stands for its value (which is not eval&rsquo;ed).  IOW, a
full-blown Lisp evaluation there is not implemented&#x2026;
</p>
</div>
</div>
</div>

<div id="outline-container-orgbd26f6a" class="outline-4">
<h4 id="orgbd26f6a">Features of the Log Entry Buffer</h4>
<div class="outline-text-4" id="text-orgbd26f6a">
<dl class="org-dl">
<dt><code>C-c C-d</code></dt><dd>Show the diff we are about to commit.</dd>

<dt><code>D</code> (<code>vc-git-previous-revision</code>)</dt><dd>Get the previous revision.</dd>
</dl>

<p>
Using Emacs VC, you only have to write the ChangeLog, then use <code>C-c C-a</code> to insert
it into the commit buffer. So there is no need to &ldquo;write the same thing twice&rdquo;.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">*** 28.1.4 (info "(emacs)Log Buffer")</span>

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--vc-log-mode-setup</span> ()
    (<span class="org-keyword">when</span> (leuven--executable-ispell-program-name-p)
      (<span class="org-keyword">setq</span> ispell-local-dictionary <span class="org-string">"american"</span>)
      (flyspell-mode)))

  (add-hook 'vc-log-mode-hook #'leuven--vc-log-mode-setup)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"vc-git"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Major mode for editing git commit messages.</span>
    (idle-require 'git-commit))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"git-commit"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Turn on on-the-fly spell-checking.</span>
    (add-hook 'git-commit-setup-hook #'flyspell-mode)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Turn off save-place.</span>
    (add-hook 'git-commit-setup-hook
              #'(lambda ()
                  (toggle-save-place 0))))
</pre>
</div>

<p>
See <a href="http://whattheemacsd.com/setup-magit.el-01.html">http://whattheemacsd.com/setup-magit.el-01.html</a>.
</p>

<p>
Or use Tig?  See <a href="http://blogs.atlassian.com/2013/05/git-tig/">http://blogs.atlassian.com/2013/05/git-tig/</a>.
</p>
</div>
</div>

<div id="outline-container-orge97ebbb" class="outline-4">
<h4 id="orge97ebbb">Examining And Comparing Old Revisions</h4>
<div class="outline-text-4" id="text-orge97ebbb">
<p>
VC can show you the <b>history of changes</b> to a <b>particular line of code</b>:
</p>

<ol class="org-ol">
<li>Run the command <code>vc-annotate</code> (with either <code>M-x vc-annotate</code> or <code>C-x v g</code>).</li>
<li>Each line will show up with its revision, like a normal <code>blame</code>.</li>
<li>Pressing <code>a</code> (<code>vc-annotate-revision-previous-to-line</code>) will navigate to the
revision before the revision at the line you&rsquo;re on.</li>
</ol>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">*** 28.1.6 (info "(emacs)Old Revisions")</span>

  (leuven--section <span class="org-string">"28.1.6 Examining And Comparing Old Revisions"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Switches for diff under VC.</span>
  (<span class="org-keyword">setq</span> vc-diff-switches diff-switches)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgac49086" class="outline-4">
<h4 id="orgac49086">VC Change Log</h4>
<div class="outline-text-4" id="text-orgac49086">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">*** 28.1.7 (info "(emacs)VC Change Log")</span>

  (leuven--section <span class="org-string">"28.1.7 VC Change Log"</span>)
</pre>
</div>

<dl class="org-dl">
<dt><code>C-x v l</code></dt><dd>Display the change history for the current <b>file</b> (<code>vc-print-log</code>).</dd>

<dt><code>C-x v L</code></dt><dd><p>
Open the <b>log buffer</b> for the current <b>repository</b> (List the change log for the
current VC controlled tree in a window).
</p>

<p>
When in it:
</p>
<ul class="org-ul">
<li><code>C-m</code> to read the commit message,</li>
<li><code>d</code> to see the corresponding diff.</li>
</ul></dd>
</dl>

<p>
We have at least two pairs of commands:
</p>

<ul class="org-ul">
<li><code>C-x v l</code> vs <code>C-x v L</code> <i>and</i></li>
<li><code>C-x v =</code> vs <code>C-x v D</code>,</li>
</ul>

<p>
of which one operates on the current <b>file</b> vs <br />
the other on the <b>repository</b> as a whole (entire project).
</p>

<ul class="org-ul">
<li><code>C-x v l</code> to view the file&rsquo;s history.</li>
<li><code>n</code> and <code>p</code> to move between commits.</li>
<li><code>f</code> to visit the file as of the commit at point.</li>
</ul>

<p>
The command <code>vc-region-history</code> shows the <b>log + diff of the active region</b>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (global-set-key (kbd <span class="org-string">"C-x v H"</span>) #'vc-region-history)
</pre>
</div>

<p>
<code>git-timemachine</code> makes the process of <b>navigating between different versions</b> of
a file almost completely seamless.
</p>

<p>
You call <code>M-x git-timemachine RET</code> from a buffer visiting a tracked file, then you
can use the following keys to navigate historic versions of the file:
</p>

<dl class="org-dl">
<dt><code>p</code></dt><dd>Visit <b>previous</b> historic version.</dd>

<dt><code>n</code></dt><dd>Visit <b>next</b> historic version.</dd>

<dt><code>w</code></dt><dd>Copy the abbreviated hash of the current historic version.</dd>

<dt><code>W</code></dt><dd>Copy the full hash of the current historic version.</dd>

<dt><code>q</code></dt><dd>Exit the time machine.</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Walk through Git revisions of a file.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"git-timemachine-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Number of chars from the full SHA1 hash to use for abbreviation.</span>
    (<span class="org-keyword">setq</span> git-timemachine-abbreviation-length 7)

    (global-set-key (kbd <span class="org-string">"C-x v t"</span>) #'git-timemachine))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Pop up last commit information of current line.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"git-messenger-autoloads"</span>

    (global-set-key (kbd <span class="org-string">"C-x v p"</span>) #'git-messenger:popup-message) <span class="org-comment-delimiter">; </span><span class="org-comment">`C-h g'.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Pop up commit ID and author name too.</span>
    (<span class="org-keyword">setq</span> git-messenger:show-detail t))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc538139" class="outline-4">
<h4 id="orgc538139">VC Directory Mode</h4>
<div class="outline-text-4" id="text-orgc538139">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">*** 28.1.9 (info "(emacs)VC Directory Mode")</span>

  (leuven--section <span class="org-string">"28.1.9 VC Directory Mode"</span>)

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-vc-jump</span> ()
    <span class="org-doc">"Jump to VC status buffer."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let*</span> ((fname (buffer-file-name))
           (dname (<span class="org-keyword">if</span> fname
                      (<span class="org-keyword">if</span> (file-directory-p fname)
                          fname
                        (file-name-directory fname))
                    default-directory)))
      (message <span class="org-string">"[VC status for directory: %s]"</span> dname)
      (vc-dir dname)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">VC status without asking for a directory.</span>
  (global-set-key (kbd <span class="org-string">"&lt;C-f9&gt;"</span>) #'leuven-vc-jump)

  (add-hook 'vc-dir-mode-hook
            #'(lambda ()
                <span class="org-comment-delimiter">;; </span><span class="org-comment">Hide up-to-date and unregistered files.</span>
                (define-key vc-dir-mode-map
                  (kbd <span class="org-string">"x"</span>) #'leuven-vc-dir-hide-up-to-date-and-unregistered)
                (define-key vc-dir-mode-map
                  (kbd <span class="org-string">"E"</span>) #'vc-ediff)
                (define-key vc-dir-mode-map
                  (kbd <span class="org-string">"#"</span>) #'vc-ediff-ignore-whitespace)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">ediff-windows-wordwise?</span>
              ))

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-vc-dir-hide-up-to-date-and-unregistered</span> ()
    (<span class="org-keyword">interactive</span>)
    (vc-dir-hide-up-to-date)
    (vc-dir-hide-unregistered))

  (<span class="org-keyword">defun</span> <span class="org-function-name">vc-dir-hide-unregistered</span> ()
    <span class="org-doc">"Hide unregistered items from display."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let</span> ((crt (ewoc-nth vc-ewoc -1))
          (first (ewoc-nth vc-ewoc 0)))
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Go over from the last item to the first and remove the unregistered</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">files and directories with no child files.</span>
      (<span class="org-keyword">while</span> (not (eq crt first))
        (<span class="org-keyword">let*</span> ((data (ewoc-data crt))
               (dir (vc-dir-fileinfo-&gt;directory data))
               (next (ewoc-next vc-ewoc crt))
               (prev (ewoc-prev vc-ewoc crt))
               <span class="org-comment-delimiter">;; </span><span class="org-comment">ewoc-delete does not work without this...</span>
               (inhibit-read-only t))
          (<span class="org-keyword">when</span> (<span class="org-keyword">or</span>
                 <span class="org-comment-delimiter">;; </span><span class="org-comment">Remove directories with no child files.</span>
                 (<span class="org-keyword">and</span> dir
                      (<span class="org-keyword">or</span>
                       <span class="org-comment-delimiter">;; </span><span class="org-comment">Nothing follows this directory.</span>
                       (not next)
                       <span class="org-comment-delimiter">;; </span><span class="org-comment">Next item is a directory.</span>
                       (vc-dir-fileinfo-&gt;directory (ewoc-data next))))
                 <span class="org-comment-delimiter">;; </span><span class="org-comment">Remove files in the unregistered state.</span>
                 (eq (vc-dir-fileinfo-&gt;state data) 'unregistered))
            (ewoc-delete vc-ewoc crt))
          (<span class="org-keyword">setq</span> crt prev)))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">vc-ediff-ignore-whitespace</span> (historic <span class="org-type">&amp;optional</span> not-urgent)
    <span class="org-doc">"Ignore regions that differ in white space &amp; line breaks only."</span>
    (<span class="org-keyword">interactive</span> (list current-prefix-arg t))
    (<span class="org-keyword">require</span> '<span class="org-constant">ediff</span>)
    (<span class="org-keyword">let</span> ((ediff-ignore-similar-regions t))
      (call-interactively 'vc-ediff)))  <span class="org-comment-delimiter">; </span><span class="org-comment">XXX does not work yet!</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge3f6647" class="outline-4">
<h4 id="orge3f6647">Branches</h4>
<div class="outline-text-4" id="text-orge3f6647">
<dl class="org-dl">
<dt>C-x v P (M-x vc-push)</dt><dd>Basic <b>push</b> support.</dd>
</dl>
</div>
</div>

<div id="outline-container-org6c5bec5" class="outline-4">
<h4 id="org6c5bec5">Customizing VC</h4>
<div class="outline-text-4" id="text-org6c5bec5">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">*** 28.1.13 (info "(emacs)Customizing VC")</span>

  (leuven--section <span class="org-string">"28.1.13 Customizing VC"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Files covered by VC get backups (as with other files).</span>
  (<span class="org-keyword">setq</span> vc-make-backup-files t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">http://www.emacswiki.org/emacs/VcTopDirectory</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">For Git.</span>
  (<span class="org-keyword">defadvice</span> <span class="org-function-name">vc-dir-prepare-status-buffer</span>
             (before leuven-vcs-goto-top-directory activate compile)
    (<span class="org-keyword">let*</span> ((backend (ad-get-arg 2))
           (vcs-dir (ad-get-arg 1))
           (vcs-top-dir (vc-call-backend backend 'responsible-p vcs-dir)))
      (<span class="org-keyword">when</span> (stringp vcs-top-dir)
        (ad-set-arg 1 vcs-top-dir))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--ediff-revision</span> (file rev1 <span class="org-type">&amp;optional</span> rev2)
    <span class="org-doc">"Run Ediff by comparing 'master' against the 'current'."</span>
    (<span class="org-keyword">require</span> '<span class="org-constant">ediff</span>)
    (find-file file)
    (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> (buffer-modified-p)
             (y-or-n-p (format <span class="org-string">"Buffer %s is modified.  Save buffer? "</span>
                               (buffer-name))))
        (save-buffer (current-buffer)))
    (ediff-load-version-control)
    (funcall
     (intern (format <span class="org-string">"ediff-%S-internal"</span> ediff-version-control-package))
     rev1 rev2 nil))

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-vc-diff</span> (<span class="org-type">&amp;optional</span> arg)
    (<span class="org-keyword">interactive</span> <span class="org-string">"P"</span>)
    (call-interactively
     (<span class="org-keyword">cond</span> (arg
            #'(lambda ()
                (<span class="org-keyword">interactive</span>)
                (vc-diff nil)))
           (t
            #'(lambda ()
                (<span class="org-keyword">interactive</span>)
                (leuven--ediff-revision (buffer-file-name)
                                        (read-string <span class="org-string">"revision? "</span>
                                                     <span class="org-string">"HEAD"</span> nil <span class="org-string">"HEAD"</span>)
                                        <span class="org-string">""</span>))))))

  (define-key vc-prefix-map (kbd <span class="org-string">"="</span>) #'leuven-vc-diff)
</pre>
</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Customize `vc-annotate-background&rsquo; (and future `vc-annotate-foreground&rsquo;)</b><br />
nil</div>
</div>
</div>
</div>

<div id="outline-container-orgb8361c9" class="outline-3">
<h3 id="orgb8361c9">Change Logs</h3>
<div class="outline-text-3" id="text-orgb8361c9">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 28.2 (info "(emacs)Change Log")</span>

  (leuven--section <span class="org-string">"28.2 (emacs)Change Logs"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"add-log"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't make a new entry, when the last entry was made by you and on the</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">same date.</span>
    (<span class="org-keyword">setq</span> add-log-always-start-new-record nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add the file's version number to the change log entry.</span>
    (<span class="org-keyword">setq</span> change-log-version-info-enabled t)

    (add-hook 'change-log-mode-hook
              (add-to-list
               'change-log-font-lock-keywords
               '(<span class="org-string">"^[0-9-]+:? +</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">^</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">Sun</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">Mon</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">Tue</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">Wed</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">Thu</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">Fri</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">Sat</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string"> [A-z][a-z][a-z] [0-9:+ ]+"</span>
                 (0 'change-log-date-face)
                 (<span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[</span><span class="org-string"><span class="org-negation-char">^</span></span><span class="org-string">&lt;(]+?</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">[   ]*[(&lt;]</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[[:alnum:]_.+-]+@[[:alnum:]_.-]+</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">[&gt;)]"</span> nil nil
                  (1 'change-log-name)
                  (2 'change-log-email))))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcbf4c11" class="outline-3">
<h3 id="orgcbf4c11">Tags Tables (navigating code)</h3>
<div class="outline-text-3" id="text-orgcbf4c11">
<p>
Using tags tables is the most generic approach to setup <b>code navigation</b>.  A
&ldquo;tag&rdquo; signifies a language object for which an index entry is available.
</p>

<div class="note">
<p>
There are many situations when you cannot or might not want to use <code>tags</code>.  You
would like to use <a href="#org1bacaee">Imenu</a> because:
</p>

<ul class="org-ul">
<li>Imenu is meaningful in non-programming modes and for non-visiting buffers.</li>

<li>Virtually all modes already define Imenu, so it works out of the box
everywhere, even if you read a language in which you will never write.</li>

<li>And finally, Imenu operates on what you work on &#x2013; open files &#x2013; you don&rsquo;t get
thousands of symbols from <code>etags</code> to deal with.</li>
</ul>

<p>
Using <code>helm-imenu-in-all-buffers</code> offers a much better, more uniform and more
consistent experience than anything else.
</p>

</div>

<p>
Always run <code>make TAGS</code> right after you build some project.
</p>

<p>
Once you&rsquo;ve built a <code>TAGS</code> file (<code>ctags</code> / <code>etags</code>), you can find all commands that
match a regexp.
</p>

<p>
Support for tags has been in Emacs for a long time: any installation of Emacs
should comes with the <code>etags</code> program, which supports many different languages.
</p>

<p>
Comparison of tools:
</p>

<dl class="org-dl">
<dt>etags (Emacs-style TAGS file)</dt><dd><p>
Ada, Asm, <b>C</b>, Objective C, <b>C++</b>, C#, Cobol, Erlang, Forth, Fortran, HTML,
<b>Java</b>, <b>Lisp</b>, Lua, Makefile, Pascal, Perl, <b>PHP</b>, Postscript, Prolog, <b>Python</b>,
Scheme, TeX, TeXinfo, and YACC.
</p>

<p>
On Windows, Emacs comes with <code>etags</code> and a similar executable file called
<code>ctags</code>.  In the Emacs distribution, <code>etags.exe</code> = <code>ctags.exe</code> in the <code>bin</code>
directory.
</p></dd>

<dt>Exuberant Ctags</dt><dd><p>
Ant, Asm, Asp, Awk, Basic, BETA, <b>C</b>, <b>C++</b>, C#, Cobol, DosBatch, Eiffel,
Erlang, Flex, Fortran, HTML, <b>Java</b>, JavaScript, <b>Lisp</b>, Lua, Makefile,
MatLab, OCaml, Pascal, Perl, <b>PHP</b>, <b>Python</b>, REXX, <b>Ruby</b>, Scheme, Sh, SLang,
SML, SQL, Tcl, TeX, Vera, Verilog, VHDL, Vim, and YACC.
</p>

<p>
You should download <b>Exuberant Ctags</b> from <a href="http://ctags.sourceforge.net/">http://ctags.sourceforge.net/</a> or
from Cygwin.  Only <b>Exuberant</b> <code>ctags.exe</code> recognizes <code>-e</code> option (<i>etags mode</i>,
which will create a tag file for use with the Emacs editor).
</p>

<p>
Exuberant Ctags can be extended to look for other things via regular
expression.  It is a wonderful thing!
</p>

<p>
For example, I can now look for tags in my shell code to by running:
</p>

<div class="org-src-container">
<pre class="src src-shell">     etags --langdef=shell --regex-shell=<span class="org-string">'/function [_[:alnum:]]+/[_[:alnum:]]+/'</span> --language-force=shell
</pre>
</div></dd>

<dt>Cscope</dt><dd>C, but flexible enough to support C++ and Java, and to be used as a
generalized &ldquo;grep database&rdquo;.</dd>

<dt>ebrowse</dt><dd>For C++, you will be better off with ebrowse, a program that also comes
with Emacs.  It understands C++ much better than etags does, and provides
similar commands (so you don&rsquo;t lose anything).  Check out the Ebrowse
manual, which is part of the Emacs distribution, for details.</dd>

<dt>GNU Idutils</dt><dd></dd>


<dt>GNU Global (gtags)</dt><dd><p>
<b>C</b>, <b>C++</b>, Yacc, <b>Java</b>, and <b>PHP4</b>.
</p>

<p>
Global is a lot smarter about finding tags tables, and is fairly fast to
update.
</p></dd>
</dl>

<p>
<b>Emacs TAGS</b> and <b>Exuberant Ctags</b> don&rsquo;t do fancy stuff, e.g. keeping an index of
function references.  They record only positions where a function (or variable
etc.) is <b>defined</b>.
</p>

<p>
Recording positions where a function is <b>called</b> (finding all <b>symbol references</b>)
is the kind of thing external tools such as <b>GNU Global</b>, <b>GNU Idutils</b> and <b>Cscope</b>
can do for you, if you&rsquo;re working with a language that they support.  <b>Grep</b>
would be the fallback method.
</p>

<p>
Please also see <a href="http://hub.opensolaris.org/bin/view/Project+opengrok/">Comparison with Similar Tools</a>.
</p>

<p>
Once you have a good tagging system in place, many tools become enabled for your
language, such as:
</p>

<ul class="org-ul">
<li>tag decoration mode (like drawing lines over the top of function tags),</li>
<li>stickyfunc mode (which shows the current function in the header line),</li>
<li><a href="#org5e5747e">Emacs Code Browser</a>, and</li>
<li>tag jumping.</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 28.3 (info "(emacs)Tags")</span>

  (leuven--section <span class="org-string">"28.3 (emacs)Tags Tables"</span>)
</pre>
</div>
</div>

<div id="outline-container-org49a63ef" class="outline-4">
<h4 id="org49a63ef">Creating Tags Tables</h4>
<div class="outline-text-4" id="text-org49a63ef">
<p>
First of all, you must build a <code>TAGS</code> file (which keeps the symbols from your
project, by scanning all the source and header files with the <code>etags</code> command).
</p>

<p>
For example, you can have a <code>TAGS</code> Makefile target to do this for you:
</p>

<div class="org-src-container">
<pre class="src src-makefile"><span class="org-makefile-targets">TAGS</span>:
<span class="org-whitespace-indentation">        </span>rm -f TAGS
<span class="org-whitespace-indentation">        </span>find $$(pwd) \( -name \*.el \
<span class="org-whitespace-indentation">                    </span> -o -name \*.[chCH] \
<span class="org-whitespace-indentation">                    </span> \) -print | /usr/bin/ctags -e -
</pre>
</div>

<p>
You can create a <code>TAGS</code> file by using <code>M-x compile RET tags RET</code>.  Every time
you changes your source file, you need to regenerate the tag file.
</p>

<p>
Alternatively,
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"etags"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Tags enhancements.</span>
    (try-require 'sure-tags))
</pre>
</div>

<p>
will make sure that <code>TAGS</code> file exists (and builds it if it doesn&rsquo;t), allowing
you to
</p>

<ul class="org-ul">
<li>first rebuild the <code>TAGS</code> file or</li>
<li>specify a new one</li>
</ul>

<p>
when the search fails.
</p>
</div>
</div>

<div id="outline-container-org4e16fef" class="outline-4">
<h4 id="org4e16fef">Selecting a Tags Table</h4>
<div class="outline-text-4" id="text-org4e16fef">
<p>
After this, you can select the tag file to use with the command
<code>M-x visit-tags-table RET</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">List of file names of tags tables to search.</span>
  (<span class="org-keyword">setq</span> tags-table-list
        '(
          <span class="org-string">"~/TAGS"</span>
          <span class="org-comment-delimiter">;; </span><span class="org-comment">"/usr/local/lib/emacs/src/TAGS"</span>
          <span class="org-comment-delimiter">;; </span><span class="org-comment">"/usr/share/texmf-texlive/tex/latex/TAGS"</span>
          ))
</pre>
</div>
</div>
</div>

<div id="outline-container-org497dbe4" class="outline-4">
<h4 id="org497dbe4">Finding a Tag (go to function definition)</h4>
<div class="outline-text-4" id="text-org497dbe4">
<div class="note">
<p>
New package Xref replaces Etags&rsquo;s front-end and UI.
</p>

<p>
The new package Xref provides a generic framework and new commands to
find and move to definitions of functions, macros, data structures
etc., as well as go back to the location where you were before moving
to a definition.  It supersedes and obsoletes many Etags commands.
</p>

</div>

<p>
You can <b>go to</b> the first <b>definition</b> of a tag (matching your regexp) &#x2013; <b>according</b>
<b>to TAGS file</b> &#x2013; by using <code>M-x xref-find-definitions</code> (bound to <code>M-.</code>).  The default
tag is the identifier under the cursor.
</p>

<p>
If <code>M-.</code> brings up the wrong method, you can type <code>C-u M-.</code> to continue searching
for the <b>next definition</b> with the same name.
</p>

<p>
Use <code>M-,~ (~M-x xref-pop-marker-stack</code>) to <b>jump back</b> to where you last invoked <code>M-.</code>.
</p>

<p>
XXX See <a href="http://marmalade-repo.org/packages/jump-dls">http://marmalade-repo.org/packages/jump-dls</a> to jump to the source of the
symbol at point using a number of possible methods, such as semantic, tags, etc.
</p>
</div>
</div>

<div id="outline-container-orgea6d704" class="outline-4">
<h4 id="orgea6d704">Select from multiple TAGS files</h4>
<div class="outline-text-4" id="text-orgea6d704">
<p>
You can search for <b>occurrences</b> of tags that match you regexp on all files in
the TAGS table, by using <code>M-x tags-search RET</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "etags"</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; Select from multiple tags.</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(try-require 'etags-select))</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"etags-select"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Do a `</span><span class="org-comment"><span class="org-constant">find-tag-at-point</span></span><span class="org-comment">', and display all exact matches.</span>
    (global-set-key (kbd <span class="org-string">"M-?"</span>) #'etags-select-find-tag-at-point))
</pre>
</div>

<p>
However, the default Emacs&rsquo; etag feature is not quite good. You should use etags
provided by Helm.  Instead of activating <code>etags-select-goto-tag</code>, try
<code>helm-etags-select</code>.  If the project is big, it take some time to load tag file.
But when it is done, the next search will be very fast.
</p>

<p>
See <a href="http://truongtx.me/2014/04/20/emacs-javascript-completion-and-refactoring/">http://truongtx.me/2014/04/20/emacs-javascript-completion-and-refactoring/</a>.
</p>
</div>
</div>

<div id="outline-container-org9b05476" class="outline-4">
<h4 id="org9b05476">Find Emacs Lisp symbol definition</h4>
<div class="outline-text-4" id="text-org9b05476">
<p>
Find the definition of the Emacs Lisp symbol near point:
</p>

<dl class="org-dl">
<dt><code>C-x F</code></dt><dd>Find <b>function</b>.</dd>

<dt><code>C-x K</code></dt><dd>Find function <b>bound to key</b> sequence.</dd>

<dt><code>C-x V</code></dt><dd>Find <b>variable</b>.</dd>

<dt><code>M-x find-face-definition</code></dt><dd>Find <b>face</b>.</dd>
</dl>

<p>
Use <code>C-x 4</code> for displaying in another window, and <code>C-x 5</code> for displaying in
another frame.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Find the definition of the Emacs Lisp function or variable near point.</span>
  (find-function-setup-keys)
</pre>
</div>

<p>
Go to source code for symbol at point:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"lisp-mode"</span>

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-goto-lisp-symbol-at-point</span> ()
      <span class="org-doc">"Go to the definition of the Emacs Lisp symbol at point."</span>
      (<span class="org-keyword">interactive</span>)
      (<span class="org-keyword">require</span> '<span class="org-constant">thingatpt</span>)              <span class="org-comment-delimiter">; </span><span class="org-comment">XXX use xref-find-definitions instead?</span>
      (<span class="org-keyword">let</span> ((sym (symbol-at-point)))    <span class="org-comment-delimiter">; </span><span class="org-comment">or (find-tag-default) or (current-word)?</span>
        (funcall (<span class="org-keyword">pcase</span> sym
                   ((pred facep)           'find-face)
                   ((pred symbol-function) 'find-function)
                   (_                      'find-variable))
                 sym)))

    (define-key emacs-lisp-mode-map (kbd <span class="org-string">"M-."</span>) #'leuven-goto-lisp-symbol-at-point))
</pre>
</div>
</div>
</div>

<div id="outline-container-org51f722d" class="outline-4">
<h4 id="org51f722d">dump-jump (go to definition)</h4>
<div class="outline-text-4" id="text-org51f722d">
<p>
With this package, you can jump to a definition (of the symbol at point) for
multiple languages without any setup (e.g. <b>no <code>TAGS</code> file is needed anymore</b>).
</p>

<p>
Dumb Jump uses
</p>
<ul class="org-ul">
<li>ripgrep <code>rg</code> (the best <code>grep</code> alternative),</li>
<li>The Silver Searcher <code>ag</code>, or</li>
<li>falls back to <code>grep</code></li>
</ul>
<p>
to find potential definitions of a function or variable under point.
</p>

<p>
It uses a set of regular expressions based on the file extension, or <code>major-mode</code>,
of the current buffer.
</p>

<p>
See <a href="https://github.com/jacktasia/dumb-jump">https://github.com/jacktasia/dumb-jump</a>.
</p>

<p>
Keyboard shortcuts:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Command</th>
<th scope="col" class="org-left">Leuven</th>
<th scope="col" class="org-left">Sublime Text</th>
<th scope="col" class="org-left">Visual Studio</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Go to definition</td>
<td class="org-left">C-M-g</td>
<td class="org-left">F12</td>
<td class="org-left">F12</td>
</tr>

<tr>
<td class="org-left">Back (can be called multiple times)</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Open definition to the side</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">C-k F12</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">Quick look</td>
<td class="org-left">C-M-y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">XXX IntelliJ IDEA:</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">C-f1</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Quick Definition View: C-S-i</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Quick Documentation View: C-q</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"dumb-jump-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Use Helm as selector when there are multiple choices.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq dumb-jump-selector 'helm)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Prefer to use `</span><span class="org-comment"><span class="org-constant">rg</span></span><span class="org-comment">' over `</span><span class="org-comment"><span class="org-constant">ag</span></span><span class="org-comment">'.</span>
    (<span class="org-keyword">setq</span> dumb-jump-prefer-searcher 'rg)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Number of seconds a grep/find command can take before being warned to use</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">ag and config.</span>
    (<span class="org-keyword">setq</span> dumb-jump-max-find-time 5)

    (global-set-key (kbd <span class="org-string">"M-g j"</span>) #'dumb-jump-go)
    (global-set-key (kbd <span class="org-string">"&lt;f12&gt;"</span>) #'dumb-jump-go)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Conflict when GDB'ing Emacs under</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Win32.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-M-g") #'dumb-jump-go)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-c S") #'dumb-jump-go)</span>

    (global-set-key (kbd <span class="org-string">"M-g o"</span>) #'dumb-jump-go-other-window)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-M-o") #'dumb-jump-go-other-window)</span>

    (global-set-key (kbd <span class="org-string">"M-g x"</span>) #'dumb-jump-go-prefer-external)
    (global-set-key (kbd <span class="org-string">"M-g z"</span>) #'dumb-jump-go-prefer-external-other-window)

    (global-set-key (kbd <span class="org-string">"M-g P"</span>) #'dumb-jump-back)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key prog-mode-map (kbd "C-M-q") nil)</span>

    (global-set-key (kbd <span class="org-string">"M-g y"</span>) #'dumb-jump-quick-look)
    (global-set-key (kbd <span class="org-string">"C-M-y"</span>) #'dumb-jump-quick-look)

    (dumb-jump-mode)
)
</pre>
</div>

<div class="note">
<p>
<code>rg</code> is faster, but its results aren&rsquo;t deterministic and it doesn&rsquo;t support
<b>multiline</b> search or full <b>PCRE</b>, that&rsquo;s where <code>ag</code> is useful.
</p>

</div>

<p>
Need to debug it?
</p>

<ul class="org-ul">
<li>If <code>dumb-jump-go</code> fails, search the same string with <code>helm-projectile-ag</code>.</li>
<li>If <code>helm-projectile-ag</code> fails, see <code>helm-ag--last-command</code> and make it from
command line.</li>
<li>If it fails, try it with plain <code>ag</code> without all the flags.</li>
<li>If it fails, try it with alternative tool like <code>grep</code> or <code>ack</code>.</li>
</ul>

<p>
(from <a href="https://kozikow.com/2016/05/21/nice-new-emacs-package-dumb-jump-el/">https://kozikow.com/2016/05/21/nice-new-emacs-package-dumb-jump-el/</a>)
</p>
</div>
</div>
</div>

<div id="outline-container-org8bee6d2" class="outline-3">
<h3 id="org8bee6d2">Emacs Development Environment</h3>
<div class="outline-text-3" id="text-org8bee6d2">
</div>
<div id="outline-container-orgf1e3a08" class="outline-4">
<h4 id="orgf1e3a08">Collection of Emacs Development Environment Tools</h4>
<div class="outline-text-4" id="text-orgf1e3a08">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 28.4 (info "(emacs)EDE")</span>

  (leuven--section <span class="org-string">"28.4 Emacs Development Environment"</span>)
</pre>
</div>

<p>
CEDET (integrated into Emacs 23.2) brings improvements over a plain TAGS file.
It provides:
</p>

<dl class="org-dl">
<dt><a href="http://www.gnu.org/software/emacs/manual/semantic.html">Semantic</a></dt><dd>A <b>parser</b> and code analyzer which provides <b>smart completion</b>
(&ldquo;Intellisense&rdquo;).</dd>

<dt>EDE</dt><dd><p>
A <b>project management</b> system which can <b>generate Makefiles</b> to compile your
code for you.
</p>

<div class="tip">
<p>
Projectile is another Emacs library providing easy project management and
navigation.  The concept of a project is pretty basic &#x2013; just a folder
containing special file.  Git repos are considered projects by default.  If
you want to mark a folder manually as a project just create an empty
<code>.projectile</code> file in it.
</p>

</div></dd>

<dt>SRecode</dt><dd>A template / <b>code generation</b> system which can convert tags from semantic
back into code.</dd>

<dt>COGRE (COnnected GRaph Editor)</dt><dd>A <b>UML diagram editor</b> which can generate code from a class diagram that you
draw in Emacs.</dd>
</dl>

<p>
See <a href="http://cedet.sourceforge.net/languagesupport.shtml">supported languages</a>.
</p>

<p>
The commands to display <b>symbol references</b> are:
</p>

<dl class="org-dl">
<dt><code>C-c , g</code></dt><dd><code>semantic-symref-symbol</code>.</dd>

<dt><code>C-c , G</code></dt><dd><code>semantic-symref</code> (current tag).</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">unless</span> (string&lt; emacs-version <span class="org-string">"23.2"</span>)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Enable global EDE (project management) features.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-ede-mode 1)</span>

    (<span class="org-keyword">setq</span> semantic-default-submodes
          '(
            <span class="org-comment-delimiter">;; </span><span class="org-comment">Turn Semantic DB mode on (Semantic parsers store the results of</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">parsing source code in a database file, which can be saved for</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">future Emacs sessions).</span>
            global-semanticdb-minor-mode

            <span class="org-comment-delimiter">;; </span><span class="org-comment">The idle scheduler will automatically reparse buffers in idle</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">time.</span>
            global-semantic-idle-scheduler-mode <span class="org-comment-delimiter">; </span><span class="org-comment">[minimum-features]</span>

            <span class="org-comment-delimiter">;; </span><span class="org-comment">Display a summary of the symbol at point in the echo area</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">(~ ElDoc).</span>
            global-semantic-idle-summary-mode <span class="org-comment-delimiter">; </span><span class="org-comment">[code-helpers]</span>

            <span class="org-comment-delimiter">;; </span><span class="org-comment">Display a tooltip with a list of possible completions near the</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">cursor.</span>
            global-semantic-idle-completions-mode <span class="org-comment-delimiter">; </span><span class="org-comment">[gaudy-code-helpers]</span>

            <span class="org-comment-delimiter">;; </span><span class="org-comment">Turn Semantic MRU Bookmarks on (keep track of the Most</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">Recently Used tags).</span>
            global-semantic-mru-bookmark-mode

            <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable Semantic-Stickyfunc mode (display a header line that shows</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">the declaration line of the function or tag).</span>
            global-semantic-stickyfunc-mode <span class="org-comment-delimiter">; </span><span class="org-comment">[gaudy-code-helpers]</span>

            <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable Semantic-Highlight-Func mode.</span>
            global-semantic-highlight-func-mode <span class="org-comment-delimiter">; </span><span class="org-comment">[excessive-code-helpers]</span>

            <span class="org-comment-delimiter">;; </span><span class="org-comment">Turn on all active decorations.  Show Method Separators.</span>
            global-semantic-decoration-mode <span class="org-comment-delimiter">; </span><span class="org-comment">[gaudy-code-helpers]</span>
            ))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">XXX If prog-mode, then Semantic will be launched after Emacs init, as</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">the scratch buffer is in Emacs Lisp...</span>
    (add-hook 'java-mode-hook #'semantic-mode)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Enable parser features (Semantic mode)</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">and install a `</span><span class="org-comment"><span class="org-constant">Development</span></span><span class="org-comment">' menu on</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">the menu-bar.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Smart completion, and display of information for tags &amp; classes.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(require 'semantic/ia)</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(require 'semantic/db)</span>

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"semantic"</span>

      (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--semantic</span> ()
        <span class="org-comment-delimiter">;; </span><span class="org-comment">Automatically complete whatever symbol you are typing.</span>
        (local-set-key
          (kbd <span class="org-string">"C-c ?"</span>) #'semantic-ia-complete-symbol) <span class="org-comment-delimiter">; </span><span class="org-comment">Better binding: `</span><span class="org-comment"><span class="org-constant">M-/</span></span><span class="org-comment">'?</span>

        <span class="org-comment-delimiter">;; </span><span class="org-comment">Jump to the definition of the symbol under cursor.</span>
        (local-set-key
          (kbd <span class="org-string">"C-c j"</span>) #'semantic-ia-fast-jump) <span class="org-comment-delimiter">; </span><span class="org-comment">Where a symbol is declared.</span>

        <span class="org-comment-delimiter">;; </span><span class="org-comment">Show the documentation of the symbol under cursor.</span>
        (local-set-key
          (kbd <span class="org-string">"C-c q"</span>) #'semantic-ia-show-doc) <span class="org-comment-delimiter">; </span><span class="org-comment">Show javadoc of the right method.</span>

        <span class="org-comment-delimiter">;; </span><span class="org-comment">Show a summary about the symbol under cursor.</span>
        (local-set-key
          (kbd <span class="org-string">"C-c s"</span>) #'semantic-ia-show-summary)


        <span class="org-comment-delimiter">;; </span><span class="org-comment">Show possible public member functions or data members (when at `.'</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">or `</span><span class="org-comment"><span class="org-constant">-&gt;</span></span><span class="org-comment">' after an object name).</span>
        (local-set-key
          (kbd <span class="org-string">"C-c &gt;"</span>) #'semantic-complete-analyze-inline)

        <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Toggle between the implementation and a prototype of symbol under</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">;; cursor.</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">(local-set-key</span>
        <span class="org-comment-delimiter">;;   </span><span class="org-comment">(kbd "C-c p") #'semantic-analyze-proto-impl-toggle) ; vs Projectile.</span>

        <span class="org-comment-delimiter">;; </span><span class="org-comment">Visit the header file under cursor.</span>
        (local-set-key
          (kbd <span class="org-string">"C-c ="</span>) #'semantic-decoration-include-visit)


        <span class="org-comment-delimiter">;; </span><span class="org-comment">Unfold the block under cursor.</span>
        (local-set-key
          (kbd <span class="org-string">"C-c +"</span>) #'semantic-tag-folding-show-block)

        <span class="org-comment-delimiter">;; </span><span class="org-comment">Fold the block under cursor.</span>
        (local-set-key
          (kbd <span class="org-string">"C-c -"</span>) #'semantic-tag-folding-fold-block)

        <span class="org-comment-delimiter">;; </span><span class="org-comment">C-c C-c is not a prefix key!</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Unfold all.</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">(local-set-key</span>
        <span class="org-comment-delimiter">;;   </span><span class="org-comment">(kbd "C-c C-c +") #'semantic-tag-folding-show-all)</span>
        <span class="org-comment-delimiter">;;</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Fold all.</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">(local-set-key</span>
        <span class="org-comment-delimiter">;;   </span><span class="org-comment">(kbd "C-c C-c -") #'semantic-tag-folding-fold-all)</span>
        )

      (add-hook 'prog-mode-hook #'leuven--semantic)

      (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--c-mode-semantic</span> ()
        <span class="org-doc">"Completion on `.' or `</span><span class="org-doc"><span class="org-constant">-&gt;</span></span><span class="org-doc">'."</span>
        (local-set-key (kbd <span class="org-string">"."</span>) #'semantic-complete-self-insert)
        (local-set-key (kbd <span class="org-string">"&gt;"</span>) #'semantic-complete-self-insert)
        (local-set-key (kbd <span class="org-string">"C-c C-r"</span>) #'semantic-symref))

      (add-hook 'c-mode-common-hook #'leuven--c-mode-semantic))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Note that this will apply to all</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">cc-modes, e.g. c-mode, c++-mode,</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">php-mode, csharp-mode, awk-mode.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Hooks, specific for Semantic.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--semantic-imenu</span> ()
      (imenu-add-to-menubar <span class="org-string">"TAGS"</span>))

    (add-hook 'semantic-init-hooks #'leuven--semantic-imenu)

    )
</pre>
</div>
</div>
</div>

<div id="outline-container-org5e5747e" class="outline-4">
<h4 id="org5e5747e">Advanced Code Browsing</h4>
<div class="outline-text-4" id="text-org5e5747e">
<p>
Some people use CEDET in combination with <a href="http://www.xemacs.org/Documentation/packages/html/ecb_2.html">ECB (the Emacs Code Browser)</a>, which
provides views of directories and files.
</p>

<p>
Keyboard navigation:
</p>

<dl class="org-dl">
<dt><code>C-c . g d</code></dt><dd>Go to directories.</dd>

<dt><code>C-c . g s</code></dt><dd>Go to sources.</dd>

<dt><code>C-c . g m</code></dt><dd>Go to methods.</dd>

<dt><code>C-c . g h</code></dt><dd>Go to history.</dd>

<dt><code>C-c . g 1</code></dt><dd>Go to edit buffer.</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Emacs Code Browser.</span>
  (custom-set-variables '(ecb-options-version <span class="org-string">"2.40"</span>))
  (try-require 'ecb-autoloads)
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ecb-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Trick for starting ECB 2.40 (with CEDET merged in Emacs since 23.2).</span>
    (<span class="org-keyword">require</span> '<span class="org-constant">semantic/analyze</span>)
    (<span class="org-keyword">provide</span> '<span class="org-constant">semantic-analyze</span>)
    (<span class="org-keyword">provide</span> '<span class="org-constant">semantic-ctxt</span>)
    (<span class="org-keyword">provide</span> '<span class="org-constant">semanticdb</span>)
    (<span class="org-keyword">provide</span> '<span class="org-constant">semanticdb-find</span>)
    (<span class="org-keyword">provide</span> '<span class="org-constant">semanticdb-mode</span>)
    (<span class="org-keyword">provide</span> '<span class="org-constant">semantic-load</span>)

    (<span class="org-keyword">setq</span> stack-trace-on-error t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't show tip of the day at start time of ECB.</span>
    (<span class="org-keyword">setq</span> ecb-tip-of-the-day nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Toggle activation of ECB (between `</span><span class="org-comment"><span class="org-constant">ecb-activate</span></span><span class="org-comment">' and `</span><span class="org-comment"><span class="org-constant">ecb-deactivate</span></span><span class="org-comment">').</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-c e") #'ecb-minor-mode)</span>
  )
</pre>
</div>

<p>
If you&rsquo;ve installed CEDET and ECB, EmacsAssist is worth trying out:
<a href="http://www.mail-archive.com/gnu-emacs-sources@gnu.org/msg00292.html">http://www.mail-archive.com/gnu-emacs-sources@gnu.org/msg00292.html</a>
</p>

<p>
It uses CEDET to provide a handy symbols browser for the current file, that
narrows down the list as you type substrings.  Tastes differ, but I for one
really like this.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (try-require 'eassist)
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"eassist"</span>

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--c-mode-eassist</span> ()
      (local-set-key (kbd <span class="org-string">"C-c t"</span>) #'eassist-switch-h-cpp)
      (local-set-key (kbd <span class="org-string">"C-x t"</span>) #'eassist-switch-h-cpp)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(local-set-key (kbd "C-c e") #'eassist-list-methods)</span>
      )

    (add-hook 'c-mode-common-hook #'leuven--c-mode-eassist))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Note that this will apply to all</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">cc-modes, e.g. c-mode, c++-mode,</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">php-mode, csharp-mode, awk-mode.</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 28 ends here.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org35107f3" class="outline-4">
<h4 id="org35107f3">Projectile</h4>
<div class="outline-text-4" id="text-org35107f3">
<p>
Projectile&rsquo;s features.
</p>

<dl class="org-dl">
<dt>C-c p p</dt><dd><b>Switch</b> between <b>projects</b> you have worked on.</dd>
</dl>
</div>

<div id="outline-container-org8f83c86" class="outline-5">
<h5 id="org8f83c86">Navigating project files</h5>
<div class="outline-text-5" id="text-org8f83c86">
<dl class="org-dl">
<dt>C-c p f</dt><dd>Prompt you for a <b>file</b> in project to <b>jump to</b>.</dd>

<dt>C-c p d</dt><dd>Prompt you for a <b>directory</b> in project to <b>jump to</b>.</dd>

<dt>C-c p e</dt><dd>Prompt you for a <b>recently visited file</b> in the project to <b>jump to</b>.</dd>

<dt>C-c p b</dt><dd>Prompt you for a project <b>buffer</b> to <b>jump to</b>.</dd>

<dt>C-c p l</dt><dd><b>Jump to</b> a <b>file in a directory</b>.</dd>
</dl>
</div>
</div>

<div id="outline-container-org9f18b95" class="outline-5">
<h5 id="org9f18b95">Running grep and occur</h5>
<div class="outline-text-5" id="text-org9f18b95">
<dl class="org-dl">
<dt>C-c p s g (or C-c p g in Emacs-Leuven)</dt><dd>Run <b><code>grep</code></b> on the files in the project.</dd>

<dt>C-c p s s</dt><dd>Run <b><code>ag</code></b> on the files in the project. [Helm-Projectile]</dd>

<dt>C-c p o</dt><dd>Run <b><code>multi-occur</code></b> on all project&rsquo;s buffers currently open.</dd>
</dl>
</div>
</div>

<div id="outline-container-orgf54249b" class="outline-5">
<h5 id="orgf54249b">X</h5>
<div class="outline-text-5" id="text-orgf54249b">
<dl class="org-dl">
<dt>C-c p R</dt><dd><b>Regenerate</b> project <b><code>etags</code> or <code>gtags</code></b> (requires <code>ggtags</code>).</dd>
</dl>
</div>
</div>

<div id="outline-container-orge6441ac" class="outline-5">
<h5 id="orge6441ac">Running tests and compilation commands</h5>
<div class="outline-text-5" id="text-orge6441ac">
<dl class="org-dl">
<dt>C-c p P</dt><dd>Run a <b>test</b> command (<code>make test</code>) for the current project.</dd>

<dt>C-c p c</dt><dd>Run a <b>compilation</b> command (<code>make</code>) for the current project.</dd>

<dt>C-c p u</dt><dd>Run a <b>run</b> command for the current project.</dd>
</dl>
</div>
</div>

<div id="outline-container-org235551f" class="outline-5">
<h5 id="org235551f">Switching between tests and source files</h5>
<div class="outline-text-5" id="text-org235551f">
<dl class="org-dl">
<dt>C-c p t</dt><dd><b>Toggle between</b> an <b>implementation</b> file <b>and</b> its <b>test</b> file.</dd>

<dt>C-c p T</dt><dd><b>Jump to</b> a <b>test file</b> in project.</dd>
</dl>
</div>
</div>

<div id="outline-container-orga968be0" class="outline-5">
<h5 id="orga968be0">Switching between controllers and views</h5>
<div class="outline-text-5" id="text-orga968be0">
<dl class="org-dl">
<dt>C-c p a</dt><dd><b>Switch between files</b> with <b>same name</b> but <b>different extensions</b> (e.g. <code>.h</code> &lt;-&gt;
<code>.c</code> / <code>.cpp</code>).</dd>
</dl>
</div>
</div>

<div id="outline-container-org21de962" class="outline-5">
<h5 id="org21de962">Running VC</h5>
<div class="outline-text-5" id="text-org21de962">
<dl class="org-dl">
<dt>C-c p v</dt><dd>Open version control for the current project.</dd>
</dl>
</div>
</div>

<div id="outline-container-org3e6f145" class="outline-5">
<h5 id="org3e6f145">Opening Dired</h5>
<div class="outline-text-5" id="text-org3e6f145">
<dl class="org-dl">
<dt>C-c p D</dt><dd>Open <b>Dired</b> at the root of the project.</dd>
</dl>
</div>
</div>

<div id="outline-container-org49c1a37" class="outline-5">
<h5 id="org49c1a37">Running a shell command</h5>
<div class="outline-text-5" id="text-org49c1a37">
<dl class="org-dl">
<dt>C-c p !</dt><dd>Run a shell command in the project root.</dd>
</dl>
</div>
</div>

<div id="outline-container-org9a5b6c5" class="outline-5">
<h5 id="org9a5b6c5">X</h5>
<div class="outline-text-5" id="text-org9a5b6c5">
<dl class="org-dl">
<dt>C-c p k</dt><dd><b>Kill all</b> project <b>buffers</b>.</dd>

<dt>C-c p r</dt><dd><b>Replace</b> literal string in project.</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"projectile-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Turn on projectile mode by default for all file types</span>
    (projectile-mode)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(projectile-global-mode) ??</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add keymap prefix.</span>
    (define-key projectile-mode-map (kbd <span class="org-string">"C-c p"</span>)   #'projectile-command-map)

    (define-key projectile-mode-map (kbd <span class="org-string">"C-c p g"</span>) #'projectile-grep)

    (<span class="org-keyword">setq</span> projectile-completion-system 'helm)
    (<span class="org-keyword">setq</span> projectile-completion-system 'helm-comp-read)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Turn on Helm bindings for projectile</span>
    (helm-projectile-on)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; For large projects.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq helm-projectile-sources-list</span>
    <span class="org-comment-delimiter">;;       </span><span class="org-comment">'(helm-source-projectile-projects</span>
    <span class="org-comment-delimiter">;;         </span><span class="org-comment">helm-source-projectile-files-list))</span>

  )

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"projectile"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Indexing method.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq projectile-indexing-method 'native)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable caching of the project's files unconditionally.</span>
    (<span class="org-keyword">setq</span> projectile-enable-caching t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Action invoked AFTER SWITCHING PROJECTS with `C-c p p'.</span>
    (<span class="org-keyword">setq</span> projectile-switch-project-action 'helm-projectile-find-file)
                                        <span class="org-comment-delimiter">;; </span><span class="org-comment">'projectile-dired</span>
                                        <span class="org-comment-delimiter">;; </span><span class="org-comment">'projectile-find-file ; Default.</span>
                                        <span class="org-comment-delimiter">;; </span><span class="org-comment">'projectile-find-file-in-known-projects</span>
                                        <span class="org-comment-delimiter">;; </span><span class="org-comment">'projectile-find-file-dwim</span>
                                        <span class="org-comment-delimiter">;; </span><span class="org-comment">'projectile-find-dir</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't echo messages that are not errors.</span>
    (<span class="org-keyword">setq</span> projectile-verbose nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Always ignore .class files.</span>
    (add-to-list 'projectile-globally-ignored-file-suffixes <span class="org-string">".class"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Ignore remote projects.</span>
    (<span class="org-keyword">setq</span> projectile-ignored-project-function 'file-remote-p)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Mode line lighter prefix for Projectile.</span>
    (<span class="org-keyword">setq</span> projectile-mode-line-prefix <span class="org-string">" P"</span>)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq projectile-mode-line-function</span>
    <span class="org-comment-delimiter">;;       </span><span class="org-comment">'(lambda ()</span>
    <span class="org-comment-delimiter">;;          </span><span class="org-comment">(if (and (projectile-project-p)</span>
    <span class="org-comment-delimiter">;;                   </span><span class="org-comment">(not (file-remote-p default-directory)))</span>
    <span class="org-comment-delimiter">;;              </span><span class="org-comment">(format " P[%s]" (projectile-project-name))</span>
    <span class="org-comment-delimiter">;;            </span><span class="org-comment">"")))</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Command to use with ‘</span><span class="org-comment"><span class="org-constant">projectile-run-project</span></span><span class="org-comment">’.</span>
    (<span class="org-keyword">setq</span> projectile-project-run-cmd <span class="org-string">"mintty /bin/bash -l -e '../../start.sh'"</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">ARCHIBUS.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">For ARCHIBUS.</span>
    (add-to-list 'projectile-other-file-alist '(<span class="org-string">"axvw"</span> <span class="org-string">"js"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">Switch from AXVW -&gt; JS.</span>
    (add-to-list 'projectile-other-file-alist '(<span class="org-string">"js"</span> <span class="org-string">"axvw"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">Switch from JS -&gt; AXVW.</span>

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-find-file-archibus-log</span> ()
      (<span class="org-keyword">interactive</span>)
      (<span class="org-keyword">when-let</span> ((root (projectile-project-root))
                 (logfile <span class="org-string">"WEB-INF/config/archibus.log"</span>))
          (<span class="org-keyword">if</span> (file-exists-p (expand-file-name logfile root))
              (find-file (expand-file-name logfile root))
            (<span class="org-warning">user-error</span> <span class="org-string">"You're not in an ARCHIBUS project"</span>))))
    (define-key projectile-mode-map (kbd <span class="org-string">"C-c p A"</span>) #'leuven-find-file-archibus-log)
  )
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgbebdc48" class="outline-4">
<h4 id="orgbebdc48">Refactoring</h4>
<div class="outline-text-4" id="text-orgbebdc48">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"emr-autoloads"</span>
    (add-hook 'prog-mode-hook #'emr-initialize)
    (define-key prog-mode-map (kbd <span class="org-string">"M-RET"</span>) #'emr-show-refactor-menu))
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb7079e7" class="outline-2">
<h2 id="orgb7079e7">Abbrevs (Snippets, Auto Replacements, or live Code Templates)</h2>
<div class="outline-text-2" id="text-orgb7079e7">
<p>
An &ldquo;abbrev&rdquo; is a <b>word</b> which has been defined (in a fixed list) to &ldquo;expand&rdquo;
into a specified <b>expansion</b>.
</p>

<p>
It allows you to write frequently used text more quickly.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 29 (info "(emacs)Abbrevs")</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-29-abbrevs <span class="org-string">"29 Abbrevs"</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">See (info "(autotype)") as well</span>
</pre>
</div>
</div>

<div id="outline-container-org3fe53d4" class="outline-3">
<h3 id="org3fe53d4">Controlling Abbrev Expansion</h3>
<div class="outline-text-3" id="text-org3fe53d4">
<p>
Inspired by <a href="http://macromates.com/">TextMate</a>.  In fact, many editors support <b>snippets</b>: Eclipse,
Notepad++, etc.
</p>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Add rv for &ldquo;REVIEW[who] text&rdquo; <a href="https://www.jetbrains.com/help/idea/using-live-templates-in-todo-comments.html">https://www.jetbrains.com/help/idea/using-live-templates-in-todo-comments.html</a></b><br />
nil</div>

<p>
For complex templates, I use <code>YASnippet</code>.  For example, new file templates (where
it&rsquo;s Lisp evaluation is handy), class and function templates with docblocks,
etc. I use it to reduce the repetitious parts of programming, and let me focus
on getting things done.
</p>

<p>
<code>YASnippet</code> does support mirror fields and transformations.  It also does support
multiple snippets with same name.  It will also expand snippets containing
non-word-constituent characters, which <code>abbrev</code> can&rsquo;t.  So I can&rsquo;t have <code>@p</code> expand
to <code>@param</code> with <code>abbrev</code>, but I can with <code>YASnippet</code>.
</p>

<p>
XXX Look at <a href="https://github.com/vderyagin/dotemacs/blob/master/conf/yasnippet-configuration.el">https://github.com/vderyagin/dotemacs/blob/master/conf/yasnippet-configuration.el</a>
</p>

<pre class="example">
# -*- mode: snippet -*-
# name: file.name
# key: hello
# --
Hello,$0 ${1:this} is a ${2:snippet}.
</pre>

<p>
Predefined YASnippet variables:
</p>
<ul class="org-ul">
<li><code>$0</code> indicates the position of the cursor after the template is expanded.</li>
<li><code>`yas-selected-text`</code> is used in <b>surround templates</b> and stands for the code
fragment to be wrapped.</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 29.3 Controlling (info "(emacs)Expanding Abbrevs")</span>

  (leuven--section <span class="org-string">"29.3 Controlling Expanding Abbrevs"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Yet Another Snippet extension for Emacs</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"yasnippet-autoloads"</span>
    (idle-require 'yasnippet))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"yasnippet"</span>
</pre>
</div>
</div>

<div id="outline-container-orgb2a6c0e" class="outline-4">
<h4 id="orgb2a6c0e">Organizing snippets</h4>
<div class="outline-text-4" id="text-orgb2a6c0e">
<p>
Where are the snippets?  <code>yas-snippet-dirs</code> is assumed to contain <b>directories of
modes</b> with snippets:
</p>

<ul class="org-ul">
<li><code>yas-installed-snippets-dir</code> (the bundled snippets), and</li>
<li><b>your own snippets</b> in the directory <code>~/.emacs.d/snippets</code>.</li>
</ul>

<p>
Load additional snippets.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add root directories that store the snippets.</span>
    (<span class="org-keyword">let</span> ((leuven-snippets              <span class="org-comment-delimiter">; </span><span class="org-comment">Additional YASnippets.</span>
           (concat leuven--directory <span class="org-string">"snippets"</span>))
          (org-snippets
           (concat leuven--local-repos-directory <span class="org-string">"yasnippet-org-mode"</span>)))

      (<span class="org-keyword">when</span> (file-directory-p org-snippets)
        (add-to-list 'yas-snippet-dirs org-snippets))

      (<span class="org-keyword">when</span> (file-directory-p leuven-snippets)
        (add-to-list 'yas-snippet-dirs leuven-snippets)))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">The first element (inserted last) is</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">always the user-created snippets</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">directory.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Use Snippet mode for files with a `</span><span class="org-comment"><span class="org-constant">yasnippet</span></span><span class="org-comment">' extension.</span>
    (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.yasnippet\\'"</span> . snippet-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc49667b" class="outline-4">
<h4 id="orgc49667b">Installation</h4>
<div class="outline-text-4" id="text-orgc49667b">
</div>
<div id="outline-container-org489fbc0" class="outline-5">
<h5 id="org489fbc0">Use YASnippet as a global minor mode</h5>
<div class="outline-text-5" id="text-org489fbc0">
<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable YASnippet in all buffers.</span>
    (yas-global-mode 1)
</pre>
</div>

<div class="tip">
<p>
Use <code>yas-global-mode</code> <b>after</b> you set yas-snippet-dirs. Otherwise you have to use
<code>yas-reload-all</code>.
</p>

</div>
</div>
</div>

<div id="outline-container-orgf3474b4" class="outline-5">
<h5 id="orgf3474b4">Use <code>yas-minor-mode</code> on a per-buffer basis</h5>
<div class="outline-text-5" id="text-orgf3474b4">
<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable YASnippet in programming modes only.</span>
    (add-hook 'prog-mode-hook #'yas-minor-mode)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"diminish-autoloads"</span>
      (diminish 'yas-minor-mode <span class="org-string">" y"</span>))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; No need to be so verbose.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq yas-verbosity 1)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Load the snippet tables.</span>
    (yas-reload-all)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Wrap around region.</span>
    (<span class="org-keyword">setq</span> yas-wrap-around-region t)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org815fd79" class="outline-4">
<h4 id="org815fd79">Expanding snippets</h4>
<div class="outline-text-4" id="text-org815fd79">
<dl class="org-dl">
<dt><code>C-c &amp; C-s</code></dt><dd>Insert snippet at point.</dd>
</dl>

<p>
Insert <b>code templates</b> (<i>snippets</i>) by pressing <code>TAB</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Bind `</span><span class="org-comment"><span class="org-constant">yas-expand</span></span><span class="org-comment">' to SPC.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key yas-minor-mode-map (kbd "&lt;tab&gt;") nil)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key yas-minor-mode-map (kbd "TAB") nil)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key yas-minor-mode-map (kbd "SPC") #'yas-expand)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't expand when you are typing in a string or comment.</span>
    (add-hook 'prog-mode-hook
              #'(lambda ()
                  (<span class="org-keyword">setq</span> yas-buffer-local-condition
                        '(<span class="org-keyword">if</span> (nth 8 (syntax-ppss))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Non-nil if in a string or comment.</span>
                             '(require-snippet-condition . force-in-comment)
                           t))))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">UI for selecting snippet when there are multiple candidates.</span>
    (<span class="org-keyword">setq</span> yas-prompt-functions '(yas-dropdown-prompt))
</pre>
</div>

<p>
YASnippet allows navigating through the data input fields, where you can specify
your own data.  Use the <code>TAB</code> key to go forward and the <code>Shift+TAB</code> keys to go back.
</p>
</div>
</div>

<div id="outline-container-org1c23d5d" class="outline-4">
<h4 id="org1c23d5d">Writing snippets</h4>
<div class="outline-text-4" id="text-org1c23d5d">
<p>
See <a href="http://cupfullofcode.com/snippet-expansion-with-yasnippet/">http://cupfullofcode.com/snippet-expansion-with-yasnippet/</a>.
</p>

<dl class="org-dl">
<dt><code>C-c &amp; C-n</code> (<code>yas-new-snippet</code>)</dt><dd>Creates a new snippet, pre-filled out with the basic structure.</dd>

<dt><code>C-c &amp; C-v</code></dt><dd><code>yas-visit-snippet-file</code>.</dd>
</dl>
</div>
</div>

<div id="outline-container-org0f1c198" class="outline-4">
<h4 id="org0f1c198">YASnippet menu</h4>
<div class="outline-text-4" id="text-org0f1c198">
<p>
After editing your snippets:
</p>

<ul class="org-ul">
<li><code>M-x yas-recompile-all</code> to compile all snippets,</li>

<li><code>M-x yas-reload-all</code> to reload them all.</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (global-set-key (kbd <span class="org-string">"C-c &amp; C-r"</span>) #'yas-reload-all)
</pre>
</div>

<p>
Automatically reload snippets after saving.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Automatically reload snippets after saving.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">recompile-and-reload-all-snippets</span> ()
      (<span class="org-keyword">interactive</span>)
      (<span class="org-keyword">when</span> (derived-mode-p 'snippet-mode)
        (yas-recompile-all)
        (yas-reload-all)
        (message <span class="org-string">"[Reloaded all snippets]"</span>)))

    (add-hook 'after-save-hook #'recompile-and-reload-all-snippets)
</pre>
</div>

<p>
Display all available snippets with <code>M-x yas-describe-tables</code> (or <code>C-c &amp; C-l</code> in
Emacs-Leuven):
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (global-set-key (kbd <span class="org-string">"C-c &amp; C-l"</span>) #'yas-describe-tables)
</pre>
</div>

<p>
See <a href="http://stackoverflow.com/questions/10155181/display-all-snippets-of-yasnippet">http://stackoverflow.com/questions/10155181/display-all-snippets-of-yasnippet</a>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">defvar</span> <span class="org-variable-name">leuven-contextual-menu-map</span>
      (<span class="org-keyword">let</span> ((map (make-sparse-keymap <span class="org-string">"Contextual menu"</span>)))
        (define-key map [help-for-help] (cons <span class="org-string">"Help"</span> 'help-for-help))
        (define-key map [seperator-two] '(menu-item <span class="org-string">"--"</span>))
        map)
      <span class="org-doc">"Keymap for the contextual menu."</span>)

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-popup-contextual-menu</span> (event <span class="org-type">&amp;optional</span> prefix)
      <span class="org-doc">"Popup a contextual menu."</span>
      (<span class="org-keyword">interactive</span> <span class="org-string">"@e \nP"</span>)
        (define-key leuven-contextual-menu-map [lawlist-major-mode-menu]
          `(menu-item ,(symbol-name major-mode)
            ,(mouse-menu-major-mode-map) <span class="org-builtin">:visible</span> t))
        (define-key leuven-contextual-menu-map (vector major-mode)
          `(menu-item ,(concat <span class="org-string">"Insert "</span> (symbol-name major-mode) <span class="org-string">" snippet"</span>)
            ,(gethash major-mode yas--menu-table)
              <span class="org-builtin">:visible</span> (yas--show-menu-p ',major-mode)))
        (popup-menu leuven-contextual-menu-map event prefix))

    (global-set-key [mouse-3] #'leuven-popup-contextual-menu)
</pre>
</div>
</div>
</div>

<div id="outline-container-orge1c0e70" class="outline-4">
<h4 id="orge1c0e70">Frequently Asked Questions</h4>
<div class="outline-text-4" id="text-orge1c0e70">
</div>
<div id="outline-container-org0d1c939" class="outline-5">
<h5 id="org0d1c939">Why is there an extra newline?</h5>
<div class="outline-text-5" id="text-org0d1c939">
<div class="org-src-container">
<pre class="src src-emacs-lisp">    (add-hook 'snippet-mode-hook
              #'(lambda ()
                  (<span class="org-keyword">setq</span> require-final-newline nil)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf805bb4" class="outline-5">
<h5 id="orgf805bb4">Why doesn&rsquo;t TAB expand a snippet?</h5>
<div class="outline-text-5" id="text-orgf805bb4">
<ol class="org-ol">
<li><p>
Check the mode line to see if there&rsquo;s <code>yas</code>. If not, then try
<code>M-x yas-minor-mode</code> to manually turn on the minor mode and try to expand the
snippet again.
</p>

<p>
If it works, then, you can add the following code to your <code>.emacs</code> before
loading YASnippet:
</p>

<pre class="example">
   (add-hook 'the-major-mode-hook #'yas-minor-mode-on)
</pre>

<p>
where <code>the-major-mode</code> is the major mode in which <code>yas-minor-mode</code> isn&rsquo;t enabled
by default.
</p>

<p>
You can also use the command <code>M-x yas-global-mode</code> to turn on YASnippet
automatically for all major modes.
</p></li>

<li><p>
If <code>yas-minor-mode</code> is on but the snippet still not expanded, then try to see
what command is bound to the <code>TAB</code> key: press <code>C-h k</code> and then press <code>TAB</code>. Emacs
will show you the result.
</p>

<p>
You&rsquo;ll see a buffer prompted by Emacs saying that <code>TAB</code> runs the command &ldquo;&#x2026;&rdquo;.
Alternatively, you might see <code>TAB</code> runs the command &ldquo;&#x2026;&rdquo;. Note the
difference between <code>TAB</code> and <code>TAB</code> where the latter has priority.
</p>

<p>
If you see <code>TAB</code> bound to a command other than <code>yas-expand</code> (e.g. in org-mode),
you can try a work around. See
<a href="https://github.com/capitaomorte/yasnippet/blob/master/doc/faq.org">https://github.com/capitaomorte/yasnippet/blob/master/doc/faq.org</a>.
</p></li>
</ol>
</div>
</div>

<div id="outline-container-org36b5428" class="outline-5">
<h5 id="org36b5428">yas-key-syntaxes</h5>
<div class="outline-text-5" id="text-org36b5428">
<p>
<code>yas-key-syntaxes</code> is the variable that allows you control the behavior &ldquo;don&rsquo;t
expand words finishing with the snippet key&rdquo;, even if:
</p>

<ul class="org-ul">
<li>the default syntax table for the major mode you are working on says that &ldquo;C-s&rdquo;
(for example) is two separate words, and</li>

<li>assuming you don&rsquo;t want to fix the major mode&rsquo;s behavior.</li>
</ul>

<p>
Find it at <a href="http://capitaomorte.github.io/yasnippet/snippet-reference.html#yas-key-syntaxes">http://capitaomorte.github.io/yasnippet/snippet-reference.html#yas-key-syntaxes</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Make the "yas-minor-mode"'s expansion behavior to take input word</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; including hyphen.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq yas-key-syntaxes '("w_" "w_." "^ "))</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">[default:</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">'("w" "w_" "w_." "w_.()"</span>
                                        <span class="org-comment-delimiter">;   </span><span class="org-comment">yas-try-key-from-whitespace)]</span>

    )
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf060126" class="outline-4">
<h4 id="orgf060126">Reference</h4>
<div class="outline-text-4" id="text-orgf060126">
<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Log level for `</span><span class="org-comment"><span class="org-constant">yas--message</span></span><span class="org-comment">'.</span>
    (<span class="org-keyword">setq</span> yas-verbosity 2)              <span class="org-comment-delimiter">; </span><span class="org-comment">Warning.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge89c39b" class="outline-4">
<h4 id="orge89c39b">Quickly create disposable YASnippets</h4>
<div class="outline-text-4" id="text-orge89c39b">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"auto-yasnippet-autoloads"</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "H-w") #'aya-create)</span>
      (global-set-key (kbd <span class="org-string">"H-y"</span>) #'aya-open-line))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf08f88d" class="outline-3">
<h3 id="orgf08f88d">Dynamic Abbrev Expansion</h3>
<div class="outline-text-3" id="text-orgf08f88d">
<p>
&ldquo;Dynamic abbrevs&rdquo; allow the meanings of abbreviations (expansions) to be
<b>determined automatically from the contents of the buffer</b>.  It is completely
independent of Abbrev mode.
</p>

<ul class="org-ul">
<li><code>M-/</code> runs the command <code>dabbrev-expand</code> by default.  Expand previous word
&ldquo;dynamically&rdquo;.  <b>Expands to the most recent, preceding word</b> for which this is
a prefix.</li>

<li><code>C-M-/</code> runs the command <code>dabbrev-completion</code>.  Completion on current word.  Like
<code>M-/</code> but finds all expansions in the current buffer and <b>presents suggestions
for completion</b>.</li>
</ul>

<p>
See <a href="#orge11bfbe">completion for symbol names</a>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 29.7 (info "(emacs)Dabbrev Customization")</span>

  (leuven--section <span class="org-string">"29.7 Dabbrev Customization"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "dabbrev"</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; Preserve case when expanding the abbreviation.</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(setq dabbrev-case-replace nil))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf766f0c" class="outline-3">
<h3 id="orgf766f0c">Code Completion</h3>
<div class="outline-text-3" id="text-orgf766f0c">
<p>
However, there are 3 amazing &ldquo;intelligent guessing completion frameworks&rdquo; in
Emacs:
</p>

<ul class="org-ul">
<li>&ldquo;Hippie&rdquo; expansion,</li>
<li>Auto-Complete and</li>
<li>Company.</li>
</ul>

<p>
Hippe-expand is great (can complete whole code blocks for you, making it possible
to e.g. cycle through all if-tests in your projects).
</p>

<p>
But Auto-Complete and Company mode are even better. They&rsquo;ll give you a nice
IntelliSense style menu, will &ldquo;learn&rdquo; as you use it, and allows you to define
a file with the completions you&rsquo;d like to be available in the various languages.
</p>

<p>
I prefer Company over Auto-Complete but YMMV.
</p>
</div>

<div id="outline-container-orgdd70e65" class="outline-4">
<h4 id="orgdd70e65">&ldquo;Hippie&rdquo; expansion (Autotype)</h4>
<div class="outline-text-4" id="text-orgdd70e65">
<p>
Typically, <b>we bind <code>hippie-expand</code> to <code>M-/</code></b>, with <code>dabbrev-expand</code> (the standard
binding of <code>M-/</code>) providing one of the expansion possibilities.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Expand text trying various ways to find its expansion.</span>
  (global-set-key (kbd <span class="org-string">"M-/"</span>) #'hippie-expand) <span class="org-comment-delimiter">; </span><span class="org-comment">Built-in.</span>
</pre>
</div>

<div class="tip">
<p>
Would we want to bind <code>hippie-expand</code> on TAB, we should have to write a <code>smart-tab</code>
command which would look if the major mode is Org and then act differently&#x2026;
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"hippie-exp"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">List of expansion functions tried (in order) by `</span><span class="org-comment"><span class="org-constant">hippie-expand</span></span><span class="org-comment">'</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(completion strategy).</span>
    (<span class="org-keyword">setq</span> hippie-expand-try-functions-list
          '(<span class="org-comment-delimiter">;; </span><span class="org-comment">Searching the current buffer.</span>
            try-expand-dabbrev

            <span class="org-comment-delimiter">;; </span><span class="org-comment">Emacs Lisp symbol, as many characters as unique.</span>
            try-complete-lisp-symbol-partially

            <span class="org-comment-delimiter">;; </span><span class="org-comment">Emacs Lisp symbol.</span>
            try-complete-lisp-symbol

            <span class="org-comment-delimiter">;; </span><span class="org-comment">Searching visible window parts.</span>
            try-expand-dabbrev-visible

            <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Searching (almost) all other buffers (see</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">;; `</span><span class="org-comment"><span class="org-constant">hippie-expand-ignore-buffers</span></span><span class="org-comment">').</span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">try-expand-dabbrev-all-buffers</span>

            <span class="org-comment-delimiter">;; </span><span class="org-comment">File name, as many characters as unique.</span>
            try-complete-file-name-partially

            <span class="org-comment-delimiter">;; </span><span class="org-comment">File name.</span>
            try-complete-file-name))
</pre>
</div>

<p>
See <a href="https://github.com/dgutov/dot-emacs/blob/master/site-lisp/hippie.el">https://github.com/dgutov/dot-emacs/blob/master/site-lisp/hippie.el</a> for
a local var version of <code>hippie-expand-try-functions-list</code> for Emacs Lisp.
</p>

<p>
Configure Hippie-expand to also expand YASnippets (on the key used by
<code>hippie-expand</code>, then).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Integrate YASnippet with `</span><span class="org-comment"><span class="org-constant">hippie-expand</span></span><span class="org-comment">'.</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"yasnippet"</span>

      (add-to-list 'hippie-expand-try-functions-list
                   'yas-hippie-try-expand)))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Makes more sense when placed at the</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">top of the list.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org8b43c76" class="outline-4">
<h4 id="org8b43c76">Auto-Complete (&ldquo;IntelliSensy&rdquo; completion when writing code)</h4>
<div class="outline-text-4" id="text-org8b43c76">
<p>
Auto-Complete shows completions as you type, so you can fill in long words by
typing only a few characters &#x2013; really brilliant!
</p>

<p>
Auto-complete uses the variable <code>ac-modes</code> to decide whether to enable
auto-completion in a particular mode; by default, <code>org-mode</code> (which interprets the
<code>TAB</code> key) is not present in this list. So, to enable auto-completion in Org
mode, simply add it to the <code>ac-modes</code>:
</p>

<pre class="example">
(add-to-list 'ac-modes 'org-mode)
</pre>

<p>
Popups:
</p>

<ul class="org-ul">
<li><p>
<b>Completion menu</b>
</p>

<p>
Candidates suffix:
</p>
<ul class="org-ul">
<li>(nothing) &#x2013; means it is buffer string cache complete.</li>
<li><code>v</code> &#x2013; Variable</li>
<li><code>f</code> &#x2013; Function</li>
<li><code>s</code> &#x2013; Symbol</li>
<li><code>c</code> &#x2013; Constant</li>
<li><code>a</code> &#x2013; Abbrev, YASnippet</li>
<li><code>d</code> &#x2013; Dictionary, environment variable (e.g. <code>LC_CTYPE</code>)</li>
<li><code>m</code> &#x2013; Module</li>
</ul></li>

<li><b>Quick help</b> (tooltip appearing at the side of the completion menu)</li>
</ul>

<p>
According to the default settings, completion is done by <code>TAB</code> or <code>RET</code>:
</p>

<dl class="org-dl">
<dt><code>ac-expand</code> (<code>TAB</code>)</dt><dd>Select candidates in cycle.</dd>

<dt><code>ac-complete</code> (<code>RET</code>)</dt><dd>Complete a selected candidate immediately.</dd>
</dl>

<p>
There are other ways to select candidates:
</p>
<ul class="org-ul">
<li><code>M-1</code> to select candidate 1,</li>
<li><code>M-2</code> to select candidate 2,</li>
<li>and so on (until 9).</li>
</ul>

<p>
Other operations are enabled temporarily <b>once the completion is started</b>:
</p>

<dl class="org-dl">
<dt><code>C-n</code> or <code>C-p</code></dt><dd>Proceed to the <b>next match</b> or to the <b>previous match</b>.</dd>

<dt><code>C-s</code> (<code>ac-isearch</code>)</dt><dd><b>Filter</b> completion candidates.</dd>

<dt><code>&lt;C-down&gt;</code> or <code>C-M-n</code> (<code>ac-quick-help-scroll-down</code>)</dt><dd>Scroll down quick help.</dd>

<dt><code>&lt;C-up&gt;</code> or <code>C-M-p</code> (<code>ac-quick-help-scroll-up</code>)</dt><dd>Scroll up quick help.</dd>

<dt><code>&lt;F1&gt;</code> (or <code>C-?</code>, <code>ac-help</code>)</dt><dd><p>
Show additional <b>help</b> (for functions, arguments and objects) in <b>temporary
buffer</b>.
</p>

<p>
Use <code>C-M-v</code> (or <code>C-M-S-v</code>) to scroll down (or up).
</p></dd>

<dt><code>M-&lt;F1&gt;</code> (or <code>C-M-?</code>, <code>ac-persist-help</code>)</dt><dd>Show additional <b>help</b> in <b>persistent buffer</b>.</dd>
</dl>

<p>
Eventually, see <a href="http://stackoverflow.com/questions/19900949/how-to-make-auto-complete-work-with-yasnippet-and-abbrev">How to make auto-complete work with yasnippet and abbrev?</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Let's have snippets in the auto-complete dropdown</span>
(add-to-list 'ac-sources 'ac-source-yasnippet)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Auto Completion.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"auto-complete-autoloads-XXX"</span>
    (idle-require 'auto-complete-config)

    (global-set-key (kbd <span class="org-string">"C-/"</span>)     #'auto-complete)
    (global-set-key (kbd <span class="org-string">"C-S-SPC"</span>) #'auto-complete))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"auto-complete-config"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">6.1 Set a list of sources to use (by default + for some major modes)</span>
    (ac-config-default))                <span class="org-comment-delimiter">; </span><span class="org-comment">... and enable Auto-Complete mode in</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">all buffers.</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"auto-complete"</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Required by ESS.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">5.4 Completion will be started automatically by inserting 1 character.</span>
    (<span class="org-keyword">setq</span> ac-auto-start 1)              <span class="org-comment-delimiter">; </span><span class="org-comment">Also applies on arguments after</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">opening parenthesis in ESS.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">7.5 Use `</span><span class="org-comment"><span class="org-constant">C-n/C-p</span></span><span class="org-comment">' to select candidates (only when completion menu is</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">displayed).</span>
    (<span class="org-keyword">setq</span> ac-use-menu-map t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Completion by TAB.</span>
    (define-key ac-completing-map (kbd <span class="org-string">"&lt;tab&gt;"</span>)   #'ac-complete)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Completion by RET.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key ac-completing-map (kbd "&lt;RET&gt;") #'ac-complete)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Unbind some keys (inconvenient in Comint buffers).</span>
    (define-key ac-completing-map (kbd <span class="org-string">"M-n"</span>)     nil)
    (define-key ac-completing-map (kbd <span class="org-string">"M-p"</span>)     nil)

    (define-key ac-completing-map (kbd <span class="org-string">"C-h"</span>)     #'ac-help)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Abort.</span>
    (define-key ac-completing-map (kbd <span class="org-string">"C-g"</span>)     #'ac-stop)
    (define-key ac-completing-map (kbd <span class="org-string">"&lt;left&gt;"</span>)  #'ac-stop)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key ac-completing-map (kbd "&lt;right&gt;") #'ac-stop)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add other modes into `</span><span class="org-comment"><span class="org-constant">ac-modes</span></span><span class="org-comment">'.</span>
    (<span class="org-keyword">setq</span> ac-modes
          (append ac-modes
                  '(change-log-mode
                    latex-mode
                    org-mode
                    prog-mode           <span class="org-comment-delimiter">; </span><span class="org-comment">Programming modes.</span>
                    snippet-mode
                    sql-mode
                    text-mode)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">7.9 Just ignore case.</span>
    (<span class="org-keyword">setq</span> ac-ignore-case t)             <span class="org-comment-delimiter">; </span><span class="org-comment">???</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">8.1 Delay to completions will be available.</span>
    (<span class="org-keyword">setq</span> ac-delay 0)                   <span class="org-comment-delimiter">; </span><span class="org-comment">Faster than default 0.1.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Eclipse uses 500ms?</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">8.2 Completion menu will be automatically shown.</span>
    (<span class="org-keyword">setq</span> ac-auto-show-menu 0.2)        <span class="org-comment-delimiter">; </span><span class="org-comment">[Default: 0.8].</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">8.13 Delay to show quick help.</span>
    (<span class="org-keyword">setq</span> ac-quick-help-delay 0.5)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">8.15 Max height of quick help.</span>
    (<span class="org-keyword">setq</span> ac-quick-help-height 10)      <span class="org-comment-delimiter">; </span><span class="org-comment">Same as `</span><span class="org-comment"><span class="org-constant">ac-menu-height</span></span><span class="org-comment">'.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">8.16 Limit on number of candidates.</span>
    (<span class="org-keyword">setq</span> ac-candidate-limit 100)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq ac-disable-inline t)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq ac-candidate-menu-min 0)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">11.1 Avoid Flyspell processes when auto completion is being started.</span>
    (ac-flyspell-workaround)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)
</pre>
</div>

<p>
XXX Test the following.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable the drop down auto complete inside comment lines.</span>
    (<span class="org-keyword">setq</span> ac-disable-faces nil)
</pre>
</div>

<p>
Integration of YASnipets:
<a href="https://github.com/joaotavora/yasnippet/issues/526">https://github.com/joaotavora/yasnippet/issues/526</a>
</p>
</div>
</div>

<div id="outline-container-org0224064" class="outline-4">
<h4 id="org0224064">Company (&ldquo;COMPlete ANYthing&rdquo;)</h4>
<div class="outline-text-4" id="text-org0224064">
<p>
The best alternative to Auto-Complete seems to be Company mode.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">toggle-auto-complete-company-modes</span> ()
  <span class="org-doc">"Toggle beteen AC and Company modes."</span>
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">if</span> auto-complete-mode
      (<span class="org-keyword">progn</span>
        (auto-complete-mode -1)
        (company-mode 1)
        (message <span class="org-string">"Disable AC.  Enable Company"</span>)
        (sit-for 2))
    (auto-complete-mode 1)
    (company-mode -1)
    (message <span class="org-string">"Disable Company.  Enable AC"</span>)
    (sit-for 2)))

(global-set-key (kbd <span class="org-string">"&lt;M-f1&gt;"</span>) #'toggle-auto-complete-company-modes)
</pre>
</div>

<p>
Besides that the maintainer of company-mode is incredibly competent and
friendly,
</p>

<ul class="org-ul">
<li>Company mode is super easy to extend (whereas you often have to write 3-4
times as much code to get the equivalent functionality out of AC backend);</li>

<li>Company &ldquo;just works&rdquo;, most of the time.  It&rsquo;s incredibly simple to use.</li>
</ul>

<p>
See <a href="https://github.com/company-mode/company-mode/issues/68">https://github.com/company-mode/company-mode/issues/68</a> for a <b>feature
comparison</b> between both.
</p>

<p>
Completion will start automatically after you type a few letters.
</p>

<p>
Company mode has a unique take on auto-completion where it will reject
keystrokes if it doesn&rsquo;t match any possibilities.  It can also search available
completions and filter as well.
</p>

<p>
When the menu (with completion candidates) is displayed, press:
</p>

<ul class="org-ul">
<li><code>up</code> and <code>down</code> to select,</li>
<li><code>RET</code> or <code>TAB</code> to complete with the current selection
(<code>company-complete-selection</code>).</li>
<li><b>Search through the completions</b> with <code>C-s</code>, <code>C-r</code> and <code>C-o</code>.</li>
<li>Filter with C-M-s.</li>
<li><code>M-(digit)</code> to quickly complete with one of the first 10 candidates.</li>
<li><code>&lt;right&gt;</code> to cancel completion.</li>
<li><code>&lt;F1&gt;</code> or C-h to <b>display the full documentation</b> for the selected symbol, or</li>
<li><code>C-w</code> to <b>show its definition</b>.</li>
</ul>

<p>
Not all back-ends support these last 2 commands.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Modular text completion framework.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"company-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable Company mode in all buffers ....</span>
    (global-company-mode 1)

    (global-set-key (kbd <span class="org-string">"C-c y"</span>) #'company-yasnippet)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Better than `</span><span class="org-comment"><span class="org-constant">helm-yas-complete</span></span><span class="org-comment">' as</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">company-yasnippet</span></span><span class="org-comment">' shows both the key</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">and the replacement.</span>
    )
</pre>
</div>
</div>

<div id="outline-container-org360f313" class="outline-5">
<h5 id="org360f313">Common</h5>
<div class="outline-text-5" id="text-org360f313">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"company"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">... Except in some modes.</span>
    (<span class="org-keyword">setq</span> company-global-modes
          '(not ess-mode                <span class="org-comment-delimiter">; </span><span class="org-comment">In (i)ESS buffers, Auto-Complete is</span>
                inferior-ess-mode       <span class="org-comment-delimiter">; </span><span class="org-comment">enabled by default.</span>
                magit-status-mode
                help-mode))
</pre>
</div>

<p>
By default, the list of candidates is sorted alphabetically, unless the backend
(or we) choose(s) to sort them in a different way.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Sort candidates according to their occurrences.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq company-transformers '(company-sort-by-occurrence))</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq company-transformers '(;; company-sort-by-statistics ;; unknown</span>
    <span class="org-comment-delimiter">;;                              </span><span class="org-comment">company-sort-by-backend-importance))</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Align annotations to the right tooltip border.</span>
    (<span class="org-keyword">setq</span> company-tooltip-align-annotations t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Minimum prefix length for idle completion.</span>
    (<span class="org-keyword">setq</span> company-minimum-prefix-length 1)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Start completion immediately.</span>
    (<span class="org-keyword">setq</span> company-idle-delay 0)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Show quick-access numbers for the first ten candidates.</span>
    (<span class="org-keyword">setq</span> company-show-numbers t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Selecting item before first or after last wraps around.</span>
    (<span class="org-keyword">setq</span> company-selection-wrap-around t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Abort.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key company-active-map (kbd "&lt;right&gt;") #'company-abort)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key company-active-map (kbd "&lt;left&gt;")  #'company-abort)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Ignore some keys (inconvenient in Comint buffers).</span>
    (define-key company-active-map (kbd <span class="org-string">"M-n"</span>)     nil)
    (define-key company-active-map (kbd <span class="org-string">"M-p"</span>)     nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Completion by TAB (insert the selected candidate).</span>
    (define-key company-active-map (kbd <span class="org-string">"&lt;tab&gt;"</span>)   #'company-complete-selection)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Temporarily show the documentation buffer for the selection.  Also on F1 or C-h.</span>
    (define-key company-active-map (kbd <span class="org-string">"C-?"</span>)     #'company-show-doc-buffer)

    <span class="org-comment-delimiter">;;</span><span class="org-comment">! Temporarily display a buffer showing the selected candidate in context.</span>
    (define-key company-active-map (kbd <span class="org-string">"M-."</span>)     #'company-show-location) <span class="org-comment-delimiter">; </span><span class="org-comment">XXX Also on C-w.</span>


 (<span class="org-keyword">setq</span> company-auto-complete
       #'(lambda ()
           (<span class="org-keyword">and</span> (company-tooltip-visible-p)
                (company-explicit-action-p))))

 (<span class="org-keyword">setq</span> company-continue-commands
   '(not save-buffer
         save-some-buffers
         save-buffers-kill-terminal
         save-buffers-kill-emacs
         comint-previous-matching-input-from-input
         comint-next-matching-input-from-input))
 (<span class="org-keyword">setq</span> company-require-match nil)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Do nothing if the indicated candidate contains digits (actually, it will</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">try to insert the digit you type).</span>
    (advice-add 'company-complete-number <span class="org-builtin">:around</span>
     #'(lambda (fun n)
         (<span class="org-keyword">let</span> ((cand (nth (+ (1- n) company-tooltip-offset)
                          company-candidates)))
           (<span class="org-keyword">if</span> (string-match-p <span class="org-string">"[0-9]"</span> cand)
               (<span class="org-keyword">let</span> ((last-command-event (+ ?0 n)))
                 (self-insert-command 1))
             (funcall fun n))))
     '((name . <span class="org-string">"Don't complete numbers"</span>)))
</pre>
</div>

<p>
<b>First</b> run the <b>indent</b> function, then try <b>completion</b> only if it didn&rsquo;t change
anything.
</p>

<p>
XXX The following does not work in Org files (<code>TAB</code> does not expand nodes anymore)!
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">See `</span><span class="org-comment"><span class="org-constant">tab-always-indent</span></span><span class="org-comment">'.</span>

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-indent-or-complete</span> ()
      <span class="org-doc">"Indent the current line; if point doesn't move, then try to complete."</span>
      (<span class="org-keyword">interactive</span>)
      (<span class="org-keyword">let</span> ((p (point)))
        <span class="org-comment-delimiter">;; </span><span class="org-comment">(if (minibufferp)</span>
        <span class="org-comment-delimiter">;;     </span><span class="org-comment">(minibuffer-complete)</span>
        (call-interactively 'indent-for-tab-command)
        (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> (= p (point))
                   (not (bolp))
                   (looking-at <span class="org-string">"\\_&gt;"</span>))
          (call-interactively 'company-complete-selection))))

    (define-key company-mode-map (kbd <span class="org-string">"&lt;tab&gt;"</span>) #'leuven-indent-or-complete)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(defun leuven--tab-fix ()</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">(local-set-key (kbd "&lt;tab&gt;") #'leuven-indent-or-complete))</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'prog-mode-hook #'leuven--tab-fix)</span>
</pre>
</div>

<p>
Only trigger the tooltip on manual invocation, but still have the preview (of
the first candidate) show up immediately:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">defun</span> <span class="org-function-name">company-pseudo-tooltip-unless-just-one-frontend--only-show-tooltip-when-invoked</span> (orig-fun <span class="org-type">&amp;rest</span> args)
      (<span class="org-keyword">when</span> (company-explicit-action-p)
        (apply orig-fun args)))
    (advice-add 'company-pseudo-tooltip-unless-just-one-frontend
       <span class="org-builtin">:around</span> #'company-pseudo-tooltip-unless-just-one-frontend--only-show-tooltip-when-invoked)
</pre>
</div>

<p>
From <a href="https://github.com/company-mode/company-mode/issues/87">https://github.com/company-mode/company-mode/issues/87</a>.
</p>

<p>
See also <a href="https://github.com/company-mode/company-mode/issues/123">https://github.com/company-mode/company-mode/issues/123</a>.
</p>
</div>
</div>

<div id="outline-container-org8d9ffdd" class="outline-5">
<h5 id="org8d9ffdd">Tab</h5>
<div class="outline-text-5" id="text-org8d9ffdd">
<p>
So, Company mode and YASnippet step on each other toes. So these functions are
to help TAB have the behaviour I expect. Attempt these actions, and do the first
one that works.
</p>

<ol class="org-ol">
<li>expand yas snippet</li>
<li>auto complete with company</li>
<li>indent</li>
</ol>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">check-expansion</span> ()
  (<span class="org-keyword">save-excursion</span>
    (<span class="org-keyword">if</span> (looking-at <span class="org-string">"\\_&gt;"</span>) t
      (backward-char 1)
      (<span class="org-keyword">if</span> (looking-at <span class="org-string">"\\."</span>) t
        (backward-char 1)
        (<span class="org-keyword">if</span> (looking-at <span class="org-string">"-&gt;"</span>) t nil)))))

(<span class="org-keyword">defun</span> <span class="org-function-name">do-yas-expand</span> ()
  (<span class="org-keyword">let</span> ((yas/fallback-behavior 'return-nil))
    (yas/expand)))

(<span class="org-keyword">defun</span> <span class="org-function-name">tab-indent-or-complete</span> ()
  (<span class="org-keyword">interactive</span>)
  (<span class="org-keyword">if</span> (minibufferp)
      (minibuffer-complete)
    (<span class="org-keyword">if</span> (<span class="org-keyword">or</span> (not yas/minor-mode)
            (null (do-yas-expand)))
        (<span class="org-keyword">if</span> (check-expansion)
            (company-complete-common)
          (indent-for-tab-command)))))
</pre>
</div>

<p>
I became fairly frustrated trying to bind tab, so this is a fairly dirty way of
altering the keymaps of company and yas-minor modes.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">bind-tab-properly</span> ()
  <span class="org-doc">"Binds tab to tab-indent-or-complete, overwritting yas and company bindings"</span>
  (<span class="org-keyword">interactive</span>)
  <span class="org-comment-delimiter">;;</span><span class="org-comment">overwrite yas and company tab mappings</span>
  (define-key yas-minor-mode-map (kbd <span class="org-string">"&lt;tab&gt;"</span>) #'tab-indent-or-complete)
  (define-key yas-minor-mode-map (kbd <span class="org-string">"TAB"</span>)   #'tab-indent-or-complete)
  (define-key company-active-map [tab]         #'tab-indent-or-complete)
  (define-key company-active-map (kbd <span class="org-string">"TAB"</span>)   #'tab-indent-or-complete))

(add-hook 'company-mode-hook 'bind-tab-properly)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    )                                   <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "company".</span>
</pre>
</div>

<p>
With the following text (where &ldquo;|&rdquo; stands for the cursor):
</p>

<pre class="example">
GOODBYE
good|
</pre>

<ul class="org-ul">
<li>the prefix &ldquo;good&rdquo; will match no word (no completion to &ldquo;goodBYE&rdquo;!) while</li>
<li>the prefix &ldquo;GOOD&rdquo; will match &ldquo;GOODBYE&rdquo; only.</li>
</ul>
</div>
</div>

<div id="outline-container-org4990ec4" class="outline-5">
<h5 id="org4990ec4">Prog modes</h5>
<div class="outline-text-5" id="text-org4990ec4">
<p>
In &ldquo;code&rdquo; modes (see <code>company-dabbrev-code-modes</code>) and their derivatives, Company
will &#x2013; by default &#x2013; complete only symbols, not text in comments or strings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Dabbrev-like company-mode back-end for code.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"company-dabbrev-code"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Search all other buffers</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq company-dabbrev-code-other-buffers 'all)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Offer completions in comments and strings.</span>
    (<span class="org-keyword">setq</span> company-dabbrev-code-everywhere t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Ignore case when collecting completion candidates.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq company-dabbrev-code-ignore-case t)</span>

    (<span class="org-keyword">when</span> (locate-library <span class="org-string">"web-mode"</span>)
      (add-to-list 'company-dabbrev-code-modes 'web-mode))
    )
</pre>
</div>

<p>
Problem:
Company: backend (company-dabbrev-code company-gtags company-etags
company-keywords) user-error: File /cygdrive/d/Users/fni/TAGS does not exist
</p>

<p>
Use command <code>company-diag</code> in bug reports.
</p>
</div>
</div>

<div id="outline-container-org2d254d4" class="outline-5">
<h5 id="org2d254d4">Company-yasnippet</h5>
<div class="outline-text-5" id="text-org2d254d4">
<p>
In a JS file, type <code>al</code>, and see <code>al -&gt; alert</code> in the Company popup. TAB&rsquo;ing on that
entry will insert the code template!
</p>

<div class="warning">
<p>
The <code>company-yasnippet</code> backend should be used with care, because as long as there
are snippets defined for the current major mode, this backend will always shadow
backends that come after it.
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (add-hook 'js2-mode-hook
            #'(lambda ()
                (set (make-local-variable 'company-backends)
                     '((company-dabbrev-code company-yasnippet)))))
</pre>
</div>

<div class="note">
<p>
<code>company-backends</code> is a variable defined in <code>company.el</code>.
</p>

<p>
Documentation: The list of active back-ends (completion engines).
</p>

<p>
<b>Only one back-end is used at a time.</b> The choice depends on the order of the
items in this list, and on the values they return in response to the &rsquo;prefix&rsquo;
command (see below). <b>But a back-end can also be a &ldquo;grouped&rdquo; one (see below).</b>
</p>

<p>
Grouped back-ends:
</p>

<p>
An element of <code>company-backends</code> can also itself be a list of back-ends, then it&rsquo;s
considered to be a &ldquo;grouped&rdquo; back-end.
</p>

<p>
When possible, commands taking a candidate as an argument are dispatched to the
back-end it came from. In other cases, the first non-nil value among all the
back-ends is returned.
</p>

<p>
The latter is the case for the <code>prefix</code> command. But if the group contains the
keyword <code>:with</code>, the back-ends after it are ignored for this command.
</p>

<p>
The completions from back-ends in a group are merged (but only from those that
return the same <code>prefix</code>).
</p>

</div>
</div>
</div>

<div id="outline-container-orgd9b503f" class="outline-5">
<h5 id="orgd9b503f">Tern</h5>
<div class="outline-text-5" id="text-orgd9b503f">
<ul class="org-ul">
<li><a href="https://github.com/proofit404/company-tern">https://github.com/proofit404/company-tern</a></li>
<li><a href="http://stackoverflow.com/questions/18102833/could-not-start-tern-server-in-emacs?rq=1">http://stackoverflow.com/questions/18102833/could-not-start-tern-server-in-emacs?rq=1</a></li>
<li><a href="https://github.com/syl20bnr/spacemacs/issues/5733">https://github.com/syl20bnr/spacemacs/issues/5733</a></li>
<li><a href="https://github.com/ternjs/tern/issues/256">https://github.com/ternjs/tern/issues/256</a></li>
<li><a href="https://github.com/angelozerr/tern.java/wiki/Tern-Eclipse-IDE">https://github.com/angelozerr/tern.java/wiki/Tern-Eclipse-IDE</a></li>
<li><a href="https://github.com/angelozerr/tern.java/wiki/Getting-Started">https://github.com/angelozerr/tern.java/wiki/Getting-Started</a></li>
<li><a href="http://emmet.io/blog/sublime-tern/">http://emmet.io/blog/sublime-tern/</a></li>
<li><a href="http://emacs.stackexchange.com/questions/3093/how-to-navigate-a-javascript-project">http://emacs.stackexchange.com/questions/3093/how-to-navigate-a-javascript-project</a></li>
<li><a href="https://truongtx.me/2014/04/20/emacs-javascript-completion-and-refactoring">https://truongtx.me/2014/04/20/emacs-javascript-completion-and-refactoring</a></li>
</ul>

<p>
Installing <a href="https://github.com/angelozerr/tern.java/wiki/Installation-Update-Site">https://github.com/angelozerr/tern.java/wiki/Installation-Update-Site</a>.
</p>

<p>
<a href="https://nodejs.org/download/release/latest/win-x64/">https://nodejs.org/download/release/latest/win-x64/</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">when</span> (executable-find <span class="org-string">"tern"</span>)

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"company-tern-autoloads"</span>

      (add-to-list 'company-backends 'company-tern)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org58ef575" class="outline-5">
<h5 id="org58ef575">Text modes</h5>
<div class="outline-text-5" id="text-org58ef575">
<p>
In the other modes, Company will pass control to other back-ends
(e.g. <code>company-dabbrev</code>).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Dabbrev-like company-mode completion back-end.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"company-dabbrev"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Only search in the current buffer</span>
    (<span class="org-keyword">setq</span> company-dabbrev-other-buffers nil) <span class="org-comment-delimiter">; </span><span class="org-comment">Prevent Company completing</span>
                                             <span class="org-comment-delimiter">; </span><span class="org-comment">numbers coming from other files.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't ignore case when collecting completion candidates.</span>
    (<span class="org-keyword">setq</span> company-dabbrev-ignore-case nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't downcase the returned candidates.</span>
    (<span class="org-keyword">setq</span> company-dabbrev-downcase nil)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Fix problem with lowercased completions in comments and strings, in many</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">programming modes.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Skip invisible text (Org drawers, etc.).</span>
    (<span class="org-keyword">setq</span> company-dabbrev-ignore-invisible t))
</pre>
</div>

<p>
XXX What about <code>company-search-candidates</code> vs <code>company-filter-candidates</code>?
</p>
</div>
</div>

<div id="outline-container-orgd9fbb4d" class="outline-5">
<h5 id="orgd9fbb4d">Company-quickhelp frontend</h5>
<div class="outline-text-5" id="text-orgd9fbb4d">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"company-quickhelp-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable `</span><span class="org-comment"><span class="org-constant">company-quickhelp-mode</span></span><span class="org-comment">'.</span>
    (company-quickhelp-mode 1)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Delay to show quick help.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq company-quickhelp-delay 0.5)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Maximum number of lines to show in the popup.</span>
    (<span class="org-keyword">setq</span> company-quickhelp-max-lines 10))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 29 ends here.</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb5eb15b" class="outline-2">
<h2 id="orgb5eb15b">Dired, the Directory Editor</h2>
<div class="outline-text-2" id="text-orgb5eb15b">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 30 (info "(emacs)Dired"), the Directory Editor</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-30-dired <span class="org-string">"30 Dired, the Directory Editor"</span>
</pre>
</div>
</div>

<div id="outline-container-org2ebd7f2" class="outline-3">
<h3 id="org2ebd7f2">Entering Dired</h3>
<div class="outline-text-3" id="text-org2ebd7f2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(emacs)Dired Enter")</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Directory-browsing commands.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"dired"</span>

    (leuven--section <span class="org-string">"30.1 (emacs)Dired Enter"</span>)
</pre>
</div>

<div class="note">
<p>
<a href="#org506582a">ls-lisp</a>, Emacs&rsquo;s own <b>emulation of <code>ls</code></b> is used by <b>default on MS Windows</b> (which
does not have an <code>ls</code> program).  Though, it does not support as many options as
GNU <code>ls</code>.
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Switches passed to `</span><span class="org-comment"><span class="org-constant">ls</span></span><span class="org-comment">' for Dired.</span>
    (<span class="org-keyword">setq</span> dired-listing-switches <span class="org-string">"-alF"</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-org506582a" class="outline-3">
<h3 id="org506582a">Emulation of <code>ls</code> on MS-Windows</h3>
<div class="outline-text-3" id="text-org506582a">
<p>
Use Emacs&rsquo;s own emulation of <code>ls</code> in all versions of Emacs.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(emacs)ls in Lisp")</span>

    (leuven--section <span class="org-string">"G.4 (emacs)ls in Lisp"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Emulate insert-directory completely in Emacs Lisp.</span>
    (<span class="org-keyword">when</span> (<span class="org-keyword">require</span> '<span class="org-constant">ls-lisp</span>)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Disable the case sensitive sort of file names.</span>
      (<span class="org-keyword">setq</span> ls-lisp-ignore-case t)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Sort directories first.</span>
      (<span class="org-keyword">setq</span> ls-lisp-dirs-first t)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Use `</span><span class="org-comment"><span class="org-constant">ls-lisp</span></span><span class="org-comment">' in all versions of Emacs (for Dired sorting to work OK!).</span>
      (<span class="org-keyword">setq</span> ls-lisp-use-insert-directory-program nil)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">[Default: nil for Windows, t otherwise]</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Use ISO 8601 dates.</span>
      (<span class="org-keyword">setq</span> ls-lisp-format-time-list
            '(<span class="org-string">"%Y-%m-%d %H:%M"</span>
              <span class="org-string">"%Y-%m-%d %H:%M"</span>))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Use localized date/time format.</span>
      (<span class="org-keyword">setq</span> ls-lisp-use-localized-time-format t))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgaf7c822" class="outline-3">
<h3 id="orgaf7c822">Navigation in the Dired Buffer</h3>
<div class="outline-text-3" id="text-orgaf7c822">
<p>
In Dired, <code>M-&gt;</code> and <code>M-&lt;</code> never took me where I wanted to go.  Now, they do.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(emacs)Dired Navigation")</span>

    (leuven--section <span class="org-string">"30.2 (emacs)Dired Navigation"</span>)

    (<span class="org-keyword">defun</span> <span class="org-function-name">dired-back-to-top</span> ()
      (<span class="org-keyword">interactive</span>)
      (goto-char (point-min))
      (dired-next-line 4))

    (define-key dired-mode-map [remap beginning-of-buffer] #'dired-back-to-top)

    (<span class="org-keyword">defun</span> <span class="org-function-name">dired-jump-to-bottom</span> ()
      (<span class="org-keyword">interactive</span>)
      (goto-char (point-max))
      (dired-next-line -1))

    (define-key dired-mode-map [remap end-of-buffer] #'dired-jump-to-bottom)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf70039f" class="outline-3">
<h3 id="orgf70039f">Deleting Files with Dired</h3>
<div class="outline-text-3" id="text-orgf70039f">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(emacs)Dired Deletion")</span>

    (leuven--section <span class="org-string">"30.3 (emacs)Dired Deletion"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Recursive deletes allowed, after asking for each directory at top level.</span>
    (<span class="org-keyword">setq</span> dired-recursive-deletes 'top)
</pre>
</div>
</div>
</div>

<div id="outline-container-org0e7855b" class="outline-3">
<h3 id="org0e7855b">Visiting Files in Dired</h3>
<div class="outline-text-3" id="text-org0e7855b">
<dl class="org-dl">
<dt><code>^</code></dt><dd><code>dired-up-directory</code>.</dd>

<dt><code>o</code></dt><dd>Open the file or directory in <b>another window</b>.</dd>

<dt><code>C-o</code></dt><dd>Open the file but stay on Dired buffer.</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(emacs)Dired Visiting")</span>

    (leuven--section <span class="org-string">"30.5 (emacs)Dired Visiting"</span>)
</pre>
</div>
</div>

<div id="outline-container-org1eba876" class="outline-4">
<h4 id="org1eba876">Open file with default tool (open directory with Windows Explorer)</h4>
<div class="outline-text-4" id="text-org1eba876">
<p>
On top of the traditional ways, there are also these add-ons which open files
using external programs (such as PDF viewers), based on their extension.
</p>

<p>
One advantage is that using the traditional <code>!</code> (or <code>X</code>) switch with Dired locks up
Emacs until you close the other program.  These add-ons do not and leave Emacs
free for continued used.
</p>

<div class="note">
<p>
Alternative
</p>

<p>
Nowadays, there&rsquo;s at least the built-in <code>dired-do-async-shell-command</code>, bound to
<code>&amp;</code>.
</p>

<p>
In addition to what others have mentioned, if you are on MS Windows then, after
loading <code>w32-browser.el</code> and <code>dired+.el</code>, you can use item <code>Open Associated Windows
App</code> in the <code>Single</code> menu to open a file with the associated program.
</p>

<p>
Same thing for the marked files, using <code>Oepn Associated Windows Apps</code> in menus
<code>Multiple</code> and <code>Multiple &gt; Marked Here and Below</code>.
</p>

<p>
And you can use item <code>Single &gt; ~Open in Windows Explorer</code> to open a file or folder
in Windows Explorer.
</p>

<p>
You can also right-click on a file and pick <code>Open Associated Windows App</code> or <code>Open
in Windows Explorer</code>.
</p>

<p>
There are key bindings for these as wel:
</p>

<dl class="org-dl">
<dt><code>M-RET</code> or <code>mouse-2</code></dt><dd>open with associated proram</dd>
<dt><code>C-RET</code></dt><dd>open in Explorer</dd>
</dl>

</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Read <a href="http://www.piprime.fr/1302/plus-qu-un-explorateur-de-fichiers-le-mode-dired-d-emacs/">http://www.piprime.fr/1302/plus-qu-un-explorateur-de-fichiers-le-mode-dired-d-emacs/</a></b><br />
nil</div>

<p>
These days, there are mature programs for launching an arbitrary file with an
appropriate viewer:
</p>

<ul class="org-ul">
<li><code>xdg-open</code> on GNU systems,</li>

<li><p>
<code>open</code> on Mac OS X,
</p>

<p>
If <code>xdg-open</code> is not available, one can replace it with <code>gnome-open</code> or <code>kde-open</code>.
</p></li>

<li><p>
<code>start</code> on MS Windows.
</p>

<p>
Though, it is a bad idea to use <code>start</code> on Windows: it has too many quirks
regarding quoting of its command line.  Instead, just invoke the existing
primitive <code>w32-shell-execute</code> with the <code>open</code> verb.  As a nice side effect, this
will support Unicode file names, something that is currently impossible when
you invoke an external command.
</p></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">defun</span> <span class="org-function-name">helm-open-file-with-default-tool</span> (file)
      <span class="org-doc">"Open FILE with the default tool on this platform."</span>
      (<span class="org-keyword">let</span> ((program (<span class="org-keyword">cond</span> (leuven--linux-p <span class="org-string">"xdg-open"</span>)
                           (leuven--mac-p <span class="org-string">"open"</span>)))
            process-connect-type)
        (<span class="org-keyword">if</span> leuven--win32-p
            (helm-w32-shell-execute-open-file file)
          (start-process <span class="org-string">"helm-open-file-with-default-tool"</span> nil program file))))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">defun</span> <span class="org-function-name">dired-open</span> ()
      (<span class="org-keyword">interactive</span>)
      (<span class="org-keyword">let</span> ((program (<span class="org-keyword">cond</span> (leuven--linux-p <span class="org-string">"xdg-open"</span>)
                           (leuven--mac-p <span class="org-string">"open"</span>))))
        (dired-do-shell-command program nil
                                (dired-get-marked-files t current-prefix-arg))))

    (define-key dired-mode-map (kbd <span class="org-string">"F"</span>) #'dired-open)
</pre>
</div>

<p>
Reveal active file in Explorer:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">defun</span> <span class="org-function-name">browse-file-directory</span> ()
      <span class="org-doc">"Open the current file's directory however the OS would."</span>
      (<span class="org-keyword">interactive</span>)
      (<span class="org-keyword">if</span> default-directory
          (browse-url-of-file (expand-file-name default-directory))
        (<span class="org-warning">error</span> <span class="org-string">"No `</span><span class="org-string"><span class="org-constant">default-directory</span></span><span class="org-string">' to open"</span>)))

    (global-set-key (kbd <span class="org-string">"C-c r"</span>) #'browse-file-directory)
</pre>
</div>
</div>

<div id="outline-container-orgef46ada" class="outline-5">
<h5 id="orgef46ada">Ask a WWW browser to display file</h5>
<div class="outline-text-5" id="text-orgef46ada">
<p>
Just ask a WWW browser to display the current file.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">In Dired, ask a WWW browser to display the file named on this line.</span>
    (define-key dired-mode-map (kbd <span class="org-string">"e"</span>) #'browse-url-of-dired-file) <span class="org-comment-delimiter">; </span><span class="org-comment">&lt;C-RET&gt;?</span>

</pre>
</div>

<p>
It works for files as well as for directories.
</p>

<p>
It opens the Windows Explorer for:
</p>

<ul class="org-ul">
<li>the <b>current directory</b> when invoked on <code>.</code>, and</li>
<li><p>
the <b>parent directory</b> when invoked on <code>..</code>.
</p>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Mapcar on the browse-url function</b><br />
<p>
See code of <code>w32-dired-open-files-externally</code>.
</p>
</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> <code>C-u RET</code> opens dired on Org link</b><br />
<p>
We should probably have the same type of key binding for opening Explorer from
Dired.
</p>
</div></li>
</ul>
</div>
</div>

<div id="outline-container-org785fa2d" class="outline-5">
<h5 id="org785fa2d">MANY FILES at once (for Windows)</h5>
<div class="outline-text-5" id="text-org785fa2d">
<p>
For those under Windows:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Open files using Windows associations.</span>
    (<span class="org-keyword">when</span> (<span class="org-keyword">or</span> leuven--win32-p
              leuven--cygwin-p)
      (<span class="org-keyword">defun</span> <span class="org-function-name">w32-dired-open-files-externally</span> (<span class="org-type">&amp;optional</span> arg)
        <span class="org-doc">"In Dired, open the marked files (or directories) with the default</span>
<span class="org-doc">      Windows tool."</span>
        (<span class="org-keyword">interactive</span> <span class="org-string">"P"</span>)
        (mapcar
         #'(lambda (file)
             (w32-shell-execute <span class="org-string">"open"</span> (convert-standard-filename file)))
         (dired-get-marked-files nil arg)))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Bind it to `E' in Dired mode.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key dired-mode-map (kbd "E") #'w32-dired-open-files-externally)</span>
      )
</pre>
</div>
</div>
</div>

<div id="outline-container-org2685d8d" class="outline-5">
<h5 id="org2685d8d">ARCHIBUS</h5>
<div class="outline-text-5" id="text-org2685d8d">
<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"dired"</span>
      (define-key dired-mode-map (kbd <span class="org-string">"C-c v"</span>)
         #'(lambda ()
             <span class="org-doc">"Ask a WWW browser to load ARCHIBUS View file."</span>
             (<span class="org-keyword">interactive</span>)
             (<span class="org-keyword">let</span> ((archibus-prefix <span class="org-string">"http://localhost:8080/archibus/"</span>))
               (browse-url (concat archibus-prefix (dired-get-filename 'no-dir t)))))))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org4551b77" class="outline-4">
<h4 id="org4551b77">Open file with <code>eww</code></h4>
<div class="outline-text-4" id="text-org4551b77">
<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Open current file with eww.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">dired-open-with-eww</span> ()
      <span class="org-doc">"In Dired, visit (with eww) the file named on this line."</span>
      (<span class="org-keyword">interactive</span>)
      (eww-open-file (file-name-sans-versions (dired-get-filename) t)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add a binding "W" -&gt; `</span><span class="org-comment"><span class="org-constant">dired-open-with-eww</span></span><span class="org-comment">' to Dired.</span>
    (define-key dired-mode-map (kbd <span class="org-string">"W"</span>) #'dired-open-with-eww)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org623e795" class="outline-3">
<h3 id="org623e795">Operating on Files</h3>
<div class="outline-text-3" id="text-org623e795">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(emacs)Operating on Files")</span>

    (leuven--section <span class="org-string">"30.7 (emacs)Operating on Files"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Try to guess a default target directory (if there is a Dired buffer</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">displayed in the next window).</span>
    (<span class="org-keyword">setq</span> dired-dwim-target t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Copy recursively without asking.</span>
    (<span class="org-keyword">setq</span> dired-recursive-copies 'always)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbe9c459" class="outline-3">
<h3 id="orgbe9c459">Updating the Dired Buffer</h3>
<div class="outline-text-3" id="text-orgbe9c459">
<div class="warning">
<p>
The following code block is currently disabled, because it causes problems with
Org and PDF LaTeX: when we&rsquo;ve opened the TeX file, to compile it from LaTeX
because an error has been reported (with no details), then the TeX file blocks
the next automatic exports (<code>C-u C-c C-e</code>), asking for confirmation because the
TeX buffer is open&#x2026;
</p>

<pre class="example">
Reverting buffer `prestations/'.
prestations-2013-06.tex changed on disk; really edit the buffer? (y, n, r or C-h) n
</pre>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (add-hook 'dired-mode-hook
              #'(lambda ()
                  <span class="org-comment-delimiter">;; </span><span class="org-comment">Auto-refresh Dired on file change.</span>
                  (auto-revert-mode)))
</pre>
</div>

<p>
Maybe the following fixes this above problem?
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(emacs)Dired Updating")</span>

    (leuven--section <span class="org-string">"30.15 (emacs)Dired Updating"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Automatically revert Dired buffer *on revisiting*.</span>
    (<span class="org-keyword">setq</span> dired-auto-revert-buffer t)
</pre>
</div>

<p>
Press <code>s</code> then <code>s</code>, <code>x</code>, <code>t</code>, <code>n</code> or <code>d</code> to sort by Size, eXtension, <b>Time</b>, <b>Name</b> or name
grouping Dirs first:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Dired sort.</span>
    (try-require 'dired-sort-map)
</pre>
</div>
</div>
</div>

<div id="outline-container-org0f87350" class="outline-3">
<h3 id="org0f87350">Dired and <code>find</code></h3>
<div class="outline-text-3" id="text-org0f87350">
<p>
For searches in Dired, see <code>dired-do-search</code> (<code>A</code>).
</p>
<ul class="org-ul">
<li>Search through all <b>marked files</b> for a match for regexp</li>
<li>Stops when a match is found</li>
<li>To continue searching for next match, use command &ldquo;M-,&rdquo;</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(emacs)Dired and Find")</span>

    (leuven--section <span class="org-string">"30.16 (emacs)Dired and Find"</span>)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; What to use in place of `</span><span class="org-comment"><span class="org-constant">-ls</span></span><span class="org-comment">' as the final argument.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq find-ls-option '("-print0 | xargs -0 ls -ld" . "-ld"))</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Quicker to collate the matches and then use `</span><span class="org-comment"><span class="org-constant">xargs</span></span><span class="org-comment">' to run the command</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">;; (variable defined in `</span><span class="org-comment"><span class="org-constant">find-dired.el</span></span><span class="org-comment">').</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Search for files with names matching a wild card pattern and Dired the</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">output.</span>
    (global-set-key (kbd <span class="org-string">"C-c 1"</span>) #'find-name-dired)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Case insensitive if</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">read-file-name-completion-ignore-case</span></span><span class="org-comment">'</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">is non-nil.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">find-grep-dired</span></span><span class="org-comment">' case insensitivity.</span>
    (<span class="org-keyword">setq</span> find-grep-options <span class="org-string">"-i -q"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Search for files with contents matching a wild card pattern and Dired the</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">output.</span>
    (global-set-key (kbd <span class="org-string">"C-c 2"</span>) #'find-grep-dired)
</pre>
</div>
</div>
</div>

<div id="outline-container-org6a48900" class="outline-3">
<h3 id="org6a48900">Editing the Dired Buffer</h3>
<div class="outline-text-3" id="text-org6a48900">
<p>
<code>Wdired</code> mode is <b>great for renaming (a lot of) files</b> in a directory, as it allows
<b>editing the Dired buffer</b> like a text file, using all the power of Emacs.  That
is, one can use keyboard macros, search and replace, rectangle mode (great for
adding prefixes to file names), flip mode bits with the mouse, etc.!
</p>

<p>
To enter it, type <code>C-x C-q</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(emacs)Wdired")</span>

    (leuven--section <span class="org-string">"30.17 Editing the (emacs)Wdired Buffer"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Put a Dired buffer in a mode in which filenames are editable.</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"wdired"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Permissions bits of the files are editable.</span>
      (<span class="org-keyword">setq</span> wdired-allow-to-change-permissions t))
</pre>
</div>
</div>
</div>

<div id="outline-container-org865485e" class="outline-3">
<h3 id="org865485e">Viewing Image Thumbnails in Dired</h3>
<div class="outline-text-3" id="text-org865485e">
<p>
<code>M-x image-dired</code> and choose a directory with images.
</p>

<p>
Prerequisites:
</p>
<ul class="org-ul">
<li><a href="http://www.imagemagick.org.">ImageMagick</a> package</li>
<li>JpegTRAN program</li>
<li><a href="http://www.sno.phy.queensu.ca/~phil/exiftool/">exiftool</a> to <b>edit comments and tags</b> for each image.</li>
</ul>

<p>
Key bindings:
</p>

<dl class="org-dl">
<dt>C-t d</dt><dd><code>image-dired-display-thumbs</code> (on marked files).</dd>

<dt>C-t e</dt><dd><code>image-dired-dired-edit-comment-and-tags</code>.</dd>
</dl>

<p>
For more information, see:
</p>
<ul class="org-ul">
<li><a href="http://www.emacswiki.org/Tumme">http://www.emacswiki.org/Tumme</a></li>
<li><a href="http://wikemacs.org/wiki/Image-dired">http://wikemacs.org/wiki/Image-dired</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(emacs)Image-Dired")</span>

    (leuven--section <span class="org-string">"30.18 Viewing Image Thumbnails in Dired"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Use Dired to browse and manipulate your images.</span>
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"image-dired"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Maximum number of files to show before warning the user.</span>
      (<span class="org-keyword">setq</span> image-dired-show-all-from-dir-max-files 100)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Size of button-like border around thumbnails.</span>
      (<span class="org-keyword">setq</span> image-dired-thumb-relief 0)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Size of the margin around thumbnails.</span>
      (<span class="org-keyword">setq</span> image-dired-thumb-margin 4))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf8014f6" class="outline-3">
<h3 id="orgf8014f6">Other Dired features</h3>
<div class="outline-text-3" id="text-orgf8014f6">
<p>
To copy the <b>name</b> of the file at point (or the folder you&rsquo;re looking at in Dired)
into the kill ring (in order to make use of it elsewhere), use
<code>dired-copy-filename-as-kill</code>, which is bound to <code>w</code> in Dired.
</p>

<div class="tip">
<p>
Use <code>0 w</code> to put the <b>full path</b>.
</p>

</div>
</div>
</div>

<div id="outline-container-orge1eeac6" class="outline-3">
<h3 id="orge1eeac6">Dired &ldquo;extra&rdquo; features</h3>
<div class="outline-text-3" id="text-orge1eeac6">
<p>
Extra Dired functionality:
</p>

<ul class="org-ul">
<li><p>
You can <b>jump to the Dired buffer</b> corresponding to the current buffer by
pressing <b><code>C-x C-j</code></b> (<code>dired-jump</code>).  If in Dired already, pop up a level and goto
old directory&rsquo;s line.
</p>

<p>
<b>Standard</b> alternative: <code>C-x d RET</code>, though it doesn&rsquo;t set point on the right
file.
</p></li>

<li><code>dired-x</code> also has a feature to &ldquo;guess&rdquo; the right shell command and the right
external viewer for documents (see <code>dired-guess-shell-alist-user</code>)</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** Dired Extra</span>

    (leuven--section <span class="org-string">"30.XX (dired-x)Top"</span>)

    (<span class="org-keyword">require</span> '<span class="org-constant">dired-x</span>))                 <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "dired" ends here.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgce308dc" class="outline-3">
<h3 id="orgce308dc">Dired+</h3>
<div class="outline-text-3" id="text-orgce308dc">
<p>
Extensions to Dired:
</p>

<ul class="org-ul">
<li>Provide fancy <b>highlighting</b>.</li>

<li>Let you act on sets of marked files in subdirs, recursively, for example.</li>
</ul>

<p>
There are global key bindings that Dired+ makes:
</p>

<dl class="org-dl">
<dt><code>C-x D</code></dt><dd><code>diredp-dired-union</code></dd>
<dt><code>C-x E</code></dt><dd><code>diredp-add-to-dired-buffer</code></dd>
<dt><code>C-x C-M-f</code></dt><dd><code>diredp-fileset</code></dd>
<dt><code>C-x R</code></dt><dd><code>diredp-dired-recent-dirs</code></dd>
</dl>

<p>
These are not bindings for Dired mode.  They are global bindings that set up
a Dired buffer.  They are thus similar to the default global bindings <code>C-x d</code> and
<code>C-x C-j</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** Dired+</span>

  (leuven--section <span class="org-string">"30.XX Dired+"</span>)

  (<span class="org-keyword">when</span> (try-require 'dired+) <span class="org-comment-delimiter">;</span><span class="org-comment">XXX</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't hide details in Dired.</span>
    (<span class="org-keyword">setq</span> diredp-hide-details-initially-flag nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't display the next Dired buffer the same way as the last.</span>
    (<span class="org-keyword">setq</span> diredp-hide-details-propagate-flag nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't wrap "next" command around to buffer beginning.</span>
    (<span class="org-keyword">setq</span> diredp-wrap-around-flag nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Dired `</span><span class="org-comment"><span class="org-constant">find-file</span></span><span class="org-comment">' commands reuse directories.</span>
    (diredp-toggle-find-file-reuse-dir 1)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Up, reusing Dired buffers.</span>
    (define-key dired-mode-map (kbd <span class="org-string">"C-x C-j"</span>)
      #'diredp-up-directory-reuse-dir-buffer))
</pre>
</div>
</div>
</div>

<div id="outline-container-org4dba356" class="outline-3">
<h3 id="org4dba356">VC diff highlighting</h3>
<div class="outline-text-3" id="text-org4dba356">
<p>
Like Git-gutter, Diff-hl shows you <b>which lines were modified compared to the
latest commit</b> &#x2013; it supports SVN, Git, and other VC systems!
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** Diff-hl</span>

  (leuven--section <span class="org-string">"30.XX Diff-hl"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable VC diff highlighting on the side of a Dired window.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"diff-hl-autoloads"</span>
    (add-hook 'dired-mode-hook #'diff-hl-dired-mode))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 30 ends here.</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org487e173" class="outline-2">
<h2 id="org487e173">The Calendar and the Diary</h2>
<div class="outline-text-2" id="text-org487e173">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 31 The (info "(emacs)Calendar/Diary")</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-31-calendar-diary <span class="org-string">"31 The Calendar and the Diary"</span>
</pre>
</div>
</div>

<div id="outline-container-org20e3b3a" class="outline-3">
<h3 id="org20e3b3a">Calendar Motion</h3>
<div class="outline-text-3" id="text-org20e3b3a">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 31.1 (info "(emacs)Calendar Motion")</span>

  (leuven--section <span class="org-string">"31.1 (emacs)Calendar Motion"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Years must be written in full.</span>
  (<span class="org-keyword">setq</span> diary-abbreviated-year-flag nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Set the style of calendar and diary dates to ISO (how to interpret the</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">dates).</span>
  (<span class="org-keyword">setq</span> calendar-date-style 'iso)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Week in the calendar begins on Monday.</span>
  (<span class="org-keyword">setq</span> calendar-week-start-day 1)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Mark all visible dates that have diary entries.</span>
  (<span class="org-keyword">when</span> (file-exists-p <span class="org-string">"~/diary"</span>)
    (<span class="org-keyword">setq</span> calendar-mark-diary-entries-flag t))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Mark the current date (by changing its face) after generating a calendar,</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">if today's date is visible.</span>
  (add-hook 'calendar-today-visible-hook #'calendar-mark-today)
</pre>
</div>
</div>
</div>

<div id="outline-container-org4169397" class="outline-3">
<h3 id="org4169397">Scroll Calendar</h3>
<div class="outline-text-3" id="text-org4169397">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 31.2 (info "(emacs)Scroll Calendar")</span>

  (leuven--section <span class="org-string">"31.2 (emacs)Scroll Calendar"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Fix foolish calendar-mode scrolling after loading `</span><span class="org-comment"><span class="org-constant">calendar.el</span></span><span class="org-comment">'.</span>
  (add-hook 'calendar-load-hook
            #'(lambda ()
                (define-key calendar-mode-map (kbd <span class="org-string">"&gt;"</span>) #'calendar-scroll-left)
                (define-key calendar-mode-map (kbd <span class="org-string">"&lt;"</span>) #'calendar-scroll-right)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orge7a7235" class="outline-3">
<h3 id="orge7a7235">Times of Sunrise/Sunset</h3>
<div class="outline-text-3" id="text-orge7a7235">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 31.7 Times of (info "(emacs)Sunrise/Sunset")</span>

  (leuven--section <span class="org-string">"31.7 Times of (emacs)Sunrise/Sunset"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Calendar functions for solar events.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "solar"</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; Name of the calendar location.</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(setq calendar-location-name "Leuven, BE")</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; Latitude of `</span><span class="org-comment"><span class="org-constant">calendar-location-name</span></span><span class="org-comment">'.</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(setq calendar-latitude 50.88)</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; Longitude of `</span><span class="org-comment"><span class="org-constant">calendar-location-name</span></span><span class="org-comment">'.</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(setq calendar-longitude 4.70))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org74e9597" class="outline-3">
<h3 id="org74e9597">Diary</h3>
<div class="outline-text-3" id="text-org74e9597">
<p>
The Emacs diary keeps track of appointments or other events on a daily basis, in
conjunction with the calendar.  To use the diary feature, you must first create
a &ldquo;diary file&rdquo; containing a list of events and their dates.
</p>

<p>
But <a href="#orge51d507">Org</a> outperforms it!
</p>
</div>
</div>

<div id="outline-container-orge4b1f1f" class="outline-3">
<h3 id="orge4b1f1f">Appointments</h3>
<div class="outline-text-3" id="text-orge4b1f1f">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 31.11 (info "(emacs)Appointments")</span>

  (leuven--section <span class="org-string">"31.11 (emacs)Appointments"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Insinuate appt if `</span><span class="org-comment"><span class="org-constant">diary-file</span></span><span class="org-comment">' exists.</span>
  (<span class="org-keyword">if</span> (file-readable-p <span class="org-string">"~/diary"</span>)
      (try-require 'appt)               <span class="org-comment-delimiter">; </span><span class="org-comment">Requires `</span><span class="org-comment"><span class="org-constant">diary-lib</span></span><span class="org-comment">', which requires</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">diary-loaddefs</span></span><span class="org-comment">'.</span>
    (message <span class="org-string">"[Appointment reminders lib `</span><span class="org-string"><span class="org-constant">appt</span></span><span class="org-string">' not loaded (no diary file found)]"</span>))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"appt"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Send the first warning 60 minutes before an appointment.</span>
    (<span class="org-keyword">setq</span> appt-message-warning-time 60) <span class="org-comment-delimiter">; </span><span class="org-comment">[default: 12]</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Warn every 15 minutes.</span>
    (<span class="org-keyword">setq</span> appt-display-interval 15)     <span class="org-comment-delimiter">; </span><span class="org-comment">[default: 3]</span>
</pre>
</div>

<p>
Send notifications using <code>notifications-notify</code> (which was added in Emacs 24).
It uses <code>notify-send</code> (if the <code>libnotify-bin</code> Ubuntu package is installed).
</p>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> For Windows users: use `todochicku.el&rsquo; (cross-platform?) and the snarl notifier</b><br />
nil</div>

<p>
Or better look at the <code>alert</code> package?
</p>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Diff between shell-command and call-process?  Blocking call?</b><br />
nil</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Use a separate window to display appointment reminders.</span>
    (<span class="org-keyword">setq</span> appt-display-format 'window)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Function called to display appointment reminders *in a window*.</span>
    (<span class="org-keyword">setq</span> appt-disp-window-function (<span class="org-keyword">function</span> leuven--appt-display))

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--appt-display</span> (mins-to-appt current-time notification-string)
      <span class="org-doc">"Display a reminder for appointments.</span>
<span class="org-doc">    Use `</span><span class="org-doc"><span class="org-constant">libnotify</span></span><span class="org-doc">' if available and if display is graphical, or fall back on a</span>
<span class="org-doc">    message in the echo area."</span>
      (<span class="org-keyword">or</span> (listp mins-to-appt)
          (<span class="org-keyword">setq</span> notification-string (list notification-string)))
      (<span class="org-keyword">dotimes</span> (i (length notification-string))
        (<span class="org-keyword">cond</span> ((<span class="org-keyword">and</span> (display-graphic-p)
                    (executable-find <span class="org-string">"notify-send"</span>))
               (shell-command
                (concat <span class="org-string">"notify-send "</span>
                        <span class="org-string">"-i /usr/share/icons/gnome/32x32/status/appointment-soon.png "</span>
                        <span class="org-string">"-t 1000 "</span>
                        <span class="org-string">"'Appointment' "</span>
                        <span class="org-string">"'"</span> (nth i notification-string) <span class="org-string">"'"</span>)))
              (t
               (message <span class="org-string">"[%s]"</span> (nth i notification-string))
               (sit-for 1)))))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Turn appointment checking on (enable reminders).</span>
    (<span class="org-keyword">when</span> leuven-verbose-loading
      (message <span class="org-string">"[Enable appointment reminders...]"</span>))
    (appt-activate 1)
    (<span class="org-keyword">when</span> leuven-verbose-loading
      (message <span class="org-string">"[Enable appointment reminders... Done]"</span>))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable appointment notification, several minutes beforehand.</span>
    (add-hook 'diary-hook #'appt-make-list)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"org-agenda"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Keep your appointment list clean: if you delete an appointment from</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">your Org agenda file, delete the corresponding alert.</span>
      (<span class="org-keyword">defadvice</span> <span class="org-function-name">org-agenda-to-appt</span> (before leuven-org-agenda-to-appt activate)
        <span class="org-doc">"Clear the existing `</span><span class="org-doc"><span class="org-constant">appt-time-msg-list</span></span><span class="org-doc">'."</span>
        (<span class="org-keyword">setq</span> appt-time-msg-list nil))

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Add today's appointments (found in `</span><span class="org-comment"><span class="org-constant">org-agenda-files</span></span><span class="org-comment">') each time the</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">agenda buffer is (re)built.</span>
      (add-hook 'org-agenda-finalize-hook #'org-agenda-to-appt)
                                          <span class="org-comment-delimiter">;</span><span class="org-comment">! Don't use the `</span><span class="org-comment"><span class="org-constant">org-agenda-mode-hook</span></span><span class="org-comment">'</span>
                                          <span class="org-comment-delimiter">;</span><span class="org-comment">! because the Org agenda files would be</span>
                                          <span class="org-comment-delimiter">;</span><span class="org-comment">! opened once by `</span><span class="org-comment"><span class="org-constant">org-agenda-to-appt</span></span><span class="org-comment">',</span>
                                          <span class="org-comment-delimiter">;</span><span class="org-comment">! and then killed by</span>
                                          <span class="org-comment-delimiter">;</span><span class="org-comment">! `</span><span class="org-comment"><span class="org-constant">org-release-buffers</span></span><span class="org-comment">' (because</span>
                                          <span class="org-comment-delimiter">;</span><span class="org-comment">! `</span><span class="org-comment"><span class="org-constant">org-agenda-to-appt</span></span><span class="org-comment">' closes all the</span>
                                          <span class="org-comment-delimiter">;</span><span class="org-comment">! files it opened itself -- as they</span>
                                          <span class="org-comment-delimiter">;</span><span class="org-comment">! weren't already opened), to be</span>
                                          <span class="org-comment-delimiter">;</span><span class="org-comment">! finally re-opened!</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Add today's appointments (found in `</span><span class="org-comment"><span class="org-constant">org-agenda-files</span></span><span class="org-comment">') each time</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">;; such a file is saved.</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'after-save-hook          ; VERY TIME CONSUMING (~ 30 s) at each save...</span>
      <span class="org-comment-delimiter">;;           </span><span class="org-comment">#'(lambda ()</span>
      <span class="org-comment-delimiter">;;             </span><span class="org-comment">(when (and (derived-mode-p 'org-mode) ; ... of an Org</span>
      <span class="org-comment-delimiter">;;                        </span><span class="org-comment">(org-agenda-file-p)) ; agenda file...</span>
      <span class="org-comment-delimiter">;;               </span><span class="org-comment">(org-agenda-to-appt))))</span>
      )
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    )                                   <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "appt" ends here.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge359ef4" class="outline-3">
<h3 id="orge359ef4">Advanced Calendar/Diary Usage</h3>
<div class="outline-text-3" id="text-orge359ef4">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 31.15 (info "(emacs)Advanced Calendar/Diary Usage")</span>

  (leuven--section <span class="org-string">"31.15 (emacs)Advanced Calendar/Diary Usage"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Get rid of some holidays.</span>
  (<span class="org-keyword">setq</span> holiday-general-holidays nil)   <span class="org-comment-delimiter">; </span><span class="org-comment">Too U.S.-centric holidays.</span>
  (<span class="org-keyword">setq</span> holiday-oriental-holidays nil)  <span class="org-comment-delimiter">; </span><span class="org-comment">Oriental holidays.</span>
  (<span class="org-keyword">setq</span> holiday-hebrew-holidays nil)    <span class="org-comment-delimiter">; </span><span class="org-comment">Religious holidays.</span>
  (<span class="org-keyword">setq</span> holiday-islamic-holidays nil)   <span class="org-comment-delimiter">; </span><span class="org-comment">Religious holidays.</span>
  (<span class="org-keyword">setq</span> holiday-bahai-holidays nil)     <span class="org-comment-delimiter">; </span><span class="org-comment">Baha'i holidays.</span>
  (<span class="org-keyword">setq</span> holiday-solar-holidays nil)     <span class="org-comment-delimiter">; </span><span class="org-comment">Sun-related holidays.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Mark dates of holidays in the calendar window.</span>
  (<span class="org-keyword">setq</span> calendar-mark-holidays-flag t)
</pre>
</div>

<p>
After the calendar is loaded, <code>calendar-holidays</code> is the list of notable days for
the command <code>M-x holidays</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-insert-current-date</span> (prefix)
    <span class="org-doc">"Insert the current date in ISO format.</span>
<span class="org-doc">  With one PREFIX argument, add day of week.  With two PREFIX arguments, add day</span>
<span class="org-doc">  of week and time."</span>
    (<span class="org-keyword">interactive</span> <span class="org-string">"P"</span>)
    (<span class="org-keyword">let</span> ((format (<span class="org-keyword">cond</span> ((not prefix) <span class="org-string">"%Y-%m-%d"</span>)
                        ((equal prefix '(4)) <span class="org-string">"%Y-%m-%d %a"</span>)
                        ((equal prefix '(16)) <span class="org-string">"%Y-%m-%d %a %H:%M"</span>))))
      (insert (format-time-string format))))

  (global-set-key (kbd <span class="org-string">"C-c ."</span>) #'leuven-insert-current-date)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb0685fd" class="outline-3">
<h3 id="orgb0685fd">Calendar framework</h3>
<div class="outline-text-3" id="text-orgb0685fd">
<p>
After displaying your <code>calfw</code> buffer, you can get a HTML buffer with <code>M-x
htmlfontify-buffer</code>.
</p>

<div class="warning">
<p>
<code>Calfw</code> requires <code>Google-maps</code>!?
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* Calendar view framework on Emacs</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Calendar view framework on Emacs.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"calfw"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Unicode characters.</span>
    (<span class="org-keyword">setq</span> cfw:fchar-junction ?╋
          cfw:fchar-vertical-line ?┃
          cfw:fchar-horizontal-line ?━
          cfw:fchar-left-junction ?┣
          cfw:fchar-right-junction ?┫
          cfw:fchar-top-junction ?┯
          cfw:fchar-top-left-corner ?┏
          cfw:fchar-top-right-corner ?┓))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Calendar view for org-agenda.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"calfw-org"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Remove some strings (tags and filenames) from item summary.</span>
    (<span class="org-keyword">defun</span> <span class="org-function-name">cfw:org-summary-format</span> (item)
      <span class="org-doc">"Format an item (How should it be displayed?)."</span>
      (<span class="org-keyword">let*</span> ((time (cfw:org-tp item 'time))
             (time-of-day (cfw:org-tp item 'time-of-day))
             (time-str (<span class="org-keyword">and</span> time-of-day
                            (format <span class="org-string">"%02i:%02i "</span>
                                    (/ time-of-day 100)
                                    (% time-of-day 100))))
             (category (cfw:org-tp item 'org-category))
             (tags (cfw:org-tp item 'tags))
             (marker (cfw:org-tp item 'org-marker))
             (buffer (<span class="org-keyword">and</span> marker (marker-buffer marker)))
             (text (cfw:org-extract-summary item))
             (props (cfw:extract-text-props item 'face 'keymap)))
        (propertize
         (concat
          (<span class="org-keyword">if</span> time-str (apply 'propertize time-str props)) text <span class="org-string">" "</span>
          <span class="org-comment-delimiter">;; </span><span class="org-comment">(and buffer (buffer-name buffer))</span>
          )
         'keymap cfw:org-text-keymap
         <span class="org-comment-delimiter">;; </span><span class="org-comment">Delete the display property, since displaying images will break our</span>
         <span class="org-comment-delimiter">;; </span><span class="org-comment">table layout.</span>
         'display nil))))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 31 ends here.</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgc77204a" class="outline-2">
<h2 id="orgc77204a">Sending Mail</h2>
<div class="outline-text-2" id="text-orgc77204a">
<p>
Minimal configuration for sending a bug report, for example.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 32 (info "(emacs)Sending Mail")</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-32-sending-mail <span class="org-string">"32 Sending Mail"</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Full name of this user.</span>
  (<span class="org-keyword">setq</span> user-full-name <span class="org-string">"John Doe"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Full mailing address of this user</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(used in MAIL envelope FROM, and to select the default personality ID).</span>
  (<span class="org-keyword">setq</span> user-mail-address <span class="org-string">"john.doe@example.com"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Sending mail.</span>
  (<span class="org-keyword">setq</span> send-mail-function 'smtpmail-send-it)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Default SMTP server (overriden by `</span><span class="org-comment"><span class="org-constant">smtpmail-smtp-server</span></span><span class="org-comment">').</span>
  (<span class="org-keyword">setq</span> smtpmail-default-smtp-server <span class="org-string">"smtp"</span>)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">SMTP process must be running</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">there... and it should be Google's own</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">mail server for GMail user mail</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">addresses...</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; SMTP service port number.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq smtpmail-smtp-service 587)</span>

)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 32 ends here.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org8dce648" class="outline-2">
<h2 id="org8dce648">Gnus</h2>
<div class="outline-text-2" id="text-org8dce648">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 34 (info "(emacs)Gnus")</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-34-gnus <span class="org-string">"34 Gnus"</span>

  (global-set-key (kbd <span class="org-string">"C-c n"</span>)
    #'(lambda ()
        (<span class="org-keyword">interactive</span>)
        (switch-or-start 'gnus <span class="org-string">"*Group*"</span>)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Directory beneath which additional per-user Gnus-specific files are placed.</span>
  (<span class="org-keyword">setq</span> gnus-directory <span class="org-string">"~/.gnus.d/"</span>)    <span class="org-comment-delimiter">; </span><span class="org-comment">Should end with a directory separator.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">A newsreader for GNU Emacs.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"gnus"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Package to compose an outgoing mail (Message, with Gnus paraphernalia).</span>
    (<span class="org-keyword">setq</span> mail-user-agent 'gnus-user-agent)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Reading mail with Gnus.</span>
    (<span class="org-keyword">setq</span> read-mail-command 'gnus))
</pre>
</div>
</div>

<div id="outline-container-org2c43391" class="outline-3">
<h3 id="org2c43391">BBDB</h3>
<div class="outline-text-3" id="text-org2c43391">
<p>
bbdb3: <a href="https://savannah.nongnu.org/projects/bbdb">https://savannah.nongnu.org/projects/bbdb</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** Insidious bbdb</span>

  (leuven--section <span class="org-string">"Insidious bbdb"</span>)

<span class="org-comment-delimiter">;;</span><span class="org-comment">* (info "(bbdb)Installation")</span>

  (<span class="org-keyword">unless</span> (<span class="org-keyword">ignore-errors</span> (load-library <span class="org-string">"bbdb-autoloads"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">"hand-made"</span>
    (autoload 'bbdb <span class="org-string">"bbdb-com"</span>
      <span class="org-doc">"Insidious Big Brother Database."</span> t)
    (autoload 'bbdb-name <span class="org-string">"bbdb-com"</span>
      <span class="org-doc">"Insidious Big Brother Database."</span> t)
    (autoload 'bbdb-company <span class="org-string">"bbdb-com"</span>
      <span class="org-doc">"Insidious Big Brother Database."</span> t)
    (autoload 'bbdb-net <span class="org-string">"bbdb-com"</span>
      <span class="org-doc">"Insidious Big Brother Database."</span> t)
    (autoload 'bbdb-notes <span class="org-string">"bbdb-com"</span>
      <span class="org-doc">"Insidious Big Brother Database."</span> t)

    (autoload 'bbdb-insinuate-gnus <span class="org-string">"bbdb-gnus"</span>
      <span class="org-doc">"Hook BBDB into Gnus."</span>)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(autoload 'bbdb-insinuate-message "bbdb"</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">"Hook BBDB into `</span><span class="org-comment"><span class="org-constant">message-mode</span></span><span class="org-comment">'.") ; BBDB 2.35</span>
    (autoload 'bbdb-insinuate-message <span class="org-string">"bbdb-message"</span>
      <span class="org-doc">"Hook BBDB into `</span><span class="org-doc"><span class="org-constant">message-mode</span></span><span class="org-doc">'."</span>))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Search the BBDB.</span>
  (global-set-key (kbd <span class="org-string">"&lt;C-f11&gt;"</span>) #'bbdb)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"bbdb"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Coding system used for reading and writing `</span><span class="org-comment"><span class="org-constant">bbdb-file</span></span><span class="org-comment">'.</span>
    (<span class="org-keyword">setq</span> bbdb-file-coding-system 'utf-8)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Ensure `</span><span class="org-comment"><span class="org-constant">~/.bbdb</span></span><span class="org-comment">' never becomes non utf-8 again (it is defined with</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">defconst</span></span><span class="org-comment">', so it is reset whenever `</span><span class="org-comment"><span class="org-constant">bbdb.el</span></span><span class="org-comment">' is loaded).</span>
    (add-hook 'bbdb-load-hook
              #'(lambda ()
                  (<span class="org-keyword">setq</span> bbdb-file-coding-system 'utf-8)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable the various package-specific BBDB functions.</span>
    (bbdb-initialize 'gnus 'message)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">- Add bindings for the default keys to Gnus and configure Gnus to notify</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">the BBDB when new messages are loaded (required if the BBDB is to be</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">able to display BBDB entries for messages displayed in Gnus).</span>
    <span class="org-comment-delimiter">;;</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">- Add a binding for `</span><span class="org-comment"><span class="org-constant">M-TAB</span></span><span class="org-comment">' to Message mode.  This will enable completion</span>
    <span class="org-comment-delimiter">;;   </span><span class="org-comment">of addresses based on BBDB records.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">What do we do when invoking bbdb interactively (`:' to display sender).</span>
    (<span class="org-keyword">setq</span> bbdb-mua-update-interactive-p '(query . create))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Update BBDB silently (don't display an auto-updated BBDB window).</span>
    (<span class="org-keyword">setq</span> bbdb-mua-pop-up nil)
</pre>
</div>
</div>

<div id="outline-container-org0604286" class="outline-4">
<h4 id="org0604286">Interfaces</h4>
<div class="outline-text-4" id="text-org0604286">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* (info "(bbdb)Interfaces")</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Mail aliases (local mailing lists).</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'message-setup-hook #'bbdb-define-all-aliases) ; BBDB 2.35</span>
    (add-hook 'message-setup-hook #'bbdb-mail-aliases) <span class="org-comment-delimiter">; </span><span class="org-comment">BBDB 3</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Always use full name when sending mail.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(even if User Name has an address of the form <a href="mailto:user.name%40domain">&lt;user.name@domain&gt;</a>)</span>
    (<span class="org-keyword">setq</span> bbdb-dwim-net-address-allow-redundancy t) <span class="org-comment-delimiter">; </span><span class="org-comment">BBDB 2.35</span>
    (<span class="org-keyword">setq</span> bbdb-mail-avoid-redundancy nil) <span class="org-comment-delimiter">; </span><span class="org-comment">BBDB 3</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">No popup on auto-complete.</span>
    (<span class="org-keyword">setq</span> bbdb-completion-display-record nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Completion is done across the set of all full-names and user-ids.</span>
    (<span class="org-keyword">setq</span> bbdb-completion-type nil)
</pre>
</div>
</div>
</div>

<div id="outline-container-org6044f5e" class="outline-4">
<h4 id="org6044f5e">Reader-specific Features</h4>
<div class="outline-text-4" id="text-org6044f5e">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* (info "(bbdb)Reader-specific Features")</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Marking posters with records in the BBDB.</span>
    (<span class="org-keyword">setq</span> bbdb/gnus-summary-mark-known-posters t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Mark authors in the Summary Buffer who have records in the BBDB.</span>
    (<span class="org-keyword">setq</span> bbdb/gnus-summary-known-poster-mark <span class="org-string">"B"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Display the poster's name from the BBDB if we have one.</span>
    (<span class="org-keyword">setq</span> bbdb/gnus-summary-prefer-real-names t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Replace the information provided in the From header with data from the</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">BBDB if we have one.</span>
    (<span class="org-keyword">setq</span> bbdb/gnus-summary-prefer-bbdb-data t)

    (<span class="org-keyword">setq</span> bbdb/gnus-summary-show-bbdb-names t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org1ad4dde" class="outline-4">
<h4 id="org1ad4dde">Options</h4>
<div class="outline-text-4" id="text-org1ad4dde">
<p>
You can add the author of a mail or posting to the BBDB by hitting <code>:</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* (info "(bbdb)Options")</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">No default area code to use when prompting for a new phone number.</span>
    (<span class="org-keyword">setq</span> bbdb-default-area-code nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Default country to use if none is specified.</span>
    (<span class="org-keyword">setq</span> bbdb-default-country <span class="org-string">""</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Disable syntax-checking of telephone numbers.</span>
    (<span class="org-keyword">setq</span> bbdb-north-american-phone-numbers-p nil) <span class="org-comment-delimiter">; </span><span class="org-comment">BBDB 2.35</span>
    (<span class="org-keyword">setq</span> bbdb-phone-style nil)         <span class="org-comment-delimiter">; </span><span class="org-comment">BBDB 3</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Restoration of the window configuration.</span>
    (<span class="org-keyword">setq</span> bbdb-electric-p t)            <span class="org-comment-delimiter">; </span><span class="org-comment">BBDB 2.35</span>
    (<span class="org-keyword">setq</span> bbdb-electric t)              <span class="org-comment-delimiter">; </span><span class="org-comment">BBDB 3</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Don't display a continuously-updating BBDB window while in GNUS.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq bbdb-use-pop-up nil)       ; BBDB 2.35</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq bbdb-pop-up-layout nil)    ; BBDB 3</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Desired number of lines in a GNUS pop-up BBDB window.</span>
    (<span class="org-keyword">setq</span> bbdb-pop-up-target-lines 1)   <span class="org-comment-delimiter">; </span><span class="org-comment">BBDB 2.35</span>
    (<span class="org-keyword">setq</span> bbdb-pop-up-window-size 1)    <span class="org-comment-delimiter">; </span><span class="org-comment">BBDB 3</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Default display layout.</span>
    (<span class="org-keyword">setq</span> bbdb-display-layout 'multi-line)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Default display layout pop-up BBDB buffers.</span>
    (<span class="org-keyword">setq</span> bbdb-pop-up-display-layout 'one-line)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Omit creation-date and time stamp from BBDB display.</span>
    (<span class="org-keyword">setq</span> bbdb-display-layout-alist
          '((one-line          (order     . (phones notes))
                               (name-end  . 24)
                               (toggle    . t)
                               (omit      . (net AKA mail-alias gnus-private
                                                 creation-date timestamp)))
            (multi-line        (indention . 14)
                               (toggle    . t)
                               (omit      . (AKA creation-date timestamp)))
            (pop-up-multi-line (indention . 14))))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Allow cycling of email addresses while completing them.</span>
    (<span class="org-keyword">setq</span> bbdb-complete-name-allow-cycling t) <span class="org-comment-delimiter">; </span><span class="org-comment">BBDB 2.35</span>
    (<span class="org-keyword">setq</span> bbdb-complete-mail-allow-cycling t) <span class="org-comment-delimiter">; </span><span class="org-comment">BBDB 3</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Save the database without asking (any time it would ask).</span>
    (<span class="org-keyword">setq</span> bbdb-offer-save 'auto)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Automatically add some text to the notes field of the BBDB record.</span>
    (add-hook 'bbdb-notice-hook #'bbdb-auto-notes-hook)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Capture auto-notes.</span>
    (<span class="org-keyword">setq</span> bbdb-auto-notes-alist
          <span class="org-comment-delimiter">;; </span><span class="org-comment">Organization.</span>
          `((<span class="org-string">"Organization"</span> (<span class="org-string">".*"</span> Organization 0))

            <span class="org-comment-delimiter">;; </span><span class="org-comment">X-Face bitmaps of the people.</span>
            (<span class="org-string">"x-face"</span> ,(list (concat <span class="org-string">"[ \t\n]*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[</span><span class="org-string"><span class="org-negation-char">^</span></span><span class="org-string"> \t\n]*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span>
                                     <span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[ \t\n]+</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[</span><span class="org-string"><span class="org-negation-char">^</span></span><span class="org-string"> \t\n]+</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">?"</span>
                                     <span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[ \t\n]+</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[</span><span class="org-string"><span class="org-negation-char">^</span></span><span class="org-string"> \t\n]+</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">?"</span>
                                     <span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[ \t\n]+</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">[</span><span class="org-string"><span class="org-negation-char">^</span></span><span class="org-string"> \t\n]+</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">?"</span>)
                             'face
                             <span class="org-string">"\\1\\3\\5\\7"</span>)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdd57529" class="outline-4">
<h4 id="orgdd57529">Utilities</h4>
<div class="outline-text-4" id="text-orgdd57529">
<p>
BBDB 3 has a dial interface which allows you to call an external interface to
make a call.  This is done by modifying <code>bbdb-dial-function</code>.  There are examples
which interface with Skype to make a phone call.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 34 ends here.</span>
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-orga5e8236" class="outline-2">
<h2 id="orga5e8236">Document Viewing</h2>
<div class="outline-text-2" id="text-orga5e8236">
<p>
If <code>doc-view</code> is not showing the PDF files as images in Emacs, it may be
because:
</p>

<ul class="org-ul">
<li>no PNG support is available in Emacs (see <a href="#orgf9bca00">Images</a>), or</li>
<li>some conversion utility for PDF files (Ghostscript) is not on your <code>PATH</code>.</li>
</ul>

<p>
In that case, <code>doc-view</code> falls back to show you the plain text contents of the PDF
if <code>doc-view-pdftotext-program</code> is on your <code>PATH</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 36 (info "(emacs)Document View")</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-36-document-view <span class="org-string">"36 Document Viewing"</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">View PDF/PostScript/DVI files in Emacs.</span>
</pre>
</div>

<p class="verse">
From Tassilo Horn:<br />
<br />
&gt;&gt; <a href="https://github.com/politza/pdf-tools">https://github.com/politza/pdf-tools</a> (available through MELPA).<br />
&gt;<br />
&gt; Oh, that looks pretty impressive.  I haven&rsquo;t used it, though, so I<br />
&gt; cannot help with this.<br />
<br />
Ok, now I had to check it out, and Andreas, it&rsquo;s a really superb<br />
package.  I&rsquo;m gonna use that now for reading PDF files instead of<br />
doc-view (where I&rsquo;m the author) and Evince (which I use due to<br />
doc-view&rsquo;s limitations).<br />
<br />
But Troy is correct.  The PDF he links makes emacs freeze, although I&rsquo;ve<br />
been able to recover by hitting `C-g&rsquo; repeatedly.  The result was that<br />
the raw PDF data was shown.<br />
<br />
Before I had opened that file successfully with doc-view and then did<br />
M-x pdf-view-mode.  That worked.  When doing it that way, it seems some<br />
if not all of PDF Tools minor modes aren&rsquo;t active, so I guess one of<br />
them does something that triggers the freeze.<br />
<br />
Andreas, do you plan to propose PDF Tools for inclusion in Emacs?  IMO,<br />
that&rsquo;s really a package anybody&rsquo;s gonna love.  (Oh my god, how well the<br />
syntex stuff/AUCTeX integration works!)<br />
</p>

<p>
PDF Tools (<code>pdf-view-mode</code>) is a major mode for viewing PDFs in Emacs similar (but
much more advanced) than <code>doc-view-mode</code>.
</p>

<p>
It offers many features:
</p>
<ul class="org-ul">
<li>highlighting search,</li>
<li>highlighting selection,</li>
<li>annotate,</li>
<li>content tree.</li>
</ul>

<p>
It&rsquo;s the best PDF viewer on GNU/Linux (including the ones not running in Emacs).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> leuven--linux-p
             (not (executable-find <span class="org-string">"epdfinfo"</span>)))
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"pdf-tools-autoloads"</span>
      (pdf-tools-install)))
</pre>
</div>
</div>

<div id="outline-container-org32d994c" class="outline-3">
<h3 id="org32d994c">Navigation</h3>
<div class="outline-text-3" id="text-org32d994c">
<p>
<code>doc-view</code> integrates with the usual bookmark facility.  So, simply use <code>C-x r m</code>
(<code>bookmark-set</code>) to jump back to the last page you&rsquo;ve read in a PDF document.
</p>
</div>
</div>

<div id="outline-container-orga6dd705" class="outline-3">
<h3 id="orga6dd705">Conversion</h3>
<div class="outline-text-3" id="text-orga6dd705">
<p>
In <code>doc-view-mode</code>, you can use <code>C-s</code> to do regexp search on the page images.
</p>

<p>
In addition, by pressing <code>C-c C-t</code>, you can open the <b>text</b>-only representation
(actually, the output of the command <code>pdftotext</code>) of the current doc in a new
buffer, which is more suitable for heavy manipulation of the text of the PDF.
</p>

<p>
Another option, without <code>doc-view</code>, is <code>! pdtotext ? - RET</code>.
</p>

<p>
<code>doc-view-enlarge</code> (<code>+</code>) and <code>doc-view-shrink</code> (<code>-</code>) work fine to zoom in or out.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 36 ends here.</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org43b91b4" class="outline-2">
<h2 id="org43b91b4">Web Browsing</h2>
<div class="outline-text-2" id="text-org43b91b4">
</div>
<div id="outline-container-org33530c3" class="outline-3">
<h3 id="org33530c3">EWW (Emacs Web Browser)</h3>
<div class="outline-text-3" id="text-org33530c3">
<p>
<code>EWW</code> is the new Web browser for Emacs.
</p>

<p>
See <a href="https://www.gnu.org/software/emacs/manual/html_node/eww/index.html">https://www.gnu.org/software/emacs/manual/html_node/eww/index.html</a>.
</p>

<p>
<code>M-x eww</code> asks EWW to browse a URL.
</p>

<dl class="org-dl">
<dt><code>&amp;</code> (<code>eww-browse-with-external-browser</code>)</dt><dd>Open the Web page in an <b>external browser</b> (when JavaScript is needed or the
&ldquo;design&rdquo; is just too bad).</dd>

<dt>F (eww-toggle-fonts)</dt><dd>Toggle whether to use variable-pitch fonts or not.  The user can also
customize the <code>shr-use-fonts</code> variable.</dd>

<dt>R (eww-readable)</dt><dd>Try do identify the <b>main textual parts of a web page</b> and <b>display only</b> that,
leaving menus and the like off the page.</dd>

<dt>D (eww-toggle-paragraph-direction)</dt><dd>Toggle the paragraph direction between left-to-right and right-to-left.</dd>

<dt>S</dt><dd>List all eww buffers, and allow managing them.</dd>
</dl>

<p>
HTTPS pages with valid certificates have headers marked in green, while invalid
certificates are marked in red.
</p>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> See package <code>eww-lnum</code> (or <code>avy</code>?)</b><br />
<p>
(define-key eww-mode-map (kbd &ldquo;f&rdquo;) #&rsquo;eww-lnum-follow)
(define-key eww-mode-map (kbd &ldquo;F&rdquo;) #&rsquo;eww-lnum-universal)
</p>
</div>

<div class="tip">
<p>
The <code>M-s M-w</code> key binding (new in Emacs 25) uses <code>eww</code> to search the web for the
text in the region.  It is super handy for quick Google and documentation
searches and this will only make it more useful.
</p>

<p>
The search engine to use for this is specified by the customizable variable
<code>eww-search-prefix</code>.
</p>

</div>
</div>
</div>
</div>

<div id="outline-container-org8a32fc2" class="outline-2">
<h2 id="org8a32fc2">Running Shell Commands from Emacs</h2>
<div class="outline-text-2" id="text-org8a32fc2">
<p>
See customizations at <a href="http://snarfed.org/why_i_run_shells_inside_emacs">http://snarfed.org/why_i_run_shells_inside_emacs</a>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 38 Running (info "(emacs)Shell") Commands from Emacs</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-38-shell <span class="org-string">"38 Running Shell Commands from Emacs"</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Transform shell names to what they really are.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"sh-script"</span>

    (add-to-list 'sh-alias-alist '(sh . bash)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Use shell from Cygwin/MinGW.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq shell-file-name "bash")</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setenv "SHELL" "/bin/bash")</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq explicit-bash-args '("-i")) ; --noediting added in Emacs 24.4</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq explicit-sh-args '("-i"))</span>
</pre>
</div>
</div>

<div id="outline-container-orgcecf76f" class="outline-3">
<h3 id="orgcecf76f">Single Shell</h3>
<div class="outline-text-3" id="text-orgcecf76f">
<p>
<code>M-!</code> (<code>shell-command</code>) reads a line of text using the minibuffer and executes it as
a shell command, in a subshell made just for that command.
</p>

<p>
<code>M-|</code> (<code>shell-command-on-region</code>) passes the contents of the region as the standard
input to the shell command.  By prefixing it with <code>C-u</code>, it deletes the old region
and <b>replaces</b> it with the output from the shell command.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 38.1 Single Shell</span>

  (leuven--section <span class="org-string">"38.1 Single Shell"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Force interactive behavior (to get my handy shell aliases).</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">FIXME Fix for Zsh (zsh:1: command not found: shopt)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(defadvice shell-command (before leuven-shell-command activate)</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(ad-set-arg 0</span>
  <span class="org-comment-delimiter">;;               </span><span class="org-comment">(concat "source ~/.bashrc; shopt -s -q expand_aliases;\n "</span>
  <span class="org-comment-delimiter">;;                       </span><span class="org-comment">(ad-get-arg 0))))</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; For single shell commands (= "the" reference).</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq shell-file-name                 ; Must be in the `</span><span class="org-comment"><span class="org-constant">PATH</span></span><span class="org-comment">'.</span>
  <span class="org-comment-delimiter">;;       </span><span class="org-comment">(or (ignore-errors</span>
  <span class="org-comment-delimiter">;;             </span><span class="org-comment">(file-name-nondirectory (or (executable-find "zsh")</span>
  <span class="org-comment-delimiter">;;                                         </span><span class="org-comment">(executable-find "bash")</span>
  <span class="org-comment-delimiter">;;                                         </span><span class="org-comment">(executable-find "sh"))))</span>
  <span class="org-comment-delimiter">;;           </span><span class="org-comment">(when leuven--win32-p "cmdproxy.exe")))</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Use `</span><span class="org-comment"><span class="org-constant">shell-file-name</span></span><span class="org-comment">' as the default shell.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setenv "SHELL" shell-file-name)</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Switch used to have the shell execute its command line argument.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq shell-command-switch "-c")      ; `</span><span class="org-comment"><span class="org-constant">/c</span></span><span class="org-comment">' did not work with XEmacs.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Quote process arguments to ensure correct parsing on Windows.</span>
  (<span class="org-keyword">setq</span> w32-quote-process-args t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Workaround for Cygwin when 'shell-file-name' is 'bash'.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq null-device "/dev/null"))</span>
</pre>
</div>

<p>
The above assignments may <b>NOT</b> be done <b>in an eval-after-load</b> as those variables
are used by the (La)TeX modes (default + AUCTeX) among others.
</p>
</div>
</div>

<div id="outline-container-org15dd22c" class="outline-3">
<h3 id="org15dd22c">Interactive Subshell</h3>
<div class="outline-text-3" id="text-org15dd22c">
<p>
To run a subshell interactively, type <code>M-x shell</code>.  This creates (or reuses)
a buffer named <code>*shell*</code>, and runs a shell subprocess with input coming from and
output going to that buffer.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 38.2 Interactive Subshell</span>

  (leuven--section <span class="org-string">"38.2 Interactive Subshell"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; For the interactive (sub)shell (and AUCTeX compilation?).</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq explicit-shell-file-name shell-file-name)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge40ee1d" class="outline-3">
<h3 id="orge40ee1d">Shell Mode</h3>
<div class="outline-text-3" id="text-orge40ee1d">
</div>

<div id="outline-container-orgad7edfb" class="outline-4">
<h4 id="orgad7edfb">Entering commands and fixing mistakes</h4>
<div class="outline-text-4" id="text-orgad7edfb">
<dl class="org-dl">
<dt><code>RET</code></dt><dd><b>Execute</b> the <b>command (on</b> the <b>current line)</b>.</dd>

<dt><code>C-c C-u</code></dt><dd><b>Delete input</b> (from the prompt) up to point (equivalent to <code>C-u</code> in Unix
shells).</dd>
</dl>
</div>
</div>

<div id="outline-container-orgfc64995" class="outline-4">
<h4 id="orgfc64995">Completion of filenames</h4>
<div class="outline-text-4" id="text-orgfc64995">
<dl class="org-dl">
<dt><code>M-?</code></dt><dd>Display a list of possible completions for the filename at point.</dd>
</dl>
</div>
</div>

<div id="outline-container-org4599f48" class="outline-4">
<h4 id="org4599f48">Manipulating the output from the last command</h4>
<div class="outline-text-4" id="text-org4599f48">
<dl class="org-dl">
<dt><code>C-c C-r</code></dt><dd><b>Show output</b> from last command (move first line of output to top of window).</dd>

<dt><code>C-c C-o</code></dt><dd><b>Delete output</b> (only) from last command.</dd>
</dl>
</div>
</div>

<div id="outline-container-org4218726" class="outline-4">
<h4 id="org4218726">Sending signals</h4>
<div class="outline-text-4" id="text-org4218726">
<dl class="org-dl">
<dt><code>C-c C-c</code></dt><dd>Interrupt current job (equivalent to <code>C-c</code> in Unix shells, <code>BREAK</code> signal).</dd>

<dt><code>C-c C-z</code></dt><dd>Suspend or stop current job (equivalent to <code>C-z</code> in Unix shells, <code>STOP</code>
signal).</dd>

<dt><code>C-c C-d</code></dt><dd>Send <code>EOF</code> character.</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 38.3 Shell Mode</span>

  (leuven--section <span class="org-string">"38.3 Shell Mode"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">General command-interpreter-in-a-buffer stuff (Shell, SQLi, Lisp, R,</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Python, ...).</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(try-require 'comint)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "comint"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Comint prompt is read only.</span>
    (<span class="org-keyword">setq</span> comint-prompt-read-only t)    <span class="org-comment-delimiter">; </span><span class="org-comment">Text is read-only (in ESS)?</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">No duplicates in command history.</span>
    (<span class="org-keyword">setq-default</span> comint-input-ignoredups t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Input to interpreter causes windows showing the buffer to scroll</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(insert at the bottom).</span>
    (<span class="org-keyword">setq-default</span> comint-scroll-to-bottom-on-input t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Output to interpreter causes windows showing the buffer to scroll</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(add output at the bottom).</span>
    (<span class="org-keyword">setq-default</span> comint-move-point-for-output t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Maximum size in lines for Comint buffers.</span>
    (<span class="org-keyword">setq</span> comint-buffer-maximum-size (* 5 1024))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">If the function</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">comint-truncate-buffer</span></span><span class="org-comment">' is added to</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">comint-output-filter-functions</span></span><span class="org-comment">'.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Strip `</span><span class="org-comment"><span class="org-constant">^M</span></span><span class="org-comment">' characters.</span>
    (add-to-list 'process-coding-system-alist
                 '(<span class="org-string">"sh"</span> . (undecided-dos . undecided-unix))) <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">es</span></span><span class="org-comment">' process.</span>
    (add-to-list 'process-coding-system-alist
                 '(<span class="org-string">"bash"</span> . (undecided-dos . undecided-unix)))
    (add-to-list 'process-coding-system-alist
                 '(<span class="org-string">"zsh"</span> . (undecided-dos . undecided-unix)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Show completion list when ambiguous.</span>
    (<span class="org-keyword">setq</span> comint-completion-autolist t)

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-comint-clear-buffer</span> ()
      <span class="org-doc">"Clear the Comint buffer."</span>
      (<span class="org-keyword">interactive</span>)
      (<span class="org-keyword">let</span> ((comint-buffer-maximum-size 0))
        (comint-truncate-buffer)))

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"comint"</span>
      (define-key comint-mode-map (kbd <span class="org-string">"C-c C-k"</span>) #'leuven-comint-clear-buffer))

<span class="org-comment-delimiter">;; </span><span class="org-comment">)</span>
</pre>
</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Command Prompt Here in Emacs</b><br />
<p>
See <a href="http://tsdh.wordpress.com/category/lisp/emacs-lisp/">http://tsdh.wordpress.com/category/lisp/emacs-lisp/</a> to quickly open a Shell
bufffer from Emacs.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org7124db4" class="outline-3">
<h3 id="org7124db4">Shell Prompts</h3>
<div class="outline-text-3" id="text-org7124db4">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 38.4 Shell Prompts</span>

  (leuven--section <span class="org-string">"38.4 Shell Prompts"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Regexp to match prompts in the inferior shell.</span>
  (<span class="org-keyword">setq</span> shell-prompt-pattern <span class="org-string">"^[</span><span class="org-string"><span class="org-negation-char">^</span></span><span class="org-string">#$%&gt;\n]*[#$%&gt;] *"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Regexp to recognize prompts in the inferior process.</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(setq comint-prompt-regexp shell-prompt-pattern) ; Used as well by SQLi!</span>
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">! Only used if the variable</span>
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">! `</span><span class="org-comment"><span class="org-constant">comint-use-prompt-regexp</span></span><span class="org-comment">' is non-nil.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org614dc11" class="outline-3">
<h3 id="org614dc11">Shell Command History</h3>
<div class="outline-text-3" id="text-org614dc11">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 38.5 Shell Command History</span>

  (leuven--section <span class="org-string">"38.5 Shell Command History"</span>)

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"comint"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Rejects short commands.</span>
    (<span class="org-keyword">setq</span> comint-input-filter
      #'(lambda (str)
          (<span class="org-keyword">and</span> (not (string-match <span class="org-string">"\\`\\s *\\'"</span> str))
               (&gt; (length str) 2))))    <span class="org-comment-delimiter">; </span><span class="org-comment">Ignore '!!' and kin.</span>
</pre>
</div>
</div>

<div id="outline-container-orgf140445" class="outline-4">
<h4 id="orgf140445">Shell History Ring</h4>
<div class="outline-text-4" id="text-orgf140445">
<dl class="org-dl">
<dt><code>C-p</code> (or <code>&lt;up&gt;</code>)</dt><dd>Fetch the next <b>earlier</b> command in the history (doesn&rsquo;t execute it).</dd>

<dt><code>C-n</code> (or <code>&lt;down&gt;</code>)</dt><dd>Fetch the next <b>later</b> command in the history (doesn&rsquo;t execute it).</dd>

<dt><code>M-p</code> (or <code>&lt;C-up&gt;</code>)</dt><dd>Fetch the next <b>earlier</b> command in the history matching the string typed so
far (doesn&rsquo;t execute it).</dd>

<dt><code>M-n</code> (or <code>&lt;C-down&gt;</code>)</dt><dd>Fetch the next <b>later</b> command in the history matching the string typed so
far (doesn&rsquo;t execute it).</dd>

<dt><code>M-r</code></dt><dd>Begin an incremental <b>regexp search of old commands</b>.</dd>

<dt><code>C-c C-l</code></dt><dd>Display the current buffer&rsquo;s <b>history</b> of shell commands.</dd>
</dl>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Cycle backwards/forwards through input history.</span>
    (define-key comint-mode-map
      (kbd <span class="org-string">"C-p"</span>) #'comint-previous-input) <span class="org-comment-delimiter">; </span><span class="org-comment">Shell.</span>
    (define-key comint-mode-map
      (kbd <span class="org-string">"&lt;up&gt;"</span>) #'comint-previous-input) <span class="org-comment-delimiter">; </span><span class="org-comment">Shell + RStudio.</span>
    (define-key comint-mode-map
      (kbd <span class="org-string">"C-n"</span>) #'comint-next-input)  <span class="org-comment-delimiter">; </span><span class="org-comment">Shell.</span>
    (define-key comint-mode-map
      (kbd <span class="org-string">"&lt;down&gt;"</span>) #'comint-next-input) <span class="org-comment-delimiter">; </span><span class="org-comment">Shell + RStudio.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Search backwards/forwards through input history for match for current</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">input.</span>
    (define-key comint-mode-map
      (kbd <span class="org-string">"M-p"</span>) #'comint-previous-matching-input-from-input) <span class="org-comment-delimiter">; </span><span class="org-comment">Shell.</span>
    (define-key comint-mode-map
      (kbd <span class="org-string">"&lt;C-up&gt;"</span>) #'comint-previous-matching-input-from-input) <span class="org-comment-delimiter">; </span><span class="org-comment">RStudio.</span>
    (define-key comint-mode-map
      (kbd <span class="org-string">"M-n"</span>) #'comint-next-matching-input-from-input) <span class="org-comment-delimiter">; </span><span class="org-comment">Shell.</span>
    (define-key comint-mode-map
      (kbd <span class="org-string">"&lt;C-down&gt;"</span>) #'comint-next-matching-input-from-input) <span class="org-comment-delimiter">; </span><span class="org-comment">RStudio.</span>

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"helm-autoloads"</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Use Helm to search `</span><span class="org-comment"><span class="org-constant">comint</span></span><span class="org-comment">' history.</span>
      (define-key comint-mode-map
        (kbd <span class="org-string">"C-c C-l"</span>) #'helm-comint-input-ring)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org611de4f" class="outline-4">
<h4 id="org611de4f">Shell History Copying</h4>
<div class="outline-text-4" id="text-org611de4f">
<p>
Manipulating the transcript: Viewing older commands.
</p>

<dl class="org-dl">
<dt><code>C-c C-p</code></dt><dd>Move point to <b>previous command prompt</b>.</dd>

<dt><code>C-c C-n</code></dt><dd>Move point to <b>next command prompt</b>.</dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-org79326c5" class="outline-3">
<h3 id="org79326c5">Directory Tracking</h3>
<div class="outline-text-3" id="text-org79326c5">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 38.6 Directory Tracking</span>

  (leuven--section <span class="org-string">"38.6 Directory Tracking"</span>)
</pre>
</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Fix case when 2 Shell buffers are run in the same dir (same name error!)</b><br />
<p>
apply: Buffer name `*shell d:/Users/fni/*&rsquo; is in use
</p>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--rename-buffer-to-curdir</span> (<span class="org-type">&amp;optional</span> _string)
    <span class="org-doc">"Change Shell buffer's name to current directory."</span>
    (rename-buffer (concat <span class="org-string">"*shell "</span> default-directory <span class="org-string">"*"</span>)))

  (add-hook 'shell-mode-hook
            #'(lambda ()
                (leuven--rename-buffer-to-curdir)
                (add-hook 'comint-output-filter-functions
                          #'leuven--rename-buffer-to-curdir nil t)))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Local to Shell comint.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org38d257e" class="outline-3">
<h3 id="org38d257e">Options</h3>
<div class="outline-text-3" id="text-org38d257e">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 38.7 Options</span>

  (leuven--section <span class="org-string">"38.7 Options"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Disable command echoing.</span>
  (<span class="org-keyword">setq-default</span> comint-process-echoes t) <span class="org-comment-delimiter">; </span><span class="org-comment">for Linux (not needed for Cygwin)</span>
</pre>
</div>
</div>

<div id="outline-container-org2ec3ac9" class="outline-4">
<h4 id="org2ec3ac9">Paging in Shell</h4>
<div class="outline-text-4" id="text-org2ec3ac9">
<p>
If you ever tried to run a program like <code>git</code> under <code>M-x shell</code>, you will have come
across the warning &ldquo;terminal is not fully functional&rdquo; followed by unusable
behavior.  This is because <code>git</code> sends its output through a pager (probably <code>less</code>),
which requires a real <a href="#orgbb878c3">terminal emulator</a>.
</p>

<p>
Setting the <code>PAGER</code> environment variable to <code>/bin/cat</code> (but only inside Emacs)
solves this problem:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (setenv <span class="org-string">"PAGER"</span> <span class="org-string">"/usr/bin/cat"</span>)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgbb878c3" class="outline-3">
<h3 id="orgbb878c3">Term Mode</h3>
<div class="outline-text-3" id="text-orgbb878c3">
<p>
To run a subshell in a text <b>terminal emulator</b>, use <code>M-x term</code>.  This creates (or
reuses) a buffer named <code>*terminal*</code>, and runs a subshell with input coming from
your keyboard, and output going to that buffer.
</p>

<p>
The terminal emulator uses Term mode, which has two input modes.
</p>

<ul class="org-ul">
<li>In &ldquo;line mode&rdquo;, Term basically acts like <a href="#orge40ee1d">Shell Mode</a>.</li>

<li>In &ldquo;char mode&rdquo;, each character is sent directly to the subshell, as terminal
input; the sole exception is the terminal escape character, which by default
is <code>C-c</code>.</li>
</ul>

<div class="note">
<p>

</p>

<p>
From my experience, none of the terminal emulators in Emacs (<code>term</code>, <code>ansi-term</code>,
<code>multi-term</code>) is supported under Windows.  It looks like the main reason is all of
them rely on low-level support for terminals (<code>stty</code>, etc.) which is not provided
by Windows.
</p>

<p>
Though, <code>term</code>, <code>ansi-term</code>, and <code>multi-term</code> do <b>work in Cygwin Emacs</b>.
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 38.9 Term Mode</span>

  (leuven--section <span class="org-string">"38.9 Term Mode"</span>)
</pre>
</div>

<p>
Emacs <b>Shell mode</b> doesn&rsquo;t support (all) terminal control codes, so <code>less</code> doesn&rsquo;t
work (&ldquo;page-at-a-time&rdquo; feature).
</p>

<p>
Shell mode buffers do not use PTYs (pseudo-terminals), so programs running in
such a buffer (the shell, the programs run by the shell, etc.) can&rsquo;t perform
character-at-a-time input.  Each line is typed in full and only sent when <code>RET</code>
is pressed.  To see proof, run the <code>tty</code> command in a Shell mode buffer, and its
output will be <code>not a tty</code>.
</p>

<p>
Note that it may seem that this is not true because you can perform command-line
editing with <code>C-b</code>, <code>C-f</code>, etc.  But this is only because <code>shell-mode</code> itself
simulates the typical command-line editing features of shells like Bash, Zsh,
etc. using Emacs own internal editing capabilities.
</p>

<p>
Anyway, you can:
</p>

<ul class="org-ul">
<li>use <code>isearch</code> to search through the command output,</li>
<li>copy stuff into the kill ring or</li>
<li>use the rectangle functions.</li>
</ul>

<p>
Or you might just prefer the Emacs key bindings over the ones your shell offers.
</p>

<p>
On the other hand, <b>Term mode</b> provides a proper <b>terminal emulator</b> (though not as
good as the good old <code>xterm</code>).  You must use it for applications that are
interactive with your terminal (such as the command <code>top</code>).
</p>

<div class="note">
<p>
In Shell mode, use <code>M-x proced</code> instead of <code>top</code>.
</p>

</div>

<div class="note">
<p>
<code>MPlayer</code> commands do not work in the Emacs shell.  Use <code>term</code> for <code>/</code> and <code>*</code> to
decrease / increase volume.
</p>

</div>

<p>
You can <b>switch to line mode</b> (<code>C-c C-j</code>) when you need Term to <i>basically</i> act like
a Shell mode buffer, and move around the buffer pretty much like anywhere else
in Emacs.  Copy / kill-ring commands, <code>isearch</code>, etc. do work.
</p>

<p>
Then, you can use <code>C-c C-k</code> to <b>switch</b> back <b>to character mode</b>, the default, which
is like your normal <b>terminal</b> emulator except the escape key.
</p>

<p>
It&rsquo;s wrong to think that <code>M-x term</code> captures everything it seems (which would
defeat the purpose of running it inside Emacs):
</p>

<ul class="org-ul">
<li>In the default character mode, <code>C-c</code> is the key prefix.</li>
<li>In line mode, you don&rsquo;t need a prefix.</li>
</ul>

<p>
Try also to use <code>M-x ansi-term</code> (Emacs terminal that accepts the ANSI-terminal
escape sequences) that is much better than <code>term</code>:
</p>
<ul class="org-ul">
<li>with <code>M-x term</code>, you can run <b>only one shell</b>;</li>
<li>with <code>M-x ansi-term</code>, you can start more than one (<code>*ansi-term*&lt;2&gt;</code>,
<code>*ansi-term*&lt;3&gt;</code>).</li>
</ul>

<p>
Note that <code>TERM</code> is different in both environments:
</p>
<ul class="org-ul">
<li>In <code>M-x shell</code>, <code>TERM=emacs</code></li>
<li>In <code>M-x term</code>,  <code>TERM=eterm-color</code></li>
</ul>

<p>
MultiTerm (<a href="http://www.emacswiki.org/emacs/MultiTerm">http://www.emacswiki.org/emacs/MultiTerm</a>) works much better than
shell or term.
</p>

<p>
&ldquo;Multi-term on POSIX hosts has let me switch from using screen, with one Emacs
screen and lots of shell screens; to just using Emacs, with lots of terminals
inside it.&rdquo;
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Managing multiple terminal buffers in Emacs</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(and fixing some troubles of `</span><span class="org-comment"><span class="org-constant">term-mode</span></span><span class="org-comment">': key bindings, etc.).</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-eval-after-load "multi-term-autoloads"</span>
  <span class="org-comment-delimiter">;;</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">;; (global-set-key (kbd "C-c t") #'multi-term-next)</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(global-set-key (kbd "C-c T") #'multi-term)) ; Create a new one.</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"multi-term"</span>

    (<span class="org-keyword">setq</span> multi-term-program shell-file-name))
</pre>
</div>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Try <i>visual</i> commands (like <code>top</code> or <code>less</code>) in <code>multi-term</code></b><br />
nil</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Run an inferior shell, with I/O through buffer `</span><span class="org-comment"><span class="org-constant">*shell*</span></span><span class="org-comment">'.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(kbd "C-c !")</span>
  <span class="org-comment-delimiter">;;   </span><span class="org-comment">(cond (leuven--win32-p 'shell)</span>
  <span class="org-comment-delimiter">;;         </span><span class="org-comment">(t 'term)))</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Toggle to and from the `</span><span class="org-comment"><span class="org-constant">*shell*</span></span><span class="org-comment">' buffer.</span>
  (global-set-key (kbd <span class="org-string">"C-!"</span>)
    #'(lambda ()
        (<span class="org-keyword">interactive</span>)
        (switch-or-start 'shell <span class="org-string">"*shell*"</span>)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org34fb1f5" class="outline-3">
<h3 id="org34fb1f5">Remote Host</h3>
<div class="outline-text-3" id="text-org34fb1f5">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 38.10 Remote Host Shell</span>

  (leuven--section <span class="org-string">"38.10 Remote Host Shell"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Load ssh.el file.</span>
  (add-to-list 'same-window-regexps <span class="org-string">"^\\*ssh-.*\\*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">&lt;[0-9]+&gt;</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span>)
  (autoload 'ssh <span class="org-string">"ssh"</span>
    <span class="org-doc">"Open a network login connection via `</span><span class="org-doc"><span class="org-constant">ssh</span></span><span class="org-doc">'."</span> t)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">This is to run ESS remotely on another computer in my own Emacs, or just</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">plain old reading remote files.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">See http://emacs.1067599.n5.nabble.com/SSH-inside-Emacs-td225528.html</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">- plink (with `</span><span class="org-comment"><span class="org-constant">dumb</span></span><span class="org-comment">' terminal option?) as interactive shell</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">- ssh -t -t user@host</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">- Cygwin'ized Emacs</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">- MSYS (MinGW)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orga78f21d" class="outline-3">
<h3 id="orga78f21d">Serial Terminal</h3>
<div class="outline-text-3" id="text-orga78f21d">
<p>
Since GNU Emacs 23, there&rsquo;s now support for serial port access.  The new command
<code>serial-term</code> starts an interactive terminal on a serial port.
</p>
</div>
</div>

<div id="outline-container-org24063d8" class="outline-3">
<h3 id="org24063d8">Helper for GNU Emacs on w32</h3>
<div class="outline-text-3" id="text-org24063d8">
<p>
Let Emacs, for example, find the program <code>/usr/bin/gunzip</code>.
</p>

<p>
<b>But <code>cygwin-mount-activate</code> causes problems (Emacs crashes or unable to connect)
when reading mail with Gnus&#x2026;</b>
</p>

<p>
Those problems disappear as soon as we do <code>cygwin-mount-deactivate</code>&#x2026;
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Let Windows Emacs recognize Cygwin paths (e.g. /usr/local/lib).</span>
  (<span class="org-keyword">when</span> (<span class="org-keyword">and</span> leuven--win32-p
             (executable-find <span class="org-string">"mount"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">Cygwin bin directory found.</span>

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"cygwin-mount-autoloads"</span>

      (autoload 'cygwin-mount-activate <span class="org-string">"cygwin-mount"</span>
        <span class="org-doc">"Activate cygwin-mount- and cygwin-style-handling."</span> t)

      <span class="org-comment-delimiter">;; </span><span class="org-comment">(cygwin-mount-activate)           ; This is sometimes VERY SLOW!</span>
      ))
</pre>
</div>

<p>
See <code>w32-settings.el</code> for more!
</p>
</div>
</div>

<div id="outline-container-orgd6cf69d" class="outline-3">
<h3 id="orgd6cf69d">Helper for Cygwin Emacs</h3>
<div class="outline-text-3" id="text-orgd6cf69d">
<p>
If you want the <b>backslashes</b> in the <b>Windows paths</b> returned by Everything to be
interpreted correctly, you should use <code>windows-path</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Let Cygwin Emacs recognize Windows paths (e.g. C:\Program Files\).</span>
  (<span class="org-keyword">when</span> leuven--cygwin-p

    (try-require 'windows-path)         <span class="org-comment-delimiter">; </span><span class="org-comment">Require cygwin-mount!</span>

    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"windows-path"</span>

      <span class="org-comment-delimiter">;; </span><span class="org-comment">Activate windows-path-style-handling.</span>
      (windows-path-activate)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org03c3180" class="outline-3">
<h3 id="org03c3180">Emacs Speaks Statistics (ESS)</h3>
<div class="outline-text-3" id="text-org03c3180">
<p>
See:
</p>
<ul class="org-ul">
<li><a href="http://ess.r-project.org/Manual/ess.html">http://ess.r-project.org/Manual/ess.html</a>,</li>
<li><a href="http://www.emacswiki.org/emacs/EmacsSpeaksStatistics">http://www.emacswiki.org/emacs/EmacsSpeaksStatistics</a>.</li>
</ul>
</div>

<div id="outline-container-org7c4faa9" class="outline-4">
<h4 id="org7c4faa9">2 Installing ESS on your system</h4>
<div class="outline-text-4" id="text-org7c4faa9">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  (leuven--section <span class="org-string">"Utilities -- ESS"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">ESS: Emacs Speaks Statistics</span>
  (autoload 'R <span class="org-string">"ess-site"</span>
    <span class="org-doc">"Call 'R', the 'GNU S' system from the R Foundation."</span> t)

  (autoload 'R-mode <span class="org-string">"ess-site"</span>
    <span class="org-doc">"Major mode for editing R source."</span> t)

  (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.[rR]\\'"</span> . R-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcf79ad7" class="outline-4">
<h4 id="orgcf79ad7">3 Interacting with statistical programs</h4>
<div class="outline-text-4" id="text-orgcf79ad7">
<p>
Start an R session with <code>M-x R</code>.
</p>

<div class="note">
<p>
To run statistical processes under ESS, Windows users will need to make sure
that the directories for <code>R</code> or <code>Rterm</code> (see <code>inferior-R-program-name</code>) are in their
<code>PATH</code> environment variable.
</p>

</div>

<p>
<b>Customize</b> variables for ESS (set these variables <b>before</b> loading <code>ess-site</code>).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Start R in current working directory, don't ask user.</span>
  (<span class="org-keyword">setq</span> ess-ask-for-ess-directory nil)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">New inferior ESS process appears in another window in the current frame.</span>
  (<span class="org-keyword">setq</span> inferior-ess-same-window nil)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">when</span> leuven--cygwin-p                 <span class="org-comment-delimiter">; </span><span class="org-comment">Using R from Cygwin.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Safe 8.3 name for 32-bit programs.</span>
    (<span class="org-keyword">setq</span> ess-program-files <span class="org-string">"c:/PROGRA~2"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Safe 8.3 name for 64-bit programs.</span>
    (<span class="org-keyword">setq</span> ess-program-files-64 <span class="org-string">"c:/PROGRA~1"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Program name for invoking an inferior ESS with `M-x R'.</span>
    (<span class="org-keyword">setq</span> inferior-R-program-name <span class="org-string">"R"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">[Default: Rterm].</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Accented characters on graphics.</span>
  (add-to-list 'process-coding-system-alist
               '(<span class="org-string">"R.*"</span> . iso-latin-1))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb0ab55a" class="outline-4">
<h4 id="orgb0ab55a">4 Interacting with the ESS process</h4>
<div class="outline-text-4" id="text-orgb0ab55a">
<ul class="org-ul">
<li><code>inferior-ess-mode-map</code> for R console only</li>
<li><code>comint-mode-map</code> for Shell console as well</li>
</ul>
</div>
</div>

<div id="outline-container-org9d12912" class="outline-4">
<h4 id="org9d12912">5 Sending code to the ESS process</h4>
<div class="outline-text-4" id="text-org9d12912">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Display input commands in the process buffer.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq ess-eval-visibly 'nowait)       ; But avoid Emacs hanging on large</span>
  <span class="org-comment-delimiter">;;                                       </span><span class="org-comment">; evaluations.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orga6e756c" class="outline-4">
<h4 id="orga6e756c">7 Editing objects and functions</h4>
<div class="outline-text-4" id="text-orga6e756c">
<p>
Smart underscore:
</p>
<ul class="org-ul">
<li>Pressing underscore once inserts <code>&lt;-</code>.</li>
<li>Pressing underscore twice inserts a literal underscore.</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Default ESS indentation style.</span>
  (<span class="org-keyword">setq</span> ess-default-style 'DEFAULT)
</pre>
</div>
</div>

<div id="outline-container-org9eb8afd" class="outline-5">
<h5 id="org9eb8afd">Code folding</h5>
<div class="outline-text-5" id="text-org9eb8afd">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ess-site"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Code folding in ESS mode.</span>
    (add-hook 'ess-mode-hook #'hs-minor-mode)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0b3dfb5" class="outline-4">
<h4 id="org0b3dfb5">9 Completion</h4>
<div class="outline-text-4" id="text-org0b3dfb5">
</div>
<div id="outline-container-org7b3abb0" class="outline-5">
<h5 id="org7b3abb0">Integration with auto-complete package</h5>
<div class="outline-text-5" id="text-org7b3abb0">
<div class="note">
<p>
R docs are not in Info format.  Though, they are available via the quick help of
Auto-Complete.
</p>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Suffix appended by `</span><span class="org-comment"><span class="org-constant">ac-source-R-args</span></span><span class="org-comment">' to candidates.</span>
    (<span class="org-keyword">setq</span> ess-ac-R-argument-suffix <span class="org-string">"="</span>)
</pre>
</div>

<p>
XXX Switch to <code>company-ess</code>, which does auto-start completion of function
arguments with 0 characters.
</p>

<p>
On <span class="timestamp-wrapper"><span class="timestamp">[2014-11-13 Thu]</span></span>, Vitalie Spinu wrote that he will add native Company support
in ESS in the near future.
</p>
</div>
</div>
</div>

<div id="outline-container-org920ac62" class="outline-4">
<h4 id="org920ac62">10 Developing with ESS</h4>
<div class="outline-text-4" id="text-org920ac62">
<p>
See
</p>
<ul class="org-ul">
<li><a href="http://code.google.com/p/ess-tracebug/">http://code.google.com/p/ess-tracebug/</a></li>
<li><a href="http://code.google.com/p/ess-tracebug/wiki/GettingStarted">http://code.google.com/p/ess-tracebug/wiki/GettingStarted</a>.</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Activate ess-tracebug every time r session starts.</span>
    (add-hook 'ess-post-run-hook #'ess-tracebug)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc2b9c99" class="outline-4">
<h4 id="orgc2b9c99">11 Other ESS features and tools</h4>
<div class="outline-text-4" id="text-orgc2b9c99">
</div>
<div id="outline-container-org22c4ee9" class="outline-5">
<h5 id="org22c4ee9">Describe object at point</h5>
<div class="outline-text-5" id="text-org22c4ee9">
<p>
Get info for object at point, and display it in an electric buffer with the
command <code>ess-describe-object-at-point</code> (bound to <code>C-c C-d C-e</code>, repeat <code>C-e</code> or <code>e</code> to
cycle between <code>str()</code>, <code>head()</code>, <code>tail()</code> and <code>summary()</code>).
</p>

<p>
Use <code>other-window</code> to switch to <code>*ess-describe*</code> window.
</p>

<p>
It was inspired by Erik Iverson&rsquo;s <code>ess-R-object-tooltip</code>.
</p>
</div>
</div>

<div id="outline-container-org5e1e1ab" class="outline-5">
<h5 id="org5e1e1ab">ElDoc</h5>
<div class="outline-text-5" id="text-org5e1e1ab">
<p>
Since ESS v12.02, ElDoc functionality (to report R function arguments) has been
moved into the core, and is active by default; so you don&rsquo;t need to configure
anything&#x2026;
</p>

<p>
When you visit a R mode, ElDoc will be turned on.  However, you will <b>first need
to associate the R buffer with an R process</b> so that args can be looked up &#x2013;
otherwise, ElDoc will silently not report anything.
</p>

<p>
So, e.g. try:
</p>
<ol class="org-ol">
<li><code>C-x C-f somefile.R</code></li>
<li><code>M-x R</code> (so that <code>somefile.R</code> is associated with <code>*R*</code>)</li>
<li>ElDoc should then work.</li>
</ol>
</div>
</div>

<div id="outline-container-orgbd4e291" class="outline-5">
<h5 id="orgbd4e291">Highlighting</h5>
<div class="outline-text-5" id="text-orgbd4e291">
<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Font-lock keywords for the R mode.</span>
    (<span class="org-keyword">setq</span> ess-R-font-lock-keywords
          '((ess-R-fl-keyword:modifiers . t) <span class="org-comment-delimiter">; </span><span class="org-comment">Default.</span>
            (ess-R-fl-keyword:fun-defs . t) <span class="org-comment-delimiter">; </span><span class="org-comment">Default.</span>
            (ess-R-fl-keyword:keywords . t) <span class="org-comment-delimiter">; </span><span class="org-comment">Default.</span>
            (ess-R-fl-keyword:assign-ops . t) <span class="org-comment-delimiter">; </span><span class="org-comment">Default.</span>
            (ess-R-fl-keyword:constants . t) <span class="org-comment-delimiter">; </span><span class="org-comment">Default.</span>
            (ess-fl-keyword:fun-calls . t)
            (ess-fl-keyword:numbers . t)
            (ess-fl-keyword:operators . t)
            (ess-fl-keyword:delimiters . t)
            (ess-fl-keyword:= . t)
            (ess-R-fl-keyword:F&amp;T . t)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Font-lock patterns used in inferior-R-mode buffers.</span>
    (<span class="org-keyword">setq</span> inferior-R-font-lock-keywords
          '((ess-S-fl-keyword:prompt . t) <span class="org-comment-delimiter">; </span><span class="org-comment">Default.</span>
            (ess-R-fl-keyword:messages . t) <span class="org-comment-delimiter">; </span><span class="org-comment">Default.</span>
            (ess-R-fl-keyword:modifiers . t) <span class="org-comment-delimiter">; </span><span class="org-comment">Default.</span>
            (ess-R-fl-keyword:fun-defs . t) <span class="org-comment-delimiter">; </span><span class="org-comment">Default.</span>
            (ess-R-fl-keyword:keywords . t) <span class="org-comment-delimiter">; </span><span class="org-comment">Default.</span>
            (ess-R-fl-keyword:assign-ops . t) <span class="org-comment-delimiter">; </span><span class="org-comment">Default.</span>
            (ess-R-fl-keyword:constants . t) <span class="org-comment-delimiter">; </span><span class="org-comment">Default.</span>
            (ess-fl-keyword:matrix-labels . t) <span class="org-comment-delimiter">; </span><span class="org-comment">Default.</span>
            (ess-fl-keyword:fun-calls . t)
            (ess-fl-keyword:numbers . t)
            (ess-fl-keyword:operators . t)
            (ess-fl-keyword:delimiters . t)
            (ess-fl-keyword:= . t)
            (ess-R-fl-keyword:F&amp;T . t)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org76ed6e5" class="outline-5">
<h5 id="org76ed6e5">Rdired</h5>
<div class="outline-text-5" id="text-org76ed6e5">
<p>
With your point on the line of a variable,
</p>

<ul class="org-ul">
<li><code>p</code> will plot the object,</li>
<li><code>v</code> will view it, and</li>
<li><code>d</code> will mark the object for deletion (<code>x</code> will actually perform the deletion).</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    <span class="org-comment-delimiter">;; </span><span class="org-comment">Prototype object browser for R, looks like dired mode.</span>
    (autoload 'ess-rdired <span class="org-string">"ess-rdired"</span>
      <span class="org-doc">"View *R* objects in a dired-like buffer."</span> t)
</pre>
</div>

<p>
You could prefer to have the <code>*R dired*</code> buffer in a separate frame.  Check out
<code>special-display-buffer-names</code>.
</p>

<p>
Or have it dedicated in a window.  Check out
<a href="https://github.com/emacsmirror/dedicated">https://github.com/emacsmirror/dedicated</a>.
</p>
</div>
</div>

<div id="outline-container-orgb962794" class="outline-5">
<h5 id="orgb962794">Interaction with Org mode</h5>
<div class="outline-text-5" id="text-orgb962794">
<p>
For anyone who wants to try it, after cloning into <code>~/elisp/polymode</code>, I only
needed to add this in my init (ESS was already in my init).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">setq</span> load-path
           (append '(<span class="org-string">"~/elisp/polymode"</span>  <span class="org-string">"~/elisp/polymode/modes"</span>)
                   load-path))
    (<span class="org-keyword">require</span> '<span class="org-constant">poly-org</span>)
    (add-to-list 'auto-mode-alist '(<span class="org-string">"\\.org"</span> . poly-org-mode))
</pre>
</div>

<p>
When point is inside a src-block the local mode prevails. So, <code>C-c C-n</code> inside an
R src block sends the line point is on to the R process. <code>C-c C-c</code> sends the
region (or function or paragraph) to the process when point is in the body. To
execute <code>org-ctrl-c-ctrl-c</code> on the src block with the <code>C-c C-c</code> keying, it is
necessary to move point to before or after the body.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org2d8614a" class="outline-3">
<h3 id="org2d8614a">Proced</h3>
<div class="outline-text-3" id="text-org2d8614a">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* Proced</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; Start Proced in a similar manner to Dired.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-x p") #'proced) ; Conflict with Bkmp.</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"proced"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Current sort scheme for Proced listing.</span>
    (<span class="org-keyword">setq-default</span> proced-sort 'start)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Display of Proced buffer as process tree.</span>
    (<span class="org-keyword">setq-default</span> proced-tree-flag t))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgd764534" class="outline-2">
<h2 id="orgd764534">Using Emacs Server</h2>
<div class="outline-text-2" id="text-orgd764534">
<div class="note">
<p>
The Emacs version you&rsquo;re using and the <code>emacsclient</code> version you&rsquo;re using must be
from the <b>same Emacs version</b>&#x2026;  If the latter is not the cause of a refused
connection, re-try <code>M-x server-start</code> in Emacs.
</p>

</div>

<p>
<code>emacsclient</code> is waiting for Emacs to tell it it&rsquo;s done editing that file.
That&rsquo;s important if you use <code>emacsclient</code> as your <code>EDITOR</code>.  If you want
<code>emacsclient</code> to return immediately, use the <code>-n</code> option.
</p>

<p>
Do you use <code>emacsclient</code> in terminals?  If not, just use parameter <code>-c -n</code>, which
creates an X Window and doesn&rsquo;t wait for <code>(server-edit)</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 39 (info "(emacs)Emacs Server")</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-39-emacs-server <span class="org-string">"39 Using Emacs as a Server"</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Use Emacs as a server (with the `</span><span class="org-comment"><span class="org-constant">emacsclient</span></span><span class="org-comment">' program).</span>
  (<span class="org-keyword">unless</span> noninteractive
    (idle-require 'server))             <span class="org-comment-delimiter">; </span><span class="org-comment">After init.</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"server"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Test whether server is (definitely) running, avoiding the message of</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">"server-start" while opening another Emacs session.</span>
    (<span class="org-keyword">or</span> (equal (server-running-p) t)

        <span class="org-comment-delimiter">;; </span><span class="org-comment">Start the Emacs server.</span>
        (server-start))                 <span class="org-comment-delimiter">; </span><span class="org-comment">~ 0.20 s</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Save file without confirmation before returning to the client.</span>
    (<span class="org-keyword">defadvice</span> <span class="org-function-name">server-edit</span> (before save-buffer-if-needed activate)
      <span class="org-doc">"Save current buffer before marking it as done."</span>
      (<span class="org-keyword">when</span> server-buffer-clients (save-buffer))))

)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 39 ends here.</span>
</pre>
</div>

<p>
Since GNU Emacs 23, there is also a <code>--daemon</code> flag to start the server in a
convenient way.
</p>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Understand the following:</b><br />
<div class="org-src-container">
<pre class="src src-emacs-lisp">        <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'server-done-hook</span>
        <span class="org-comment-delimiter">;;        </span><span class="org-comment">#'(lambda ()</span>
        <span class="org-comment-delimiter">;;          </span><span class="org-comment">(shell-command "screen -r -X select `cat ~/tmp/emacsclient-caller`")))</span>
</pre>
</div>

<p>
and see
<a href="http://blog.jr0cket.co.uk/2012/10/using-emacs-24-server-on-mac-osx-for.html">http://blog.jr0cket.co.uk/2012/10/using-emacs-24-server-on-mac-osx-for.html</a>
for ideas about having the right <code>emacsclient</code> used to connect to the Emacs
server.
</p>
</div>

<div class="note">
<p>
You can use <code>emacsclient</code> with a different Emacs daemon. For example, you can
start your Git checkout Emacs binary and the local installation with:
</p>

<pre class="example">
/path/to/git/checkout/src/emacs --daemon=git
emacs --daemon=local
</pre>


<p>
and use <code>emacsclient -s git</code> or <code>emacsclient -s local</code> to connect to the daemon you
want to use.
</p>

</div>
</div>
</div>

<div id="outline-container-orgfcc393b" class="outline-2">
<h2 id="orgfcc393b">Printing Hard Copies</h2>
<div class="outline-text-2" id="text-orgfcc393b">
<p>
You can print any buffer with <code>C-u M-x ps-print-buffer-with-faces RET</code>.  Because
of the <code>C-u</code>, it will prompt for a file to place the PostScript into.  You can
then convert PS to PDF, if so desired.
</p>

<p>
You can print without faces (i.e. no colour) with <code>ps-print-buffer</code>.
</p>

<p>
You may wish to set <code>ps-print-landscape</code> to <code>t</code>.
</p>

<p>
See <code>(info "(emacs)Windows Printing")</code> for several methods of correctly setting up
printing on Windows.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 40 (info "(emacs)Printing")</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-40-printing <span class="org-string">"40 Printing Hard Copies"</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Print Emacs buffer on line printer</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">for {lpr,print}-{buffer,region}.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"lpr"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Name of program for printing a file.</span>
    (<span class="org-keyword">setq</span> lpr-command (executable-find <span class="org-string">"enscript"</span>))
                                    <span class="org-comment-delimiter">; </span><span class="org-comment">TODO Install `</span><span class="org-comment"><span class="org-constant">enscript</span></span><span class="org-comment">'.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">List of strings to pass as extra options for the printer program.</span>
    (<span class="org-keyword">setq</span> lpr-switches (list <span class="org-string">"--font=Courier8"</span>
                             <span class="org-string">"--header-font=Courier10"</span>
                             (format <span class="org-string">"--header=%s"</span> (buffer-name))))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Name of a printer to which data is sent for printing.</span>
    (<span class="org-keyword">setq</span> printer-name t))

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-ps-print-buffer-with-faces-query</span> ()
    <span class="org-doc">"Query user before printing the buffer."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">when</span> (y-or-n-p <span class="org-string">"Are you sure you want to print this buffer? "</span>)
      (ps-print-buffer-with-faces)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Generate and print a PostScript image of the buffer.</span>
  (<span class="org-keyword">when</span> leuven--win32-p
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Override `Print Screen' globally used as a hotkey by Windows.</span>
    (w32-register-hot-key (kbd <span class="org-string">"&lt;snapshot&gt;"</span>))
    (global-set-key
      (kbd <span class="org-string">"&lt;snapshot&gt;"</span>) #'leuven-ps-print-buffer-with-faces-query))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Print text from the buffer as PostScript.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ps-print"</span>

    (<span class="org-keyword">defvar</span> <span class="org-variable-name">gsprint-program</span>
      (concat leuven--windows-program-files-dir <span class="org-string">"Ghostgum/gsview/gsprint.exe"</span>)
      <span class="org-doc">"Defines the Windows path to the gsview executable."</span>)

    (leuven--file-exists-and-executable-p gsprint-program)

    (<span class="org-keyword">if</span> (<span class="org-keyword">and</span> gsprint-program
             (executable-find gsprint-program))

        (<span class="org-keyword">progn</span>
          <span class="org-comment-delimiter">;; </span><span class="org-comment">Name of a local printer for printing PostScript files.</span>
          (<span class="org-keyword">setq</span> ps-printer-name t)      <span class="org-comment-delimiter">; </span><span class="org-comment">Adjusted to run Ghostscript.</span>


          <span class="org-comment-delimiter">;; </span><span class="org-comment">Name of program for printing a PostScript file.</span>
          (<span class="org-keyword">setq</span> ps-lpr-command gsprint-program)
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Tell Emacs where Ghostscript print</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">utility is located.</span>

          <span class="org-comment-delimiter">;; </span><span class="org-comment">List of extra switches to pass to `</span><span class="org-comment"><span class="org-constant">ps-lpr-command</span></span><span class="org-comment">'.</span>
          (<span class="org-keyword">setq</span> ps-lpr-switches '(<span class="org-string">"-query"</span>)))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Tell Ghostscript to query which</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">printer to use.</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">'("-q" "-dNOPAUSE" "-dBATCH" "-sDEVICE=mswinpr2")</span>

      (<span class="org-keyword">setq</span> ps-printer-name <span class="org-string">"//PRINT-SERVER/Brother HL-4150CDN"</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">XXX</span>
      (<span class="org-keyword">setq</span> ps-lpr-command <span class="org-string">""</span>)
      (<span class="org-keyword">setq</span> ps-lpr-switches '(<span class="org-string">"raw"</span>)))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq ps-error-handler-message 'system)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Size of paper to format for.</span>
    (<span class="org-keyword">setq</span> ps-paper-type 'a4)
    (<span class="org-keyword">setq</span> ps-warn-paper-type nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Print in portrait mode.</span>
    (<span class="org-keyword">setq</span> ps-landscape-mode nil)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq ps-print-control-characters nil)</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Number of columns.</span>
    (<span class="org-keyword">setq</span> ps-number-of-columns 1)

    (<span class="org-keyword">setq</span> ps-left-margin 40)
    (<span class="org-keyword">setq</span> ps-right-margin 56)
    (<span class="org-keyword">setq</span> ps-bottom-margin 22)
    (<span class="org-keyword">setq</span> ps-top-margin 32)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Page layout: Header [file-name     2001-06-18 Mon]</span>
    (<span class="org-keyword">setq</span> ps-print-header-frame nil)    <span class="org-comment-delimiter">; </span><span class="org-comment">No box around the header.</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">See http://www.emacswiki.org/emacs/PsPrintPackage-23.</span>
    (<span class="org-keyword">setq</span> ps-header-frame-alist '((fore-color . <span class="org-string">"#CCCCCC"</span>)))
    (<span class="org-keyword">setq</span> ps-header-lines 1)
    (<span class="org-keyword">setq</span> ps-header-font-family 'Helvetica)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq ps-header-font-size 11)</span>
    (<span class="org-keyword">setq</span> ps-header-title-font-size 11)
    (<span class="org-keyword">defun</span> <span class="org-function-name">ps-time-stamp-yyyy-mm-dd-aaa</span> ()
      <span class="org-doc">"Return date as \"yyyy-MM-dd ddd\" (ISO 8601 date + day of week)."</span>
      (format-time-string <span class="org-string">"%Y-%m-%d %a"</span>))
    (<span class="org-keyword">setq</span> ps-right-header '(ps-time-stamp-yyyy-mm-dd-aaa))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Page layout: Footer [                         n/m]</span>
    (<span class="org-keyword">setq</span> ps-footer-offset 14)
    (<span class="org-keyword">setq</span> ps-footer-line-pad .50)
    (<span class="org-keyword">setq</span> ps-print-footer t)
    (<span class="org-keyword">setq</span> ps-print-footer-frame nil)    <span class="org-comment-delimiter">; </span><span class="org-comment">No box around the footer.</span>
    (<span class="org-keyword">setq</span> ps-footer-frame-alist '((fore-color . <span class="org-string">"#666666"</span>)))
    (<span class="org-keyword">setq</span> ps-footer-lines 1)
    (<span class="org-keyword">setq</span> ps-footer-font-family 'Helvetica)
    (<span class="org-keyword">setq</span> ps-footer-font-size 8)
    (<span class="org-keyword">setq</span> ps-left-footer nil)
    (<span class="org-keyword">setq</span> ps-right-footer (list <span class="org-string">"/pagenumberstring load"</span>)) <span class="org-comment-delimiter">; </span><span class="org-comment">Page n of m.</span>

    (<span class="org-keyword">setq</span> ps-font-family 'Courier)      <span class="org-comment-delimiter">; </span><span class="org-comment">See `</span><span class="org-comment"><span class="org-constant">ps-font-info-database</span></span><span class="org-comment">'.</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Legitimate values include Courier,</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Helvetica, NewCenturySchlbk, Palatino</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">and Times.</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Font size, in points, for ordinary text, when generating PostScript.</span>
    (<span class="org-keyword">setq</span> ps-font-size 9.1)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Specify if face background should be used.</span>
    (<span class="org-keyword">setq</span> ps-use-face-background t)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Specify line spacing, in points, for ordinary text.</span>
    (<span class="org-keyword">setq</span> ps-line-spacing 3))

)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 40 ends here.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdf3b949" class="outline-2">
<h2 id="orgdf3b949">Sorting Text</h2>
<div class="outline-text-2" id="text-orgdf3b949">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 41 (info "(emacs)Sorting") Text</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-41-sorting <span class="org-string">"41 Sorting Text"</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Key binding.</span>
  (global-set-key (kbd <span class="org-string">"C-c ^"</span>) #'sort-lines)

)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 41 ends here.</span>
</pre>
</div>

<p>
To <b>reverse the order of</b> the <b>lines</b> in the region, use <code>M-x reverse-region</code>.
</p>
</div>
</div>

<div id="outline-container-org0d24e6b" class="outline-2">
<h2 id="org0d24e6b">Saving Emacs Sessions</h2>
<div class="outline-text-2" id="text-org0d24e6b">
<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Check that there is no extra ~/.saves directory!</b><br />
nil</div>

<p>
Pick up where you left off.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 44 (info "(emacs)Saving Emacs Sessions")</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-44-saving-emacs-sessions <span class="org-string">"44 Saving Emacs Sessions"</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Remember cursor position.</span>
  (<span class="org-keyword">if</span> (version&lt; emacs-version <span class="org-string">"25.0"</span>)

      (<span class="org-keyword">progn</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">Automatically save place in each file.</span>
        (<span class="org-keyword">setq-default</span> save-place t)     <span class="org-comment-delimiter">; </span><span class="org-comment">Default value for all buffers.</span>

        <span class="org-comment-delimiter">;; </span><span class="org-comment">Name of the file that records `</span><span class="org-comment"><span class="org-constant">save-place-alist</span></span><span class="org-comment">' value.</span>
        (<span class="org-keyword">setq</span> save-place-file <span class="org-string">"~/.emacs.d/places"</span>)

        (<span class="org-keyword">require</span> '<span class="org-constant">saveplace</span>))

    (save-place-mode 1))

)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 44 ends here.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgae20938" class="outline-2">
<h2 id="orgae20938">Hyperlinking and Navigation Features</h2>
<div class="outline-text-2" id="text-orgae20938">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 46 (info "(emacs)Hyperlinking")</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-46-hyperlinking <span class="org-string">"46 Hyperlinking and Navigation Features"</span>
</pre>
</div>
</div>

<div id="outline-container-orgec882df" class="outline-3">
<h3 id="orgec882df">Following URLs</h3>
<div class="outline-text-3" id="text-orgec882df">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Use proxy.</span>
  (<span class="org-keyword">setq</span> url-proxy-services              <span class="org-comment-delimiter">;</span><span class="org-comment">! Emacs expects just hostname and port</span>
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">! in `</span><span class="org-comment"><span class="org-constant">url-proxy-services</span></span><span class="org-comment">', NOT prefixed</span>
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">! with "http://"</span>
        `((<span class="org-string">"http"</span>     . ,(getenv <span class="org-string">"http_proxy"</span>))
          (<span class="org-string">"ftp"</span>      . ,(getenv <span class="org-string">"http_proxy"</span>))
          (<span class="org-string">"no_proxy"</span> . <span class="org-string">"^.*example.com"</span>)))
          <span class="org-comment-delimiter">;; </span><span class="org-comment">Disable proxy for some hosts.</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** Pass a URL to a WWW browser.</span>

  (leuven--section <span class="org-string">"pass a URL to a WWW browser"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Default browser started when you click on some URL in the buffer.</span>
  (<span class="org-keyword">setq</span> browse-url-browser-function
        (<span class="org-keyword">cond</span> ((<span class="org-keyword">or</span> leuven--win32-p
                   leuven--cygwin-p)
               'browse-url-default-windows-browser)
              (leuven--mac-p
               'browse-url-default-macosx-browser)
              ((not (display-graphic-p)) <span class="org-comment-delimiter">; </span><span class="org-comment">Console.</span>
               'eww-browse-url)
              (t                        <span class="org-comment-delimiter">; </span><span class="org-comment">Linux.</span>
               'browse-url-generic)))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">;; TEMP For testing purpose</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq browse-url-browser-function 'eww-browse-url)</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Name of the browser program used by `</span><span class="org-comment"><span class="org-constant">browse-url-generic</span></span><span class="org-comment">'.</span>
  (<span class="org-keyword">setq</span> browse-url-generic-program (executable-find <span class="org-string">"gnome-open"</span>))
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">Defer the decision to Gnome.  We could</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">use "firefox" or "google-chrome" as</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">well.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">For WSL (Ubuntu on Windows).</span>
  (<span class="org-keyword">setq</span> browse-url-generic-program (executable-find <span class="org-string">"/mnt/c/Program Files/Internet Explorer/iexplore.exe"</span>))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">setq</span> browse-url-browser-function 'browse-url-generic)
  (<span class="org-keyword">setq</span> browse-url-generic-program <span class="org-string">"cygstart"</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-org034b232" class="outline-3">
<h3 id="org034b232">Finding Files and URLs at Point</h3>
<div class="outline-text-3" id="text-org034b232">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  (leuven--section <span class="org-string">"FFAP"</span>)

  (<span class="org-keyword">unless</span> (<span class="org-keyword">featurep</span> '<span class="org-constant">helm-config</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Visit a file.</span>
    (global-set-key (kbd <span class="org-string">"&lt;f3&gt;"</span>) #'find-file-at-point))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Find file (or URL) at point.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"ffap"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Function called to fetch an URL.</span>
    (<span class="org-keyword">setq</span> ffap-url-fetcher 'browse-url))<span class="org-comment-delimiter">; </span><span class="org-comment">Could be `</span><span class="org-comment"><span class="org-constant">browse-url-emacs</span></span><span class="org-comment">' or</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">`</span><span class="org-comment"><span class="org-constant">eww-browse-url</span></span><span class="org-comment">'.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org008b71b" class="outline-3">
<h3 id="org008b71b">Google search</h3>
<div class="outline-text-3" id="text-org008b71b">
<div class="inlinetask">
<b><span class="todo TODO">TODO</span> Use engine-mode</b><br />
<p>
I use Google (on C-c / g) and Github (on C-c / h), but the engine-mode readme
explains how to set it up with DuckDuckGo, stack overflow, etc.  It&rsquo;s
configurable, but results can be displayed in eww, Emacs&rsquo; built-in text-based
web browser.
</p>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** Web search</span>

  (leuven--section <span class="org-string">"Web search"</span>)
</pre>
</div>

<dl class="org-dl">
<dt><code>C-c g SPC</code></dt><dd><code>google-this-region</code></dd>

<dt><code>C-c g n</code></dt><dd><code>google-this-noconfirm</code></dd>

<dt><code>C-c g t</code></dt><dd><code>google-this</code></dd>
</dl>

<div class="tip">
<p>
The <code>M-s M-w</code> key binding (new in Emacs 25) uses <code>eww</code> to search the web for the
text in the region.  It is super handy for quick Google and documentation
searches and this will only make it more useful.
</p>

<p>
The search engine to use for this is specified by the customizable variable
<code>eww-search-prefix</code>.
</p>

</div>

<p>
<code>url-parse</code> and <code>url-cookies</code> are quite heavy to load, hence:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">A set of functions and bindings to Google under point.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"google-this-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Keybinding under which `</span><span class="org-comment"><span class="org-constant">google-this-mode-submap</span></span><span class="org-comment">' is assigned.</span>
    (<span class="org-keyword">setq</span> google-this-keybind (kbd <span class="org-string">"C-c g"</span>))

    (idle-require 'google-this))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"google-this"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Enable Google-This mode.</span>
    (google-this-mode 1))
</pre>
</div>

<p>
When I want to Google most of a line, I call <code>google-this-line</code> and edit the
prompt. And when I to Google the entire line, hitting <code>RET</code> one extra time doesn&rsquo;t
quite bother me.
</p>

<p>
If you&rsquo;d like to skip confirmation, you can define the following function and
bind it to a key:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">    (<span class="org-keyword">defun</span> <span class="org-function-name">google-this-line-noconfirm</span> (prefix)
      <span class="org-doc">"Google the current line without confirmationl.</span>
<span class="org-doc">    PREFIX determines quoting."</span>
      (<span class="org-keyword">interactive</span> <span class="org-string">"P"</span>)
      (google-this-line prefix 'noconfirm))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-google-search-active-region-or-word-at-point</span> ()
    <span class="org-doc">"Create a Google search URL and send it to your web browser.</span>
<span class="org-doc">  If `</span><span class="org-doc"><span class="org-constant">transient-mark-mode</span></span><span class="org-doc">' is non-nil and the mark is active, it defaults to the</span>
<span class="org-doc">  current region, else to the word at or before point."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let</span> ((query
           (<span class="org-keyword">if</span> (use-region-p)
               (buffer-substring-no-properties (region-beginning) (region-end))
             (find-tag-default))))      <span class="org-comment-delimiter">; </span><span class="org-comment">or (current-word) for word at point?</span>
      (browse-url
       (concat
        <span class="org-string">"http://www.google.com/search?q="</span>
        (url-hexify-string query)))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-duckduckgo-search-active-region-or-word-at-point</span> ()
    <span class="org-doc">"Create a DuckDuckGo search URL and send it to your web browser.</span>
<span class="org-doc">  If `</span><span class="org-doc"><span class="org-constant">transient-mark-mode</span></span><span class="org-doc">' is non-nil and the mark is active, it defaults to the</span>
<span class="org-doc">  current region, else to the word at or before point."</span>
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">let</span> ((query
           (<span class="org-keyword">if</span> (use-region-p)
               (buffer-substring-no-properties (region-beginning) (region-end))
             (find-tag-default))))      <span class="org-comment-delimiter">; </span><span class="org-comment">or (current-word) for word at point?</span>
      (browse-url
       (concat
        <span class="org-string">"https://duckduckgo.com/?q="</span>
        (url-hexify-string query)))))

  (global-set-key (kbd <span class="org-string">"C-c g G"</span>) #'leuven-google-search-active-region-or-word-at-point)
  (global-set-key (kbd <span class="org-string">"C-c g D"</span>) #'leuven-duckduckgo-search-active-region-or-word-at-point)
</pre>
</div>
</div>
</div>

<div id="outline-container-org0b7e5af" class="outline-3">
<h3 id="org0b7e5af">How do I?  (StackOverflow)</h3>
<div class="outline-text-3" id="text-org0b7e5af">
<p>
Instant coding answers via Emacs.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"howdoi-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">XXX Key sequence starts with non-prefix key C-c h. Conflict with Helm!</span>
    (global-set-key (kbd <span class="org-string">"C-c h n"</span>) #'howdoi-query)
    (global-set-key (kbd <span class="org-string">"C-c h d"</span>) #'howdoi-query-insert-code-snippet-at-point))
</pre>
</div>
</div>
</div>

<div id="outline-container-org46981cb" class="outline-3">
<h3 id="org46981cb">Babel translator</h3>
<div class="outline-text-3" id="text-org46981cb">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** Babel</span>

  (leuven--section <span class="org-string">"Babel"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Interface to web translation services such as Babelfish.</span>
  (<span class="org-keyword">when</span> (locate-library <span class="org-string">"babel"</span>)

    (autoload 'babel <span class="org-string">"babel"</span>
      <span class="org-doc">"Use a web translation service to translate the message MSG."</span> t)
    (autoload 'babel-region <span class="org-string">"babel"</span>
      <span class="org-doc">"Use a web translation service to translate the current region."</span> t)
    (autoload 'babel-as-string <span class="org-string">"babel"</span>
      <span class="org-doc">"Use a web translation service to translate MSG, returning a string."</span> t)
    (autoload 'babel-buffer <span class="org-string">"babel"</span>
      <span class="org-doc">"Use a web translation service to translate the current buffer."</span> t)

    (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-babel-translate</span> ()
      <span class="org-doc">"Translate using many online translators."</span>
      (<span class="org-keyword">interactive</span>)
      (<span class="org-keyword">require</span> '<span class="org-constant">babel</span>)
      (<span class="org-keyword">let</span> (source)
        (switch-to-buffer <span class="org-string">"*leuven--translate*"</span>)
        (erase-buffer)
        (yank)
        (<span class="org-keyword">setq</span> source (buffer-substring-no-properties (point-min) (point-max)))
        (erase-buffer)
        (insert <span class="org-string">"--- Source ---\n\n"</span>)
        (insert source)
        (insert <span class="org-string">"\n\n\n--- Translation FR -&gt; EN done by FreeTranslation ---\n\n"</span>)
        (insert (babel-work source <span class="org-string">"fr"</span> <span class="org-string">"en"</span> 'babel-free-fetch 'babel-free-wash))
        (insert <span class="org-string">"\n\n\n--- Translation EN -&gt; FR done by FreeTranslation ---\n\n"</span>)
        (insert (babel-work source <span class="org-string">"en"</span> <span class="org-string">"fr"</span> 'babel-free-fetch 'babel-free-wash)))))

)
</pre>
</div>

<p>
Switch between different translation directions directly from minibuffer by
using <code>C-n</code> and <code>C-p</code> key bindings.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Emacs interface to Google Translate.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"google-translate-autoloads"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Translate a text using translation directions.</span>
    (global-set-key (kbd <span class="org-string">"C-c t"</span>) #'google-translate-smooth-translate))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Just another UI to Google.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"google-translate-smooth-ui"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Translation directions.</span>
    (<span class="org-keyword">setq</span> google-translate-translation-directions-alist
          '((<span class="org-string">"fr"</span> . <span class="org-string">"en"</span>) (<span class="org-string">"en"</span> . <span class="org-string">"fr"</span>)
            (<span class="org-string">"fr"</span> . <span class="org-string">"nl"</span>) (<span class="org-string">"nl"</span> . <span class="org-string">"fr"</span>)
            (<span class="org-string">"fr"</span> . <span class="org-string">"es"</span>) (<span class="org-string">"es"</span> . <span class="org-string">"fr"</span>))))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org5bb9b45" class="outline-2">
<h2 id="org5bb9b45">Other Amusements</h2>
<div class="outline-text-2" id="text-org5bb9b45">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 47 Other (info "(emacs)Amusements")</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-47-amusements <span class="org-string">"47 Other Amusements"</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Define a default menu bar.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"menu-bar"</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Get rid of the Games in the Tools menu.</span>
    (define-key menu-bar-tools-menu [games] nil))

)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 47 ends here.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org0fa1848" class="outline-2">
<h2 id="org0fa1848">Customization</h2>
<div class="outline-text-2" id="text-org0fa1848">
<p>
Emacs 24 custom themes allow loading multiple themes simultaneously.  If you
don&rsquo;t want the previous theme to stay in effect, you will need to unload it
first.
</p>

<p>
Install Leuven Theme via the <a href="#orgf4a8798">Emacs Lisp Packages</a> (or use the one bundled in GNU
Emacs 24.4).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* 49 (info "(emacs)Customization")</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-49-customization <span class="org-string">"49 Customization"</span>

  (<span class="org-keyword">ignore-errors</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Load custom theme "Leuven" and enable it.</span>
    (load-theme 'leuven t))
</pre>
</div>
</div>

<div id="outline-container-org5716267" class="outline-3">
<h3 id="org5716267">Color</h3>
<div class="outline-text-3" id="text-org5716267">
<p>
You can govern the sort order of colors now such as HSV or RGB distance from a
particular color&#x2026;
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Color sort order for `</span><span class="org-comment"><span class="org-constant">list-colors-display</span></span><span class="org-comment">'.</span>
  (<span class="org-keyword">setq</span> list-colors-sort '(rgb-dist . <span class="org-string">"#FFFFFF"</span>))
</pre>
</div>
</div>
</div>

<div id="outline-container-org7eae814" class="outline-3">
<h3 id="org7eae814">Variables</h3>
<div class="outline-text-3" id="text-org7eae814">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 49.3 (info "(emacs)Variables")</span>

  (leuven--section <span class="org-string">"49.3 (emacs)Variables"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">File local variables specifications are obeyed, without query --</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">RISKY!</span>
  (<span class="org-keyword">setq</span> enable-local-variables t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Obey `</span><span class="org-comment"><span class="org-constant">eval</span></span><span class="org-comment">' variables -- RISKY!</span>
  (<span class="org-keyword">setq</span> enable-local-eval t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Record safe values for some local variables.</span>
  (<span class="org-keyword">setq</span> safe-local-variable-values
        '((TeX-master . t)
          (ac-sources . (ac-source-words-in-buffer ac-source-dictionary))
          (flycheck-emacs-lisp-initialize-packages . t)
          (flycheck-mode . nil)
          (flyspell-mode . -1)
          (flyspell-mode . 1)
          (ispell-local-dictionary . <span class="org-string">"american"</span>)
          (ispell-local-dictionary . <span class="org-string">"francais"</span>)
          (org-tags-column . -80)       <span class="org-comment-delimiter">; </span><span class="org-comment">org-issues.org</span>
          (outline-minor-mode)
          (whitespace-style face tabs spaces trailing lines
                            space-before-tab::space newline indentation::space
                            empty space-after-tab::space space-mark tab-mark
                            newline-mark)))
</pre>
</div>

<p>
Have a look at (info &ldquo;(emacs)Directory Variables&rdquo;).
</p>
</div>
</div>

<div id="outline-container-org16ac0a3" class="outline-3">
<h3 id="org16ac0a3">Key Bindings</h3>
<div class="outline-text-3" id="text-org16ac0a3">
<p>
The keys <code>C-c LETTER</code> are <a href="http://www.gnu.org/software/emacs/manual/html_node/elisp/Key-Binding-Conventions.html%20">reserved for user functions</a>.
</p>

<p>
You can get a list of all the disabled functions by typing:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">M-: (<span class="org-keyword">let</span> (lst) (mapatoms (<span class="org-keyword">lambda</span> (x) (<span class="org-keyword">if</span> (get x 'disabled) (<span class="org-keyword">push</span> x lst)))) lst) RET
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 49.4 Customizing (info "(emacs)Key Bindings")</span>

  (leuven--section <span class="org-string">"49.4 Customizing (emacs)Key Bindings"</span>)
</pre>
</div>

<p>
See as well Print keybindings (pkb).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Print the key bindings in a tabular form.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-keytable</span> (arg)
    <span class="org-doc">"Print the key bindings in a tabular form."</span>
    (<span class="org-keyword">interactive</span> <span class="org-string">"sEnter a modifier string:"</span>)
    (<span class="org-keyword">with-output-to-temp-buffer</span> <span class="org-string">"*Key table*"</span>
      (<span class="org-keyword">let*</span> ((i 0)
             (keys (list <span class="org-string">"a"</span> <span class="org-string">"b"</span> <span class="org-string">"c"</span> <span class="org-string">"d"</span> <span class="org-string">"e"</span> <span class="org-string">"f"</span> <span class="org-string">"g"</span> <span class="org-string">"h"</span> <span class="org-string">"i"</span> <span class="org-string">"j"</span> <span class="org-string">"k"</span> <span class="org-string">"l"</span>
                         <span class="org-string">"m"</span> <span class="org-string">"n"</span> <span class="org-string">"o"</span> <span class="org-string">"p"</span> <span class="org-string">"q"</span> <span class="org-string">"r"</span> <span class="org-string">"s"</span> <span class="org-string">"t"</span> <span class="org-string">"u"</span> <span class="org-string">"v"</span> <span class="org-string">"w"</span> <span class="org-string">"x"</span>
                         <span class="org-string">"y"</span> <span class="org-string">"z"</span> <span class="org-string">"&lt;RET&gt;"</span> <span class="org-string">"&lt;down&gt;"</span> <span class="org-string">"&lt;up&gt;"</span> <span class="org-string">"&lt;right&gt;"</span>
                         <span class="org-string">"&lt;left&gt;"</span> <span class="org-string">"&lt;home&gt;"</span> <span class="org-string">"&lt;end&gt;"</span> <span class="org-string">"&lt;f1&gt;"</span> <span class="org-string">"&lt;f2&gt;"</span> <span class="org-string">"&lt;f3&gt;"</span>
                         <span class="org-string">"&lt;f4&gt;"</span> <span class="org-string">"&lt;f5&gt;"</span> <span class="org-string">"&lt;f6&gt;"</span> <span class="org-string">"&lt;f7&gt;"</span> <span class="org-string">"&lt;f8&gt;"</span> <span class="org-string">"&lt;f9&gt;"</span>
                         <span class="org-string">"&lt;f10&gt;"</span> <span class="org-string">"&lt;f11&gt;"</span> <span class="org-string">"&lt;f12&gt;"</span> <span class="org-string">"1"</span> <span class="org-string">"2"</span> <span class="org-string">"3"</span> <span class="org-string">"4"</span> <span class="org-string">"5"</span> <span class="org-string">"6"</span>
                         <span class="org-string">"7"</span> <span class="org-string">"8"</span> <span class="org-string">"9"</span> <span class="org-string">"0"</span> <span class="org-string">"`"</span> <span class="org-string">"~"</span> <span class="org-string">"!"</span> <span class="org-string">"@"</span> <span class="org-string">"#"</span> <span class="org-string">"$"</span> <span class="org-string">"%"</span> <span class="org-string">"^"</span>
                         <span class="org-string">"&amp;"</span> <span class="org-string">"*"</span> <span class="org-string">"("</span> <span class="org-string">")"</span> <span class="org-string">"-"</span> <span class="org-string">"_"</span> <span class="org-string">"="</span> <span class="org-string">"+"</span> <span class="org-string">"\\"</span> <span class="org-string">"|"</span> <span class="org-string">"{"</span> <span class="org-string">"["</span>
                         <span class="org-string">"]"</span> <span class="org-string">"}"</span> <span class="org-string">";"</span> <span class="org-string">"'"</span> <span class="org-string">":"</span> <span class="org-string">"\""</span> <span class="org-string">"&lt;"</span> <span class="org-string">"&gt;"</span> <span class="org-string">","</span> <span class="org-string">"."</span> <span class="org-string">"/"</span> <span class="org-string">"?"</span>
                         ))
             (n (length keys))
             (modifiers (list <span class="org-string">""</span> <span class="org-string">"S-"</span> <span class="org-string">"C-"</span> <span class="org-string">"M-"</span> <span class="org-string">"M-C-"</span>))
             (k))
        (<span class="org-keyword">or</span> (string= arg <span class="org-string">""</span>) (<span class="org-keyword">setq</span> modifiers (list arg)))
        (<span class="org-keyword">setq</span> k (length modifiers))
        (princ (format <span class="org-string">" %-10.10s |"</span> <span class="org-string">"Key"</span>))
        (<span class="org-keyword">let</span> ((j 0))
          (<span class="org-keyword">while</span> (&lt; j k)
            (princ (format <span class="org-string">" %-28.28s |"</span> (nth j modifiers)))
            (<span class="org-keyword">setq</span> j (1+ j))))
        (princ <span class="org-string">"\n"</span>)
        (princ (format <span class="org-string">"_%-10.10s_|"</span> <span class="org-string">"__________"</span>))
        (<span class="org-keyword">let</span> ((j 0))
          (<span class="org-keyword">while</span> (&lt; j k)
            (princ (format <span class="org-string">"_%-28.28s_|"</span>
                           <span class="org-string">"_______________________________"</span>))
            (<span class="org-keyword">setq</span> j (1+ j))))
        (princ <span class="org-string">"\n"</span>)
        (<span class="org-keyword">while</span> (&lt; i n)
          (princ (format <span class="org-string">" %-10.10s |"</span> (nth i keys)))
          (<span class="org-keyword">let</span> ((j 0))
            (<span class="org-keyword">while</span> (&lt; j k)
              (<span class="org-keyword">let*</span> ((binding
                      (key-binding (read-kbd-macro
                                    (concat (nth j modifiers)
                                            (nth i keys)))))
                     (binding-string <span class="org-string">"_"</span>))
                (<span class="org-keyword">when</span> binding
                  (<span class="org-keyword">if</span> (eq binding 'self-insert-command)
                      (<span class="org-keyword">setq</span> binding-string (concat <span class="org-string">"'"</span> (nth i keys) <span class="org-string">"'"</span>))
                    (<span class="org-keyword">setq</span> binding-string (format <span class="org-string">"%s"</span> binding))))
                (<span class="org-keyword">setq</span> binding-string
                      (substring binding-string 0
                                 (min (length binding-string) 28)))
                (princ (format <span class="org-string">" %-28.28s |"</span> binding-string))
                (<span class="org-keyword">setq</span> j (1+ j)))))
          (princ <span class="org-string">"\n"</span>)
          (<span class="org-keyword">setq</span> i (1+ i)))
        (princ (format <span class="org-string">"_%-10.10s_|"</span> <span class="org-string">"__________"</span>))
        (<span class="org-keyword">let</span> ((j 0))
          (<span class="org-keyword">while</span> (&lt; j k)
            (princ (format <span class="org-string">"_%-28.28s_|"</span>
                           <span class="org-string">"_______________________________"</span>))
            (<span class="org-keyword">setq</span> j (1+ j))))))
    (delete-window)
    (<span class="org-keyword">setq</span> truncate-lines t))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Guide the following key bindings automatically and dynamically.</span>
  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"which-key-autoloads"</span>
    (idle-require 'which-key))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"which-key"</span>

    (which-key-mode)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Apply suggested settings for side-window that opens on right if there is</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">space and the bottom otherwise.</span>
    (which-key-setup-side-window-right-bottom)

    (<span class="org-keyword">setq</span> which-key-idle-delay 0.4)

    (<span class="org-keyword">setq</span> which-key-sort-order 'which-key-local-then-key-order)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Set the maximum length (in characters) for key descriptions (commands or</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">prefixes).</span>
    (<span class="org-keyword">setq</span> which-key-max-description-length 33))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgaa11d5c" class="outline-3">
<h3 id="orgaa11d5c">Syntax Table</h3>
<div class="outline-text-3" id="text-orgaa11d5c">
<p>
The syntax table contains information that tells Emacs how to operate on text,
words, sentences etc.  It will make Emacs know enough about all the symbols in
a buffer.  Syntax table is used for example for:
</p>

<ul class="org-ul">
<li>commands like <code>forward-word</code> (<code>M-f</code>) or <code>backward-kill-word</code> (<code>M-DEL</code>),</li>
<li>spell-checking of words,</li>
<li>expansion commands of abbrevs,</li>
<li>etc.</li>
</ul>

<p>
Evaluate <code>current-word</code> and see whether characters such as <code>-</code> and <code>_</code> are
considered part of the word (depending on the current major mode).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 49.5 The (info "(emacs)Syntax") Table</span>

  (leuven--section <span class="org-string">"49.5 The (emacs)Syntax Table"</span>)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Define "-" as part of a word.</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'emacs-lisp-mode-hook</span>
  <span class="org-comment-delimiter">;;           </span><span class="org-comment">#'(lambda ()</span>
  <span class="org-comment-delimiter">;;             </span><span class="org-comment">(modify-syntax-entry ?- "w")))</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter 49 ends here.</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgeae8056" class="outline-2">
<h2 id="orgeae8056">Emacs Display</h2>
<div class="outline-text-2" id="text-orgeae8056">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* Emacs Display</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-XX-emacs-display <span class="org-string">"XX Emacs Display"</span>
</pre>
</div>
</div>

<div id="outline-container-org5502b5c" class="outline-3">
<h3 id="org5502b5c">Faces</h3>
<div class="outline-text-3" id="text-org5502b5c">
<p>
You can get text properties of any char by typing <code>C-u C-x =</code>.
</p>

<p>
Under Windows, you can get the current <b>font</b> by typing <code>(w32-select-font)</code>
followed by <code>C-x C-e</code>.
</p>

<p>
You can find the current <b>font string</b> by typing
<code>M-x ielm RET (frame-parameters) RET</code> &#x2013; see the line <code>font</code>.
</p>

<p>
To check if some font is available in Emacs do following:
</p>

<ol class="org-ol">
<li>Switch to the <code>*scratch*</code> buffer.</li>

<li><p>
Type
</p>

<p>
<code>(prin1-to-string (x-list-fonts "font-you-want-to-check or pattern"))</code>
</p></li>

<li>Place the cursor after the last closing paren and hit <code>C-j</code>.  List of the names
of available fonts matching given pattern will appear in the current buffer
(<code>*scratch*</code>).</li>

<li><p>
For listing of all available fonts, use
</p>

<p>
<code>(prin1-to-string (x-list-fonts "*"))</code>
</p>

<p>
or
</p>

<p>
<code>(dolist (i (x-list-fonts "*")) (princ i) (terpri))</code>
</p>

<p>
for a better output.
</p></li>
</ol>

<p>
Under Linux, use the <code>xfontsel</code> utility (or the command-line <code>xlsfonts</code>) to try out
different fonts.  After choosing a font, click the select button in <code>xfontsel</code>
window.  This will copy font name you choose to copy &amp; paste buffer.
</p>

<p>
Now Emacs should start with that font.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** (info "(elisp)Faces")</span>

  (leuven--section <span class="org-string">"Faces"</span>)
</pre>
</div>

<p>
For reasons unknown to me, Emacs takes a long time to change fonts in an X
environment.
</p>

<p>
Rather than using <code>(set-default-font ...)</code> in <code>.emacs</code>, stick the font definition in
your <code>.Xresources</code> file (key &rsquo;Emacs*font&rsquo;) and then use <code>xrdb -load</code> to activate it.
You will find that startup time is greatly improved!
</p>

<p>
Edit your <code>~/.Xresources</code> file to have a line with &ldquo;Emacs.font&rdquo;.  Then do a
</p>

<p>
<code>xrdb -merge ~/.Xresources</code>
</p>

<p>
or restart your X11 to validate the modification.  I let Emacs do this for me:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven--merge-x-resources</span> ()
    (<span class="org-keyword">let</span> ((file (file-name-nondirectory (buffer-file-name))))
      (<span class="org-keyword">when</span> (<span class="org-keyword">or</span> (string= file <span class="org-string">".Xdefaults"</span>)
                (string= file <span class="org-string">".Xresources"</span>))
        (start-process <span class="org-string">"xrdb"</span> nil <span class="org-string">"xrdb"</span> <span class="org-string">"-merge"</span> (buffer-file-name))
        (message (format <span class="org-string">"[Merged %s into X resource database]"</span> file)))))

  (add-hook 'after-save-hook #'leuven--merge-x-resources)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">allow any scalable font</span>
  (<span class="org-keyword">setq</span> scalable-fonts-allowed t)
</pre>
</div>
</div>

<div id="outline-container-orgcc621a4" class="outline-4">
<h4 id="orgcc621a4">UTF-8</h4>
<div class="outline-text-4" id="text-orgcc621a4">
<p>
Fonts that have a good UTF-8 coverage are:
</p>

<ul class="org-ul">
<li>DejaVu Sans Mono</li>
<li>FreeMono (FreeSans, FreeSerif)</li>
<li>Monospace</li>
</ul>

<p>
None of them has all four variants, some have regular (medium) and bold or light
and regular, one regular and oblique.
</p>
</div>
</div>

<div id="outline-container-org5d67c80" class="outline-4">
<h4 id="org5d67c80">Anti-aliasing</h4>
<div class="outline-text-4" id="text-org5d67c80">
<p>
To see if anti-aliasing is active, use <code>xmag</code> (under Linux) or any of the other
magnifier applications.  The fonts should have gray edges.
</p>
</div>
</div>

<div id="outline-container-orgcfd1263" class="outline-4">
<h4 id="orgcfd1263">Adjust the height of the default face</h4>
<div class="outline-text-4" id="text-orgcfd1263">
<p>
There are a few commands to adjust the font sizes:
</p>

<dl class="org-dl">
<dt><code>C-x C-+</code></dt><dd>Increase the default face height by one step.</dd>

<dt><code>C-x C--</code></dt><dd>Decrease the default face height by one step.</dd>

<dt><code>C-x C-0</code></dt><dd>Resets to defaults.</dd>
</dl>

<p>
Those bindings are global and repeatable, e.g. <code>C-x C-+ C-+ C-+</code>.
</p>

<p>
Zoom in/out (increase/decrease the font size) with <code>Ctrl</code> key and scroll wheel on
the mouse:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (global-set-key (kbd <span class="org-string">"&lt;C-wheel-up&gt;"</span>)   #'text-scale-increase)
  (global-set-key (kbd <span class="org-string">"&lt;C-wheel-down&gt;"</span>) #'text-scale-decrease)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">For Linux.</span>
  (global-set-key (kbd <span class="org-string">"&lt;C-mouse-4&gt;"</span>)    #'text-scale-increase)
  (global-set-key (kbd <span class="org-string">"&lt;C-mouse-5&gt;"</span>)    #'text-scale-decrease)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf9bca00" class="outline-3">
<h3 id="orgf9bca00">Images</h3>
<div class="outline-text-3" id="text-orgf9bca00">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">** 37.17 (info "(elisp)Images")</span>
</pre>
</div>

<p>
How do I get image support? See <code>image-library-alist</code>, a list of image types vs.
external libraries needed to display them.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(describe-variable 'image-library-alist)
</pre>
</div>

<div class="note">
<p>
You can download the corresponding dlls from ezwinports
<a href="http://sourceforge.net/projects/ezwinports/files/">http://sourceforge.net/projects/ezwinports/files/</a> and put them into
emacs&rsquo;s `bin` directory.
</p>

<p>
There are some instructions in the &ldquo;Image support&rdquo; part on page
<a href="https://ftp.gnu.org/gnu/emacs/windows/">https://ftp.gnu.org/gnu/emacs/windows/</a>.
</p>

</div>

<p>
If you use compiled Emacs binaries (available on the <a href="http://ftp.gnu.org/gnu/emacs/windows/">GNU Website</a>), eventually,
copy those DLLs (<code>libpng16.dll</code>, for example) from an old Windows Emacs
installation to your Emacs <code>bin</code> directory, and restart Emacs for image support to
be enabled.
</p>

<p>
If you use Cygwin Emacs, install <code>libpng</code> via Cygwin as well.
</p>

<p>
You can do:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(image-type-available-p 'png)
</pre>
</div>

<p>
to check if you have <code>png</code> image support in your Emacs.
</p>

<p>
<code>image-library-alist</code> maps image type to a list of dlls which support it.
</p>

<p>
To check all image libraries at once:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(mapcar #'(lambda (elt)
            (list (car elt) (image-type-available-p (car elt))))
        dynamic-library-alist)
</pre>
</div>

<p>
If missing image libraries bother you, read <code>README.W32</code> (or <code>nt/INSTALL</code>).
</p>

<p>
For animated GIF (or multi-page TIFF):
</p>
<ul class="org-ul">
<li><code>f</code> steps through image frame frame, and</li>
<li><code>RET</code> animates.</li>
</ul>
<p>
No need for ImageMagick.
</p>
</div>
</div>
</div>

<div id="outline-container-orge63b264" class="outline-2">
<h2 id="orge63b264">Emacs Lisp</h2>
<div class="outline-text-2" id="text-orge63b264">
</div>
<div id="outline-container-org712f45e" class="outline-3">
<h3 id="org712f45e">Variables</h3>
<div class="outline-text-3" id="text-org712f45e">
</div>
<div id="outline-container-orgeb78a03" class="outline-4">
<h4 id="orgeb78a03">Local Variables</h4>
<div class="outline-text-4" id="text-orgeb78a03">
<div class="org-src-container">
<pre class="src src-emacs-lisp">  <span class="org-comment-delimiter">;; </span><span class="org-comment">Limit on number of Lisp variable bindings &amp; unwind-protects.</span>
  (<span class="org-keyword">setq</span> max-specpdl-size 3000)          <span class="org-comment-delimiter">; </span><span class="org-comment">XEmacs 21.5.29</span>
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org9e995de" class="outline-2">
<h2 id="org9e995de">Calc</h2>
<div class="outline-text-2" id="text-org9e995de">
<p>
<code>C-x *</code> invokes the GNU Emacs Calculator.
</p>
</div>

<div id="outline-container-orgdee03ee" class="outline-3">
<h3 id="orgdee03ee">Introduction</h3>
<div class="outline-text-3" id="text-orgdee03ee">
</div>
<div id="outline-container-org7aa040f" class="outline-4">
<h4 id="org7aa040f">Basic Commands</h4>
<div class="outline-text-4" id="text-org7aa040f">
<p>
Start the Calc: <code>C-x * c</code>.
</p>
</div>
</div>

<div id="outline-container-org3e87165" class="outline-4">
<h4 id="org3e87165">&ldquo;Quick Calculator&rdquo; Mode</h4>
<div class="outline-text-4" id="text-org3e87165">
<p>
Run the Calculator in the minibuffer: <code>M-x quick-calc</code> (bound to <code>C-x * q</code> or
<code>C-x * Q</code>).
</p>

<div class="note">
<p>
If <code>quick-calc</code> is called with a prefix argument, insert the result of the
calculation into the current buffer.
</p>

</div>
</div>
</div>
</div>

<div id="outline-container-org4c4081c" class="outline-3">
<h3 id="org4c4081c">Embedded Mode</h3>
<div class="outline-text-3" id="text-org4c4081c">
<p>
Try the Embedded mode of Calc: <code>C-x * e</code> (no need to mark the region).
</p>

<p>
Similar commands: in place of <code>e</code>,
</p>

<dl class="org-dl">
<dt><code>w</code></dt><dd>Start Embedded mode on the current &ldquo;word&rdquo;.</dd>

<dt><code>j</code></dt><dd>Operate on <b>assignments</b>.</dd>
</dl>

<p>
You need to type <code>C-x * e</code> again to exit the Embedded mode.
</p>
</div>
</div>
</div>

<div id="outline-container-org0f79863" class="outline-2">
<h2 id="org0f79863">IRC client for Emacs</h2>
<div class="outline-text-2" id="text-org0f79863">
<p>
See <a href="http://en.wikipedia.org/wiki/List_of_IRC_commands">List of Internet Relay Chat commands</a>:
</p>
<ul class="org-ul">
<li><code>/whois</code></li>
<li><code>/leave</code></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* Emacs IRC client</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Other IRC for Emacs: rcirc, circe, bitlbee, liece, riece, zenirc, erc</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Circe is advised by Tassilo (contributor).</span>

  (autoload 'circe <span class="org-string">"circe"</span>
    <span class="org-doc">"Connect to an IRC server."</span> t)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Connect to the Freenode network</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-irc-connect</span> ()
    <span class="org-doc">"Connect to Freenode."</span>
    (<span class="org-keyword">interactive</span>)
    (circe <span class="org-string">"irc.freenode.net"</span> <span class="org-string">"6667"</span> <span class="org-string">"freenode"</span>))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">... upon hitting `M-x leuven-start-irc'.</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-start-irc</span> ()
    <span class="org-doc">"Start IRC."</span>
    (<span class="org-keyword">interactive</span>)
    (switch-or-start 'leuven-irc-connect <span class="org-string">"irc.freenode.net:6667"</span>))

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"circe"</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 1 Basics</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Default channels to join whenever connecting to Freenode.</span>
    (<span class="org-keyword">setq</span> circe-server-auto-join-channels
          '((<span class="org-string">"^freenode$"</span>
             <span class="org-string">"#emacs"</span>
             <span class="org-comment-delimiter">;; </span><span class="org-comment">"#gnus"</span>
             <span class="org-comment-delimiter">;; </span><span class="org-comment">"#latex"</span>
             <span class="org-comment-delimiter">;; </span><span class="org-comment">"#ledger"</span>
             <span class="org-string">"#org-mode"</span>
             <span class="org-comment-delimiter">;; </span><span class="org-comment">"#stumpwm"</span>
             <span class="org-comment-delimiter">;; </span><span class="org-comment">"#zsh"</span>
             )))

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 2 Reference</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">*** 2.3 Configuration</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Default nick.</span>
    (<span class="org-keyword">setq</span> circe-default-nick <span class="org-string">"johndoe"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Your "real name" on IRC.</span>
    (<span class="org-keyword">setq</span> circe-default-realname <span class="org-string">"John Doe"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Authentication info.</span>
    (<span class="org-keyword">setq</span> freenode-passwd <span class="org-string">""</span>)
    (<span class="org-keyword">setq</span> circe-nickserv-passwords
          `((<span class="org-string">"freenode"</span> ,freenode-passwd)))

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 3 Fighting Information Overload</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">*** 3.1 Channels</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">When other people say things in buffers that are currently buried (no</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">window is showing them), the mode line will now show you the abbreviated</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">channel or nick name.  Use `C-c C-SPC' to switch to these buffers.</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">*** 3.3 Keywords</span>

    <span class="org-comment-delimiter">;; </span><span class="org-comment">List of keywords to highlight.</span>
    (<span class="org-keyword">setq</span> lui-highlight-keywords
          '(
            <span class="org-comment-delimiter">;; </span><span class="org-comment">"[</span><span class="org-comment"><span class="org-negation-char">^</span></span><span class="org-comment">&lt;]vauban"</span>
            <span class="org-string">"org"</span> <span class="org-string">"beamer"</span> <span class="org-string">"ledger"</span> <span class="org-string">"tikz"</span>))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Add IRC color support to LUI.</span>
    (try-require 'lui-irc-colors)
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"lui-irc-colors"</span>
      (add-to-list 'lui-pre-output-hook 'lui-irc-colors))

<span class="org-comment-delimiter">;;</span><span class="org-comment">** 4 Hacking and Tweaking</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">*** 4.2 Using fly spell mode</span>

    (<span class="org-keyword">when</span> (leuven--executable-ispell-program-name-p)
      (<span class="org-keyword">setq</span> lui-flyspell-p t)
      (<span class="org-keyword">setq</span> lui-flyspell-alist '((<span class="org-string">"."</span> <span class="org-string">"american"</span>))))

<span class="org-comment-delimiter">;;</span><span class="org-comment">** Others</span>

    (<span class="org-keyword">setq</span> circe-highlight-nick-type 'occurrence)

    (try-require 'circe-highlight-all-nicks)
    (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"circe-highlight-all-nicks"</span>
      (enable-circe-highlight-all-nicks))

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Format for messages to queries or channels.</span>
    (<span class="org-keyword">setq</span> circe-format-self-say <span class="org-string">"&lt;{nick}&gt; {body}"</span>)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Truncate the buffer (at the top) if it grows too much.</span>
    (<span class="org-keyword">setq</span> lui-max-buffer-size 30000)

    <span class="org-comment-delimiter">;; </span><span class="org-comment">Column at which Lui should break output.</span>
    (<span class="org-keyword">setq</span> lui-fill-column fill-column)

    )                                   <span class="org-comment-delimiter">; </span><span class="org-comment">with-eval-after-load "circe" ends here.</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package erc
  <span class="org-builtin">:commands</span> (erc erc-tls)
  <span class="org-builtin">:bind</span> (<span class="org-builtin">:map</span> erc-mode-map
              (<span class="org-string">"C-c r"</span> . reset-erc-track-mode))
  <span class="org-builtin">:preface</span>
  (<span class="org-keyword">defun</span> <span class="org-function-name">irc</span> (<span class="org-type">&amp;optional</span> arg)
    (<span class="org-keyword">interactive</span> <span class="org-string">"P"</span>)
    (<span class="org-keyword">if</span> arg
        (<span class="org-keyword">pcase-dolist</span> (`(,server . ,nick)
                       '((<span class="org-string">"irc.freenode.net"</span>     . <span class="org-string">"johnw"</span>)
                         (<span class="org-string">"irc.gitter.im"</span>        . <span class="org-string">"jwiegley"</span>)
                         <span class="org-comment-delimiter">;; </span><span class="org-comment">("irc.oftc.net"         . "johnw")</span>
                         ))
          (erc-tls <span class="org-builtin">:server</span> server <span class="org-builtin">:port</span> 6697 <span class="org-builtin">:nick</span> (concat nick <span class="org-string">"_"</span>)
                   <span class="org-builtin">:password</span> (lookup-password server nick 6697)))
      (<span class="org-keyword">let</span> ((pass (lookup-password <span class="org-string">"irc.freenode.net"</span> <span class="org-string">"johnw"</span> 6697)))
        (<span class="org-keyword">when</span> (&gt; (length pass) 32)
          (<span class="org-warning">error</span> <span class="org-string">"Failed to read ZNC password"</span>))
        (erc <span class="org-builtin">:server</span> <span class="org-string">"127.0.0.1"</span> <span class="org-builtin">:port</span> 6697 <span class="org-builtin">:nick</span> <span class="org-string">"johnw"</span>
             <span class="org-builtin">:password</span> (concat <span class="org-string">"johnw/gitter:"</span> pass))
        (sleep-for 5)
        (erc <span class="org-builtin">:server</span> <span class="org-string">"127.0.0.1"</span> <span class="org-builtin">:port</span> 6697 <span class="org-builtin">:nick</span> <span class="org-string">"johnw"</span>
             <span class="org-builtin">:password</span> (concat <span class="org-string">"johnw/freenode:"</span> pass)))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">reset-erc-track-mode</span> ()
    (<span class="org-keyword">interactive</span>)
    (<span class="org-keyword">setq</span> erc-modified-channels-alist nil)
    (erc-modified-channels-update)
    (erc-modified-channels-display)
    (force-mode-line-update))

  (<span class="org-keyword">defun</span> <span class="org-function-name">setup-irc-environment</span> ()
    (set (make-local-variable 'scroll-conservatively) 100)
    (<span class="org-keyword">setq</span> erc-timestamp-only-if-changed-flag nil
          erc-timestamp-format <span class="org-string">"%H:%M "</span>
          erc-fill-prefix <span class="org-string">"          "</span>
          erc-fill-column 78
          erc-insert-timestamp-function 'erc-insert-timestamp-left
          ivy-use-virtual-buffers nil))

  (<span class="org-keyword">defcustom</span> <span class="org-variable-name">erc-foolish-content</span> '()
    <span class="org-doc">"Regular expressions to identify foolish content.</span>
<span class="org-doc">    Usually what happens is that you add the bots to</span>
<span class="org-doc">    `</span><span class="org-doc"><span class="org-constant">erc-ignore-list</span></span><span class="org-doc">' and the bot commands to this list."</span>
    <span class="org-builtin">:group</span> 'erc
    <span class="org-builtin">:type</span> '(repeat regexp))

  (<span class="org-keyword">defun</span> <span class="org-function-name">erc-foolish-content</span> (msg)
    <span class="org-doc">"Check whether MSG is foolish."</span>
    (erc-list-match erc-foolish-content msg))

  <span class="org-builtin">:init</span>
  (add-hook 'erc-mode-hook #'setup-irc-environment)
  (<span class="org-keyword">when</span> alternate-emacs
    (add-hook 'emacs-startup-hook 'irc))

  (eval-after-load 'erc-identd
    '(<span class="org-keyword">defun</span> <span class="org-function-name">erc-identd-start</span> (<span class="org-type">&amp;optional</span> port)
       <span class="org-doc">"Start an identd server listening to port 8113.</span>
<span class="org-doc">  Port 113 (auth) will need to be redirected to port 8113 on your</span>
<span class="org-doc">  machine -- using iptables, or a program like redir which can be</span>
<span class="org-doc">  run from inetd. The idea is to provide a simple identd server</span>
<span class="org-doc">  when you need one, without having to install one globally on</span>
<span class="org-doc">  your system."</span>
       (<span class="org-keyword">interactive</span> (list (read-string <span class="org-string">"Serve identd requests on port: "</span> <span class="org-string">"8113"</span>)))
       (<span class="org-keyword">unless</span> port (<span class="org-keyword">setq</span> port erc-identd-port))
       (<span class="org-keyword">when</span> (stringp port)
         (<span class="org-keyword">setq</span> port (string-to-number port)))
       (<span class="org-keyword">when</span> erc-identd-process
         (delete-process erc-identd-process))
       (<span class="org-keyword">setq</span> erc-identd-process
<span class="org-whitespace-indentation">    </span>     (make-network-process <span class="org-builtin">:name</span> <span class="org-string">"identd"</span>
<span class="org-whitespace-indentation">            </span>           <span class="org-builtin">:buffer</span> nil
<span class="org-whitespace-indentation">            </span>           <span class="org-builtin">:host</span> 'local <span class="org-builtin">:service</span> port
<span class="org-whitespace-indentation">            </span>           <span class="org-builtin">:server</span> t <span class="org-builtin">:noquery</span> t
<span class="org-whitespace-indentation">            </span>           <span class="org-builtin">:filter</span> 'erc-identd-filter))
       (set-process-query-on-exit-flag erc-identd-process nil)))

  <span class="org-builtin">:config</span>
  (erc-track-minor-mode 1)
  (erc-track-mode 1)

  (add-hook 'erc-insert-pre-hook
            #'(lambda (s)
                (<span class="org-keyword">when</span> (erc-foolish-content s)
                  (<span class="org-keyword">setq</span> erc-insert-this nil)))))

(use-package erc-alert
  <span class="org-builtin">:disabled</span> t
  <span class="org-builtin">:after</span> erc)

(use-package erc-highlight-nicknames
  <span class="org-builtin">:after</span> erc)

(use-package erc-macros
  <span class="org-builtin">:after</span> erc)

(use-package erc-patch
  <span class="org-builtin">:disabled</span> t
  <span class="org-builtin">:after</span> erc)

(use-package erc-question
  <span class="org-builtin">:disabled</span> t
  <span class="org-builtin">:after</span> erc)

(use-package erc-yank
  <span class="org-builtin">:load-path</span> <span class="org-string">"lisp/erc-yank"</span>
  <span class="org-builtin">:after</span> erc
  <span class="org-builtin">:bind</span> (<span class="org-builtin">:map</span> erc-mode-map
              (<span class="org-string">"C-y"</span> . erc-yank )))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc0f72d1" class="outline-2">
<h2 id="orgc0f72d1">Emacs and Microsoft Windows/MS-DOS</h2>
<div class="outline-text-2" id="text-orgc0f72d1">
<p>
Eventually have a look as well at <code>input-decode-map</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* App G Emacs and (info "(emacs)Microsoft Windows/MS-DOS")</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-AppG-ms-dos <span class="org-string">"Appendix G Emacs and MS-DOS"</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Divide key (needed in GNU Emacs for Windows).</span>
  (global-set-key (kbd <span class="org-string">"&lt;kp-divide&gt;"</span>) (kbd <span class="org-string">"/"</span>))

)                                       <span class="org-comment-delimiter">; </span><span class="org-comment">Chapter G ends here.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org566d66d" class="outline-2">
<h2 id="org566d66d">Profiler</h2>
<div class="outline-text-2" id="text-org566d66d">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;</span><span class="org-comment">* Profiler</span>

  (<span class="org-keyword">with-eval-after-load</span> <span class="org-string">"profiler"</span>

    (<span class="org-keyword">setq</span> profiler-report-cpu-line-format
      '((100 left)                      <span class="org-comment-delimiter">; </span><span class="org-comment">The 100 above is increased from the</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">default of 50 to allow the deeply</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">nested call tree to be seen.</span>
        (24 right ((19 right)
                   (5 right))))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org5599d81" class="outline-2">
<h2 id="org5599d81">Reporting Bugs</h2>
<div class="outline-text-2" id="text-org5599d81">
<p>
To get a backtrace when a specific regexp is displayed in the echo area (through
calls to message), set the variable <code>debug-on-message</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Recovery from Problems</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">* Reporting Bugs</span>

(<span class="org-keyword">leuven--chapter</span> leuven-load-chapter-99-debugging <span class="org-string">"99 Debugging"</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Get the backtrace when uncaught errors occur.</span>
  (<span class="org-keyword">setq</span> debug-on-error nil)             <span class="org-comment-delimiter">; </span><span class="org-comment">Was set to `t' at beginning of file.</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Hit `</span><span class="org-comment"><span class="org-constant">C-g</span></span><span class="org-comment">' while it's frozen to get an Emacs Lisp backtrace.</span>
  (<span class="org-keyword">setq</span> debug-on-quit nil)              <span class="org-comment-delimiter">; </span><span class="org-comment">Was set to `t' at beginning of file.</span>

  (<span class="org-keyword">setq</span> debug-on-entry 'user-error))

<span class="org-comment-delimiter">;; </span><span class="org-comment">(use-package ert</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">:bind ("C-c e t" . ert-run-tests-interactively))</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">when</span> (<span class="org-keyword">and</span> (string-match <span class="org-string">"GNU Emacs"</span> (version))
           leuven-verbose-loading)
  (ad-disable-advice 'message 'before 'leuven-when-was-that)
  (ad-update 'message))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">when</span> leuven-verbose-loading
  (message <span class="org-string">"| Chapter | Time |"</span>)
  (message <span class="org-string">"|---------+------|"</span>)
  (mapcar #'(lambda (el)                  <span class="org-comment-delimiter">; </span><span class="org-comment">FIXME Use `</span><span class="org-comment"><span class="org-constant">mapc</span></span><span class="org-comment">' or `</span><span class="org-comment"><span class="org-constant">dolist</span></span><span class="org-comment">'.</span>
              (message el))
          (nreverse leuven--load-times-list))
  (message <span class="org-string">"|---------+------|"</span>)
  (message <span class="org-string">"|         | =vsum(@-I..@-II) |"</span>))
</pre>
</div>
</div>
</div>

<div id="outline-container-org5f6b9b4" class="outline-2">
<h2 id="org5f6b9b4">Post Init</h2>
<div class="outline-text-2" id="text-org5f6b9b4">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">let</span> ((elapsed (float-time (time-subtract (current-time)
                                          leuven--start-time))))
  (message <span class="org-string">"[Loaded %s in %.2f s]"</span> load-file-name elapsed))
(sit-for 0.3)

</pre>
</div>

<p>
See <a href="https://github.com/emacs-dashboard/emacs-dashboard/issues/57">https://github.com/emacs-dashboard/emacs-dashboard/issues/57</a> (very nice
dashboard):
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">;; (use-package dashboard</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">;;   :if (&lt; (length command-line-args) 2)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">;;   :preface</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(defun my/dashboard-banner ()</span>
<span class="org-comment-delimiter">;;     </span><span class="org-comment">"Sets a dashboard banner including information on package initialization</span>
<span class="org-comment-delimiter">;;      </span><span class="org-comment">time and garbage collections."</span>
<span class="org-comment-delimiter">;;     </span><span class="org-comment">(setq dashboard-banner-logo-title</span>
<span class="org-comment-delimiter">;;           </span><span class="org-comment">(format "Emacs ready in %.2f seconds with %d garbage collections."</span>
<span class="org-comment-delimiter">;;                   </span><span class="org-comment">(float-time</span>
<span class="org-comment-delimiter">;;                    </span><span class="org-comment">(time-subtract after-init-time before-init-time)) gcs-done)))</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">;; :init</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(add-hook 'after-init-hook 'dashboard-refresh-buffer)</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(add-hook 'dashboard-mode-hook 'my/dashboard-banner)</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">;; :custom</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">;; (dashboard-startup-banner 'logo)</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">;; :config</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(dashboard-setup-startup-hook)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">;; )</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'after-init-hook
          #'(lambda ()
              (message <span class="org-string">"[Emacs startup time: %s; GC done: %S]"</span> (emacs-init-time) gcs-done)
              (sit-for 0.3))
  t)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgeec5eb4" class="outline-2">
<h2 id="orgeec5eb4">Leuven</h2>
<div class="outline-text-2" id="text-orgeec5eb4">
<p>
If you are like me, you want to know if there are:
</p>

<ul class="org-ul">
<li>changes to existing files</li>
<li>newly added files</li>
<li>deleted files</li>
</ul>

<p>
and specifically do not want to know about <b>untracked files</b>.
</p>

<p>
This should do it:
</p>

<div class="org-src-container">
<pre class="src src-shell">git status --untracked-files=no --porcelain
</pre>
</div>

<p>
See <a href="https://github.com/mordocai/.emacs.d/blob/master/init.el">https://github.com/mordocai/.emacs.d/blob/master/init.el</a> for many Git
functions implemented in Emacs Lisp.
</p>

<p>
&ldquo;Package can be upgraded&rdquo;
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-update</span> ()
    <span class="org-doc">"Update Emacs-Leuven to its latest version."</span>
    (<span class="org-keyword">interactive</span>)
    (leuven-emacs-version)
    (message <span class="org-string">"[Updating Leuven...]"</span>)
    (cd leuven--directory)
    (<span class="org-keyword">let</span> ((ret (shell-command-to-string <span class="org-string">"LC_ALL=C git pull --rebase"</span>)))
      (<span class="org-keyword">if</span> (string-match <span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">up to date</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">up-to-date</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span> ret)
          (message <span class="org-string">"[Configuration already up-to-date]"</span>)
        (princ ret)
        (sit-for 3)
        (message <span class="org-string">"[Configuration updated. Restart Emacs to complete the process]"</span>))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-show-latest-commits</span> ()
    <span class="org-doc">"List latest changes in Emacs-Leuven."</span>
    (<span class="org-keyword">interactive</span>)
    (leuven-emacs-version)
    (message <span class="org-string">"[Fetching last changes in Leuven...]"</span>)
    (cd leuven--directory)
    (<span class="org-keyword">let</span> ((ret (shell-command-to-string <span class="org-string">"LC_ALL=C git fetch --verbose"</span>))
          (bufname <span class="org-string">"*Leuven latest commits*"</span>))
      (<span class="org-keyword">if</span> (string-match <span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">up to date</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">up-to-date</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">"</span> ret)
          (message <span class="org-string">"[Configuration already up-to-date]"</span>)
       (<span class="org-keyword">with-output-to-temp-buffer</span> bufname
         (shell-command
          <span class="org-string">"LC_ALL=C git log --pretty=format:'%h %ad %s' --date=short HEAD..origin"</span>
          bufname)
         (pop-to-buffer bufname)))))

  (<span class="org-keyword">defun</span> <span class="org-function-name">leuven-emacs-version</span> ()
    (<span class="org-keyword">interactive</span>)
    (message <span class="org-string">"[Emacs-Leuven version %s]"</span> leuven--emacs-version))
</pre>
</div>

<p>
Please address particular issues or suggestions <b>specifically</b>, using <code>M-x
leuven-send-bug-report</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(message <span class="org-string">"* --[ Loaded Emacs-Leuven %s]--"</span> leuven--emacs-version)
</pre>
</div>
</div>

<div id="outline-container-org5ee40c1" class="outline-3">
<h3 id="org5ee40c1">Feature</h3>
<div class="outline-text-3" id="text-org5ee40c1">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span class="org-keyword">provide</span> '<span class="org-constant">emacs-leuven</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgaaec302" class="outline-3">
<h3 id="orgaaec302">File Local Variables</h3>
<div class="outline-text-3" id="text-orgaaec302">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">This is for the sake of Emacs.</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Local Variables&#58;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">coding: utf-8-unix</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">eval: (when (require 'rainbow-mode nil t) (rainbow-mode))</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">flycheck-emacs-lisp-initialize-packages: t</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">flycheck-mode: nil</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">ispell-local-dictionary: "american"</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">End:</span>

<span class="org-comment-delimiter">;;; </span><span class="org-comment">emacs-leuven.el ends here</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Fabrice Niessen</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
